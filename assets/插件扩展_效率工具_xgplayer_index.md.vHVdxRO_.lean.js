import{i as Gr,k as Wr,l as Ws,g as wr,h as Vr,b as Rr,c as Tr}from"./chunks/theme.Cyu29J7Q.js";import{b as vt,B as Kt,U as Ut,c as Xn,d as Gn,e as St,S as xr,f as xi,W as ws,s as ei,u as Mr,A as Cr,g as Yr,a as Vs}from"./chunks/index.min.Dk0WtnfT.js";import{G as Mi,r as Ir,b as _r,f as ui,P as Rs,O as Mt,j as Ct,K as Lt,u as Zt,h as Wn,L as Fr,a8 as Kr,S as Dr,aE as Pr,ad as Hr}from"./chunks/framework.DMTyxyBf.js";function Ts(r,a){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);a&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),t.push.apply(t,i)}return t}function Ce(r){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?Ts(Object(t),!0).forEach(function(i){B(r,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Ts(Object(t)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(t,i))})}return r}function se(){se=function(){return r};var r={},a=Object.prototype,t=a.hasOwnProperty,i=Object.defineProperty||function(m,p,v){m[p]=v.value},e=typeof Symbol=="function"?Symbol:{},s=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",l=e.toStringTag||"@@toStringTag";function o(m,p,v){return Object.defineProperty(m,p,{value:v,enumerable:!0,configurable:!0,writable:!0}),m[p]}try{o({},"")}catch{o=function(p,v,E){return p[v]=E}}function u(m,p,v,E){var Z=p&&p.prototype instanceof c?p:c,R=Object.create(Z.prototype),x=new M(E||[]);return i(R,"_invoke",{value:k(m,v,x)}),R}function h(m,p,v){try{return{type:"normal",arg:m.call(p,v)}}catch(E){return{type:"throw",arg:E}}}r.wrap=u;var d={};function c(){}function f(){}function y(){}var g={};o(g,s,function(){return this});var b=Object.getPrototypeOf,S=b&&b(b(C([])));S&&S!==a&&t.call(S,s)&&(g=S);var G=y.prototype=c.prototype=Object.create(g);function X(m){["next","throw","return"].forEach(function(p){o(m,p,function(v){return this._invoke(p,v)})})}function L(m,p){function v(Z,R,x,D){var _=h(m[Z],m,R);if(_.type!=="throw"){var K=_.arg,j=K.value;return j&&typeof j=="object"&&t.call(j,"__await")?p.resolve(j.__await).then(function(P){v("next",P,x,D)},function(P){v("throw",P,x,D)}):p.resolve(j).then(function(P){K.value=P,x(K)},function(P){return v("throw",P,x,D)})}D(_.arg)}var E;i(this,"_invoke",{value:function(Z,R){function x(){return new p(function(D,_){v(Z,R,D,_)})}return E=E?E.then(x,x):x()}})}function k(m,p,v){var E="suspendedStart";return function(Z,R){if(E==="executing")throw new Error("Generator is already running");if(E==="completed"){if(Z==="throw")throw R;return U()}for(v.method=Z,v.arg=R;;){var x=v.delegate;if(x){var D=W(x,v);if(D){if(D===d)continue;return D}}if(v.method==="next")v.sent=v._sent=v.arg;else if(v.method==="throw"){if(E==="suspendedStart")throw E="completed",v.arg;v.dispatchException(v.arg)}else v.method==="return"&&v.abrupt("return",v.arg);E="executing";var _=h(m,p,v);if(_.type==="normal"){if(E=v.done?"completed":"suspendedYield",_.arg===d)continue;return{value:_.arg,done:v.done}}_.type==="throw"&&(E="completed",v.method="throw",v.arg=_.arg)}}}function W(m,p){var v=p.method,E=m.iterator[v];if(E===void 0)return p.delegate=null,v==="throw"&&m.iterator.return&&(p.method="return",p.arg=void 0,W(m,p),p.method==="throw")||v!=="return"&&(p.method="throw",p.arg=new TypeError("The iterator does not provide a '"+v+"' method")),d;var Z=h(E,m.iterator,p.arg);if(Z.type==="throw")return p.method="throw",p.arg=Z.arg,p.delegate=null,d;var R=Z.arg;return R?R.done?(p[m.resultName]=R.value,p.next=m.nextLoc,p.method!=="return"&&(p.method="next",p.arg=void 0),p.delegate=null,d):R:(p.method="throw",p.arg=new TypeError("iterator result is not an object"),p.delegate=null,d)}function V(m){var p={tryLoc:m[0]};1 in m&&(p.catchLoc=m[1]),2 in m&&(p.finallyLoc=m[2],p.afterLoc=m[3]),this.tryEntries.push(p)}function w(m){var p=m.completion||{};p.type="normal",delete p.arg,m.completion=p}function M(m){this.tryEntries=[{tryLoc:"root"}],m.forEach(V,this),this.reset(!0)}function C(m){if(m){var p=m[s];if(p)return p.call(m);if(typeof m.next=="function")return m;if(!isNaN(m.length)){var v=-1,E=function Z(){for(;++v<m.length;)if(t.call(m,v))return Z.value=m[v],Z.done=!1,Z;return Z.value=void 0,Z.done=!0,Z};return E.next=E}}return{next:U}}function U(){return{value:void 0,done:!0}}return f.prototype=y,i(G,"constructor",{value:y,configurable:!0}),i(y,"constructor",{value:f,configurable:!0}),f.displayName=o(y,l,"GeneratorFunction"),r.isGeneratorFunction=function(m){var p=typeof m=="function"&&m.constructor;return!!p&&(p===f||(p.displayName||p.name)==="GeneratorFunction")},r.mark=function(m){return Object.setPrototypeOf?Object.setPrototypeOf(m,y):(m.__proto__=y,o(m,l,"GeneratorFunction")),m.prototype=Object.create(G),m},r.awrap=function(m){return{__await:m}},X(L.prototype),o(L.prototype,n,function(){return this}),r.AsyncIterator=L,r.async=function(m,p,v,E,Z){Z===void 0&&(Z=Promise);var R=new L(u(m,p,v,E),Z);return r.isGeneratorFunction(p)?R:R.next().then(function(x){return x.done?x.value:R.next()})},X(G),o(G,l,"Generator"),o(G,s,function(){return this}),o(G,"toString",function(){return"[object Generator]"}),r.keys=function(m){var p=Object(m),v=[];for(var E in p)v.push(E);return v.reverse(),function Z(){for(;v.length;){var R=v.pop();if(R in p)return Z.value=R,Z.done=!1,Z}return Z.done=!0,Z}},r.values=C,M.prototype={constructor:M,reset:function(m){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!m)for(var p in this)p.charAt(0)==="t"&&t.call(this,p)&&!isNaN(+p.slice(1))&&(this[p]=void 0)},stop:function(){this.done=!0;var m=this.tryEntries[0].completion;if(m.type==="throw")throw m.arg;return this.rval},dispatchException:function(m){if(this.done)throw m;var p=this;function v(_,K){return R.type="throw",R.arg=m,p.next=_,K&&(p.method="next",p.arg=void 0),!!K}for(var E=this.tryEntries.length-1;E>=0;--E){var Z=this.tryEntries[E],R=Z.completion;if(Z.tryLoc==="root")return v("end");if(Z.tryLoc<=this.prev){var x=t.call(Z,"catchLoc"),D=t.call(Z,"finallyLoc");if(x&&D){if(this.prev<Z.catchLoc)return v(Z.catchLoc,!0);if(this.prev<Z.finallyLoc)return v(Z.finallyLoc)}else if(x){if(this.prev<Z.catchLoc)return v(Z.catchLoc,!0)}else{if(!D)throw new Error("try statement without catch or finally");if(this.prev<Z.finallyLoc)return v(Z.finallyLoc)}}}},abrupt:function(m,p){for(var v=this.tryEntries.length-1;v>=0;--v){var E=this.tryEntries[v];if(E.tryLoc<=this.prev&&t.call(E,"finallyLoc")&&this.prev<E.finallyLoc){var Z=E;break}}Z&&(m==="break"||m==="continue")&&Z.tryLoc<=p&&p<=Z.finallyLoc&&(Z=null);var R=Z?Z.completion:{};return R.type=m,R.arg=p,Z?(this.method="next",this.next=Z.finallyLoc,d):this.complete(R)},complete:function(m,p){if(m.type==="throw")throw m.arg;return m.type==="break"||m.type==="continue"?this.next=m.arg:m.type==="return"?(this.rval=this.arg=m.arg,this.method="return",this.next="end"):m.type==="normal"&&p&&(this.next=p),d},finish:function(m){for(var p=this.tryEntries.length-1;p>=0;--p){var v=this.tryEntries[p];if(v.finallyLoc===m)return this.complete(v.completion,v.afterLoc),w(v),d}},catch:function(m){for(var p=this.tryEntries.length-1;p>=0;--p){var v=this.tryEntries[p];if(v.tryLoc===m){var E=v.completion;if(E.type==="throw"){var Z=E.arg;w(v)}return Z}}throw new Error("illegal catch attempt")},delegateYield:function(m,p,v){return this.delegate={iterator:C(m),resultName:p,nextLoc:v},this.method==="next"&&(this.arg=void 0),d}},r}function Oi(r){"@babel/helpers - typeof";return Oi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},Oi(r)}function xs(r,a,t,i,e,s,n){try{var l=r[s](n),o=l.value}catch(u){t(u);return}l.done?a(o):Promise.resolve(o).then(i,e)}function Ve(r){return function(){var a=this,t=arguments;return new Promise(function(i,e){var s=r.apply(a,t);function n(o){xs(s,i,e,n,l,"next",o)}function l(o){xs(s,i,e,n,l,"throw",o)}n(void 0)})}}function ki(r,a){if(!(r instanceof a))throw new TypeError("Cannot call a class as a function")}function Ms(r,a){for(var t=0;t<a.length;t++){var i=a[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,Rn(i.key),i)}}function Si(r,a,t){return a&&Ms(r.prototype,a),t&&Ms(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function B(r,a,t){return a=Rn(a),a in r?Object.defineProperty(r,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[a]=t,r}function wn(r,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(a&&a.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),a&&Ai(r,a)}function pi(r){return pi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pi(r)}function Ai(r,a){return Ai=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,e){return i.__proto__=e,i},Ai(r,a)}function Nr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ee(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Ur(r,a){if(a&&(typeof a=="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ee(r)}function Vn(r){var a=Nr();return function(){var i=pi(r),e;if(a){var s=pi(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return Ur(this,e)}}function zr(r,a){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var i=t.call(r,a||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(r)}function Rn(r){var a=zr(r,"string");return typeof a=="symbol"?a:String(a)}function Cs(r,a){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);a&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),t.push.apply(t,i)}return t}function zt(r){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?Cs(Object(t),!0).forEach(function(i){I(r,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Cs(Object(t)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(t,i))})}return r}function ge(){ge=function(){return r};var r={},a=Object.prototype,t=a.hasOwnProperty,i=Object.defineProperty||function(m,p,v){m[p]=v.value},e=typeof Symbol=="function"?Symbol:{},s=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",l=e.toStringTag||"@@toStringTag";function o(m,p,v){return Object.defineProperty(m,p,{value:v,enumerable:!0,configurable:!0,writable:!0}),m[p]}try{o({},"")}catch{o=function(p,v,E){return p[v]=E}}function u(m,p,v,E){var Z=p&&p.prototype instanceof c?p:c,R=Object.create(Z.prototype),x=new M(E||[]);return i(R,"_invoke",{value:k(m,v,x)}),R}function h(m,p,v){try{return{type:"normal",arg:m.call(p,v)}}catch(E){return{type:"throw",arg:E}}}r.wrap=u;var d={};function c(){}function f(){}function y(){}var g={};o(g,s,function(){return this});var b=Object.getPrototypeOf,S=b&&b(b(C([])));S&&S!==a&&t.call(S,s)&&(g=S);var G=y.prototype=c.prototype=Object.create(g);function X(m){["next","throw","return"].forEach(function(p){o(m,p,function(v){return this._invoke(p,v)})})}function L(m,p){function v(Z,R,x,D){var _=h(m[Z],m,R);if(_.type!=="throw"){var K=_.arg,j=K.value;return j&&typeof j=="object"&&t.call(j,"__await")?p.resolve(j.__await).then(function(P){v("next",P,x,D)},function(P){v("throw",P,x,D)}):p.resolve(j).then(function(P){K.value=P,x(K)},function(P){return v("throw",P,x,D)})}D(_.arg)}var E;i(this,"_invoke",{value:function(Z,R){function x(){return new p(function(D,_){v(Z,R,D,_)})}return E=E?E.then(x,x):x()}})}function k(m,p,v){var E="suspendedStart";return function(Z,R){if(E==="executing")throw new Error("Generator is already running");if(E==="completed"){if(Z==="throw")throw R;return U()}for(v.method=Z,v.arg=R;;){var x=v.delegate;if(x){var D=W(x,v);if(D){if(D===d)continue;return D}}if(v.method==="next")v.sent=v._sent=v.arg;else if(v.method==="throw"){if(E==="suspendedStart")throw E="completed",v.arg;v.dispatchException(v.arg)}else v.method==="return"&&v.abrupt("return",v.arg);E="executing";var _=h(m,p,v);if(_.type==="normal"){if(E=v.done?"completed":"suspendedYield",_.arg===d)continue;return{value:_.arg,done:v.done}}_.type==="throw"&&(E="completed",v.method="throw",v.arg=_.arg)}}}function W(m,p){var v=p.method,E=m.iterator[v];if(E===void 0)return p.delegate=null,v==="throw"&&m.iterator.return&&(p.method="return",p.arg=void 0,W(m,p),p.method==="throw")||v!=="return"&&(p.method="throw",p.arg=new TypeError("The iterator does not provide a '"+v+"' method")),d;var Z=h(E,m.iterator,p.arg);if(Z.type==="throw")return p.method="throw",p.arg=Z.arg,p.delegate=null,d;var R=Z.arg;return R?R.done?(p[m.resultName]=R.value,p.next=m.nextLoc,p.method!=="return"&&(p.method="next",p.arg=void 0),p.delegate=null,d):R:(p.method="throw",p.arg=new TypeError("iterator result is not an object"),p.delegate=null,d)}function V(m){var p={tryLoc:m[0]};1 in m&&(p.catchLoc=m[1]),2 in m&&(p.finallyLoc=m[2],p.afterLoc=m[3]),this.tryEntries.push(p)}function w(m){var p=m.completion||{};p.type="normal",delete p.arg,m.completion=p}function M(m){this.tryEntries=[{tryLoc:"root"}],m.forEach(V,this),this.reset(!0)}function C(m){if(m){var p=m[s];if(p)return p.call(m);if(typeof m.next=="function")return m;if(!isNaN(m.length)){var v=-1,E=function Z(){for(;++v<m.length;)if(t.call(m,v))return Z.value=m[v],Z.done=!1,Z;return Z.value=void 0,Z.done=!0,Z};return E.next=E}}return{next:U}}function U(){return{value:void 0,done:!0}}return f.prototype=y,i(G,"constructor",{value:y,configurable:!0}),i(y,"constructor",{value:f,configurable:!0}),f.displayName=o(y,l,"GeneratorFunction"),r.isGeneratorFunction=function(m){var p=typeof m=="function"&&m.constructor;return!!p&&(p===f||(p.displayName||p.name)==="GeneratorFunction")},r.mark=function(m){return Object.setPrototypeOf?Object.setPrototypeOf(m,y):(m.__proto__=y,o(m,l,"GeneratorFunction")),m.prototype=Object.create(G),m},r.awrap=function(m){return{__await:m}},X(L.prototype),o(L.prototype,n,function(){return this}),r.AsyncIterator=L,r.async=function(m,p,v,E,Z){Z===void 0&&(Z=Promise);var R=new L(u(m,p,v,E),Z);return r.isGeneratorFunction(p)?R:R.next().then(function(x){return x.done?x.value:R.next()})},X(G),o(G,l,"Generator"),o(G,s,function(){return this}),o(G,"toString",function(){return"[object Generator]"}),r.keys=function(m){var p=Object(m),v=[];for(var E in p)v.push(E);return v.reverse(),function Z(){for(;v.length;){var R=v.pop();if(R in p)return Z.value=R,Z.done=!1,Z}return Z.done=!0,Z}},r.values=C,M.prototype={constructor:M,reset:function(m){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!m)for(var p in this)p.charAt(0)==="t"&&t.call(this,p)&&!isNaN(+p.slice(1))&&(this[p]=void 0)},stop:function(){this.done=!0;var m=this.tryEntries[0].completion;if(m.type==="throw")throw m.arg;return this.rval},dispatchException:function(m){if(this.done)throw m;var p=this;function v(_,K){return R.type="throw",R.arg=m,p.next=_,K&&(p.method="next",p.arg=void 0),!!K}for(var E=this.tryEntries.length-1;E>=0;--E){var Z=this.tryEntries[E],R=Z.completion;if(Z.tryLoc==="root")return v("end");if(Z.tryLoc<=this.prev){var x=t.call(Z,"catchLoc"),D=t.call(Z,"finallyLoc");if(x&&D){if(this.prev<Z.catchLoc)return v(Z.catchLoc,!0);if(this.prev<Z.finallyLoc)return v(Z.finallyLoc)}else if(x){if(this.prev<Z.catchLoc)return v(Z.catchLoc,!0)}else{if(!D)throw new Error("try statement without catch or finally");if(this.prev<Z.finallyLoc)return v(Z.finallyLoc)}}}},abrupt:function(m,p){for(var v=this.tryEntries.length-1;v>=0;--v){var E=this.tryEntries[v];if(E.tryLoc<=this.prev&&t.call(E,"finallyLoc")&&this.prev<E.finallyLoc){var Z=E;break}}Z&&(m==="break"||m==="continue")&&Z.tryLoc<=p&&p<=Z.finallyLoc&&(Z=null);var R=Z?Z.completion:{};return R.type=m,R.arg=p,Z?(this.method="next",this.next=Z.finallyLoc,d):this.complete(R)},complete:function(m,p){if(m.type==="throw")throw m.arg;return m.type==="break"||m.type==="continue"?this.next=m.arg:m.type==="return"?(this.rval=this.arg=m.arg,this.method="return",this.next="end"):m.type==="normal"&&p&&(this.next=p),d},finish:function(m){for(var p=this.tryEntries.length-1;p>=0;--p){var v=this.tryEntries[p];if(v.finallyLoc===m)return this.complete(v.completion,v.afterLoc),w(v),d}},catch:function(m){for(var p=this.tryEntries.length-1;p>=0;--p){var v=this.tryEntries[p];if(v.tryLoc===m){var E=v.completion;if(E.type==="throw"){var Z=E.arg;w(v)}return Z}}throw new Error("illegal catch attempt")},delegateYield:function(m,p,v){return this.delegate={iterator:C(m),resultName:p,nextLoc:v},this.method==="next"&&(this.arg=void 0),d}},r}function Wt(r){"@babel/helpers - typeof";return Wt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},Wt(r)}function Ys(r,a,t,i,e,s,n){try{var l=r[s](n),o=l.value}catch(u){t(u);return}l.done?a(o):Promise.resolve(o).then(i,e)}function dt(r){return function(){var a=this,t=arguments;return new Promise(function(i,e){var s=r.apply(a,t);function n(o){Ys(s,i,e,n,l,"next",o)}function l(o){Ys(s,i,e,n,l,"throw",o)}n(void 0)})}}function He(r,a){if(!(r instanceof a))throw new TypeError("Cannot call a class as a function")}function Is(r,a){for(var t=0;t<a.length;t++){var i=a[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,xn(i.key),i)}}function Ne(r,a,t){return a&&Is(r.prototype,a),t&&Is(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function I(r,a,t){return a=xn(a),a in r?Object.defineProperty(r,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[a]=t,r}function Qt(r,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(a&&a.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),a&&Jt(r,a)}function wt(r){return wt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wt(r)}function Jt(r,a){return Jt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,e){return i.__proto__=e,i},Jt(r,a)}function Tn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hi(r,a,t){return Tn()?hi=Reflect.construct.bind():hi=function(e,s,n){var l=[null];l.push.apply(l,s);var o=Function.bind.apply(e,l),u=new o;return n&&Jt(u,n.prototype),u},hi.apply(null,arguments)}function Jr(r){return Function.toString.call(r).indexOf("[native code]")!==-1}function mi(r){var a=typeof Map=="function"?new Map:void 0;return mi=function(i){if(i===null||!Jr(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(typeof a<"u"){if(a.has(i))return a.get(i);a.set(i,e)}function e(){return hi(i,arguments,wt(this).constructor)}return e.prototype=Object.create(i.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Jt(e,i)},mi(r)}function Br(r,a){if(r==null)return{};var t={},i=Object.keys(r),e,s;for(s=0;s<i.length;s++)e=i[s],!(a.indexOf(e)>=0)&&(t[e]=r[e]);return t}function Or(r,a){if(r==null)return{};var t=Br(r,a),i,e;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(e=0;e<s.length;e++)i=s[e],!(a.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(t[i]=r[i])}return t}function O(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Ar(r,a){if(a&&(typeof a=="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return O(r)}function qt(r){var a=Tn();return function(){var i=wt(r),e;if(a){var s=wt(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return Ar(this,e)}}function jr(r,a){for(;!Object.prototype.hasOwnProperty.call(r,a)&&(r=wt(r),r!==null););return r}function di(){return typeof Reflect<"u"&&Reflect.get?di=Reflect.get.bind():di=function(a,t,i){var e=jr(a,t);if(e){var s=Object.getOwnPropertyDescriptor(e,t);return s.get?s.get.call(arguments.length<3?a:i):s.value}},di.apply(this,arguments)}function Qr(r,a){if(r){if(typeof r=="string")return _s(r,a);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return _s(r,a)}}function _s(r,a){(a==null||a>r.length)&&(a=r.length);for(var t=0,i=new Array(a);t<a;t++)i[t]=r[t];return i}function qr(r,a){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=Qr(r))||a){t&&(r=t);var i=0,e=function(){};return{s:e,n:function(){return i>=r.length?{done:!0}:{done:!1,value:r[i++]}},e:function(o){throw o},f:e}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,n=!1,l;return{s:function(){t=t.call(r)},n:function(){var o=t.next();return s=o.done,o},e:function(o){n=!0,l=o},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(n)throw l}}}}function $r(r,a){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var i=t.call(r,a||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(r)}function xn(r){var a=$r(r,"string");return typeof a=="symbol"?a:String(a)}var me=function(){function r(){He(this,r)}return Ne(r,null,[{key:"start",value:function(t){return!t||!t.length||t.length===1&&t.end(0)-t.start(0)<1e-6||t.length===1&&t.start(0)<0?0:t.start(0)}},{key:"end",value:function(t){return!t||!t.length||t.length===1&&t.end(0)-t.start(0)<1e-6?0:t.end(t.length-1)}},{key:"get",value:function(t){if(t)try{return t.buffered}catch{}}},{key:"buffers",value:function(t,i){if(!t||!t.length)return[];for(var e=[],s=0,n=t.length;s<n;s++){var l=e.length;if(!l||!i)e.push([t.start(s),t.end(s)]);else{var o=e[l-1],u=o[1],h=t.start(s);if(h-u<=i){var d=t.end(s);d>u&&(o[1]=d)}else e.push([t.start(s),t.end(s)])}}return e}},{key:"totalLength",value:function(t){return!t||!t.length?0:t.reduce(function(i,e){return i+=e[1]-e[0]},0)}},{key:"info",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(!t||!t.length)return{start:0,end:0,buffers:[]};for(var s=0,n=0,l=0,o=0,u=0,h=0,d=0,c=r.buffers(t,e),f=0,y=c.length;f<y;f++){var g=c[f];if(i+e>=g[0]&&i<=g[1])s=g[0],n=g[1],l=f;else if(i+e<g[0]){o=g[0],u=g[1];break}else i+e>g[1]&&(h=g[0],d=g[1])}return{start:s,end:n,index:l,buffers:c,nextStart:o,nextEnd:u,prevStart:h,prevEnd:d,currentTime:i,behind:i-s,remaining:n?n-i:0,length:r.totalLength&&r.totalLength(c)}}},{key:"isBuffered",value:function(t,i){if(t){var e=r.get(t);if(e!=null&&e.length){for(var s=0;s<e.length;s++)if(i>=e.start(s)&&i<=e.end(s))return!0}}return!1}}]),r}(),ea=typeof window<"u",_e,N={MANIFEST:"manifest",NETWORK:"network",NETWORK_TIMEOUT:"network_timeout",NETWORK_FORBIDDEN:"network_forbidden",NETWORK_NOTFOUND:"network_notfound",NETWROK_RANGE_NOT_SATISFIABLE:"network_range_not_satisfiable",DEMUX:"demux",REMUX:"remux",MEDIA:"media",DRM:"drm",OTHER:"other",RUNTIME:"runtime",SUB_TYPES:{FLV:"FLV",HLS:"HLS",MP4:"MP4",FMP4:"FMP4",MSE_ADD_SB:"MSE_ADD_SB",MSE_APPEND_BUFFER:"MSE_APPEND_BUFFER",MSE_OTHER:"MSE_OTHER",MSE_FULL:"MSE_FULL",MSE_CHANGE_TYPE:"MSE_CHANGE_TYPE",OPTION:"OPTION",DASH:"DASH",LICENSE:"LICENSE",CUSTOM_LICENSE:"CUSTOM_LICENSE",MSE_HIJACK:"MSE_HIJACK",EME_HIJACK:"EME_HIJACK",SIDX:"SIDX",NO_CANPLAY_ERROR:"NO_CANPLAY_ERROR",BUFFERBREAK_ERROR:"BUFFERBREAK_ERROR",WAITING_TIMEOUT_ERROR:"WAITING_TIMEOUT_ERROR",MEDIA_ERR_ABORTED:"MEDIA_ERR_ABORTED",MEDIA_ERR_NETWORK:"MEDIA_ERR_NETWORK",MEDIA_ERR_DECODE:"MEDIA_ERR_DECODE",MEDIA_ERR_SRC_NOT_SUPPORTED:"MEDIA_ERR_SRC_NOT_SUPPORTED",MEDIA_ERR_CODEC_NOT_SUPPORTED:"MEDIA_ERR_CODEC_NOT_SUPPORTED",MEDIA_ERR_URL_EMPTY:"MEDIA_ERR_URL_EMPTY"}},ye=(_e={},I(_e,N.MANIFEST,{HLS:1100,DASH:1200}),I(_e,N.NETWORK,2100),I(_e,N.NETWORK_TIMEOUT,2101),I(_e,N.NETWORK_FORBIDDEN,2103),I(_e,N.NETWORK_NOTFOUND,2104),I(_e,N.NETWROK_RANGE_NOT_SATISFIABLE,2116),I(_e,N.DEMUX,{FLV:3100,HLS:3200,MP4:3300,FMP4:3400,SIDX:3410}),I(_e,N.REMUX,{FMP4:4100,MP4:4200}),I(_e,N.MEDIA,{MEDIA_ERR_ABORTED:5101,MEDIA_ERR_NETWORK:5102,MEDIA_ERR_DECODE:5103,MEDIA_ERR_SRC_NOT_SUPPORTED:5104,MEDIA_ERR_CODEC_NOT_SUPPORTED:5105,MEDIA_ERR_URL_EMPTY:5106,MSE_ADD_SB:5200,MSE_APPEND_BUFFER:5201,MSE_OTHER:5202,MSE_FULL:5203,MSE_HIJACK:5204,MSE_CHANGE_TYPE:5205,EME_HIJACK:5301}),I(_e,N.DRM,{LICENSE:7100,CUSTOM_LICENSE:7200}),I(_e,N.OTHER,8e3),I(_e,N.RUNTIME,{NO_CANPLAY_ERROR:9001,BUFFERBREAK_ERROR:9002,WAITING_TIMEOUT_ERROR:9003}),_e),oe=function(r){Qt(t,r);var a=qt(t);function t(i,e,s,n,l){var o;return He(this,t),o=a.call(this,l||(s==null?void 0:s.message)),o.errorType=i===N.NETWORK_TIMEOUT?N.NETWORK:i,o.originError=s,o.ext=n,o.errorCode=ye[i][e]||ye[i],o.errorMessage=o.message,o.errorCode||(o.errorType=N.OTHER,o.errorCode=ye[o.errorType]),o}return Ne(t,null,[{key:"create",value:function(e,s,n,l,o){return e instanceof t?e:(e instanceof Error&&(n=e,e=""),e||(e=N.OTHER),new t(e,s,n,l,o))}},{key:"network",value:function(e){var s;return new t(e!=null&&e.isTimeout?N.NETWORK_TIMEOUT:N.NETWORK,null,e instanceof Error?e:null,{url:e==null?void 0:e.url,response:e==null?void 0:e.response,httpCode:e==null||(s=e.response)===null||s===void 0?void 0:s.status})}}]),t}(mi(Error)),ti={DEBUG:1,LOG:2,WARN:3,ERROR:4},ta=200*1024,ia=["Boolean","Number","String","Undefined","Null","Date","Object"],Te=function(){function r(a,t){He(this,r),this.name=a||"",this._prefix="[".concat(this.name,"]"),this.logCacheLevel=(t==null?void 0:t.logCacheLevel)||3,this.logMaxSize=(t==null?void 0:t.logMaxSize)||ta,this.logSize=0,this.logTextArray=[]}return Ne(r,[{key:"debug",value:function(){for(var t,i=arguments.length,e=new Array(i),s=0;s<i;s++)e[s]=arguments[s];this.logCache.apply(this,[ti.DEBUG].concat(e)),!r.disabled&&(t=console).debug.apply(t,[this._prefix,Ht()].concat(e))}},{key:"log",value:function(){for(var t,i=arguments.length,e=new Array(i),s=0;s<i;s++)e[s]=arguments[s];this.logCache.apply(this,[ti.LOG].concat(e)),!r.disabled&&(t=console).log.apply(t,[this._prefix,Ht()].concat(e))}},{key:"warn",value:function(){for(var t,i=arguments.length,e=new Array(i),s=0;s<i;s++)e[s]=arguments[s];this.logCache.apply(this,[ti.WARN].concat(e)),!r.disabled&&(t=console).warn.apply(t,[this._prefix,Ht()].concat(e))}},{key:"error",value:function(){for(var t,i=arguments.length,e=new Array(i),s=0;s<i;s++)e[s]=arguments[s];this.logCache.apply(this,[ti.ERROR].concat(e)),!r.disabled&&(t=console).error.apply(t,[this._prefix,Ht()].concat(e))}},{key:"logCache",value:function(t){if(!(t<this.logCacheLevel)){var i="";try{for(var e=arguments.length,s=new Array(e>1?e-1:0),n=1;n<e;n++)s[n-1]=arguments[n];var l=s.map(function(u){return Mn(u)});i=this._prefix+Ht()+JSON.stringify(l)}catch{return}if(t>=this.logCacheLevel&&(this.logSize+=i.length,this.logTextArray.push(i)),this.logSize>this.logMaxSize){var o=this.logTextArray.shift();this.logSize-=o.length}}}},{key:"getLogCache",value:function(){var t=this.logTextArray.join(`
`);return this.reset(),t}},{key:"reset",value:function(){this.logTextArray=[],this.logSize=0}},{key:"table",value:function(){var t;r.disabled||(console.group(this._prefix),(t=console).table.apply(t,arguments),console.groupEnd())}},{key:"setLogLevel",value:function(t){this.logCacheLevel=t}}],[{key:"enable",value:function(){r.disabled=!1}},{key:"disable",value:function(){r.disabled=!0}}]),r}();I(Te,"disabled",!0);function Ht(){return new Date().toLocaleString()}function sa(r){if(Wt(r)!=="object")return r;var a=Object.prototype.toString.call(r).slice(8,-1);switch(a){case"Array":case"Uint8Array":case"ArrayBuffer":return a+"["+r.length+"]";case"Object":return"{}";default:return a}}function Mn(r,a,t){t||(t=1),a||(a=2);var i={};if(!r||Wt(r)!=="object")return r;var e=Object.prototype.toString.call(r).slice(8,-1);if(!ia.includes(e))return e;if(!(t>a)){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t===a?i[s]=sa(r[s]):Wt(r[s])==="object"?i[s]=Mn(r[s],a,t+1):i[s]=r[s]);return i}}function Yt(){var r,a,t=new Promise(function(i,e){r=i,a=e});return t.used=!1,t.resolve=function(){return t.used=!0,r.apply(void 0,arguments)},t.reject=function(){return t.used=!0,a.apply(void 0,arguments)},t}function xt(){try{return parseInt(performance.now(),10)}catch{return new Date().getTime()}}var na={stringify:function(a){try{return JSON.stringify(a)}catch{return""}},parse:function(a){try{return JSON.parse(a)}catch{return}}};function Fs(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;try{return ea?r&&typeof ManagedMediaSource<"u"?ManagedMediaSource:window.MediaSource:null}catch{}}function Ci(r){return/ManagedMediaSource/gi.test(Object.prototype.toString.call(r))}function ra(r){var a=[];if(r instanceof TimeRanges)for(var t=0;t<r.length;t++)a.push({start:r.start(t),end:r.end(t)});return a}var ii={APPEND:"appendBuffer",REMOVE:"removeBuffer",UPDATE_DURATION:"updateDuration"},ce=function(){function r(a,t){var i=this;He(this,r),I(this,"media",null),I(this,"mediaSource",null),I(this,"_openPromise",Yt()),I(this,"_queue",Object.create(null)),I(this,"_sourceBuffer",Object.create(null)),I(this,"_mseFullFlag",{}),I(this,"_st",0),I(this,"_opst",0),I(this,"_logger",null),I(this,"_config",null),I(this,"_url",null),I(this,"_onStartStreaming",function(){i._logger.debug("startstreaming")}),I(this,"_onEndStreaming",function(){i._logger.debug("endstreaming")}),I(this,"_onSBUpdateEnd",function(e){var s=i._queue[e];if(s){var n=s[0];if((n==null?void 0:n.opName)!==ii.UPDATE_DURATION&&s.shift(),n){var l,o,u=xt()-i._opst;i._logger.debug("UpdateEnd(".concat(e,"/").concat(n.opName,")"),na.stringify(ra((l=i._sourceBuffer[e])===null||l===void 0?void 0:l.buffered)),u,n.context),n.promise.resolve({name:n.opName,context:n.context,costtime:u});var h=(o=n.context)===null||o===void 0?void 0:o.callback;h&&typeof h=="function"&&h(n.context),i._startQueue(e)}}}),I(this,"_onSBUpdateError",function(e,s){var n=i._queue[e];if(n){var l=n[0];l&&(i._logger.error("UpdateError",e,l.opName,l.context),l.promise.reject(new oe(N.MEDIA,N.SUB_TYPES.MSE_APPEND_BUFFER,s)))}}),this._config=Object.assign(r.getDefaultConfig(),t),a&&this.bindMedia(a),this._logger=new Te("MSE"),this._config.openLog&&Te.enable()}return Ne(r,[{key:"isOpened",get:function(){var t;return((t=this.mediaSource)===null||t===void 0?void 0:t.readyState)==="open"}},{key:"hasOpTasks",get:function(){var t=this,i=!1;return Object.keys(this._queue).forEach(function(e){var s=t._queue[e];Array.isArray(s)&&(i||(i=s.length>0))}),i}},{key:"url",get:function(){return this._url}},{key:"duration",get:function(){var t;return((t=this.mediaSource)===null||t===void 0?void 0:t.duration)||-1}},{key:"isEnded",get:function(){return this.mediaSource?this.mediaSource.readyState==="ended":!1}},{key:"streaming",get:function(){return Ci(this.mediaSource)?this.mediaSource.streaming:!0}},{key:"isFull",value:function(t){return t?this._mseFullFlag[t]:this._mseFullFlag[r.VIDEO]}},{key:"updateDuration",value:function(t){var i=this,e=this.mediaSource&&this.mediaSource.duration>t;if(this.mediaSource&&this.mediaSource.duration>t){var s=0;if(Object.keys(this._sourceBuffer).forEach(function(n){try{s=Math.max(i.bufferEnd(n)||0,s)}catch{}}),t<s)return Promise.resolve()}return this._enqueueBlockingOp(function(){if(i.isEnded){i._logger.debug("setDuration but ended");return}i.mediaSource&&(i.mediaSource.duration=t,i._logger.debug("setDuration",t))},ii.UPDATE_DURATION,{isReduceDuration:e})}},{key:"open",value:function(){var t=this;if(this._openPromise.used&&!this.isOpened&&this.mediaSource){var i=this.mediaSource,e=function s(){var n=xt()-t._st;t._logger.debug("sourceopen",n),i.removeEventListener("sourceopen",s),t._openPromise.resolve({costtime:n})};i.addEventListener("sourceopen",e),this._openPromise=Yt()}return this._openPromise}},{key:"bindMedia",value:function(){var a=dt(ge().mark(function i(e){var s=this,n,l,o,u;return ge().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(!(this.mediaSource||this.media)){d.next=3;break}return d.next=3,this.unbindMedia();case 3:if(n=Fs(this._config.preferMMS),!(!e||!n)){d.next=6;break}throw new Error("Param media or MediaSource does not exist");case 6:return this.media=e,l=this.mediaSource=new n,o=Ci(l),this._st=xt(),u=function c(){var f=xt()-s._st;s._logger.debug("sourceopen"),l.removeEventListener("sourceopen",c),URL.revokeObjectURL(e.src),s._openPromise.resolve({costtime:f})},l.addEventListener("sourceopen",u),o&&(l.addEventListener("startstreaming",this._onStartStreaming),l.addEventListener("endstreaming",this._onEndStreaming)),this._url=URL.createObjectURL(l),e.src=this._url,e.disableRemotePlayback=o,d.abrupt("return",this._openPromise);case 17:case"end":return d.stop()}},i,this)}));function t(i){return a.apply(this,arguments)}return t}()},{key:"unbindMedia",value:function(){var a=dt(ge().mark(function i(){var e=this,s,n,l;return ge().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this._openPromise.used||this._openPromise.resolve(),s=this.mediaSource,s){if(Object.keys(this._queue).forEach(function(h){var d=e._queue[h];d&&d.forEach(function(c){var f,y;return(f=c.promise)===null||f===void 0||(y=f.resolve)===null||y===void 0?void 0:y.call(f)})}),n=!!this.media&&this.media.readyState>=1,l=s.readyState==="open",n&&l)try{s.endOfStream()}catch{}Object.keys(this._sourceBuffer).forEach(function(h){try{s.removeSourceBuffer(e._sourceBuffer[h])}catch{}}),Ci(s)&&(s.removeEventListener("startstreaming",this._onStartStreaming),s.removeEventListener("endstreaming",this._onEndStreaming))}if(this.media){this.media.disableRemotePlayback=!1,this.media.removeAttribute("src");try{this.media.load()}catch{}this.media=null}this.mediaSource=null,this._openPromise=Yt(),this._queue=Object.create(null),this._sourceBuffer=Object.create(null);case 8:case"end":return u.stop()}},i,this)}));function t(){return a.apply(this,arguments)}return t}()},{key:"createSource",value:function(t,i){if(!(this._sourceBuffer[t]||!this.mediaSource)){var e;try{e=this._sourceBuffer[t]=this.mediaSource.addSourceBuffer(i)}catch(s){throw new oe(N.MEDIA,N.SUB_TYPES.MSE_ADD_SB,s)}e.mimeType=i,e.addEventListener("updateend",this._onSBUpdateEnd.bind(this,t)),e.addEventListener("error",this._onSBUpdateError.bind(this,t))}}},{key:"changeType",value:function(t,i){var e=this,s=this._sourceBuffer[t];return!this.mediaSource||!s||s.mimeType===i?Promise.resolve():typeof s.changeType!="function"?Promise.reject(new oe(N.MEDIA,N.SUB_TYPES.MSE_CHANGE_TYPE,new Error("changeType is not a function"))):this._enqueueOp(t,function(){try{s.changeType(i)}catch(n){throw new oe(N.MEDIA,N.SUB_TYPES.MSE_CHANGE_TYPE,n)}s.mimeType=i,e._onSBUpdateEnd(t)},"changeType",{mimeType:i})}},{key:"createOrChangeSource",value:function(t,i){return this.createSource(t,i),this.changeType(t,i)}},{key:"append",value:function(t,i,e){var s=this;return!i||!i.byteLength||!this._sourceBuffer[t]?Promise.resolve():this._enqueueOp(t,function(){var n;!s.mediaSource||s.media.error||(s._logger.debug("MSE APPEND START",e),s._opst=xt(),(n=s._sourceBuffer[t])===null||n===void 0||n.appendBuffer(i))},ii.APPEND,e)}},{key:"remove",value:function(t,i,e,s){var n=this,l=!1;return this._mseFullFlag[t]&&(l=!0),this._enqueueOp(t,function(){if(!(!n.mediaSource||n.media.error)){var o=n._sourceBuffer[t];if(i>=e||!o){n._onSBUpdateEnd(t);return}n._opst=xt(),n._logger.debug("MSE REMOVE START",t,i,e,s),o.remove(i,e)}},ii.REMOVE,s,l)}},{key:"clearBuffer",value:function(t,i){var e=this,s;return Object.keys(this._sourceBuffer).forEach(function(n){s=e.remove(n,t,i)}),s||Promise.resolve()}},{key:"clearAllBuffer",value:function(){var t=this,i;return Object.keys(this._sourceBuffer).forEach(function(e){var s=t._sourceBuffer[e];i=t.remove(e,0,me.end(me.get(s)))}),i}},{key:"clearOpQueues",value:function(t,i){var e;this._logger.debug("MSE clearOpQueue START");var s=this._queue[t];if(i&&s){this._queue[t]=[];return}if(!(!s||!s[t]||s.length<5)){var n=[];s.forEach(function(l){l.context&&l.context.isinit&&n.push(l)}),this._queue[t]=s.slice(0,2),n.length>0&&(e=this._queue[t]).push.apply(e,n)}}},{key:"endOfStream",value:function(t){var i=this;return!this.mediaSource||this.mediaSource.readyState!=="open"?Promise.resolve():this._enqueueBlockingOp(function(){var e=i.mediaSource;!e||e.readyState!=="open"||(i._logger.debug("MSE endOfStream START"),t?e.endOfStream(t):e.endOfStream())},"endOfStream")}},{key:"setLiveSeekableRange",value:function(t,i){var e=this.mediaSource;t<0||i<t||!(e!=null&&e.setLiveSeekableRange)||e.readyState!=="open"||e.setLiveSeekableRange(t,i)}},{key:"getSourceBuffer",value:function(t){return this._sourceBuffer[t]}},{key:"buffered",value:function(t){return me.get(this._sourceBuffer[t])}},{key:"bufferStart",value:function(t){return me.start(this.buffered(t))}},{key:"bufferEnd",value:function(t){return me.end(this.buffered(t))}},{key:"_enqueueOp",value:function(t,i,e,s,n){var l=this;if(!this.mediaSource)return Promise.resolve();var o=this._queue[t]=this._queue[t]||[],u={exec:i,promise:Yt(),opName:e,context:s};return n?(o.splice(0,0,u),this._mseFullFlag[t]=!1,this._startQueue(t)):o.push(u),this.isOpened||this.isEnded?o.length===1&&this._startQueue(t):this._openPromise.then(function(){o.length===1&&l._startQueue(t)}),u.promise}},{key:"_enqueueBlockingOp",value:function(){var a=dt(ge().mark(function i(e,s,n){var l=this,o,u;return ge().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(this.mediaSource){d.next=2;break}return d.abrupt("return",Promise.resolve());case 2:if(o=Object.keys(this._sourceBuffer),o.length){d.next=5;break}return d.abrupt("return",e());case 5:return u=[],o.forEach(function(c){var f=l._queue[c],y=Yt();u.push(y),f.push({exec:function(){y.resolve()},promise:y,opName:s,context:n}),f.length===1&&l._startQueue(c)}),d.abrupt("return",Promise.all(u).then(function(){try{return e()}finally{o.forEach(function(c){var f=l._queue[c],y=l._sourceBuffer[c];f==null||f.shift(),(!y||!y.updating)&&l._startQueue(c)})}}));case 8:case"end":return d.stop()}},i,this)}));function t(i,e,s){return a.apply(this,arguments)}return t}()},{key:"_startQueue",value:function(t){var i=this._queue[t];if(i){var e=i[0];if(e&&!this._mseFullFlag[t])try{e.exec()}catch(s){s&&s.message&&s.message.indexOf("SourceBuffer is full")>=0?(this._mseFullFlag[t]=!0,e.context&&Wt(e.context)==="object"&&(e.context.isFull=!0),this._logger.error("[MSE error],  context,",e.context," ,name,",e.opName,",err,SourceBuffer is full"),e.promise.reject(new oe(N.MEDIA,N.SUB_TYPES.MSE_FULL,s))):(this._logger.error(s),e.promise.reject(s.constructor===oe?s:new oe(N.MEDIA,N.SUB_TYPES.MSE_OTHER,s)),i.shift(),this._startQueue(t))}}}},{key:"setTimeoffset",value:function(t,i,e){var s=this;return this._enqueueOp(t,function(){i<0&&(i+=.001),s._sourceBuffer[t].timestampOffset=i,s._onSBUpdateEnd(t)},"setTimeoffset",e)}},{key:"abort",value:function(t,i){var e=this;return this.isOpened?this._enqueueOp(t,function(){e._sourceBuffer[t].abort(),e._onSBUpdateEnd(t)},"abort",i):Promise.resolve()}}],[{key:"isSupported",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:'video/mp4; codecs="avc1.42E01E,mp4a.40.2"',i=Fs();if(!i)return!1;try{return i.isTypeSupported(t)}catch(e){return this._logger.error(t,e),!1}}},{key:"isMMSOnly",value:function(){return typeof ManagedMediaSource<"u"&&typeof MediaSource>"u"}},{key:"getDefaultConfig",value:function(){return{openLog:!1,preferMMS:!1}}}]),r}();I(ce,"VIDEO","video");I(ce,"AUDIO","audio");var Xt={FETCH:"fetch",XHR:"xhr"},Bt={ARRAY_BUFFER:"arraybuffer",TEXT:"text",JSON:"json"},tt=function(r){Qt(t,r);var a=qt(t);function t(i,e,s,n){var l;return He(this,t),l=a.call(this,n),I(O(l),"retryCount",0),I(O(l),"isTimeout",!1),I(O(l),"loaderType",Xt.FETCH),I(O(l),"startTime",0),I(O(l),"endTime",0),I(O(l),"options",{}),l.url=i,l.request=e,l.response=s,l}return Ne(t)}(mi(Error)),Cn=Object.prototype.toString;function aa(r){return r!==null&&Wt(r)==="object"}function Ks(r){if(Cn.call(r)!=="[object Object]")return!1;var a=Object.getPrototypeOf(r);return a===null||a===Object.prototype}function la(r){return Cn.call(r)==="[object Date]"}function Yn(r){if(!(!r||r[0]===null||r[0]===void 0||r[0]===0&&(r[1]===null||r[1]===void 0))){var a="bytes="+r[0]+"-";return r[1]&&(a+=r[1]),a}}function Ds(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function In(r,a){if(r){if(!a)return r;var t,i=Object.keys(a).map(function(s){if(t=a[s],t!=null)return Array.isArray(t)?s=s+"[]":t=[t],t.map(function(n){return la(n)?n=n.toISOString():aa(n)&&(n=JSON.stringify(n)),"".concat(Ds(s),"=").concat(Ds(n))}).join("&")}).filter(Boolean).join("&");if(i){var e=r.indexOf("#");e!==-1&&(r=r.slice(0,e)),r+=(r.indexOf("?")===-1?"?":"&")+i}return r}}function ji(r,a,t,i,e,s,n,l,o,u,h){e=e!=null?parseFloat(e):null,i=parseInt(i||"0",10),Number.isNaN(i)&&(i=0);var d={range:o,vid:u,index:l,contentLength:i,age:e,startTime:s,firstByteTime:n,endTime:Date.now(),priOptions:h};return{data:r,done:a,options:d,response:t}}function Qi(r,a){return Math.round(r*8*1e3/a/1024)}var F={ERROR:"error",TTFB:"core.ttfb",LOAD_START:"core.loadstart",LOAD_RESPONSE_HEADERS:"core.loadresponseheaders",LOAD_COMPLETE:"core.loadcomplete",LOAD_RETRY:"core.loadretry",SOURCEBUFFER_CREATED:"core.sourcebuffercreated",MEDIASOURCE_OPENED:"core.mediasourceopened",ANALYZE_DURATION_EXCEEDED:"core.analyzedurationexceeded",REMOVE_BUFFER:"core.removebuffer",BUFFEREOS:"core.buffereos",KEYFRAME:"core.keyframe",CHASEFRAME:"core.chaseframe",METADATA_PARSED:"core.metadataparsed",SEI:"core.sei",SEI_IN_TIME:"core.seiintime",FLV_SCRIPT_DATA:"core.flvscriptdata",LOWDECODE:"core.lowdecode",SWITCH_URL_SUCCESS:"core.switchurlsuccess",SWITCH_URL_FAILED:"core.switchurlfailed",SPEED:"core.speed",HLS_MANIFEST_LOADED:"core.hlsmanifestloaded",HLS_LEVEL_LOADED:"core.hlslevelloaded",DEMUXED_TRACK:"core.demuxedtrack",STREAM_EXCEPTION:"core.streamexception",LARGE_AV_FIRST_FRAME_GAP_DETECT:"LARGE_AV_FIRST_FRAME_GAP_DETECT",LARGE_VIDEO_DTS_GAP_DETECT:"LARGE_VIDEO_DTS_GAP_DETECT",LARGE_AUDIO_DTS_GAP_DETECT:"LARGE_AUDIO_DTS_GAP_DETECT",AUDIO_GAP_DETECT:"AUDIO_GAP_DETECT",AUDIO_OVERLAP_DETECT:"AUDIO_OVERLAP_DETECT",MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT:"MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT",REAL_TIME_SPEED:"real_time_speed"},Ps=2*1024*1024,qi=function(r){Qt(t,r);var a=qt(t);function t(){var i;return He(this,t),i=a.call(this),I(O(i),"_abortController",null),I(O(i),"_timeoutTimer",null),I(O(i),"_reader",null),I(O(i),"_response",null),I(O(i),"_aborted",!1),I(O(i),"_index",-1),I(O(i),"_range",null),I(O(i),"_receivedLength",0),I(O(i),"_running",!1),I(O(i),"_logger",null),I(O(i),"_vid",""),I(O(i),"_onProcessMinLen",0),I(O(i),"_onCancel",null),I(O(i),"_priOptions",null),i}return Ne(t,[{key:"load",value:function(e){var s,n=this,l=e.url,o=e.vid,u=e.timeout,h=e.responseType,d=e.onProgress,c=e.index,f=e.onTimeout,y=e.onCancel,g=e.range,b=e.transformResponse,S=e.request,G=e.params,X=e.logger,L=e.method,k=e.headers,W=e.body,V=e.mode,w=e.credentials,M=e.cache,C=e.redirect,U=e.referrer,m=e.referrerPolicy,p=e.onProcessMinLen,v=e.priOptions;this._logger=X,this._aborted=!1,this._onProcessMinLen=p,this._onCancel=y,this._abortController=typeof AbortController<"u"&&new AbortController,this._running=!0,this._index=c,this._range=g||[0,0],this._vid=o||l,this._priOptions=v||{};var E={method:L,headers:k,body:W,mode:V,credentials:w,cache:M,redirect:C,referrer:U,referrerPolicy:m,signal:(s=this._abortController)===null||s===void 0?void 0:s.signal},Z=!1;clearTimeout(this._timeoutTimer),l=In(l,G);var R=Yn(g);R&&(S?k=S.headers:k=E.headers=E.headers||(Headers?new Headers:{}),Headers&&k instanceof Headers?k.append("Range",R):k.Range=R),u&&(this._timeoutTimer=setTimeout(function(){if(Z=!0,n.cancel(),f){var D=new tt(l,E,null,"timeout");D.isTimeout=!0,f(D,{index:n._index,range:n._range,vid:n._vid,priOptions:n._priOptions})}},u));var x=Date.now();return this._logger.debug("[fetch load start], index,",c,",range,",g),new Promise(function(D,_){fetch(S||l,S?void 0:E).then(function(){var K=dt(ge().mark(function j(P){var ve,be,Je,pe;return ge().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:if(clearTimeout(n._timeoutTimer),n._response=P,!(n._aborted||!n._running)){ae.next=4;break}return ae.abrupt("return");case 4:if(b&&(P=b(P,l)||P),P.ok){ae.next=7;break}throw new tt(l,E,P,"bad network response");case 7:if(ve=Date.now(),h!==Bt.TEXT){ae.next=15;break}return ae.next=11,P.text();case 11:be=ae.sent,n._running=!1,ae.next=37;break;case 15:if(h!==Bt.JSON){ae.next=22;break}return ae.next=18,P.json();case 18:be=ae.sent,n._running=!1,ae.next=37;break;case 22:if(!d){ae.next=29;break}return n.resolve=D,n.reject=_,n._loadChunk(P,d,x,ve),ae.abrupt("return");case 29:return ae.next=31,P.arrayBuffer();case 31:be=ae.sent,be=new Uint8Array(be),n._running=!1,Je=Date.now()-x,pe=Qi(be.byteLength,Je),n.emit(F.REAL_TIME_SPEED,{speed:pe,len:be.byteLength,time:Je,vid:n._vid,index:n._index,range:n._range,priOptions:n._priOptions});case 37:n._logger.debug("[fetch load end], index,",c,",range,",g),D(ji(be,!0,P,P.headers.get("Content-Length"),P.headers.get("age"),x,ve,c,g,n._vid,n._priOptions));case 39:case"end":return ae.stop()}},j)}));return function(j){return K.apply(this,arguments)}}()).catch(function(K){var j;clearTimeout(n._timeoutTimer),n._running=!1,!(n._aborted&&!Z)&&(K=K instanceof tt?K:new tt(l,E,null,(j=K)===null||j===void 0?void 0:j.message),K.startTime=x,K.endTime=Date.now(),K.isTimeout=Z,K.options={index:n._index,range:n._range,vid:n._vid,priOptions:n._priOptions},_(K))})})}},{key:"cancel",value:function(){var i=dt(ge().mark(function s(){return ge().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!this._aborted){l.next=2;break}return l.abrupt("return");case 2:if(this._aborted=!0,this._running=!1,!this._response){l.next=14;break}if(l.prev=5,!this._reader){l.next=9;break}return l.next=9,this._reader.cancel();case 9:l.next=13;break;case 11:l.prev=11,l.t0=l.catch(5);case 13:this._response=this._reader=null;case 14:if(this._abortController){try{this._abortController.abort()}catch{}this._abortController=null}this._onCancel&&this._onCancel({index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions});case 16:case"end":return l.stop()}},s,this,[[5,11]])}));function e(){return i.apply(this,arguments)}return e}()},{key:"_loadChunk",value:function(e,s,n,l){var o=this;if(!e.body||!e.body.getReader){this._running=!1;var u=new tt(e.url,"",e,"onProgress of bad response.body.getReader");u.options={index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions},this.reject(u);return}this._onProcessMinLen>0&&(this._cache=new Uint8Array(Ps),this._writeIdx=0);var h=this._reader=e.body.getReader(),d,c,f,y=function(){var g=dt(ge().mark(function b(){var S,G,X,L,k,W,V,w;return ge().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return c=Date.now(),C.prev=1,C.next=4,h.read();case 4:d=C.sent,f=Date.now(),C.next=13;break;case 8:return C.prev=8,C.t0=C.catch(1),f=Date.now(),o._aborted||(o._running=!1,C.t0.options={index:o._index,range:o._range,vid:o._vid,priOptions:o._priOptions},o.reject(C.t0)),C.abrupt("return");case 13:if(G=((S=o._range)===null||S===void 0?void 0:S.length)>0?o._range[0]:0,X=G+o._receivedLength,!o._aborted){C.next=19;break}return o._running=!1,s(void 0,!1,{range:[X,X],vid:o._vid,index:o._index,startTime:c,endTime:f,st:n,firstByteTime:l,priOptions:o._priOptions},e),C.abrupt("return");case 19:L=d.value?d.value.byteLength:0,o._receivedLength+=L,o._logger.debug("【fetchLoader,onProgress call】,task,",o._range,", start,",X,", end,",G+o._receivedLength,", done,",d.done),o._onProcessMinLen>0?o._writeIdx+L>=o._onProcessMinLen||d.done?(k=new Uint8Array(o._writeIdx+L),k.set(o._cache.slice(0,o._writeIdx),0),L>0&&k.set(d.value,o._writeIdx),o._writeIdx=0,o._logger.debug("【fetchLoader,onProgress enough】,done,",d.done,",len,",k.byteLength,", writeIdx,",o._writeIdx)):L>0&&o._writeIdx+L<Ps?(o._cache.set(d.value,o._writeIdx),o._writeIdx+=L,o._logger.debug("【fetchLoader,onProgress cache】,len,",L,", writeIdx,",o._writeIdx)):L>0&&(W=new Uint8Array(o._writeIdx+L+2048),o._logger.debug("【fetchLoader,onProgress extra start】,size,",o._writeIdx+L+2048,", datalen,",L,", writeIdx,",o._writeIdx),W.set(o._cache.slice(0,o._writeIdx),0),L>0&&W.set(d.value,o._writeIdx),o._writeIdx+=L,delete o._cache,o._cache=W,o._logger.debug("【fetchLoader,onProgress extra end】,len,",L,", writeIdx,",o._writeIdx)):k=d.value,(k&&k.byteLength>0||d.done)&&s(k,d.done,{range:[o._range[0]+o._receivedLength-(k?k.byteLength:0),o._range[0]+o._receivedLength],vid:o._vid,index:o._index,startTime:c,endTime:f,st:n,firstByteTime:l,priOptions:o._priOptions},e),d.done?(V=Date.now()-n,w=Qi(o._receivedLength,V),o.emit(F.REAL_TIME_SPEED,{speed:w,len:o._receivedLength,time:V,vid:o._vid,index:o._index,range:o._range,priOptions:o._priOptions}),o._running=!1,o._logger.debug("[fetchLoader onProgress end],task,",o._range,",done,",d.done),o.resolve(ji(d,!0,e,e.headers.get("Content-Length"),e.headers.get("age"),n,l,o._index,o._range,o._vid,o._priOptions))):y();case 25:case"end":return C.stop()}},b,null,[[1,8]])}));return function(){return g.apply(this,arguments)}}();y()}},{key:"receiveLen",get:function(){return this._receivedLength}},{key:"running",get:function(){return this._running},set:function(e){this._running=e}}],[{key:"isSupported",value:function(){return typeof fetch<"u"}}]),t}(vt);function oa(r){return zt({loaderType:Xt.FETCH,retry:0,retryDelay:0,timeout:0,request:null,onTimeout:void 0,onProgress:void 0,onRetryError:void 0,transformRequest:void 0,transformResponse:void 0,transformError:void 0,responseType:Bt.TEXT,range:void 0,url:"",params:void 0,method:"GET",headers:{},body:void 0,mode:void 0,credentials:void 0,cache:void 0,redirect:void 0,referrer:void 0,referrerPolicy:void 0,integrity:void 0,onProcessMinLen:0},r)}var ua=function(r){Qt(t,r);var a=qt(t);function t(){var i;return He(this,t),i=a.call(this),I(O(i),"_xhr",null),I(O(i),"_aborted",!1),I(O(i),"_timeoutTimer",null),I(O(i),"_range",null),I(O(i),"_receivedLength",0),I(O(i),"_url",null),I(O(i),"_onProgress",null),I(O(i),"_index",-1),I(O(i),"_headers",null),I(O(i),"_currentChunkSizeKB",384),I(O(i),"_timeout",null),I(O(i),"_xhr",null),I(O(i),"_withCredentials",null),I(O(i),"_startTime",-1),I(O(i),"_loadCompleteResolve",null),I(O(i),"_loadCompleteReject",null),I(O(i),"_runing",!1),I(O(i),"_logger",!1),I(O(i),"_vid",""),I(O(i),"_responseType",void 0),I(O(i),"_credentials",void 0),I(O(i),"_method",void 0),I(O(i),"_transformResponse",void 0),I(O(i),"_firstRtt",void 0),I(O(i),"_onCancel",null),I(O(i),"_priOptions",null),i}return Ne(t,[{key:"load",value:function(e){var s=this;clearTimeout(this._timeoutTimer),this._logger=e.logger,this._range=e.range,this._onProgress=e.onProgress,this._index=e.index,this._headers=e.headers,this._withCredentials=e.credentials==="include"||e.credentials==="same-origin",this._body=e.body||null,e.method&&(this._method=e.method),this._timeout=e.timeout||null,this._runing=!0,this._vid=e.vid||e.url,this._responseType=e.responseType,this._firstRtt=-1,this._onTimeout=e.onTimeout,this._onCancel=e.onCancel,this._request=e.request,this._priOptions=e.priOptions||{},this._logger.debug("【xhrLoader task】, range",this._range),this._url=In(e.url,e.params);var n=Date.now();return new Promise(function(l,o){s._loadCompleteResolve=l,s._loadCompleteReject=o,s._startLoad()}).catch(function(l){if(clearTimeout(s._timeoutTimer),s._runing=!1,!s._aborted)throw l=l instanceof tt?l:new tt(s._url,s._request),l.startTime=n,l.endTime=Date.now(),l.options={index:s._index,vid:s._vid,priOptions:s._priOptions},l})}},{key:"_startLoad",value:function(){var e=null;if(this._responseType===Bt.ARRAY_BUFFER&&this._range&&this._range.length>1)if(this._onProgress){this._firstRtt=-1;var s=this._currentChunkSizeKB*1024,n=this._range[0]+this._receivedLength,l=this._range[1];s<this._range[1]-n&&(l=n+s),e=[n,l],this._logger.debug("[xhr_loader->],tast :",this._range,", SubRange, ",e)}else e=this._range,this._logger.debug("[xhr_loader->],tast :",this._range,", allRange, ",e);this._internalOpen(e)}},{key:"_internalOpen",value:function(e){var s=this;try{this._startTime=Date.now();var n=this._xhr=new XMLHttpRequest;n.open(this._method||"GET",this._url,!0),n.responseType=this._responseType,this._timeout&&(n.timeout=this._timeout),n.withCredentials=this._withCredentials,n.onload=this._onLoad.bind(this),n.onreadystatechange=this._onReadyStatechange.bind(this),n.onerror=function(u){var h,d,c;s._running=!1;var f=new tt(s._url,s._request,u==null||(h=u.currentTarget)===null||h===void 0?void 0:h.response,"xhr.onerror.status:"+(u==null||(d=u.currentTarget)===null||d===void 0?void 0:d.status)+",statusText,"+(u==null||(c=u.currentTarget)===null||c===void 0?void 0:c.statusText));f.options={index:s._index,range:s._range,vid:s._vid,priOptions:s._priOptions},s._loadCompleteReject(f)},n.ontimeout=function(u){s.cancel();var h=new tt(s._url,s._request,{status:408},"timeout");s._onTimeout&&(h.isTimeout=!0,s._onTimeout(h,{index:s._index,range:s._range,vid:s._vid,priOptions:s._priOptions})),h.options={index:s._index,range:s._range,vid:s._vid,priOptions:s._priOptions},s._loadCompleteReject(h)};var l=this._headers||{},o=Yn(e);o&&(l.Range=o),l&&Object.keys(l).forEach(function(u){n.setRequestHeader(u,l[u])}),this._logger.debug("[xhr.send->] tast,",this._range,",load sub range, ",e),n.send(this._body)}catch(u){u.options={index:this._index,range:e,vid:this._vid,priOptions:this._priOptions},this._loadCompleteReject(u)}}},{key:"_onReadyStatechange",value:function(e){var s=e.target;s.readyState===2&&this._firstRtt<0&&(this._firstRtt=Date.now())}},{key:"_onLoad",value:function(e){var s,n=e.target.status;if(n<200||n>299){var l=new tt(this._url,null,zt(zt({},e.target.response),{},{status:n}),"bad response,status:"+n);return l.options={index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions},this._loadCompleteReject(l)}var o=null,u=!1,h,d=((s=this._range)===null||s===void 0?void 0:s.length)>0?this._range[0]:0;if(this._responseType===Bt.ARRAY_BUFFER){var c,f=new Uint8Array(e.target.response);if(h=d+this._receivedLength,f&&f.byteLength>0){this._receivedLength+=f.byteLength;var y=Date.now()-this._startTime,g=Qi(this._receivedLength,y);this.emit(F.REAL_TIME_SPEED,{speed:g,len:this._receivedLength,time:y,vid:this._vid,index:this._index,range:[h,d+this._receivedLength],priOptions:this._priOptions})}o=f,((c=this._range)===null||c===void 0?void 0:c.length)>1&&this._range[1]&&this._receivedLength<this._range[1]-this._range[0]?u=!1:u=!0,this._logger.debug("[xhr load done->], tast :",this._range,", start",h,"end ",d+this._receivedLength,",dataLen,",f?f.byteLength:0,",receivedLength",this._receivedLength,",index,",this._index,", done,",u)}else u=!0,o=e.target.response;var b={ok:n>=200&&n<300,status:n,statusText:this._xhr.statusText,url:this._xhr.responseURL,headers:this._getHeaders(this._xhr),body:this._xhr.response};this._transformResponse&&(b=this._transformResponse(b,this._url)||b),this._onProgress&&this._onProgress(o,u,{index:this._index,vid:this._vid,range:[h,d+this._receivedLength],startTime:this._startTime,endTime:Date.now(),priOptions:this._priOptions},b),u?(this._runing=!1,this._loadCompleteResolve&&this._loadCompleteResolve(ji(this._onProgress?null:o,u,b,b.headers["content-length"],b.headers.age,this._startTime,this._firstRtt,this._index,this._range,this._vid,this._priOptions))):this._startLoad()}},{key:"cancel",value:function(){if(!this._aborted&&(this._aborted=!0,this._runing=!1,di(wt(t.prototype),"removeAllListeners",this).call(this),this._onCancel&&this._onCancel({index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions}),this._xhr))return this._xhr.abort()}},{key:"receiveLen",get:function(){return this._receivedLength}},{key:"running",get:function(){return this._running},set:function(e){this._running=e}},{key:"_getHeaders",value:function(e){var s=e.getAllResponseHeaders().trim().split(`\r
`),n={},l=qr(s),o;try{for(l.s();!(o=l.n()).done;){var u=o.value,h=u.split(": ");n[h[0].toLowerCase()]=h.slice(1).join(": ")}}catch(d){l.e(d)}finally{l.f()}return n}}],[{key:"isSupported",value:function(){return typeof XMLHttpRequest<"u"}}]),t}(vt),ha=["retry","retryDelay","onRetryError","transformError"],da=function(){function r(a,t){He(this,r),this.promise=Yt(),this.alive=!!t.onProgress,!t.logger&&(t.logger=new Te("Loader")),this._loaderType=a,this._loader=a===Xt.FETCH&&typeof fetch<"u"?new qi:new ua,this._config=t,this._retryCount=0,this._retryTimer=null,this._canceled=!1,this._retryCheckFunc=t.retryCheckFunc,this._logger=t.logger}return Ne(r,[{key:"exec",value:function(){var t=this,i=this._config,e=i.retry,s=i.retryDelay,n=i.onRetryError,l=i.transformError,o=Or(i,ha),u=function(){var h=dt(ge().mark(function d(){var c,f,y;return ge().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.prev=0,b.next=3,t._loader.load(o);case 3:c=b.sent,t.promise.resolve(c),b.next=27;break;case 7:if(b.prev=7,b.t0=b.catch(0),t._loader.running=!1,t._logger.debug("[task request catch err]",b.t0),!t._canceled){b.next=13;break}return b.abrupt("return");case 13:if(b.t0.loaderType=t._loaderType,b.t0.retryCount=t._retryCount,f=b.t0,l&&(f=l(f)||f),n&&t._retryCount>0&&n(f,t._retryCount,{index:o.index,vid:o.vid,range:o.range,priOptions:o.priOptions}),t._retryCount++,y=!0,t._retryCheckFunc&&(y=t._retryCheckFunc(b.t0)),!(y&&t._retryCount<=e)){b.next=26;break}return clearTimeout(t._retryTimer),t._logger.debug("[task request setTimeout],retry",t._retryCount,",retry range,",o.range),t._retryTimer=setTimeout(u,s),b.abrupt("return");case 26:t.promise.reject(f);case 27:case"end":return b.stop()}},d,null,[[0,7]])}));return function(){return h.apply(this,arguments)}}();return u(),this.promise}},{key:"cancel",value:function(){var a=dt(ge().mark(function i(){return ge().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return clearTimeout(this._retryTimer),this._canceled=!0,this._loader.running=!1,s.abrupt("return",this._loader.cancel());case 4:case"end":return s.stop()}},i,this)}));function t(){return a.apply(this,arguments)}return t}()},{key:"running",get:function(){return this._loader&&this._loader.running}},{key:"loader",get:function(){return this._loader}}]),r}();function _n(r){return r&&!r.paused&&!r.ended&&r.playbackRate!==0&&r.readyState!==0}function Fn(r){if(!r)return{};if(typeof r.getVideoPlaybackQuality=="function"){var a=r.getVideoPlaybackQuality();return{droppedVideoFrames:a.droppedVideoFrames||a.corruptedVideoFrames,totalVideoFrames:a.totalVideoFrames,creationTime:a.creationTime}}return{droppedVideoFrames:r.webkitDroppedFrameCount,totalVideoFrames:r.webkitDecodedFrameCount,creationTime:performance.now()}}function Gt(){for(var r=arguments.length,a=new Array(r),t=0;t<r;t++)a[t]=arguments[t];if(a=a.filter(Boolean),a.length<2)return a[0];var i=new Uint8Array(a.reduce(function(s,n){return s+n.byteLength},0)),e=0;return a.forEach(function(s){i.set(s,e),e+=s.byteLength}),i}function ca(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new Promise(function(a){return setTimeout(a,r)})}var ft=function(r){Qt(t,r);var a=qt(t);function t(i){var e;return He(this,t),e=a.call(this,i),I(O(e),"type",Xt.FETCH),I(O(e),"_queue",[]),I(O(e),"_alive",[]),I(O(e),"_currentTask",null),I(O(e),"_finnalUrl",""),I(O(e),"_config",void 0),e._config=oa(i),(e._config.loaderType===Xt.XHR||!qi.isSupported())&&(e.type=Xt.XHR),e.log=i.logger,e}return Ne(t,[{key:"isFetch",value:function(){return this.type===Xt.FETCH}},{key:"load",value:function(e){var s=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};typeof e=="string"||!e?n.url=e||n.url||this._config.url:n=e,n=Object.assign({},this._config,n),n.params&&(n.params=Object.assign({},n.params)),n.headers&&Ks(n.headers)&&(n.headers=Object.assign({},n.headers)),n.body&&Ks(n.body)&&(n.body=Object.assign({},n.body)),n.transformRequest&&(n=n.transformRequest(n)||n),n.logger=this.log;var l=new da(this.type,n);return l.loader.on(F.REAL_TIME_SPEED,function(o){s.emit(F.REAL_TIME_SPEED,o)}),this._queue.push(l),this._queue.length===1&&(!this._currentTask||!this._currentTask.running)&&this._processTask(),l.promise}},{key:"cancel",value:function(){var i=dt(ge().mark(function s(){var n;return ge().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return n=this._queue.map(function(u){return u.cancel()}).concat(this._alive.map(function(u){return u.cancel()})),this._currentTask&&n.push(this._currentTask.cancel()),this._queue=[],this._alive=[],o.next=6,Promise.all(n);case 6:return o.next=8,ca();case 8:case"end":return o.stop()}},s,this)}));function e(){return i.apply(this,arguments)}return e}()},{key:"_processTask",value:function(){var e=this;if(this._currentTask=this._queue.shift(),!!this._currentTask){this._currentTask.alive&&this._alive.push(this._currentTask);var s=this._currentTask.exec().catch(function(n){});s&&typeof s.finally=="function"&&s.finally(function(){var n,l;(n=e._currentTask)!==null&&n!==void 0&&n.alive&&((l=e._alive)===null||l===void 0?void 0:l.length)>0&&(e._alive=e._alive.filter(function(o){return o&&o!==e._currentTask})),e._processTask()})}}}],[{key:"isFetchSupport",value:function(){return qi.isSupported()}}]),t}(vt),Kn=function(){function r(){He(this,r),I(this,"_prevCurrentTime",0)}return Ne(r,[{key:"do",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3,e=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;if(t){var n=t.currentTime,l=0;if(this._prevCurrentTime===n){var o=me.info(me.get(t),n);if(!o.buffers.length)return;e&&o.nextStart||o.nextStart&&o.nextStart-n<i?l=o.nextStart+.1:o.end&&o.end-n>s&&!t.seeking&&(l=n+.1)}this._prevCurrentTime=n,l&&n!==l&&(t.currentTime=l)}}}]),r}(),Dn=function(){function r(a){var t=this;He(this,r),I(this,"_seiSet",new Set),this.emitter=a,a.on(F.SEI,function(i){i&&t._seiSet.add(i)})}return Ne(r,[{key:"throw",value:function(t,i){var e=this;if(!(t==null||!this._seiSet.size)){var s=t-.2,n=t+.2,l=[];this._seiSet.forEach(function(o){o.time>=s&&o.time<=n&&l.push(o)}),l.forEach(function(o){e._seiSet.delete(o),e.emitter.emit(F.SEI_IN_TIME,o)}),i&&this._seiSet.forEach(function(o){o.time<t-5&&e._seiSet.delete(o)})}}},{key:"reset",value:function(){this._seiSet.clear()}}]),r}(),pa=1e3,ma=50,fa=3,ya=3e3,Pn=function(){function r(a){He(this,r),I(this,"_chunkSpeed",0),I(this,"_chunkCache",[]),I(this,"_speeds",[]),I(this,"_totalSize",0),I(this,"_totalCost",0),this._opts=a||{}}return Ne(r,[{key:"addRecord",value:function(t,i){!t||!i||(this._speeds.push(8e3*t/i),this._speeds=this._speeds.slice(-fa))}},{key:"addChunkRecord",value:function(t,i){var e,s;if(!(!t||!i||t<(((e=this._opts)===null||e===void 0?void 0:e.skipChunkSize)||pa))){this._totalSize+=t,this._totalCost+=i,this._chunkSpeed=8e3*t/i,this._chunkCache.push({size:t,duration:i,timestamp:performance.now()});var n=((s=this._opts)===null||s===void 0?void 0:s.chunkCountForSpeed)||ma;this._chunkCache.length>n&&(this._chunkCache=this._chunkCache.slice(-n))}}},{key:"getAvgSpeed",value:function(){var t;if(!this._chunkCache.length&&!this._speeds.length)return 0;if(this._speeds.length)return this._speeds.reduce(function(l,o){return l+=o})/this._speeds.length;var i=this._chunkCache[this._chunkCache.length-1],e=performance.now()-i.timestamp;e>(((t=this._opts)===null||t===void 0?void 0:t.longtimeNoReceived)||ya)&&this._chunkCache.push({size:0,duration:e,timestamp:performance.now()});var s=this._chunkCache.reduce(function(l,o){return l+=o.size},0),n=this._chunkCache.reduce(function(l,o){return l+=o.duration},0);return 8e3*s/n}},{key:"getLatestSpeed",value:function(){return!this._chunkCache.length&&!this._speeds.length?0:this._speeds.length?this._speeds[this._speeds.length-1]:this._chunkSpeed}},{key:"getTotalSize",value:function(){return this._totalSize}},{key:"getTotalCost",value:function(){return this._totalCost}},{key:"reset",value:function(){this._chunkCache=[],this._speeds=[],this._totalSize=0,this._totalCost=0}}]),r}(),Hs=function(){function r(a){He(this,r),I(this,"encodeType",""),I(this,"audioCodec",""),I(this,"videoCodec",""),I(this,"domain",""),I(this,"fps",0),I(this,"bitrate",0),I(this,"width",0),I(this,"height",0),I(this,"samplerate",0),I(this,"channelCount",0),I(this,"gop",0),I(this,"_bitsAccumulateSize",0),I(this,"_bitsAccumulateDuration",0),I(this,"_startGopId",-1),this._timescale=a}return Ne(r,[{key:"getStats",value:function(){return{encodeType:this.encodeType,audioCodec:this.audioCodec,videoCodec:this.videoCodec,domain:this.domain,fps:this.fps,bitrate:this.bitrate,width:this.width,height:this.height,samplerate:this.samplerate,channelCount:this.channelCount,gop:this.gop}}},{key:"setEncodeType",value:function(t){this.encodeType=t}},{key:"setFpsFromScriptData",value:function(t){var i,e=t.data,s=e==null||(i=e.onMetaData)===null||i===void 0?void 0:i.framerate;s&&s>0&&s<100&&(this.fps=s)}},{key:"setVideoMeta",value:function(t){if(this.width=t.width,this.height=t.height,this.videoCodec=t.codec,this.encodeType=t.codecType,t.fpsNum&&t.fpsDen){var i=t.fpsNum/t.fpsDen;i>0&&i<100&&(this.fps=i)}}},{key:"setAudioMeta",value:function(t){this.audioCodec=t.codec,this.samplerate=t.sampleRate,this.channelCount=t.channelCount}},{key:"setDomain",value:function(t){this.domain=t.split("/").slice(2,3)[0]}},{key:"updateBitrate",value:function(t){var i=this;if((!this.fps||this.fps>=100)&&t.length){var e=t.reduce(function(s,n){return s+=n.duration},0)/t.length;this.fps=Math.round(this._timescale/e)}t.forEach(function(s){i._startGopId===-1&&(i._startGopId=s.gopId),s.gopId===i._startGopId&&i.gop++,i._bitsAccumulateDuration+=s.duration/(i._timescale/1e3),i._bitsAccumulateSize+=s.units.reduce(function(n,l){return n+=l.length},0),i._bitsAccumulateDuration>=1e3&&(i.bitrate=i._bitsAccumulateSize*8,i._bitsAccumulateDuration=0,i._bitsAccumulateSize=0)})}}]),r}(),Hn=function(){function r(a){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;He(this,r),I(this,"_core",null),I(this,"_samples",[]),this._core=a,this._timescale=t,this._stats=new Hs(t),this._bindEvents()}return Ne(r,[{key:"getStats",value:function(){var t,i,e,s,n,l,o,u,h,d,c,f=((t=this._core)===null||t===void 0?void 0:t.media)||{},y=f.currentTime,g=y===void 0?0:y,b=f.decodeFps,S=b===void 0?0:b;return zt(zt({},this._stats.getStats()),{},{downloadSpeed:((i=this._core)===null||i===void 0||(e=i.speedInfo)===null||e===void 0?void 0:e.call(i).speed)||0,avgSpeed:((s=this._core)===null||s===void 0||(n=s.speedInfo)===null||n===void 0?void 0:n.call(s).avgSpeed)||0,totalReceivedByte:((l=this._core)===null||l===void 0||(o=l.speedInfo)===null||o===void 0?void 0:o.call(l).totalSize)||0,totalReceivedCost:((u=this._core)===null||u===void 0||(h=u.speedInfo)===null||h===void 0?void 0:h.call(u).totalCost)||0,currentTime:g,bufferEnd:((d=this._core)===null||d===void 0||(c=d.bufferInfo())===null||c===void 0?void 0:c.remaining)||0,decodeFps:S})}},{key:"_bindEvents",value:function(){var t=this;this._core.on(F.DEMUXED_TRACK,function(i){var e=i.videoTrack;return t._stats.updateBitrate(e.samples)}),this._core.on(F.FLV_SCRIPT_DATA,function(i){t._stats.setFpsFromScriptData(i)}),this._core.on(F.METADATA_PARSED,function(i){i.type==="video"?t._stats.setVideoMeta(i.track):t._stats.setAudioMeta(i.track)}),this._core.on(F.TTFB,function(i){t._stats.setDomain(i.responseUrl)})}},{key:"reset",value:function(){this._samples=[],this._stats=new Hs(this._timescale)}}]),r}();function va(r,a){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var i,e,s,n,l=[],o=!0,u=!1;try{if(s=(t=t.call(r)).next,a!==0)for(;!(o=(i=s.call(t)).done)&&(l.push(i.value),l.length!==a);o=!0);}catch(h){u=!0,e=h}finally{try{if(!o&&t.return!=null&&(n=t.return(),Object(n)!==n))return}finally{if(u)throw e}}return l}}function ue(r,a){if(!(r instanceof a))throw new TypeError("Cannot call a class as a function")}function Ns(r,a){for(var t=0;t<a.length;t++){var i=a[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,zn(i.key),i)}}function he(r,a,t){return a&&Ns(r.prototype,a),t&&Ns(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function Y(r,a,t){return a=zn(a),a in r?Object.defineProperty(r,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[a]=t,r}function Nn(r,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(a&&a.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),a&&$i(r,a)}function fi(r){return fi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fi(r)}function $i(r,a){return $i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,e){return i.__proto__=e,i},$i(r,a)}function ba(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ga(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Za(r,a){if(a&&(typeof a=="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ga(r)}function Un(r){var a=ba();return function(){var i=fi(r),e;if(a){var s=fi(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return Za(this,e)}}function ka(r,a){return La(r)||va(r,a)||ms(r,a)||Ga()}function Re(r){return Sa(r)||Ea(r)||ms(r)||Xa()}function Sa(r){if(Array.isArray(r))return es(r)}function La(r){if(Array.isArray(r))return r}function Ea(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function ms(r,a){if(r){if(typeof r=="string")return es(r,a);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return es(r,a)}}function es(r,a){(a==null||a>r.length)&&(a=r.length);for(var t=0,i=new Array(a);t<a;t++)i[t]=r[t];return i}function Xa(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ga(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wa(r,a){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=ms(r))||a){t&&(r=t);var i=0,e=function(){};return{s:e,n:function(){return i>=r.length?{done:!0}:{done:!1,value:r[i++]}},e:function(o){throw o},f:e}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,n=!1,l;return{s:function(){t=t.call(r)},n:function(){var o=t.next();return s=o.done,o},e:function(o){n=!0,l=o},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(n)throw l}}}}function wa(r,a){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var i=t.call(r,a||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(r)}function zn(r){var a=wa(r,"string");return typeof a=="symbol"?a:String(a)}var yt={VIDEO:"video",AUDIO:"audio",METADATA:"metadata"},it={AV1:"av1",AVC:"avc",HEVC:"hevc"},st={AAC:"aac",G711PCMA:"g7110a",G711PCMU:"g7110m"},fe={LARGE_AV_SHIFT:"LARGE_AV_SHIFT",LARGE_VIDEO_GAP:"LARGE_VIDEO_GAP",LARGE_VIDEO_GAP_BETWEEN_CHUNK:"LARGE_VIDEO_GAP_BETWEEN_CHUNK",LARGE_AUDIO_GAP:"LARGE_AUDIO_GAP",AUDIO_FILLED:"AUDIO_FILLED",AUDIO_DROPPED:"AUDIO_DROPPED"},Li=function(){function r(){ue(this,r),Y(this,"id",1),Y(this,"type",yt.VIDEO),Y(this,"codecType",it.AVC),Y(this,"pid",-1),Y(this,"hvcC",void 0),Y(this,"codec",""),Y(this,"timescale",0),Y(this,"formatTimescale",0),Y(this,"sequenceNumber",0),Y(this,"baseMediaDecodeTime",0),Y(this,"baseDts",0),Y(this,"duration",0),Y(this,"warnings",[]),Y(this,"samples",[]),Y(this,"pps",[]),Y(this,"sps",[]),Y(this,"vps",[]),Y(this,"fpsNum",0),Y(this,"fpsDen",0),Y(this,"sarRatio",[]),Y(this,"width",0),Y(this,"height",0),Y(this,"nalUnitSize",4),Y(this,"present",!1),Y(this,"isVideoEncryption",!1),Y(this,"isAudioEncryption",!1),Y(this,"isVideo",!0),Y(this,"kid",null),Y(this,"pssh",null),Y(this,"ext",void 0)}return he(r,[{key:"reset",value:function(){this.sequenceNumber=this.width=this.height=this.fpsDen=this.fpsNum=this.duration=this.baseMediaDecodeTime=this.timescale=0,this.codec="",this.present=!1,this.pid=-1,this.pps=[],this.sps=[],this.vps=[],this.sarRatio=[],this.samples=[],this.warnings=[],this.hvcC=null}},{key:"firstDts",get:function(){return this.samples.length?this.samples[0].dts:null}},{key:"firstPts",get:function(){return this.samples.length?this.samples[0].pts:null}},{key:"samplesDuration",get:function(){if(this.samples.length>0){var t=this.samples[0],i=this.samples[this.samples.length-1];return i.dts-t.dts+i.duration}return 0}},{key:"exist",value:function(){return/av01/.test(this.codec)?!0:!!(this.pps.length&&this.sps.length&&this.codec)}},{key:"hasSample",value:function(){return!!this.samples.length}},{key:"isEncryption",get:function(){return this.isVideoEncryption}}]),r}(),Ei=function(){function r(){ue(this,r),Y(this,"id",2),Y(this,"type",yt.AUDIO),Y(this,"codecType",st.AAC),Y(this,"pid",-1),Y(this,"codec",""),Y(this,"sequenceNumber",0),Y(this,"sampleDuration",0),Y(this,"timescale",0),Y(this,"formatTimescale",0),Y(this,"baseMediaDecodeTime",0),Y(this,"duration",0),Y(this,"warnings",[]),Y(this,"samples",[]),Y(this,"baseDts",0),Y(this,"sampleSize",16),Y(this,"sampleRate",0),Y(this,"channelCount",0),Y(this,"objectType",0),Y(this,"sampleRateIndex",0),Y(this,"config",[]),Y(this,"present",!1),Y(this,"isVideoEncryption",!1),Y(this,"isAudioEncryption",!1),Y(this,"kid",null),Y(this,"ext",void 0)}return he(r,[{key:"reset",value:function(){this.sequenceNumber=0,this.timescale=0,this.sampleDuration=0,this.sampleRate=0,this.channelCount=0,this.baseMediaDecodeTime=0,this.present=!1,this.pid=-1,this.codec="",this.samples=[],this.config=[],this.warnings=[]}},{key:"exist",value:function(){return!!(this.sampleRate&&this.channelCount&&this.codec&&this.codecType===st.AAC)}},{key:"hasSample",value:function(){return!!this.samples.length}},{key:"isEncryption",get:function(){return this.isAudioEncryption}},{key:"firstDts",get:function(){return this.samples.length?this.samples[0].dts:null}},{key:"firstPts",get:function(){return this.samples.length?this.samples[0].pts:null}},{key:"samplesDuration",get:function(){if(this.samples.length>0){var t=this.samples[0],i=this.samples[this.samples.length-1];return i.dts-t.dts+i.duration}return 0}}]),r}(),Dt=function(){function r(a,t,i){ue(this,r),Y(this,"flag",{}),Y(this,"keyframe",!1),Y(this,"gopId",0),Y(this,"duration",0),Y(this,"size",0),Y(this,"units",[]),Y(this,"chromaFormat",420),this.originPts=this.pts=a,this.originDts=this.dts=t,i&&(this.units=i)}return he(r,[{key:"cts",get:function(){return this.pts-this.dts}},{key:"setToKeyframe",value:function(){this.keyframe=!0,this.flag.dependsOn=2,this.flag.isNonSyncSample=0}}]),r}(),nt=he(function r(a,t,i,e){ue(this,r),Y(this,"duration",1024),Y(this,"flag",{dependsOn:2,isNonSyncSample:0}),Y(this,"keyframe",!0),this.originPts=this.pts=this.dts=a,this.data=t,this.size=t.byteLength,this.sampleOffset=e,i&&(this.duration=i)}),Jn=he(function r(a,t){ue(this,r),Y(this,"time",0),this.data=a,this.originPts=this.pts=t}),Va=function(r){Nn(t,r);var a=Un(t);function t(){return ue(this,t),a.apply(this,arguments)}return he(t)}(Jn),Bn=function(r){Nn(t,r);var a=Un(t);function t(){return ue(this,t),a.apply(this,arguments)}return he(t)}(Jn),Xi=function(){function r(){ue(this,r),Y(this,"id",3),Y(this,"type",yt.METADATA),Y(this,"timescale",0),Y(this,"flvScriptSamples",[]),Y(this,"seiSamples",[])}return he(r,[{key:"exist",value:function(){return!!((this.flvScriptSamples.length||this.seiSamples.length)&&this.timescale)}},{key:"reset",value:function(){this.timescale=0,this.flvScriptSamples=[],this.seiSamples=[]}},{key:"hasSample",value:function(){return!!(this.flvScriptSamples.length||this.seiSamples.length)}}]),r}(),Vt=function(){function r(a){ue(this,r),this.name=a||"",this._prefix="[".concat(this.name,"]")}return he(r,[{key:"warn",value:function(){var t;if(!r.disabled){for(var i=arguments.length,e=new Array(i),s=0;s<i;s++)e[s]=arguments[s];(t=console).warn.apply(t,[this._prefix].concat(e))}}}],[{key:"enable",value:function(){r.disabled=!1}},{key:"disable",value:function(){r.disabled=!0}}]),r}();Y(Vt,"disabled",!0);var Gi=typeof window<"u",fs=Gi&&navigator.userAgent.toLocaleLowerCase(),On=Gi&&/^((?!chrome|android).)*safari/.test(fs),Ra=Gi&&fs.includes("firefox"),Ta=Gi&&fs.includes("android"),Oe=function(){function r(){ue(this,r)}return he(r,null,[{key:"getRateIndexByRate",value:function(t){return r.FREQ.indexOf(t)}},{key:"parseADTS",value:function(t,i){for(var e=t.length,s=0;s+2<e&&!(t[s]===255&&(t[s+1]&246)===240);)s++;if(!(s>=e)){var n=s,l=[],o=(t[s+2]&60)>>>2,u=r.FREQ[o];if(!u)throw new Error("Invalid sampling index: ".concat(o));for(var h=((t[s+2]&192)>>>6)+1,d=(t[s+2]&1)<<2|(t[s+3]&192)>>>6,c=r._getConfig(o,d,h),f=c.config,y=c.codec,g,b,S=0,G=r.getFrameDuration(u);s+7<e;){if(t[s]!==255||(t[s+1]&246)!==240){s++;continue}if(b=(t[s+3]&3)<<11|t[s+4]<<3|(t[s+5]&224)>>5,!b||e-s<b)break;g=(~t[s+1]&1)*2,l.push({pts:i+S*G,data:t.subarray(s+7+g,s+b)}),S++,s+=b}return{skip:n,remaining:s>=e?void 0:t.subarray(s),frames:l,samplingFrequencyIndex:o,sampleRate:u,objectType:h,channelCount:d,codec:y,config:f,originCodec:"mp4a.40.".concat(h)}}}},{key:"parseAudioSpecificConfig",value:function(t){if(t.length){var i=t[0]>>>3,e=(t[0]&7)<<1|t[1]>>>7,s=(t[1]&120)>>>3,n=r.FREQ[e];if(n){var l=r._getConfig(e,s,i),o=l.config,u=l.codec;return{samplingFrequencyIndex:e,sampleRate:n,objectType:i,channelCount:s,config:o,codec:u,originCodec:"mp4a.40.".concat(i)}}}}},{key:"getFrameDuration",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:9e4;return 1024*i/t}},{key:"_getConfig",value:function(t,i,e){var s=[],n,l;return Ra?t>=6?(n=5,l=t-3):(n=2,l=t):Ta?(n=2,l=t):(n=e===2||e===5?e:5,l=t,t>=6?l=t-3:i===1&&(n=2,l=t)),s[0]=n<<3,s[0]|=(t&14)>>1,s[1]=(t&1)<<7,s[1]|=i<<3,n===5&&(s[1]|=(l&14)>>1,s[2]=(l&1)<<7,s[2]|=8,s[3]=0),{config:s,codec:"mp4a.40.".concat(n)}}},{key:"getSilentFrame",value:function(t,i){switch(t){case"mp4a.40.2":if(i===1)return new Uint8Array([0,200,0,128,35,128]);if(i===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(i===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(i===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(i===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(i===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(i===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(i===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(i===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}]),r}();Y(Oe,"FREQ",[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350]);var xa=500,Us=3,Yi=1e3,Ii=5e3,Ma=1e3,Ca=200,zs=5e3,Js=5,Ya=function(){function r(a,t,i){ue(this,r),this.videoTrack=a,this.audioTrack=t,this.metadataTrack=i,this._baseDts=-1,this._baseDtsInited=!1,this._audioNextPts=void 0,this._videoNextDts=void 0,this._audioTimestampBreak=0,this._videoTimestampBreak=0,this._lastVideoDuration=0,this._keyFrameInNextChunk=!1,this._lastAudioExceptionGapDot=-1/0,this._lastAudioExceptionOverlapDot=-1/0,this._lastAudioExceptionLargeGapDot=-1/0,this._lastVideoExceptionLargeGapDot=-1/0,this._lastVideoExceptionChunkFirstDtsDot=-1/0}return he(r,[{key:"fix",value:function(){var t=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;i=Math.round(i*1e3);var n=this.videoTrack,l=this.audioTrack;(e||!s)&&(this._videoLastSample=null,this._audioNextPts=void 0,this._videoNextDts=void 0,this._audioTimestampBreak=0,this._videoTimestampBreak=0,this._lastAudioExceptionGapDot=-1/0,this._lastAudioExceptionOverlapDot=-1/0,this._lastAudioExceptionLargeGapDot=-1/0,this._lastVideoExceptionLargeGapDot=-1/0,this._lastVideoExceptionChunkFirstDtsDot=-1/0),e&&!s&&(this._baseDtsInited=!1),this._baseDtsInited||this._calculateBaseDts(l,n),!s&&i&&(this._audioNextPts=this._videoNextDts=i);var o=this._baseDtsInited&&(this._videoTimestampBreak||!this.videoTrack.exist())&&(this._audioTimestampBreak||!this.audioTrack.exist());if(o&&this._resetBaseDtsWhenStreamBreaked(),this._fixAudio(l),this._keyFrameInNextChunk=!1,this._fixVideo(n),this.metadataTrack.exist()){var u=this.metadataTrack.timescale;this.metadataTrack.seiSamples.forEach(function(h){h.pts=h.originPts-t._baseDts,h.time=Math.max(0,h.pts)/u}),this.metadataTrack.flvScriptSamples.forEach(function(h){h.pts=h.originPts-t._baseDts,h.time=Math.max(0,h.pts)/u})}n.samples.length&&(n.baseMediaDecodeTime=n.samples[0].dts),l.samples.length&&(l.baseMediaDecodeTime=l.samples[0].pts*l.timescale/1e3)}},{key:"_fixVideo",value:function(t){var i=this,e=t.samples;if(e.length){e.forEach(function(G){G.dts-=i._baseDts,G.pts-=i._baseDts,G.keyframe&&(i._keyFrameInNextChunk=!0)});var s;if(t.fpsNum&&t.fpsDen)s=t.timescale*(t.fpsDen/t.fpsNum);else if(t.length>1){var n=t.samples[0],l=t.samples[e.length-1];s=Math.floor((l.dts-n.dts)/(e.length-1))}else s=this._lastVideoDuration||40;var o=e.pop();if(this._videoLastSample&&e.unshift(this._videoLastSample),this._videoLastSample=o,!!e.length){if(this._videoNextDts===void 0){var u=e[0];this._videoNextDts=u.dts}var h=e.length,d=0,c=e[0],f=this._videoNextDts-c.dts;if(Math.abs(f)>Ca){if(Math.abs(c.dts-this._lastVideoExceptionChunkFirstDtsDot)>zs){var y;this._lastVideoExceptionChunkFirstDtsDot=c.dts,t.warnings.push({type:fe.LARGE_VIDEO_GAP_BETWEEN_CHUNK,nextDts:this._videoNextDts,firstSampleDts:c.dts,nextSampleDts:(y=e[1])===null||y===void 0?void 0:y.dts,sampleDuration:f})}this._videoTimestampBreak>=Js?(this._videoNextDts=c.dts,this._videoTimestampBreak=0):(c.dts+=f,c.pts+=f,this.audioTrack.exist()||(this._videoTimestampBreak=1))}for(var g=0;g<h;g++){var b=e[g].dts,S=e[g+1];g<h-1?d=S.dts-b:o?d=o.dts-b:d=s,(d>Ma||d<0)&&(this._videoTimestampBreak++,Math.abs(b-this._lastVideoExceptionLargeGapDot)>zs&&(this._lastVideoExceptionLargeGapDot=b,t.warnings.push({type:fe.LARGE_VIDEO_GAP,time:b/t.timescale,dts:b,originDts:e[g].originDts,nextDts:this._videoNextDts,sampleDuration:d,refSampleDuration:s})),d=s),e[g].duration=d,this._videoNextDts+=d,this._lastVideoDuration=d}}}}},{key:"_fixAudio",value:function(t){var i=this,e=t.samples;e.length&&(e.forEach(function(s){s.dts=s.pts-=i._baseDts}),this._doFixAudioInternal(t,e,1e3))}},{key:"_calculateBaseDts",value:function(t,i){var e=t.samples,s=i.samples;if(!e.length&&!s.length)return!1;var n=1/0,l=1/0;e.length&&(t.baseDts=n=e[0].pts),s.length&&(i.baseDts=l=s[0].dts),this._baseDts=Math.min(n,l);var o=l-n;return Number.isFinite(o)&&Math.abs(o)>xa&&i.warnings.push({type:fe.LARGE_AV_SHIFT,videoBaseDts:l,audioBasePts:n,baseDts:this._baseDts,delta:o}),this._baseDtsInited=!0,!0}},{key:"_resetBaseDtsWhenStreamBreaked",value:function(){var t=this._calculateBaseDts(this.audioTrack,this.videoTrack);t&&(this.audioTrack.exist()?this.videoTrack.exist()?this._baseDts-=Math.min(this._audioNextPts,this._videoNextDts):this._baseDts-=this._audioNextPts:this._baseDts-=this._videoNextDts,this._videoTimestampBreak=0,this._audioTimestampBreak=0)}},{key:"_doFixAudioInternal",value:function(t,i,e){t.sampleDuration||(t.sampleDuration=t.codecType===st.AAC?Oe.getFrameDuration(t.timescale,e):this._getG711Duration(t));var s=t.sampleDuration,n=t.codecType===st.AAC?1024:s*t.timescale/1e3;if(this._audioNextPts===void 0){var l=i[0];this._audioNextPts=l.pts}for(var o=0;o<i.length;o++){var u=this._audioNextPts,h=i[o],d=h.pts-u;if(o===0&&this._audioTimestampBreak>=Js&&this._keyFrameInNextChunk&&(u=this._audioNextPts=h.dts,d=0,this._audioTimestampBreak=0),!this._audioTimestampBreak&&d>=Us*s&&d<=Yi&&!On){var c=this._getSilentFrame(t)||i[0].data.subarray(),f=Math.floor(d/s);Math.abs(h.pts-this._lastAudioExceptionGapDot)>Ii&&(this._lastAudioExceptionGapDot=h.pts,t.warnings.push({type:fe.AUDIO_FILLED,pts:h.pts,originPts:h.originPts,count:f,nextPts:u,refSampleDuration:s}));for(var y=0;y<f;y++){var g=new nt(Math.floor(this._audioNextPts+s)-Math.floor(this._audioNextPts),c,n);g.originPts=Math.floor(this._baseDts+u),i.splice(o,0,g),this._audioNextPts+=s,o++}o--}else d<=-Us*s&&d>=-1*Yi?(Math.abs(h.pts-this._lastAudioExceptionOverlapDot)>Ii&&(this._lastAudioExceptionOverlapDot=h.pts,t.warnings.push({type:fe.AUDIO_DROPPED,pts:h.pts,originPts:h.originPts,nextPts:u,refSampleDuration:s})),i.splice(o,1),o--):(Math.abs(d)>Yi&&(this._audioTimestampBreak++,Math.abs(h.pts-this._lastAudioExceptionLargeGapDot)>Ii&&(this._lastAudioExceptionLargeGapDot=h.pts,t.warnings.push({type:fe.LARGE_AUDIO_GAP,time:h.pts/1e3,pts:h.pts,originPts:h.originPts,nextPts:u,sampleDuration:d,refSampleDuration:s}))),h.dts=h.pts=u,h.duration=n,this._audioNextPts+=s)}}},{key:"_getG711Duration",value:function(t){var i=t.sampleSize,e=t.channelCount,s=t.sampleRate,n=t.samples[0];if(n)return n.data.byteLength*2/e/(i/8)/s*1e3}},{key:"_getSilentFrame",value:function(t){return t.codecType===st.AAC?Oe.getSilentFrame(t.codec,t.channelCount):new Uint8Array(8*t.sampleDuration*t.channelCount)}}]),r}();function Pe(){for(var r=arguments.length,a=new Array(r),t=0;t<r;t++)a[t]=arguments[t];a=a.filter(Boolean);var i=new Uint8Array(a.reduce(function(s,n){return s+n.byteLength},0)),e=0;return a.forEach(function(s){i.set(s,e),e+=s.byteLength}),i}var Ia=Math.pow(2,32);function de(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(r[a]<<8)+(r[a+1]||0)}function _a(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(r[a]<<16)+(r[a+1]<<8)+(r[a+2]||0)}function H(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(r[a]<<24>>>0)+(r[a+1]<<16)+(r[a+2]<<8)+(r[a+3]||0)}function kt(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return H(r,a)*Ia+H(r,a+4)}function An(r){for(var a="avc1.",t,i=0;i<3;i++)t=r[i].toString(16),t.length<2&&(t="0".concat(t)),a+=t;return a}function Fa(r){var a="";if(r.forEach(function(e){a+=Ka(e)}),a.length<=32)for(var t=32-a.length,i=0;i<t;i++)a+="0";return a}function Bs(r){if(!Array.isArray(r)){for(var a=[],t="",i=0;i<r.length;i++)i%2&&(t=r[i-1]+r[i],a.push(parseInt(t,16)),t="");return a}return r.map(function(e){return parseInt(e,16)})}function Ka(r){return("0"+Number(r).toString(16)).slice(-2).toUpperCase()}function _i(r,a){return+(r+"."+a)}function Da(r){if(r.length<5)return 0;var a=Math.hypot(r[0],r[3]),t=Math.hypot(r[1],r[4]);return a===0||t===0?0:180*Math.atan2(r[1]/t,r[0]/a)/Math.PI}var $e=function(){function r(){ue(this,r)}return he(r,null,[{key:"parseAnnexB",value:function(t){for(var i=t.length,e=2,s=0;t[e]!==null&&t[e]!==void 0&&t[e]!==1;)e++;if(e++,s=e+2,s>=i)return[];for(var n=[];s<i;)switch(t[s]){case 0:if(t[s-1]!==0){s+=2;break}else if(t[s-2]!==0){s++;break}e!==s-2&&n.push(t.subarray(e,s-2));do s++;while(t[s]!==1&&s<i);e=s+1,s=e+2;break;case 1:if(t[s-1]!==0||t[s-2]!==0){s+=3;break}e!==s-2&&n.push(t.subarray(e,s-2)),e=s+1,s=e+2;break;default:s+=3;break}return e<i&&n.push(t.subarray(e)),n}},{key:"parseAvcC",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;if(!(t.length<4)){for(var e=t.length,s=[],n=0,l;n+i<e;)if(l=H(t,n),i===3&&(l>>>=8),n+=i,!!l){if(n+l>e)break;s.push(t.subarray(n,n+l)),n+=l}return s}}},{key:"parseSEI",value:function(t,i){for(var e=t.length,s=i?2:1,n=0,l=0,o="";t[s]===255;)n+=255,s++;for(n+=t[s++];t[s]===255;)l+=255,s++;if(l+=t[s++],n===5&&e>s+16)for(var u=0;u<16;u++)o+=t[s].toString(16),s++;return{payload:t.subarray(s,s+l),type:n,size:l,uuid:o}}},{key:"removeEPB",value:function(t){for(var i=t.byteLength,e=[],s=1;s<i-2;)t[s]===0&&t[s+1]===0&&t[s+2]===3?(e.push(s+2),s+=2):s++;if(!e.length)return t;var n=i-e.length,l=new Uint8Array(n),o=0;for(s=0;s<n;o++,s++)o===e[0]&&(o++,e.shift()),l[s]=t[o];return l}}]),r}(),ts=function(){function r(a){if(ue(this,r),Y(this,"_bytesAvailable",void 0),Y(this,"_bitsAvailable",0),Y(this,"_word",0),!a)throw new Error("ExpGolomb data params is required");this._data=a,this._bytesAvailable=a.byteLength,this._bytesAvailable&&this._loadWord()}return he(r,[{key:"bitsAvailable",get:function(){return this._bitsAvailable}},{key:"_loadWord",value:function(){var t=this._data.byteLength-this._bytesAvailable,i=Math.min(4,this._bytesAvailable);if(i===0)throw new Error("No bytes available");var e=new Uint8Array(4);e.set(this._data.subarray(t,t+i)),this._word=new DataView(e.buffer).getUint32(0),this._bitsAvailable=i*8,this._bytesAvailable-=i}},{key:"skipBits",value:function(t){if(this._bitsAvailable>t)this._word<<=t,this._bitsAvailable-=t;else{t-=this._bitsAvailable;var i=Math.floor(t/8);t-=i*8,this._bytesAvailable-=i,this._loadWord(),this._word<<=t,this._bitsAvailable-=t}}},{key:"readBits",value:function(t){if(t>32)throw new Error("Cannot read more than 32 bits");var i=Math.min(this._bitsAvailable,t),e=this._word>>>32-i;return this._bitsAvailable-=i,this._bitsAvailable>0?this._word<<=i:this._bytesAvailable>0&&this._loadWord(),i=t-i,i>0&&this._bitsAvailable?e<<i|this.readBits(i):e}},{key:"skipLZ",value:function(){var t;for(t=0;t<this._bitsAvailable;++t)if(this._word&2147483648>>>t)return this._word<<=t,this._bitsAvailable-=t,t;return this._loadWord(),t+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var t=this.skipLZ();return this.readBits(t+1)-1}},{key:"readEG",value:function(){var t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)}},{key:"readBool",value:function(){return this.readBits(1)===1}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"skipScalingList",value:function(t){for(var i=8,e=8,s,n=0;n<t;n++)e!==0&&(s=this.readEG(),e=(i+s+256)%256),i=e===0?i:e}}]),r}(),jn=function(){function r(){ue(this,r)}return he(r,null,[{key:"parseAVCDecoderConfigurationRecord",value:function(t){if(!(t.length<7)){for(var i=(t[4]&3)+1,e,s=[],n=[],l=6,o=t[5]&31,u,h=0;h<o;h++)if(u=t[l]<<8|t[l+1],l+=2,!!u){var d=t.subarray(l,l+u);l+=u,s.push(d),e||(e=r.parseSPS($e.removeEPB(d)))}var c=t[l];l++;for(var f,y=0;y<c;y++)f=t[l]<<8|t[l+1],l+=2,f&&(n.push(t.subarray(l,l+f)),l+=f);return{sps:e,spsArr:s,ppsArr:n,nalUnitSize:i}}}},{key:"parseSPS",value:function(t){var i=new ts(t);i.readUByte();var e=i.readUByte(),s=i.readUByte(),n=i.readUByte();i.skipUEG();var l=420;if(e===100||e===110||e===122||e===244||e===44||e===83||e===86||e===118||e===128||e===138||e===144){var o=i.readUEG();if(o<=3&&(l=[0,420,422,444][o]),o===3&&i.skipBits(1),i.skipUEG(),i.skipUEG(),i.skipBits(1),i.readBool())for(var u=o!==3?8:12,h=0;h<u;h++)i.readBool()&&(h<6?i.skipScalingList(16):i.skipScalingList(64))}i.skipUEG();var d=i.readUEG();if(d===0)i.readUEG();else if(d===1){i.skipBits(1),i.skipUEG(),i.skipUEG();for(var c=i.readUEG(),f=0;f<c;f++)i.skipUEG()}i.skipUEG(),i.skipBits(1);var y=i.readUEG(),g=i.readUEG(),b=i.readBits(1);b===0&&i.skipBits(1),i.skipBits(1);var S=0,G=0,X=0,L=0;i.readBool()&&(S=i.readUEG(),G=i.readUEG(),X=i.readUEG(),L=i.readUEG());var k,W,V,w,M;if(i.readBool()){if(i.readBool()){var C=i.readUByte();switch(C){case 1:k=[1,1];break;case 2:k=[12,11];break;case 3:k=[10,11];break;case 4:k=[16,11];break;case 5:k=[40,33];break;case 6:k=[24,11];break;case 7:k=[20,11];break;case 8:k=[32,11];break;case 9:k=[80,33];break;case 10:k=[18,11];break;case 11:k=[15,11];break;case 12:k=[64,33];break;case 13:k=[160,99];break;case 14:k=[4,3];break;case 15:k=[3,2];break;case 16:k=[2,1];break;case 255:{k=[i.readUByte()<<8|i.readUByte(),i.readUByte()<<8|i.readUByte()];break}}}if(i.readBool()&&i.readBool(),i.readBool()&&(i.readBits(4),i.readBool()&&i.readBits(24)),i.readBool()&&(i.readUEG(),i.readUEG()),i.readBool()){var U=i.readBits(32),m=i.readBits(32);W=i.readBool(),V=m,w=U*2,M=V/w}}return{codec:An(t.subarray(1,4)),profileIdc:e,profileCompatibility:s,levelIdc:n,chromaFormat:l,width:Math.ceil((y+1)*16-2*(S+G)),height:(2-b)*(g+1)*16-(b?2:4)*(X+L),sarRatio:k,fpsNum:V,fpsDen:w,fps:M,fixedFrame:W}}}]),r}(),is=function(){function r(){ue(this,r)}return he(r,null,[{key:"parseHEVCDecoderConfigurationRecord",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!(t.length<23)){i=i||{};for(var e=(t[21]&3)+1,s,n,l=[],o=[],u=[],h=23,d=t[22],c,f,y,g=0;g<d;g++){c=t[h]&63,f=t[h+1]<<8|t[h+2],h+=3;for(var b=0;b<f;b++)if(y=t[h]<<8|t[h+1],h+=2,!!y){switch(c){case 32:{var S=t.subarray(h,h+y);s||(s=r.parseVPS($e.removeEPB(S),i)),u.push(S)}break;case 33:{var G=t.subarray(h,h+y);n||(n=r.parseSPS($e.removeEPB(G),i)),l.push(G)}break;case 34:o.push(t.subarray(h,h+y));break}h+=y}}return{hvcC:i,sps:n,spsArr:l,ppsArr:o,vpsArr:u,nalUnitSize:e}}}},{key:"parseVPS",value:function(t,i){i=i||{};var e=new ts(t);e.readUByte(),e.readUByte(),e.readBits(12);var s=e.readBits(3);return i.numTemporalLayers=Math.max(i.numTemporalLayers||0,s+1),e.readBits(17),r._parseProfileTierLevel(e,s,i),i}},{key:"parseSPS",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};i=i||{};var e=new ts(t);e.readUByte(),e.readUByte(),e.readBits(4);var s=e.readBits(3);i.numTemporalLayers=Math.max(s+1,i.numTemporalLayers||0),i.temporalIdNested=e.readBits(1),r._parseProfileTierLevel(e,s,i),e.readUEG();var n=i.chromaFormatIdc=e.readUEG(),l=420;n<=3&&(l=[0,420,422,444][n]);var o=0;n===3&&(o=e.readBits(1));var u=e.readUEG(),h=e.readUEG(),d=e.readBits(1),c,f,y,g;if(d===1&&(c=e.readUEG(),f=e.readUEG(),y=e.readUEG(),g=e.readUEG()),i.bitDepthLumaMinus8=e.readUEG(),i.bitDepthChromaMinus8=e.readUEG(),d===1){var b=(n===1||n===2)&&o===0?2:1,S=n===1&&o===0?2:1;u-=b*(f+c),h-=S*(g+y)}return{codec:"hev1.1.6.L93.B0",width:u,height:h,chromaFormat:l,hvcC:i}}},{key:"_parseProfileTierLevel",value:function(t,i,e){var s=e.generalTierFlag||0;e.generalProfileSpace=t.readBits(2),e.generalTierFlag=Math.max(t.readBits(1),s),e.generalProfileIdc=Math.max(t.readBits(5),e.generalProfileIdc||0),e.generalProfileCompatibilityFlags=t.readBits(32),e.generalConstraintIndicatorFlags=[t.readBits(8),t.readBits(8),t.readBits(8),t.readBits(8),t.readBits(8),t.readBits(8)];var n=t.readBits(8);s<e.generalTierFlag?e.generalLevelIdc=n:e.generalLevelIdc=Math.max(n,e.generalLevelIdc||0);var l=[],o=[];if(i>t.bitsAvailable)throw new Error("maxSubLayersMinus inavlid size ".concat(i));for(var u=0;u<i;u++)l[u]=t.readBits(1),o[u]=t.readBits(1);i>0&&t.readBits((8-i)*2);for(var h=0;h<i;h++)l[h]!==0&&(t.readBits(2),t.readBits(1),t.readBits(5),t.readBits(16),t.readBits(16),t.readBits(4),t.readBits(16),t.readBits(16),t.readBits(12)),o[h]!==0&&t.readBits(8)}}]),r}(),Os=function(){function r(){ue(this,r)}return he(r,null,[{key:"decode",value:function(t){for(var i=[],e=t,s=0,n=t.length;s<n;){if(e[s]<128){i.push(String.fromCharCode(e[s])),++s;continue}else if(!(e[s]<192)){if(e[s]<224){if(r._checkContinuation(e,s,1)){var l=(e[s]&31)<<6|e[s+1]&63;if(l>=128){i.push(String.fromCharCode(l&65535)),s+=2;continue}}}else if(e[s]<240){if(r._checkContinuation(e,s,2)){var o=(e[s]&15)<<12|(e[s+1]&63)<<6|e[s+2]&63;if(o>=2048&&(o&63488)!==55296){i.push(String.fromCharCode(o&65535)),s+=3;continue}}}else if(e[s]<248&&r._checkContinuation(e,s,3)){var u=(e[s]&7)<<18|(e[s+1]&63)<<12|(e[s+2]&63)<<6|e[s+3]&63;if(u>65536&&u<1114112){u-=65536,i.push(String.fromCharCode(u>>>10|55296)),i.push(String.fromCharCode(u&1023|56320)),s+=4;continue}}}i.push("�"),++s}return i.join("")}},{key:"_checkContinuation",value:function(t,i,e){var s=t;if(i+e<s.length){for(;e--;)if((s[++i]&192)!==128)return!1;return!0}else return!1}}]),r}(),Pa=function(){function r(){ue(this,r)}return he(r,null,[{key:"parse",value:function(t){if(!(t.length<3)){var i={},e=r._parseValue(new DataView(t.buffer,t.byteOffset,t.byteLength)),s=r._parseValue(new DataView(t.buffer,t.byteOffset+e.size,t.byteLength-e.size));return i[e.data]=s.data,i}}},{key:"_parseValue",value:function(t){var i=t.byteLength,e=t.getUint8(0),s=1,n=!1,l;switch(e){case 0:l=t.getFloat64(1),s+=8;break;case 1:{l=!!t.getUint8(1),s+=1;break}case 2:{var o=r._parseString(new DataView(t.buffer,t.byteOffset+s,t.byteLength-s)),u=o.data,h=o.size;l=u,s+=h}break;case 3:{l={};var d=0;for((t.getUint32(i-4)&16777215)===9&&(d=3);s<i-4;){var c=r._parseObject(new DataView(t.buffer,t.byteOffset+s,t.byteLength-s-d)),f=c.size,y=c.data,g=c.isEnd;if(g)break;l[y.name]=y.value,s+=f}if(s<=i-3){var b=t.getUint32(s-1)&16777215;b===9&&(s+=3)}}break;case 8:{l={},s+=4;var S=0;for((t.getUint32(i-4)&16777215)===9&&(S=3);s<i-8;){var G=r._parseObject(new DataView(t.buffer,t.byteOffset+s,t.byteLength-s-S)),X=G.size,L=G.data,k=G.isEnd;if(k)break;l[L.name]=L.value,s+=X}if(s<=i-3){var W=t.getUint32(s-1)&16777215;W===9&&(s+=3)}}break;case 9:l=void 0,s=1,n=!0;break;case 10:{l=[];var V=t.getUint32(1);s+=4;for(var w=0;w<V;w++){var M=r._parseValue(new DataView(t.buffer,t.byteOffset+s,t.byteLength-s)),C=M.data,U=M.size;l.push(C),s+=U}}break;case 11:{var m=t.getFloat64(s)+t.getInt16(s+8)*6e4;l=new Date(m),s+=10}break;case 12:{var p=t.getUint32(1);s+=4,l="",p>0&&(l=Os.decode(new Uint8Array(t.buffer,t.byteOffset+s,p))),s+=p}break;default:s=i;break}return{data:l,size:s,isEnd:n}}},{key:"_parseString",value:function(t){var i=t.getUint16(0),e="";return i>0&&(e=Os.decode(new Uint8Array(t.buffer,t.byteOffset+2,i))),{data:e,size:2+i}}},{key:"_parseObject",value:function(t){if(!(t.byteLength<3)){var i=r._parseString(t),e=r._parseValue(new DataView(t.buffer,t.byteOffset+i.size,t.byteLength-i.size));return{data:{name:i.data,value:e.data},size:i.size+e.size,isEnd:e.isEnd}}}}]),r}(),lt=new Vt("FlvDemuxer"),Qn=function(){function r(a,t,i){ue(this,r),Y(this,"_headerParsed",!1),Y(this,"_remainingData",null),Y(this,"_gopId",0),Y(this,"_needAddMetaBeforeKeyFrameNal",!0),this.videoTrack=a||new Li,this.audioTrack=t||new Ei,this.metadataTrack=i||new Xi,this._fixer=new Ya(this.videoTrack,this.audioTrack,this.metadataTrack)}return he(r,[{key:"demux",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=this.audioTrack,n=this.videoTrack,l=this.metadataTrack;if((i||!e)&&(this._remainingData=null),i&&(this._headerParsed=!1),i?(n.reset(),s.reset(),l.reset()):(n.samples=[],s.samples=[],l.seiSamples=[],l.flvScriptSamples=[],n.warnings=[],s.warnings=[],this._remainingData&&(t=Pe(this._remainingData,t),this._remainingData=null)),!t.length)return{videoTrack:n,audioTrack:s,metadataTrack:l};var o=0;if(!this._headerParsed){if(!r.probe(t))throw new Error("Invalid flv file");s.present=(t[4]&4)>>>2!==0,n.present=(t[4]&1)!==0,this._headerParsed=!0,o=H(t,5)+4}for(var u=t.length,h,d,c,f,y;o+15<u&&(h=t[o],d=t[o+1]<<16|t[o+2]<<8|t[o+3],!(o+15+d>u));)c=(t[o+7]<<24>>>0)+(t[o+4]<<16)+(t[o+5]<<8)+t[o+6],o+=11,f=t.subarray(o,o+d),h===8?this._parseAudio(f,c):h===9?this._parseVideo(f,c):h===18?this._parseScript(f,c):lt.warn("Invalid tag type: ".concat(h)),o+=d,y=H(t,o),y!==11+d&&lt.warn("Invalid PrevTagSize ".concat(y," (").concat(11+d,")")),o+=4;return o<u&&(this._remainingData=t.subarray(o)),s.formatTimescale=n.formatTimescale=n.timescale=l.timescale=1e3,s.timescale=s.sampleRate||0,!s.exist()&&s.hasSample()&&s.reset(),!n.exist()&&n.hasSample()&&n.reset(),{videoTrack:n,audioTrack:s,metadataTrack:l}}},{key:"fix",value:function(t,i,e){return this._fixer.fix(t,i,e),{videoTrack:this.videoTrack,audioTrack:this.audioTrack,metadataTrack:this.metadataTrack}}},{key:"demuxAndFix",value:function(t,i,e,s){return this.demux(t,i,e),this.fix(s,i,e)}},{key:"_parseAudio",value:function(t,i){if(t.length){var e=(t[0]&240)>>>4,s=this.audioTrack;if(e!==10&&e!==7&&e!==8){lt.warn("Unsupported sound format: ".concat(e)),s.reset();return}if(e!==10){var n=(t[0]&12)>>2,l=(t[0]&2)>>1,o=t[0]&1;s.sampleRate=r.AUDIO_RATE[n],s.sampleSize=l?16:8,s.channelCount=o+1}e===10?this._parseAac(t,i):this._parseG711(t,i,e)}}},{key:"_parseG711",value:function(t,i,e){var s=this.audioTrack;s.codecType=e===7?st.G711PCMA:st.G711PCMU,s.sampleRate=8e3,s.codec=s.codecType,s.samples.push(new nt(i,t.subarray(1)))}},{key:"_parseAac",value:function(t,i){var e=this.audioTrack;if(e.codecType=st.AAC,t[1]===0){var s=Oe.parseAudioSpecificConfig(t.subarray(2));s?(e.codec=s.codec,e.channelCount=s.channelCount,e.sampleRate=s.sampleRate,e.config=s.config,e.objectType=s.objectType,e.sampleRateIndex=s.samplingFrequencyIndex):(e.reset(),lt.warn("Cannot parse AudioSpecificConfig",t))}else if(t[1]===1){if(i==null)return;e.samples.push(new nt(i,t.subarray(2)))}else lt.warn("Unknown AACPacketType: ".concat(t[1]))}},{key:"_parseVideo",value:function(t,i){var e=this;if(!(t.length<6)){var s=(t[0]&240)>>>4,n=t[0]&15,l=this.videoTrack;if(n!==7&&n!==12){l.reset(),lt.warn("Unsupported codecId: ".concat(n));return}var o=n===12;l.codecType=o?it.HEVC:it.AVC;var u=t[1],h=(t[2]<<16|t[3]<<8|t[4])<<8>>8;if(u===0){var d=t.subarray(5),c=o?is.parseHEVCDecoderConfigurationRecord(d):jn.parseAVCDecoderConfigurationRecord(d);if(c){var f=c.hvcC,y=c.sps,g=c.ppsArr,b=c.spsArr,S=c.vpsArr,G=c.nalUnitSize;f&&(l.hvcC=l.hvcC||f),y&&(l.codec=y.codec,l.width=y.width,l.height=y.height,l.sarRatio=y.sarRatio,l.fpsNum=y.fpsNum,l.fpsDen=y.fpsDen),b.length&&(l.sps=b),g.length&&(l.pps=g),S&&S.length&&(l.vps=S),G&&(l.nalUnitSize=G)}else lt.warn("Cannot parse ".concat(o?"HEVC":"AVC","DecoderConfigurationRecord"),t)}else if(u===1){var X=$e.parseAvcC(t.subarray(5),l.nalUnitSize);if(X=this._checkAddMetaNalToUnits(o,X,l),X&&X.length){var L=new Dt(i+h,i,X);s===1&&L.setToKeyframe(),l.samples.push(L),X.forEach(function(k){var W=o?k[0]>>>1&63:k[0]&31;switch(W){case 5:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:if(!o&&W!==5||o&&W===5)break;L.setToKeyframe();break;case 6:case 39:case 40:if(!o&&W!==6||o&&W===6)break;e.metadataTrack.seiSamples.push(new Bn($e.parseSEI($e.removeEPB(k),o),i+h));break}}),L.keyframe&&this._gopId++,L.gopId=this._gopId}else lt.warn("Cannot parse NALUs",t)}else u===2||lt.warn("Unknown AVCPacketType: ".concat(u))}}},{key:"_checkAddMetaNalToUnits",value:function(t,i,e){if(!t||!this._needAddMetaBeforeKeyFrameNal)return this._needAddMetaBeforeKeyFrameNal=!1,i;var s=i.map(function(n){return n[0]>>>1&63});return s.includes(32)?(this._needAddMetaBeforeKeyFrameNal=!1,i):(i.unshift(e.pps[0]),i.unshift(e.sps[0]),i.unshift(e.vps[0]),i.filter(Boolean))}},{key:"_parseScript",value:function(t,i){this.metadataTrack.flvScriptSamples.push(new Va(Pa.parse(t),i))}}],[{key:"probe",value:function(t){return t[0]!==70||t[1]!==76||t[2]!==86||t[3]!==1?!1:H(t,5)>=9}}]),r}();Y(Qn,"AUDIO_RATE",[5500,11e3,22e3,44e3]);var Ha=9e4/2,As=3,si=9e4,Fi=5*9e4,Ki=9e4,Na=9e4/2,Ua=9e4*5,za=function(){function r(a,t,i,e){ue(this,r),this.videoTrack=a,this.audioTrack=t,this.metadataTrack=i,this._baseDts=-1,this._baseVideoDts=-1,this._baseAudioDts=-1,this._baseDtsInited=!1,this._audioNextPts=void 0,this._videoNextDts=void 0,this._audioTimestampBreak=!1,this._videoTimestampBreak=!1,this._lastAudioExceptionGapDot=0,this._lastAudioExceptionOverlapDot=0,this._lastAudioExceptionLargeGapDot=0,this._needForceFixLargeGap=e==null?void 0:e.forceFixLargeGap,this._largeGapThreshold=(e==null?void 0:e.largeGapThreshold)||Ua}return he(r,[{key:"fix",value:function(){var t=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;i=Math.round(i*9e4);var n=this.videoTrack,l=this.audioTrack,o=n.samples,u=l.samples;if(!(!o.length&&!u.length)){var h=o[0],d=u[0],c=0;if(o.length&&u.length&&(c=h.dts-d.pts),this._baseDtsInited||this._calculateBaseDts(this.audioTrack,this.videoTrack),e&&(this._calculateBaseDts(this.audioTrack,this.videoTrack),this._baseDts-=i,this._baseAudioDts-=i,this._baseVideoDts-=i),!s){this._videoNextDts=c>0?i+c:i,this._audioNextPts=c>0?i:i-c,this._needForceFixLargeGap&&(this._videoNextDts=0,this._audioNextPts=0);var f=h?h.dts-this._baseDts-this._videoNextDts:0,y=d?d.pts-this._baseDts-this._audioNextPts:0;Math.abs(f||y)>Ki&&(this._calculateBaseDts(this.audioTrack,this.videoTrack),this._baseDts-=i)}if(this._resetBaseDtsWhenStreamBreaked(),this._fixAudio(l),this._fixVideo(n),this.metadataTrack.exist()){var g=this.metadataTrack.timescale;this.metadataTrack.seiSamples.forEach(function(b){b.pts=b.originPts-t._baseDts,b.time=Math.max(0,b.pts)/g})}n.samples.length&&(n.baseMediaDecodeTime=n.samples[0].dts),l.samples.length&&(l.baseMediaDecodeTime=l.samples[0].pts*l.timescale/9e4)}}},{key:"_fixVideo",value:function(t){var i=this,e=t.samples;if(e.length){if(e.forEach(function(V){V.dts-=i._needForceFixLargeGap?i._baseVideoDts:i._baseDts,V.pts-=i._needForceFixLargeGap?i._baseVideoDts:i._baseDts}),this._videoNextDts===void 0){var s=e[0];this._videoNextDts=s.dts}var n=e.length,l=0,o=e[0],u=e[1],h=this._videoNextDts-o.dts;if(Math.abs(h)>Na){var d;if(t.warnings.push({type:fe.LARGE_VIDEO_GAP_BETWEEN_CHUNK,nextDts:this._videoNextDts/90,firstSampleDts:o.dts/90,nextSampleDts:(((d=e[1])===null||d===void 0?void 0:d.dts)||0)/90,sampleDuration:h/90}),o.dts+=h,o.pts+=h,u&&Math.abs(u.dts-o.dts)>Ki)this._videoTimestampBreak=!0,e.forEach(function(V,w){w!==0&&(V.dts+=h,V.pts+=h)});else for(var c=1;c<n-1;c++){var f,y=(f=e[c])===null||f===void 0?void 0:f.dts,g=e[c-1].dts;y&&y-g<0&&(e[c].dts+=h,e[c].pts+=h)}}var b;if(t.fpsNum&&t.fpsDen&&(b=t.timescale*(t.fpsDen/t.fpsNum)),b<90*10&&(b=0),!b){var S=t.samples[0],G=t.samples[1];b=n===1?9e3:Math.floor(G.dts-S.dts)}for(var X=0;X<n;X++){var L=e[X].dts,k=e[X+1];if(X<n-1?l=k.dts-L:e[X-1]?l=Math.min(L-e[X-1].dts,b):l=b,l>Ki||l<0){this._videoTimestampBreak=!0,l=this._audioTimestampBreak?b:Math.max(l,30*90);var W=this._audioNextPts||0;k&&k.dts>W&&(l=b),t.warnings.push({type:fe.LARGE_VIDEO_GAP,time:L/t.timescale,dts:L,originDts:e[X].originDts,nextDts:this._videoNextDts,sampleDuration:l,refSampleDuration:b})}e[X].duration=l,this._videoNextDts+=l}}}},{key:"_fixAudio",value:function(t){var i=this,e=t.samples;e.length&&(e.forEach(function(s){s.pts-=i._needForceFixLargeGap?i._baseAudioDts:i._baseDts,s.dts=s.pts}),this._doFixAudioInternal(t,e,9e4))}},{key:"_calculateBaseDts",value:function(t,i){var e=t.samples,s=i.samples;if(!e.length&&!s.length)return!1;var n=1/0,l=1/0;e.length&&(t.baseDts=n=e[0].pts,this._baseAudioDts=n),s.length&&(i.baseDts=l=s[0].dts,this._baseVideoDts=l),this._baseDts=Math.min(n,l);var o=l-n,u=!1;return Number.isFinite(o)&&Math.abs(o)>Ha&&i.warnings.push({type:fe.LARGE_AV_SHIFT,videoBaseDts:l,audioBasePts:n,baseDts:this._baseDts,delta:o}),Number.isFinite(o)&&Math.abs(o)>this._largeGapThreshold*si&&(u=!0),this._baseDtsInited||(u&&this._needForceFixLargeGap?this._needForceFixLargeGap=!0:this._needForceFixLargeGap=!1),this._baseDtsInited=!0,!0}},{key:"_resetBaseDtsWhenStreamBreaked",value:function(){if(this._baseDtsInited&&this._videoTimestampBreak&&this._audioTimestampBreak){var t=this._calculateBaseDts(this.audioTrack,this.videoTrack);if(!t)return;this._baseDts-=Math.min(this._audioNextPts,this._videoNextDts),this._audioLastSample=null,this._videoLastSample=null,this._videoTimestampBreak=!1,this._audioTimestampBreak=!1}}},{key:"_doFixAudioInternal",value:function(t,i,e){t.sampleDuration||(t.sampleDuration=Oe.getFrameDuration(t.timescale,e));var s=t.sampleDuration;if(this._audioNextPts===void 0){var n=i[0];this._audioNextPts=n.pts}for(var l=0;l<i.length;l++){var o=this._audioNextPts,u=i[l],h=u.pts-o;if(!this._audioTimestampBreak&&h>=As*s&&h<=si&&!On){var d=Oe.getSilentFrame(t.codec,t.channelCount)||i[0].data.subarray(),c=Math.floor(h/s);Math.abs(u.pts-this._lastAudioExceptionGapDot)>Fi&&(this._lastAudioExceptionGapDot=u.pts),t.warnings.push({type:fe.AUDIO_FILLED,pts:u.pts/90,originPts:u.originPts,count:c,nextPts:o/90,refSampleDuration:s});for(var f=0;f<c;f++){var y=new nt(Math.floor(o),d);y.originPts=Math.floor(this._baseDts+o),i.splice(l,0,y),this._audioNextPts+=s,l++}l--}else h<=-As*s&&h>=-1*si?(Math.abs(u.pts-this._lastAudioExceptionOverlapDot)>Fi&&(this._lastAudioExceptionOverlapDot=u.pts,t.warnings.push({type:fe.AUDIO_DROPPED,pts:u.pts/90,originPts:u.originPts,nextPts:o/90,refSampleDuration:s})),i.splice(l,1),l--):(Math.abs(h)>=si&&(this._audioTimestampBreak=!0,Math.abs(u.pts-this._lastAudioExceptionLargeGapDot)>Fi&&(this._lastAudioExceptionLargeGapDot=u.pts,t.warnings.push({type:fe.LARGE_AUDIO_GAP,time:u.pts/1e3,pts:u.pts/90,originPts:u.originPts,nextPts:o/90,sampleDuration:h,refSampleDuration:s}))),u.dts=u.pts=o,this._audioNextPts+=s)}}}]),r}(),Ae=new Vt("TsDemuxer"),qn=function(){function r(a,t,i){var e=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};ue(this,r),Y(this,"_pmtId",-1),Y(this,"_remainingPacketData",null),Y(this,"_videoPesData",[]),Y(this,"_audioPesData",[]),Y(this,"_gopId",0),this.videoTrack=a||new Li,this.audioTrack=t||new Ei,this.metadataTrack=i||new Xi,this._fixer=new za(this.videoTrack,this.audioTrack,this.metadataTrack,e)}return he(r,[{key:"demux",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=this.audioTrack,n=this.videoTrack,l=this.metadataTrack;i&&(this._pmtId=-1,n.reset(),s.reset(),l.reset()),!e||i?(this._remainingPacketData=null,this._videoPesData=[],this._audioPesData=[]):(n.samples=[],s.samples=[],l.seiSamples=[],n.warnings=[],s.warnings=[],this._remainingPacketData&&(t=Pe(this._remainingPacketData,t),this._remainingPacketData=null));var o=t.length,u=o%188;u&&(this._remainingPacketData=t.subarray(o-u),o-=u);for(var h=n.pid,d=s.pid,c=0;c<o;c+=188){if(t[c]!==71)throw new Error("TS packet did not start with 0x47");var f=!!(t[c+1]&64),y=((t[c+1]&31)<<8)+t[c+2],g=(t[c+3]&48)>>4,b=void 0;if(g>1){if(b=c+5+t[c+4],b===c+188)continue}else b=c+4;switch(y){case 0:f&&(b+=t[b]+1),this._pmtId=(t[b+10]&31)<<8|t[b+11];break;case this._pmtId:{f&&(b+=t[b]+1);var S=b+3+((t[b+1]&15)<<8|t[b+2])-4,G=(t[b+10]&15)<<8|t[b+11];for(b+=12+G;b<S;){var X=(t[b+1]&31)<<8|t[b+2];switch(t[b]){case 15:s.pid=d=X;break;case 27:if(h!==-1)break;n.codecType=it.AVC,n.pid=h=X;break;case 36:if(h!==-1)break;n.codecType=it.HEVC,n.pid=h=X;break;default:Ae.warn("Unsupported stream. type: ".concat(t[b],", pid: ").concat(X))}b+=((t[b+3]&15)<<8|t[b+4])+5}}break;case h:f&&this._videoPesData.length&&this._parseVideoData(),this._videoPesData.push(t.subarray(b,c+188));break;case d:f&&this._audioPesData.length&&this._parseAudioData(),this._audioPesData.push(t.subarray(b,c+188));break;case 17:case 8191:break;default:Ae.warn("Unknown pid: ".concat(y))}}return this._parseVideoData(),this._parseAudioData(),s.formatTimescale=n.formatTimescale=n.timescale=l.timescale=9e4,s.timescale=s.sampleRate||0,{videoTrack:n,audioTrack:s,metadataTrack:l}}},{key:"fix",value:function(t,i,e){return this._fixer.fix(t,i,e),{videoTrack:this.videoTrack,audioTrack:this.audioTrack,metadataTrack:this.metadataTrack}}},{key:"demuxAndFix",value:function(t,i,e,s){return this.demux(t,i,e),this.fix(s,i,e)}},{key:"_parseVideoData",value:function(){if(this._videoPesData.length){var t=r._parsePES(Pe.apply(void 0,Re(this._videoPesData)));if(!t){Ae.warn("Cannot parse video pes",this._videoPesData);return}var i=$e.parseAnnexB(t.data);i?this._createVideoSample(i,t.pts,t.dts):Ae.warn("Cannot parse avc units",t),this._videoPesData=[]}}},{key:"_createVideoSample",value:function(t,i,e){var s=this;if(t.length){var n=this.videoTrack,l=n.codecType===it.HEVC,o=new Dt(i,e);t.forEach(function(u){var h=l?u[0]>>>1&63:u[0]&31;switch(h){case 5:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:if(!l&&h!==5||l&&h===5)break;o.setToKeyframe(),s._gopId++;break;case 6:case 39:case 40:if(!l&&h!==6||l&&h===6)break;s.metadataTrack.seiSamples.push(new Bn($e.parseSEI($e.removeEPB(u),l),i));return;case 32:if(!l)break;if(!n.vps.length){var d=is.parseVPS($e.removeEPB(u),n.hvcC);n.hvcC=n.hvcC||d,n.vps=[u]}break;case 7:case 33:if(!l&&h!==7||l&&h===7)break;if(!n.sps.length){var c=$e.removeEPB(u),f=l?is.parseSPS(c,n.hvcC):jn.parseSPS(c);n.sps=[u],n.hvcC=n.hvcC||f.hvcC,n.codec=f.codec,n.width=f.width,n.height=f.height,n.sarRatio=f.sarRatio,n.fpsNum=f.fpsNum,n.fpsDen=f.fpsDen}break;case 8:case 34:if(!l&&h!==8||l&&h===8)break;n.pps.length||(n.pps=[u]);break;case 9:case 35:break;case 38:if(l){for(var y=!1,g=2;g<u.byteLength;g++)if(u[g]===255){y=!0;break}if(!y)return}break}o.units.push(u)}),o.gopId=this._gopId,this._pushVideoSample(n,o)}}},{key:"_pushVideoSample",value:function(t,i){if(i.units.length)if(i.pts===null||i.pts===void 0){Ae.warn("Video sample no pts",i);var e=t.samples[t.samples.length-1];e?(i.pts=e.pts,i.dts=e.dts):Ae.warn("Drop video sample",i)}else t.samples.push(i)}},{key:"_parseAudioData",value:function(){if(this._audioPesData.length){var t=r._parsePES(Pe.apply(void 0,Re(this._audioPesData)));if(!t){Ae.warn("Cannot parse audio pes",this._audioPesData);return}this._parseAacData(t),this._audioPesData=[]}}},{key:"_parseAacData",value:function(t){var i=this.audioTrack,e=t.pts;if(e==null){if(Ae.warn("AAC pes not pts",i),!i.samples.length||!i.sampleRate)return;e=i.samples[i.samples.length-1].pts+Oe.getFrameDuration(i.sampleRate)}var s=Oe.parseADTS(t.data,e);if(s){var n;i.codec=s.codec,i.channelCount=s.channelCount,i.sampleRate=s.sampleRate,i.objectType=s.objectType,i.sampleRateIndex=s.samplingFrequencyIndex,i.config=s.config,(n=i.samples).push.apply(n,Re(s.frames.map(function(l){return new nt(l.pts,l.data)}))),s.skip&&Ae.warn("Skip aac adts ".concat(s.skip," bits")),s.remaining&&Ae.warn("Remaining aac adts ".concat(s.remaining," bits"))}else Ae.warn("Cannot parse aac adts",t)}}],[{key:"probe",value:function(t){return t.length?t[0]===71&&t[188]===71&&t[376]===71:!1}},{key:"_parsePES",value:function(t){var i=t[8];if(!(i==null||t.length<i+9)){var e=t[0]<<16|t[1]<<8|t[2];if(e===1){var s=(t[4]<<8)+t[5];if(!(s&&s>t.length-6)){var n,l,o=t[7];return o&192&&(n=(t[9]&14)*536870912+(t[10]&255)*4194304+(t[11]&254)*16384+(t[12]&255)*128+(t[13]&254)/2,o&64?(l=(t[14]&14)*536870912+(t[15]&255)*4194304+(t[16]&254)*16384+(t[17]&255)*128+(t[18]&254)/2,n-l>60*9e4&&(n=l)):l=n),{data:t.subarray(9+i),pts:n,dts:l}}}}}}]),r}(),Di=function(){function r(a,t,i){ue(this,r),this.dv=new DataView(a),this.start=this.offset=t||this.dv.byteOffset,this.end=i?this.start+i:this.start+this.dv.byteLength}return he(r,[{key:"buffer",get:function(){return this.dv.buffer}},{key:"unreadLength",get:function(){return Math.max(this.end-this.offset,0)}},{key:"size",get:function(){return this.end-this.start}},{key:"readFloat",value:function(t){var i=0;switch(t){case 4:i=this.dv.getFloat32(this.offset);break;case 8:i=this.dv.getFloat64(this.offset);break;default:throw new Error("read ".concat(t,"-byte float is not supported"))}return this.offset+=t,i}},{key:"back",value:function(t){this.offset-=t}},{key:"skip",value:function(t){this.offset+=t}},{key:"readInt",value:function(t){var i=this.offset;switch(this.offset+=t,t){case 1:return this.dv.getInt8(i);case 2:return this.dv.getInt16(i);case 4:return this.dv.getInt32(i);default:throw new Error("read ".concat(t,"-byte integers is not supported"))}}},{key:"read",value:function(t){var i=this.offset;switch(this.offset+=t,t){case 1:return this.dv.getUint8(i);case 2:return this.dv.getUint16(i);case 3:return(this.dv.getUint16(i)<<8)+this.dv.getUint8(i+2);case 4:return this.dv.getUint32(i);default:return this.back(t-4),this.read(t-4)+this.dv.getUint32(i)*Math.pow(256,t-4)}}},{key:"write",value:function(t,i){var e=this.offset;switch(this.offset+=t,t){case 1:return this.dv.setUint8(e,i);case 2:return this.dv.setUint16(e,i);case 3:return this.dv.setUint8(e,i>>>16),this.dv.setUint16(e+1,65535&i);case 4:return this.dv.setUint32(e,i);default:throw new Error("write ".concat(t,"-byte integers is not supported"))}}},{key:"readToBuffer",value:function(t){var i;return this.offset||t?i=this.dv.buffer.slice(this.offset,t?this.offset+t:this.end):i=this.dv.buffer,this.offset+=i.byteLength,i}},{key:"readToUint8",value:function(t){var i=new Uint8Array(this.dv.buffer,this.offset,t||this.unreadLength);return this.offset+=i.byteLength,i}},{key:"readString",value:function(t){for(var i=0,e="";i<t;i++)e+=String.fromCharCode(this.dv.getUint8(this.offset)),this.offset++;return e}}],[{key:"fromUint8",value:function(t){return new r(t.buffer,t.byteOffset,t.byteLength)}},{key:"concatUint8s",value:function(t){var i=new Uint8Array(t.reduce(function(s,n){return s+n.byteLength},0)),e=0;return t.forEach(function(s){i.set(s,e),e+=s.byteLength}),i}},{key:"concatUint8",value:function(){for(var t=arguments.length,i=new Array(t),e=0;e<t;e++)i[e]=arguments[e];return this.concatUint8s(i)}}]),r}(),Ja=function(){function r(a,t){ue(this,r),this.offset=0,this.val=a,this.size=t}return he(r,[{key:"skip",value:function(t){this.offset+=t}},{key:"read",value:function(t){var i=this.size-this.offset-t;if(i>=0){var e=0,s=0;if(this.offset+=t,this.size>31){for(;s<t;s++)e+=Math.pow(2,s);return this.val/Math.pow(2,i)&e}else{for(;s<t;s++)e+=1<<s;return this.val>>>i&e}}throw new Error("the number of the read operation exceeds the total length limit of bits")}}],[{key:"fromByte",value:function(t,i){return new r(t.read(i),i<<3)}}]),r}(),q=function(){function r(){ue(this,r)}return he(r,null,[{key:"findBox",value:function(t,i){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=[];if(!t)return s;for(var n=0,l="",o=0;t.length>7;){if(n=H(t),l=String.fromCharCode.apply(null,t.subarray(4,8)),o=8,n===1?(n=kt(t,8),o+=8):n||(n=t.length),!i[0]||l===i[0]){var u=t.subarray(0,n);if(i.length<2)s.push({start:e,size:n,headerSize:o,type:l,data:u});else return r.findBox(u.subarray(o),i.slice(1),e+o)}e+=n,t=t.subarray(n)}return s}},{key:"tfhd",value:function(t){return A(t,!0,function(i,e){i.trackId=H(e);var s=4,n=i.flags&255&1,l=i.flags&255&2,o=i.flags&255&8,u=i.flags&255&16,h=i.flags&255&32;n&&(s+=4,i.baseDataOffset=H(e,s),s+=4),l&&(i.sampleDescriptionIndex=H(e,s),s+=4),o&&(i.defaultSampleDuration=H(e,s),s+=4),u&&(i.defaultSampleSize=H(e,s),s+=4),h&&(i.defaultSampleFlags=H(e,s))})}},{key:"sidx",value:function(t){return A(t,!0,function(i,e){var s=0;i.reference_ID=H(e,s),s+=4,i.timescale=H(e,s),s+=4,i.version===0?(i.earliest_presentation_time=H(e,s),s+=4,i.first_offset=H(e,s),s+=4):(i.earliest_presentation_time=kt(e,s),s+=8,i.first_offset=kt(e,s),s+=8),s+=2,i.references=[];var n=de(e,s);s+=2;for(var l=0;l<n;l++){var o={};i.references.push(o);var u=H(e,s);s+=4,o.reference_type=u>>31&1,o.referenced_size=u&2147483647,o.subsegment_duration=H(e,s),s+=4,u=H(e,s),s+=4,o.starts_with_SAP=u>>31&1,o.SAP_type=u>>28&7,o.SAP_delta_time=u&268435455}})}},{key:"moov",value:function(t){return A(t,!1,function(i,e,s){i.mvhd=r.mvhd(r.findBox(e,["mvhd"],s)[0]),i.trak=r.findBox(e,["trak"],s).map(function(n){return r.trak(n)}),i.pssh=r.pssh(r.findBox(e,["pssh"],s)[0])})}},{key:"mvhd",value:function(t){return A(t,!0,function(i,e){var s=0;i.version===1?(i.timescale=H(e,16),i.duration=kt(e,20),s+=28):(i.timescale=H(e,8),i.duration=H(e,12),s+=16),i.nextTrackId=H(e,s+76)})}},{key:"trak",value:function(t){return A(t,!1,function(i,e,s){i.tkhd=r.tkhd(r.findBox(e,["tkhd"],s)[0]),i.mdia=r.mdia(r.findBox(e,["mdia"],s)[0])})}},{key:"tkhd",value:function(t){return A(t,!0,function(i,e){var s=Di.fromUint8(e);i.version===1?(s.read(8),s.read(8),i.trackId=s.read(4),s.read(4),i.duration=s.read(8)):(s.read(4),s.read(4),i.trackId=s.read(4),s.read(4),i.duration=s.read(4)),s.skip(16),i.matrix=[];for(var n=0;n<36;n++)i.matrix.push(s.read(1));s.back(36);for(var l=[],o=0,u;o<3;o++)l.push(_i(s.readInt(2),s.readInt(2))),l.push(_i(s.readInt(2),s.readInt(2))),u=s.readInt(4),l.push(_i(u>>30,u&1073741823));i.rotation=Da(l),i.width=s.read(4),i.height=s.read(4)})}},{key:"mdia",value:function(t){return A(t,!1,function(i,e,s){i.mdhd=r.mdhd(r.findBox(e,["mdhd"],s)[0]),i.hdlr=r.hdlr(r.findBox(e,["hdlr"],s)[0]),i.minf=r.minf(r.findBox(e,["minf"],s)[0])})}},{key:"mdhd",value:function(t){return A(t,!0,function(i,e){var s=0;i.version===1?(i.timescale=H(e,16),i.duration=kt(e,20),s+=28):(i.timescale=H(e,8),i.duration=H(e,12),s+=16);var n=de(e,s);i.language=String.fromCharCode((n>>10&31)+96,(n>>5&31)+96,(n&31)+96)})}},{key:"hdlr",value:function(t){return A(t,!0,function(i,e){i.version===0&&(i.handlerType=String.fromCharCode.apply(null,e.subarray(4,8)))})}},{key:"minf",value:function(t){return A(t,!1,function(i,e,s){i.vmhd=r.vmhd(r.findBox(e,["vmhd"],s)[0]),i.smhd=r.smhd(r.findBox(e,["smhd"],s)[0]),i.stbl=r.stbl(r.findBox(e,["stbl"],s)[0])})}},{key:"vmhd",value:function(t){return A(t,!0,function(i,e){i.graphicsmode=de(e),i.opcolor=[de(e,2),de(e,4),de(e,6)]})}},{key:"smhd",value:function(t){return A(t,!0,function(i,e){i.balance=de(e)})}},{key:"stbl",value:function(t){return A(t,!1,function(i,e,s){var n,l,o;i.stsd=r.stsd(r.findBox(e,["stsd"],s)[0]),i.stts=r.stts(r.findBox(e,["stts"],s)[0]),i.ctts=r.ctts(r.findBox(e,["ctts"],s)[0]),i.stsc=r.stsc(r.findBox(e,["stsc"],s)[0]),i.stsz=r.stsz(r.findBox(e,["stsz"],s)[0]),i.stco=r.stco(r.findBox(e,["stco"],s)[0]),i.stco||(i.co64=r.co64(r.findBox(e,["co64"],s)[0]),i.stco=i.co64);var u=(n=i.stsd.entries[0])===null||n===void 0||(l=n.sinf)===null||l===void 0||(o=l.schi)===null||o===void 0?void 0:o.tenc.default_IV_size;i.stss=r.stss(r.findBox(e,["stss"],s)[0]),i.senc=r.senc(r.findBox(e,["senc"],s)[0],u)})}},{key:"senc",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;return A(t,!0,function(e,s){var n=0,l=H(s,n);n+=4,e.samples=[];for(var o=0;o<l;o++){var u={};u.InitializationVector=[];for(var h=0;h<i;h++)u.InitializationVector[h]=s[n+h];if(n+=i,e.flags&2){u.subsamples=[];var d=de(s,n);n+=2;for(var c=0;c<d;c++){var f={};f.BytesOfClearData=de(s,n),n+=2,f.BytesOfProtectedData=H(s,n),n+=4,u.subsamples.push(f)}}e.samples.push(u)}})}},{key:"pssh",value:function(t){return A(t,!0,function(i,e){for(var s=[],n=[],l=0,o=0;o<16;o++)n.push(Hi(e[l+o]));if(l+=16,i.version>0){var u=H(e,l);l+=4;for(var h=0;h<(""+u).length;h++)for(var d=0;d<16;d++){var c=e[l];l+=1,s.push(Hi(c))}}var f=H(e,l);i.data_size=f,l+=4,i.kid=s,i.system_id=n,i.buffer=e})}},{key:"stsd",value:function(t){return A(t,!0,function(i,e,s){i.entryCount=H(e),i.entries=r.findBox(e.subarray(4),[],s+4).map(function(n){switch(n.type){case"av01":return r.av01(n);case"avc1":case"avc2":case"avc3":case"avc4":return r.avc1(n);case"hvc1":case"hev1":return r.hvc1(n);case"mp4a":return r.mp4a(n);case"alaw":case"ulaw":return r.alaw(n);case"enca":return A(n,!1,function(l,o,u){l.channelCount=de(o,16),l.samplesize=de(o,18),l.sampleRate=H(o,24)/65536,o=o.subarray(28),l.sinf=r.sinf(r.findBox(o,["sinf"],u)[0]),l.esds=r.esds(r.findBox(o,["esds"],u)[0])});case"encv":return A(n,!1,function(l,o,u){l.width=de(o,24),l.height=de(o,26),l.horizresolution=H(o,28),l.vertresolution=H(o,32),o=o.subarray(78),l.sinf=r.sinf(r.findBox(o,["sinf"],u)[0]),l.avcC=r.avcC(r.findBox(o,["avcC"],u)[0]),l.hvcC=r.hvcC(r.findBox(o,["hvcC"],u)[0]),l.pasp=r.pasp(r.findBox(o,["pasp"],u)[0])})}}).filter(Boolean)})}},{key:"tenc",value:function(t){return A(t,!1,function(i,e){var s=6;i.default_IsEncrypted=e[s],s+=1,i.default_IV_size=e[s],s+=1,i.default_KID=[];for(var n=0;n<16;n++)i.default_KID.push(Hi(e[s])),s+=1})}},{key:"schi",value:function(t){return A(t,!1,function(i,e,s){i.tenc=r.tenc(r.findBox(e,["tenc"],s)[0])})}},{key:"sinf",value:function(t){return A(t,!1,function(i,e,s){i.schi=r.schi(r.findBox(e,["schi"],s)[0]),i.frma=r.frma(r.findBox(e,["frma"],s)[0])})}},{key:"frma",value:function(t){return A(t,!1,function(i,e){i.data_format="";for(var s=0;s<4;s++)i.data_format+=String.fromCharCode(e[s])})}},{key:"colr",value:function(t){return A(t,!1,function(i,e){var s=Di.fromUint8(e);i.data=t.data,i.colorType=s.readString(4),i.colorType==="nclx"?(i.colorPrimaries=s.read(2),i.transferCharacteristics=s.read(2),i.matrixCoefficients=s.read(2),i.fullRangeFlag=s.read(1)>>7):(i.colorType==="rICC"||i.colorType==="prof")&&(i.iccProfile=e.readToUint8())})}},{key:"av01",value:function(t){return A(t,!1,function(i,e,s){var n=Pi(i,e),l=e.subarray(n);s+=n,i.av1C=r.av1C(r.findBox(l,["av1C"],s)[0]),i.colr=r.colr(r.findBox(l,["colr"],s)[0])})}},{key:"av1C",value:function(t){return A(t,!1,function(i,e){i.data=t.data;var s=Di.fromUint8(e),n=Ja.fromByte(s,4);i.marker=n.read(1),i.version=n.read(7),i.seqProfile=n.read(3),i.seqLevelIdx0=n.read(5),i.seqTier0=n.read(1),i.highBitdepth=n.read(1),i.twelveBit=n.read(1),i.monochrome=n.read(1),i.chromaSubsamplingX=n.read(1),i.chromaSubsamplingY=n.read(1),i.chromaSamplePosition=n.read(2),i.reserved=n.read(3),i.initialPresentationDelayPresent=n.read(1),i.initialPresentationDelayPresent?i.initialPresentationDelayMinusOne=n.read(4):i.initialPresentationDelayMinusOne=0,i.configOBUs=s.readToUint8();var l;i.seqLevelIdx0===2&&i.highBitdepth===1?l=i.twelveBit===1?"12":"10":i.seqProfile<=2&&(l=i.highBitdepth===1?"10":"08"),i.codec=["av01",i.seqProfile,(i.seqLevelIdx0<10?"0"+i.seqLevelIdx0:i.seqLevelIdx0)+(i.seqTier0?"H":"M"),l].join(".")})}},{key:"avc1",value:function(t){return A(t,!1,function(i,e,s){var n=Pi(i,e),l=e.subarray(n);s+=n,i.avcC=r.avcC(r.findBox(l,["avcC"],s)[0]),i.pasp=r.pasp(r.findBox(l,["pasp"],s)[0])})}},{key:"avcC",value:function(t){return A(t,!1,function(i,e){i.data=t.data,i.configurationVersion=e[0],i.AVCProfileIndication=e[1],i.profileCompatibility=e[2],i.AVCLevelIndication=e[3],i.codec=An([e[1],e[2],e[3]]),i.lengthSizeMinusOne=e[4]&3,i.spsLength=e[5]&31,i.sps=[];for(var s=6,n=0;n<i.spsLength;n++){var l=de(e,s);s+=2,i.sps.push(e.subarray(s,s+l)),s+=l}i.ppsLength=e[s],s+=1,i.pps=[];for(var o=0;o<i.ppsLength;o++){var u=de(e,s);s+=2,i.pps.push(e.subarray(s,s+=u)),s+=u}})}},{key:"hvc1",value:function(t){return A(t,!1,function(i,e,s){var n=Pi(i,e),l=e.subarray(n);s+=n,i.hvcC=r.hvcC(r.findBox(l,["hvcC"],s)[0]),i.pasp=r.pasp(r.findBox(l,["pasp"],s)[0])})}},{key:"hvcC",value:function(t){return A(t,!1,function(i,e){i.data=t.data,i.codec="hev1.1.6.L93.B0",i.configurationVersion=e[0];var s=e[1];i.generalProfileSpace=s>>6,i.generalTierFlag=(s&32)>>5,i.generalProfileIdc=s&31,i.generalProfileCompatibility=H(e,2),i.generalConstraintIndicatorFlags=e.subarray(6,12),i.generalLevelIdc=e[12],i.avgFrameRate=de(e,19),i.numOfArrays=e[22],i.vps=[],i.sps=[],i.pps=[];for(var n=23,l=0,o=0,u=0,h=0;h<i.numOfArrays;h++){l=e[n]&63,o=de(e,n+1),n+=3;for(var d=[],c=0;c<o;c++)u=de(e,n),n+=2,d.push(e.subarray(n,n+u)),n+=u;if(l===32){var f;(f=i.vps).push.apply(f,d)}else if(l===33){var y;(y=i.sps).push.apply(y,d)}else if(l===34){var g;(g=i.pps).push.apply(g,d)}}})}},{key:"pasp",value:function(t){return A(t,!1,function(i,e){i.hSpacing=H(e),i.vSpacing=H(e,4)})}},{key:"mp4a",value:function(t){return A(t,!1,function(i,e,s){var n=Qs(i,e);i.esds=r.esds(r.findBox(e.subarray(n),["esds"],s+n)[0])})}},{key:"esds",value:function(t){return A(t,!0,function(i,e){i.codec="mp4a.";for(var s=0,n=0,l=0,o=0;e.length;){for(s=0,o=e[s],n=e[s+1],s+=2;n&128;)l=(n&127)<<7,n=e[s],s+=1;if(l+=n&127,o===3)e=e.subarray(s+3);else if(o===4)i.codec+=(e[s].toString(16)+".").padStart(3,"0"),e=e.subarray(s+13);else if(o===5){var u=i.config=e.subarray(s,s+l),h=(u[0]&248)>>3;h===31&&u.length>=2&&(h=32+((u[0]&7)<<3)+((u[1]&224)>>5)),i.objectType=h,i.codec+=h.toString(16),i.codec[i.codec.length-1]==="."&&(i.codec=i.codec.substring(0,i.codec.length-1));return}else{i.codec[i.codec.length-1]==="."&&(i.codec=i.codec.substring(0,i.codec.length-1));return}}})}},{key:"alaw",value:function(t){return A(t,!1,function(i,e){Qs(i,e)})}},{key:"stts",value:function(t){return A(t,!0,function(i,e){for(var s=H(e),n=[],l=4,o=0;o<s;o++)n.push({count:H(e,l),delta:H(e,l+4)}),l+=8;i.entryCount=s,i.entries=n})}},{key:"ctts",value:function(t){return A(t,!0,function(i,e){var s=H(e),n=[],l=4;if(i.version===1)for(var o=0;o<s;o++)n.push({count:H(e,l),offset:H(e,l+4)}),l+=8;else for(var u=0;u<s;u++)n.push({count:H(e,l),offset:-(~H(e,l+4)+1)}),l+=8;i.entryCount=s,i.entries=n})}},{key:"stsc",value:function(t){return A(t,!0,function(i,e){for(var s=H(e),n=[],l=4,o=0;o<s;o++)n.push({firstChunk:H(e,l),samplesPerChunk:H(e,l+4),sampleDescriptionIndex:H(e,l+8)}),l+=12;i.entryCount=s,i.entries=n})}},{key:"stsz",value:function(t){return A(t,!0,function(i,e){var s=H(e),n=H(e,4),l=[];if(!s)for(var o=8,u=0;u<n;u++)l.push(H(e,o)),o+=4;i.sampleSize=s,i.sampleCount=n,i.entrySizes=l})}},{key:"stco",value:function(t){return A(t,!0,function(i,e){for(var s=H(e),n=[],l=4,o=0;o<s;o++)n.push(H(e,l)),l+=4;i.entryCount=s,i.entries=n})}},{key:"co64",value:function(t){return A(t,!0,function(i,e){for(var s=H(e),n=[],l=4,o=0;o<s;o++)n.push(kt(e,l)),l+=8;i.entryCount=s,i.entries=n})}},{key:"stss",value:function(t){return A(t,!0,function(i,e){for(var s=H(e),n=[],l=4,o=0;o<s;o++)n.push(H(e,l)),l+=4;i.entryCount=s,i.entries=n})}},{key:"moof",value:function(t){return A(t,!1,function(i,e,s){i.mfhd=r.mfhd(r.findBox(e,["mfhd"],s)[0]),i.traf=r.findBox(e,["traf"],s).map(function(n){return r.traf(n)})})}},{key:"mfhd",value:function(t){return A(t,!0,function(i,e){i.sequenceNumber=H(e)})}},{key:"traf",value:function(t){return A(t,!1,function(i,e,s){i.tfhd=r.tfhd(r.findBox(e,["tfhd"],s)[0]),i.tfdt=r.tfdt(r.findBox(e,["tfdt"],s)[0]),i.trun=r.trun(r.findBox(e,["trun"],s)[0])})}},{key:"trun",value:function(t){return A(t,!0,function(i,e){var s=i.version,n=i.flags,l=e.length,o=i.sampleCount=H(e),u=4;if(l>u&&n&1&&(i.dataOffset=-(~H(e,u)+1),u+=4),l>u&&n&4&&(i.firstSampleFlags=H(e,u),u+=4),i.samples=[],l>u)for(var h,d=0;d<o;d++)h={},n&256&&(h.duration=H(e,u),u+=4),n&512&&(h.size=H(e,u),u+=4),n&1024&&(h.flags=H(e,u),u+=4),n&2048&&(s?h.cts=-(~H(e,u+4)+1):h.cts=H(e,u),u+=4),i.samples.push(h)})}},{key:"tfdt",value:function(t){return A(t,!0,function(i,e){i.version===1?i.baseMediaDecodeTime=kt(e):i.baseMediaDecodeTime=H(e)})}},{key:"probe",value:function(t){return!!r.findBox(t,["ftyp"])}},{key:"parseSampleFlags",value:function(t){return{isLeading:(t[0]&12)>>>2,dependsOn:t[0]&3,isDependedOn:(t[1]&192)>>>6,hasRedundancy:(t[1]&48)>>>4,paddingValue:(t[1]&14)>>>1,isNonSyncSample:t[1]&1,degradationPriority:t[2]<<8|t[3]}}},{key:"moovToTrack",value:function(t,i,e){var s,n,l=t.trak;if(!(!l||!l.length)){var o=l.find(function(Ti){var bt,gt;return((bt=Ti.mdia)===null||bt===void 0||(gt=bt.hdlr)===null||gt===void 0?void 0:gt.handlerType)==="vide"}),u=l.find(function(Ti){var bt,gt;return((bt=Ti.mdia)===null||bt===void 0||(gt=bt.hdlr)===null||gt===void 0?void 0:gt.handlerType)==="soun"});if(o&&i){var h,d,c,f,y,g,b,S=i,G=(h=o.tkhd)===null||h===void 0?void 0:h.trackId;G!=null&&(S.id=o.tkhd.trackId),S.tkhdDuration=o.tkhd.duration,S.mvhdDurtion=t.mvhd.duration,S.mvhdTimecale=t.mvhd.timescale,S.timescale=S.formatTimescale=o.mdia.mdhd.timescale,S.duration=o.mdia.mdhd.duration||S.mvhdDurtion/S.mvhdTimecale*S.timescale,S.rotation=o.tkhd.rotation,S.matrix=o.tkhd.matrix;var X=o.mdia.minf.stbl.stsd.entries[0];if(S.width=X.width,S.height=X.height,X.pasp&&(S.sarRatio=[X.pasp.hSpacing,X.pasp.vSpacing]),X.av1C)S.codecType=it.AV1,S.codec=X.av1C.codec,S.av1C=X.av1C.data,S.colr=X.colr.data;else if(X.hvcC)S.codecType=it.HEVC,S.codec=X.hvcC.codec,S.vps=X.hvcC.vps,S.sps=X.hvcC.sps,S.pps=X.hvcC.pps,S.hvcC=X.hvcC.data;else if(X.avcC)S.codec=X.avcC.codec,S.sps=X.avcC.sps,S.pps=X.avcC.pps;else throw new Error("unknown video stsd entry");if(S.present=!0,S.ext={},S.ext.stss=(d=o.mdia)===null||d===void 0||(c=d.minf)===null||c===void 0||(f=c.stbl)===null||f===void 0?void 0:f.stss,S.ext.ctts=(y=o.mdia)===null||y===void 0||(g=y.minf)===null||g===void 0||(b=g.stbl)===null||b===void 0?void 0:b.ctts,X&&X.type==="encv"){var L,k,W,V,w,M,C,U;S.isVideoEncryption=!0,X.default_KID=(L=X.sinf)===null||L===void 0||(k=L.schi)===null||k===void 0?void 0:k.tenc.default_KID,X.default_IsEncrypted=(W=X.sinf)===null||W===void 0||(V=W.schi)===null||V===void 0?void 0:V.tenc.default_IsEncrypted,X.default_IV_size=(w=X.sinf)===null||w===void 0||(M=w.schi)===null||M===void 0?void 0:M.tenc.default_IV_size,S.videoSenc=o.mdia.minf.stbl.senc&&o.mdia.minf.stbl.senc.samples,X.data_format=(C=X.sinf)===null||C===void 0||(U=C.frma)===null||U===void 0?void 0:U.data_format,S.useEME=t.useEME,S.kidValue=t.kidValue,S.pssh=t.pssh,S.encv=X}}if(u&&e){var m,p,v,E,Z,R,x,D,_,K=e,j=(m=u.tkhd)===null||m===void 0?void 0:m.trackId;j!=null&&(K.id=u.tkhd.trackId),K.tkhdDuration=u.tkhd.duration,K.mvhdDurtion=t.mvhd.duration,K.mvhdTimecale=t.mvhd.timescale,K.timescale=K.formatTimescale=u.mdia.mdhd.timescale,K.duration=u.mdia.mdhd.duration||K.mvhdDurtion/K.mvhdTimecale*K.timescale;var P=u.mdia.minf.stbl.stsd.entries[0];switch(K.sampleSize=P.sampleSize,K.sampleRate=P.sampleRate,K.channelCount=P.channelCount,K.present=!0,P.type){case"alaw":K.codecType=K.codec=st.G711PCMA,K.sampleRate=8e3;break;case"ulaw":K.codecType=K.codec=st.G711PCMU,K.sampleRate=8e3;break;default:K.sampleDuration=Oe.getFrameDuration(K.sampleRate,K.timescale),K.sampleRateIndex=Oe.getRateIndexByRate(K.sampleRate),K.objectType=((s=P.esds)===null||s===void 0?void 0:s.objectType)||2,P.esds&&(K.config=Array.from(P.esds.config)),K.codec=((n=P.esds)===null||n===void 0?void 0:n.codec)||"mp4a.40.2";break}if(K.sampleDuration=Oe.getFrameDuration(K.sampleRate,K.timescale),K.objectType=((p=P.esds)===null||p===void 0?void 0:p.objectType)||2,P.esds&&(P.esds.config?K.config=Array.from(P.esds.config):console.warn("esds config is null")),K.codec=((v=P.esds)===null||v===void 0?void 0:v.codec)||"mp4a.40.2",K.sampleRateIndex=Oe.getRateIndexByRate(K.sampleRate),K.ext={},K.ext.stss=(E=u.mdia)===null||E===void 0||(Z=E.minf)===null||Z===void 0||(R=Z.stbl)===null||R===void 0?void 0:R.stss,K.ext.ctts=(x=u.mdia)===null||x===void 0||(D=x.minf)===null||D===void 0||(_=D.stbl)===null||_===void 0?void 0:_.ctts,K.present=!0,P&&P.type==="enca"){var ve,be,Je,pe,pt,ae,rt,Be;K.isAudioEncryption=!0,P.data_format=(ve=P.sinf)===null||ve===void 0||(be=ve.frma)===null||be===void 0?void 0:be.data_format,P.default_KID=(Je=P.sinf)===null||Je===void 0||(pe=Je.schi)===null||pe===void 0?void 0:pe.tenc.default_KID,P.default_IsEncrypted=(pt=P.sinf)===null||pt===void 0||(ae=pt.schi)===null||ae===void 0?void 0:ae.tenc.default_IsEncrypted,P.default_IV_size=(rt=P.sinf)===null||rt===void 0||(Be=rt.schi)===null||Be===void 0?void 0:Be.tenc.default_IV_size,K.audioSenc=u.mdia.minf.stbl.senc&&u.mdia.minf.stbl.senc.samples,K.useEME=t.useEME,K.kidValue=t.kidValue,K.enca=P}}if(e&&(e.isVideoEncryption=i?i.isVideoEncryption:!1),i&&(i.isAudioEncryption=e?e.isAudioEncryption:!1),i!=null&&i.encv||e!=null&&e.enca){var at,Ri,Es=i==null||(at=i.encv)===null||at===void 0?void 0:at.default_KID,Xs=e==null||(Ri=e.enca)===null||Ri===void 0?void 0:Ri.default_KID,Gs=Es||Xs?(Es||Xs).join(""):null;i&&(i.kid=Gs),e&&(e.kid=Gs)}return i&&(i.flags=3841),e&&(e.flags=1793),{videoTrack:i,audioTrack:e}}}},{key:"evaluateDefaultDuration",value:function(t,i,e){var s,n=i==null||(s=i.samples)===null||s===void 0?void 0:s.length;if(!n)return 1024;var l=1024*n/i.timescale;return l*t.timescale/e}},{key:"moofToSamples",value:function(t,i,e){var s={};return t.mfhd&&(i&&(i.sequenceNumber=t.mfhd.sequenceNumber),e&&(e.sequenceNumber=t.mfhd.sequenceNumber)),t.traf.forEach(function(n){var l=n.tfhd,o=n.tfdt,u=n.trun;if(!(!l||!u)){o&&(i&&i.id===l.trackId&&(i.baseMediaDecodeTime=o.baseMediaDecodeTime),e&&e.id===l.trackId&&(e.baseMediaDecodeTime=o.baseMediaDecodeTime));var h=l.defaultSampleSize||0,d=l.defaultSampleDuration||r.evaluateDefaultDuration(i,e,u.samples.length||u.sampleCount),c=u.dataOffset||0,f=0,y=-1;if(!u.samples.length&&u.sampleCount){s[l.trackId]=[];for(var g=0;g<u.sampleCount;g++)s[l.trackId].push({offset:c,dts:f,duration:d,size:h}),f+=d,c+=h}else s[l.trackId]=u.samples.map(function(b,S){return b={offset:c,dts:f,pts:f+(b.cts||0),duration:b.duration||d,size:b.size||h,gopId:y,keyframe:S===0||b.flags!==null&&b.flags!==void 0&&(b.flags&65536)>>>0!==65536},b.keyframe&&(y++,b.gopId=y),f+=b.duration,c+=b.size,b})}}),s}},{key:"moovToSamples",value:function(t){var i=t.trak;if(!(!i||!i.length)){var e=i.find(function(C){var U,m;return((U=C.mdia)===null||U===void 0||(m=U.hdlr)===null||m===void 0?void 0:m.handlerType)==="vide"}),s=i.find(function(C){var U,m;return((U=C.mdia)===null||U===void 0||(m=U.hdlr)===null||m===void 0?void 0:m.handlerType)==="soun"});if(!(!e&&!s)){var n,l;if(e){var o,u,h=(o=e.mdia)===null||o===void 0||(u=o.minf)===null||u===void 0?void 0:u.stbl;if(!h)return;var d=h.stts,c=h.stsc,f=h.stsz,y=h.stco,g=h.stss,b=h.ctts;if(!d||!c||!f||!y||!g)return;n=js(d,c,f,y,b,g)}if(s){var S,G,X,L=(S=s.mdia)===null||S===void 0||(G=S.minf)===null||G===void 0?void 0:G.stbl;if(!L)return;var k=(X=s.mdia.mdhd)===null||X===void 0?void 0:X.timescale,W=L.stts,V=L.stsc,w=L.stsz,M=L.stco;if(!k||!W||!V||!w||!M)return;l=js(W,V,w,M)}return{videoSamples:n,audioSamples:l}}}}}]),r}();function js(r,a,t,i,e,s){var n=[],l=e==null?void 0:e.entries,o=a.entries,u=i.entries,h=t.entrySizes,d=s==null?void 0:s.entries,c;d&&(c={},d.forEach(function(V){c[V-1]=!0}));var f;l&&(f=[],l.forEach(function(V){for(var w=V.count,M=V.offset,C=0;C<w;C++)f.push(M)}));var y,g=-1,b=0,S=0,G=0,X=0,L=0,k=o[0].samplesPerChunk,W=o[1]?o[1].firstChunk-1:1/0;return r.entries.forEach(function(V){for(var w=V.count,M=V.delta,C=0;C<w;C++)y={dts:b,duration:M,size:h[S]||t.sampleSize,offset:u[G]+L,index:S},d&&(y.keyframe=c[S],y.keyframe&&g++,y.gopId=g),f&&S<f.length&&(y.pts=y.dts+f[S]),n.push(y),b+=M,S++,S<k?L+=y.size:(G++,L=0,G>=W&&(X++,W=o[X+1]?o[X+1].firstChunk-1:1/0),k+=o[X].samplesPerChunk)}),n}function Pi(r,a){return r.dataReferenceIndex=de(a,6),r.width=de(a,24),r.height=de(a,26),r.horizresolution=H(a,28),r.vertresolution=H(a,32),r.frameCount=de(a,40),r.depth=de(a,74),78}function Qs(r,a){return r.dataReferenceIndex=de(a,6),r.channelCount=de(a,16),r.sampleSize=de(a,18),r.sampleRate=H(a,24)/65536,28}function A(r,a,t){if(r){if(r.size!==r.data.length)throw new Error("box ".concat(r.type," size !== data.length"));var i={start:r.start,size:r.size,headerSize:r.headerSize,type:r.type};return a&&(i.version=r.data[r.headerSize],i.flags=_a(r.data,r.headerSize+1),i.headerSize+=4),t(i,r.data.subarray(i.headerSize),i.start+i.headerSize),i}}var Ba=function(a,t,i){for(var e=String(i),s=t>>0,n=Math.ceil(s/e.length),l=[],o=String(a);n--;)l.push(e);return l.join("").substring(0,s-o.length)+o},Hi=function(){for(var a=[],t=arguments.length,i=new Array(t),e=0;e<t;e++)i[e]=arguments[e];return i.forEach(function(s){a.push(Ba(Number(s).toString(16),2,0))}),a[0]},$n=function(){function r(a,t,i){ue(this,r),Y(this,"__loadedMoofWraps",[]),Y(this,"__lastRemainData",null),Y(this,"__lastRemainDataStart",0),Y(this,"__nextMoofStart",-1),this.videoTrack=a||new Li,this.audioTrack=t||new Ei,this.metadataTrack=i||new Xi}return he(r,[{key:"demuxPart",value:function(t,i,e){var s=this,n=this.videoTrack,l=this.audioTrack,o=n.exist(),u=l.exist(),h=/av01/.test(n.codec);n.samples=[],l.samples=[];var d=t,c=i;if(this.__lastRemainData){var f=this.__lastRemainDataStart+this.__lastRemainData.byteLength,y=i<=f&&i>this.__lastRemainDataStart&&i+t.byteLength>f;if(y){var g=t.subarray(this.__lastRemainData.byteLength+this.__lastRemainDataStart-i);d=Pe(this.__lastRemainData,g),c=this.__lastRemainDataStart,this.__lastRemainData=null}else this.__lastRemainData=null,this.__lastRemainDataStart=0,this.__nextMoofStart=-1}if(!e){var b=q.findBox(d,["moov"])[0];if(!b)throw new Error("cannot found moov box");e=q.moov(b)}if(d){var S=c+d.byteLength;!o&&!u&&q.moovToTrack(e,n,l);var G=[];this.__nextMoofStart<0?q.findBox(d,["moof"],c).forEach(function(V){return G.push(V)}):this.__nextMoofStart>=c&&this.__nextMoofStart<=S-8&&q.findBox(d.subarray(this.__nextMoofStart-c),["moof"],this.__nextMoofStart).forEach(function(V){return G.push(V)}),G.filter(function(V){return V.size<=V.data.length}).forEach(function(V){var w=q.moof(V);s.__nextMoofStart=w.start+Math.max.apply(Math,Re(w.traf.map(function(M){return M.trun.samples.reduce(function(C,U){return C+U.size},M.trun.dataOffset||0)}))),s.__loadedMoofWraps.push({start:w.start,nextMoofStart:s.__nextMoofStart,moof:w}),s.__loadedMoofWraps.sort(function(M,C){return M.start-C.start})});var X=Wa(this.__loadedMoofWraps),L;try{var k=function(){var w=L.value;if(w.start>S||w.nextMoofStart<c)return"continue";var M=w.start,C=q.moofToSamples(w.moof,n,l),U=n.baseMediaDecodeTime,m=l.baseMediaDecodeTime,p;Object.keys(C).forEach(function(v){n.id==v?C[v].some(function(E){var Z=E.offset+=M;if(!(Z<c)){if(Z+E.size>S)return!0;var R=new Dt((E.pts||E.dts)+U,E.dts+U);R.duration=E.duration,R.gopId=E.gopId,E.keyframe&&R.setToKeyframe();var x=d.subarray(Z-c,Z-c+E.size);if(R.data=x,!h)for(var D=0,_=x.length-1;D<_;)p=H(x,D),D+=4,R.units.push(x.subarray(D,D+p)),D+=p;s.__lastRemainDataStart=Z+E.size,n.samples.push(R)}}):l.id==v&&C[v].some(function(E){var Z=E.offset+M;if(!(Z<c)){if(Z+E.size>S)return!0;var R=d.subarray(Z-c,Z-c+E.size);l.samples.push(new nt(E.dts+m,R,E.duration)),s.__lastRemainDataStart=Z+E.size}})})};for(X.s();!(L=X.n()).done;)var W=k()}catch(V){X.e(V)}finally{X.f()}}return this.__lastRemainDataStart>c&&this.__lastRemainDataStart<d.byteLength+c?this.__lastRemainData=d.subarray(this.__lastRemainDataStart-c):(this.__lastRemainData=d,this.__lastRemainDataStart=c),n.samples.length&&(n.baseMediaDecodeTime=n.samples[0].pts),l.samples.length&&(l.baseMediaDecodeTime=l.samples[0].pts),{videoTrack:n,audioTrack:l,metadataTrack:this.metadataTrack}}},{key:"demux",value:function(t,i){var e=this.videoTrack,s=this.audioTrack,n=e.exist(),l=s.exist();if(e.samples=[],s.samples=[],i){if(!l){var o=q.findBox(i,["moov"])[0];if(!o)throw new Error("cannot found moov box");q.moovToTrack(q.moov(o),null,s)}var u=q.findBox(i,["moof"])[0];if(u){var h=q.moofToSamples(q.moof(u),null,s)[s.id],d=s.baseMediaDecodeTime;if(h){var c=u.start;h.map(function(L){L.offset+=c;var k=i.subarray(L.offset,L.offset+L.size);s.samples.push(new nt(L.dts+d,k,L.duration))})}}}if(t){if(!n&&!l){var f=q.findBox(t,["moov"])[0];if(!f)throw new Error("cannot found moov box");q.moovToTrack(q.moov(f),e,s)}var y=q.findBox(t,["moof"])[0];if(y){var g=q.moofToSamples(q.moof(y),e,s),b=e.baseMediaDecodeTime,S=s.baseMediaDecodeTime,G=y.start,X;Object.keys(g).forEach(function(L){e.id==L?g[L].map(function(k){k.offset+=G;var W=new Dt((k.pts||k.dts)+b,k.dts+b);W.duration=k.duration,W.gopId=k.gopId,k.keyframe&&W.setToKeyframe();var V=t.subarray(k.offset,k.offset+k.size);W.data=V;for(var w=0,M=V.length-1;w<M;)X=H(V,w),w+=4,W.units.push(V.subarray(w,w+X)),w+=X;e.samples.push(W)}):s.id==L&&g[L].map(function(k){k.offset+=G;var W=t.subarray(k.offset,k.offset+k.size);s.samples.push(new nt(k.dts+S,W,k.duration))})})}}return{videoTrack:e,audioTrack:s,metadataTrack:this.metadataTrack}}},{key:"reset",value:function(){this.videoTrack.reset(),this.audioTrack.reset(),this.metadataTrack.reset()}}],[{key:"probe",value:function(t){return q.probe(t)}}]),r}();function Oa(r){for(var a=0,t=arguments.length,i=new Array(t>1?t-1:0),e=1;e<t;e++)i[e-1]=arguments[e];i.forEach(function(l){a+=l.length});var s=new r(a),n=0;return i.forEach(function(l){s.set(l,n),n+=l.length}),s}var Se=function(){function r(){ue(this,r),this.buffer=new Uint8Array(0)}return he(r,[{key:"write",value:function(){for(var t=this,i=arguments.length,e=new Array(i),s=0;s<i;s++)e[s]=arguments[s];e.forEach(function(n){n?t.buffer=Oa(Uint8Array,t.buffer,n):window.console.warn(n)})}}],[{key:"writeUint16",value:function(t){return new Uint8Array([t>>8&255,t&255])}},{key:"writeUint32",value:function(t){return new Uint8Array([t>>24,t>>16&255,t>>8&255,t&255])}}]),r}(),qs=Math.pow(2,32)-1,$=function(){function r(){ue(this,r)}return he(r,null,[{key:"box",value:function(t){for(var i=arguments.length,e=new Array(i>1?i-1:0),s=1;s<i;s++)e[s-1]=arguments[s];e=e.filter(Boolean);var n=8+e.reduce(function(u,h){return u+h.byteLength},0),l=new Uint8Array(n);l[0]=n>>24&255,l[1]=n>>16&255,l[2]=n>>8&255,l[3]=n&255,l.set(t,4);var o=8;return e.forEach(function(u){l.set(u,o),o+=u.byteLength}),l}},{key:"ftyp",value:function(t){var i=t.find(function(e){return e.type===yt.VIDEO&&e.codecType===it.HEVC});return i?r.FTYPHEV1:r.FTYPAVC1}},{key:"initSegment",value:function(t){var i=r.ftyp(t),e=Pe(i,r.moov(t));return e}},{key:"pssh",value:function(t){var i=new Uint8Array([1,0,0,0].concat([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75],[0,0,0,1],Bs(t.kid),[0,0,0,0]));return r.box(r.types.pssh,i)}},{key:"moov",value:function(t){if(t[0].useEME&&(t[0].encv||t[0].enca)){t[0].pssh||(t[0].pssh={kid:t[0].kid});var i=this.pssh(t[0].pssh);return r.box.apply(r,[r.types.moov,r.mvhd(t[0].mvhdDurtion||t[0].duration,t[0].mvhdTimecale||t[0].timescale),r.mvex(t)].concat(Re(t.map(function(e){return r.trak(e)})),[i]))}else return r.box.apply(r,[r.types.moov,r.mvhd(t[0].mvhdDurtion||t[0].duration,t[0].mvhdTimecale||t[0].timescale)].concat(Re(t.map(function(e){return r.trak(e)})),[r.mvex(t)]))}},{key:"mvhd",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:9e4,e=r.box(r.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,i>>24&255,i>>16&255,i>>8&255,i&255,t>>24&255,t>>16&255,t>>8&255,t&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]));return e}},{key:"trak",value:function(t){var i=r.box(r.types.trak,r.tkhd(t.id,t.tkhdDuration||0,t.width,t.height),r.mdia(t));return i}},{key:"tkhd",value:function(t,i){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,n=r.box(r.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,i>>24&255,i>>16&255,i>>8&255,i&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,e>>8&255,e&255,0,0,s>>8&255,s&255,0,0]));return n}},{key:"mdia",value:function(t){var i=r.box(r.types.mdia,r.mdhd(t.duration,t.timescale),r.hdlr(t.type),r.minf(t));return i}},{key:"mdhd",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:9e4,e=r.box(r.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,i>>24&255,i>>16&255,i>>8&255,i&255,t>>24&255,t>>16&255,t>>8&255,t&255,85,196,0,0]));return e}},{key:"hdlr",value:function(t){var i=r.box(r.types.hdlr,r.HDLR_TYPES[t]);return i}},{key:"minf",value:function(t){var i=r.box(r.types.minf,t.type===yt.VIDEO?r.VMHD:r.SMHD,r.DINF,r.stbl(t));return i}},{key:"stbl",value:function(t){var i=[];t&&t.ext&&t.ext.stss&&i.push(r.stss(t.ext.stss.entries));var e=r.box(r.types.stbl,r.stsd(t),r.STTS,i[0],r.STSC,r.STSZ,r.STCO);return e}},{key:"stsd",value:function(t){var i;t.type==="audio"?t.useEME&&t.enca?i=r.enca(t):i=r.mp4a(t):t.useEME&&t.encv?i=r.encv(t):t.av1C?i=r.av01(t):i=r.avc1hev1(t);var e=r.box(r.types.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),i);return e}},{key:"enca",value:function(t){var i=t.enca.channelCount,e=t.enca.sampleRate,s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,e>>8&255,e&255,0,0]),n=r.esds(t.config),l=r.sinf(t.enca);return r.box(r.types.enca,s,n,l)}},{key:"encv",value:function(t){var i,e,s=t.sps.length>0?t.sps[0]:[],n=t.pps.length>0?t.pps[0]:[],l=t.width,o=t.height,u=t.sarRatio[0],h=t.sarRatio[1],d=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,o>>8&255,o&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),c=new Uint8Array((i=(e=[1,s[1],s[2],s[3],255,225,s.length>>>8&255,s.length&255]).concat.apply(e,Re(s)).concat([1,n.length>>>8&255,n.length&255])).concat.apply(i,Re(n))),f=new Uint8Array([0,0,88,57,0,15,200,192,0,4,86,72]),y=r.sinf(t.encv),g=new Uint8Array([u>>24,u>>16&255,u>>8&255,u&255,h>>24,h>>16&255,h>>8&255,h&255]);return r.box(r.types.encv,d,r.box(r.types.avcC,c),r.box(r.types.btrt,f),y,r.box(r.types.pasp,g))}},{key:"schi",value:function(t){var i=new Uint8Array([]),e=r.tenc(t);return r.box(r.types.schi,i,e)}},{key:"tenc",value:function(t){var i=new Uint8Array([0,0,0,0,0,0,t.default_IsEncrypted&255,t.default_IV_size&255].concat(Bs(t.default_KID)));return r.box(r.types.tenc,i)}},{key:"sinf",value:function(t){var i=new Uint8Array([]),e=new Uint8Array([t.data_format.charCodeAt(0),t.data_format.charCodeAt(1),t.data_format.charCodeAt(2),t.data_format.charCodeAt(3)]),s=new Uint8Array([0,0,0,0,99,101,110,99,0,1,0,0]),n=r.schi(t);return r.box(r.types.sinf,i,r.box(r.types.frma,e),r.box(r.types.schm,s),n)}},{key:"av01",value:function(t){return r.box(r.types.av01,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,t.width>>8&255,t.width&255,t.height>>8&255,t.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),t.av1C,t.colr)}},{key:"avc1hev1",value:function(t){var i=t.codecType===it.HEVC,e=i?r.types.hvc1:r.types.avc1,s=i?r.hvcC(t):r.avcC(t),n=[new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,t.width>>8&255,t.width&255,t.height>>8&255,t.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s];return i?n.push(r.box(r.types.fiel,new Uint8Array([1,0]))):t.sarRatio&&t.sarRatio.length>1&&n.push(r.pasp(t.sarRatio)),r.box.apply(r,[e].concat(n))}},{key:"avcC",value:function(t){var i,e,s=[],n=[],l;return t.sps.forEach(function(o){l=o.byteLength,s.push(l>>>8&255),s.push(l&255),s.push.apply(s,Re(o))}),t.pps.forEach(function(o){l=o.byteLength,n.push(l>>>8&255),n.push(l&255),n.push.apply(n,Re(o))}),r.box(r.types.avcC,new Uint8Array((i=(e=[1,s[3],s[4],s[5],255,224|t.sps.length]).concat.apply(e,s).concat([t.pps.length])).concat.apply(i,n)))}},{key:"hvcC",value:function(t){var i=t.hvcC;if(i instanceof ArrayBuffer||i instanceof Uint8Array)return i;var e=t.vps,s=t.sps,n=t.pps,l;if(i){var o=i.generalProfileCompatibilityFlags,u=i.generalConstraintIndicatorFlags,h=(e.length&&1)+(s.length&&1)+(n.length&&1);l=[1,i.generalProfileSpace<<6|i.generalTierFlag<<5|i.generalProfileIdc,o>>>24,o>>>16,o>>>8,o,u[0],u[1],u[2],u[3],u[4],u[5],i.generalLevelIdc,240,0,252,i.chromaFormatIdc|252,i.bitDepthLumaMinus8|248,i.bitDepthChromaMinus8|248,0,0,i.numTemporalLayers<<3|i.temporalIdNested<<2|3,h];var d=function(f){var y;l.push(f.length>>8,f.length),(y=l).push.apply(y,Re(f))};e.length&&(l.push(160,0,e.length),e.forEach(d)),s.length&&(l.push(161,0,s.length),s.forEach(d)),n.length&&(l.push(162,0,n.length),n.forEach(d))}else l=[1,1,96,0,0,0,144,0,0,0,0,0,93,240,0,252,253,248,248,0,0,15,3,160,0,1,0,24,64,1,12,1,255,255,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,153,152,9,161,0,1,0,45,66,1,1,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,160,2,128,128,45,22,89,153,164,147,43,154,128,128,128,130,0,0,3,0,2,0,0,3,0,50,16,162,0,1,0,7,68,1,193,114,180,98,64];return r.box(r.types.hvcC,new Uint8Array(l))}},{key:"pasp",value:function(t){var i=ka(t,2),e=i[0],s=i[1];return r.box(r.types.pasp,new Uint8Array([e>>24,e>>16&255,e>>8&255,e&255,s>>24,s>>16&255,s>>8&255,s&255]))}},{key:"mp4a",value:function(t){return r.box(r.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,t.sampleRate>>8&255,t.sampleRate&255,0,0]),t.config.length?r.esds(t.config):void 0)}},{key:"esds",value:function(t){var i=t.length,e=r.box(r.types.esds,new Uint8Array([0,0,0,0,3,23+i,0,0,0,4,15+i,64,21,0,6,0,0,0,218,192,0,0,218,192,5].concat([i]).concat(t).concat([6,1,2])));return e}},{key:"mvex",value:function(t){var i=r.box.apply(r,[r.types.mvex].concat(Re(t.map(function(e){return r.trex(e.id)}))));return i}},{key:"trex",value:function(t){var i=r.box(r.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]));return i}},{key:"trex1",value:function(t){var i=r.box(r.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,2,0,0,0,0,0,0,1,0,0]));return i}},{key:"trex2",value:function(t){var i=r.box(r.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,4,0,0,0,0,0,2,0,0,0]));return i}},{key:"moof",value:function(t){var i=r.box.apply(r,[r.types.moof,r.mfhd(t[0].samples?t[0].samples[0].gopId:0)].concat(Re(t.map(function(e){return r.traf(e)}))));return i}},{key:"mfhd",value:function(t){var i=r.box(r.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]));return i}},{key:"traf",value:function(t){var i=r.tfhd(t.id),e=r.tfdt(t,t.baseMediaDecodeTime),s=0,n;if(t.isVideo&&t.videoSenc&&(n=t.videoSenc,n.forEach(function(p){s=s+8,p.subsamples&&p.subsamples.length&&(s=s+2,s=s+p.subsamples.length*6)})),t.videoSencLength=s,!t.useEME||!t.isVideoEncryption&&!t.isAudioEncryption){var l=r.sdtp(t),o=76;return r.box(r.types.traf,i,e,l,r.trun(t.samples,l.byteLength+o))}else if(t.isVideoEncryption)if(t.isVideo){var u=r.saiz(t),h=r.saio(t),d=r.trun1(t),c=r.senc(t),f=r.box(r.types.traf,i,e,u,h,d,c);return f}else if(t.isAudioEncryption){var b=r.sbgp(),S=r.saiz(t),G=r.saio(t),X=r.senc(t),L=r.trun1(t),k=r.box(r.types.traf,i,e,b,S,G,X,L);return k}else{var y=r.sbgp(),g=r.trun1(t);return r.box(r.types.traf,i,e,y,g)}else if(t.isVideo){var W=r.trun1(t);return r.box(r.types.traf,i,e,W)}else{var V=r.sbgp(),w=r.saiz(t),M=r.saio(t),C=r.senc(t),U=r.trun1(t),m=r.box(r.types.traf,i,e,V,w,M,C,U);return m}}},{key:"sdtp",value:function(t){var i=new Se;return t.samples.forEach(function(e){i.write(new Uint8Array(t.isVideo?[e.keyframe?32:16]:[16]))}),r.box(r.types.sdtp,this.extension(0,0),i.buffer)}},{key:"trun1",value:function(t){var i=new Se,e=Se.writeUint32(t.samples.length),s=null;if(t.isVideo){var n=t.videoSencLength;s=Se.writeUint32(t.samples.length*16+n+149),!t.isVideoEncryption&&t.isAudioEncryption&&(s=Se.writeUint32(t.samples.length*16+92))}else{var l=t.samples.length*12+124;t.isAudioEncryption&&(l=t.samples.length*12+8*t.audioSenc.length+177),s=Se.writeUint32(l)}return t.samples.forEach(function(o){i.write(Se.writeUint32(o.duration)),i.write(Se.writeUint32(o.size)),i.write(Se.writeUint32(o.keyframe?33554432:65536)),t.isVideo&&i.write(Se.writeUint32(o.cts?o.cts:0))}),r.box(r.types.trun,this.extension(0,t.flags),e,s,i.buffer)}},{key:"senc",value:function(t){var i=new Se,e=t.samples.length,s=t.isVideo?16:8,n=t.isVideo?2:0,l=[],o=0;return t.isVideo?(l=t.videoSenc,o=t.videoSencLength):l=t.audioSenc,o=o||s*e,i.write(Se.writeUint32(16+o),r.types.senc,this.extension(0,n)),i.write(Se.writeUint32(e)),l.forEach(function(u){for(var h=0;h<u.InitializationVector.length;h++)i.write(new Uint8Array([u.InitializationVector[h]]));u.subsamples&&u.subsamples.length&&(i.write(Se.writeUint16(u.subsamples.length)),u.subsamples.forEach(function(d){i.write(Se.writeUint16(d.BytesOfClearData)),i.write(Se.writeUint32(d.BytesOfProtectedData))}))}),i.buffer}},{key:"saio",value:function(t){var i=t.samples.length*12+141;!t.isVideo&&t.isAudioEncryption&&(i=149);var e=new Uint8Array([1,0,0,0,0,0,0,1,0,0,0,0,i>>24&255,i>>16&255,i>>8&255,i&255]);return r.box(r.types.saio,e)}},{key:"saiz",value:function(t){var i=t.samples.length,e=new Uint8Array([0,0,0,0,16,i>>24&255,i>>16&255,i>>8&255,i&255]);return r.box(r.types.saiz,e)}},{key:"sbgp",value:function(){var t=new Uint8Array([114,111,108,108,0,0,0,1,0,0,1,25,0,0,0,1]);return r.box(r.types.sbgp,this.extension(0,0),t)}},{key:"extension",value:function(t,i){return new Uint8Array([t,i>>16&255,i>>8&255,i&255])}},{key:"tfhd",value:function(t){return r.box(r.types.tfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]))}},{key:"tfdt",value:function(t,i){var e=Math.floor(i/(qs+1)),s=Math.floor(i%(qs+1));return t.useEME&&(t.isVideoEncryption||t.isAudioEncryption)?r.box(r.types.tfdt,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,s&255])):r.box(r.types.tfdt,new Uint8Array([1,0,0,0,e>>24,e>>16&255,e>>8&255,e&255,s>>24,s>>16&255,s>>8&255,s&255]))}},{key:"trun",value:function(t,i){var e=t.length,s=12+16*e;i+=8+s;var n=new Uint8Array(s);n.set([0,0,15,1,e>>>24&255,e>>>16&255,e>>>8&255,e&255,i>>>24&255,i>>>16&255,i>>>8&255,i&255],0);for(var l=0;l<e;l++){var o=t[l],u=o.duration,h=o.size,d=o.flag,c=d===void 0?{}:d,f=o.cts,y=f===void 0?0:f;n.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,h>>>24&255,h>>>16&255,h>>>8&255,h&255,c.isLeading<<2|(c.dependsOn===null||c.dependsOn===void 0?1:c.dependsOn),c.isDependedOn<<6|c.hasRedundancy<<4|c.paddingValue<<1|(c.isNonSyncSample===null||c.isNonSyncSample===void 0?1:c.isNonSyncSample),c.degradationPriority&61440,c.degradationPriority&15,y>>>24&255,y>>>16&255,y>>>8&255,y&255],12+16*l)}return r.box(r.types.trun,n)}},{key:"moovMP4",value:function(t){return r.box.apply(r,[r.types.moov,r.mvhd(t[0].duration,t[0].timescale)].concat(Re(t.map(function(i){return r.trackMP4(i)}))))}},{key:"trackMP4",value:function(t){return r.box(r.types.trak,r.tkhd(t.id,t.duration,t.width,t.height),r.mdiaMP4(t))}},{key:"mdiaMP4",value:function(t){return r.box(r.types.mdia,r.mdhd(t.duration,t.timescale),r.hdlr(t.type),r.minfMP4(t))}},{key:"minfMP4",value:function(t){return r.box(r.types.minf,t.type===yt.VIDEO?r.VMHD:r.SMHD,r.DINF,r.stblMP4(t))}},{key:"stblMP4",value:function(t){var i=t.ext,e=[r.stsd(t),r.stts(i.stts),r.stsc(i.stsc),r.stsz(i.stsz),r.stco(i.stco)];return i.stss.length&&e.push(r.stss(i.stss)),i.ctts.length&&e.push(r.ctts(i.ctts)),r.box.apply(r,[r.types.stbl].concat(e))}},{key:"stts",value:function(t){var i=t.length,e=new Uint8Array(8*i),s=0;return t.forEach(function(n){var l=n.value,o=n.count;e.set([o>>24,o>>16&255,o>>8&255,o&255,l>>24,l>>16&255,l>>8&255,l&255],s),s+=8}),r.box(r.types.stts,Pe(new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255]),e))}},{key:"stsc",value:function(t){var i=t.length,e=new Uint8Array(12*i),s=0;return t.forEach(function(n){var l=n.firstChunk,o=n.samplesPerChunk,u=n.sampleDescIndex;e.set([l>>24,l>>16&255,l>>8&255,l&255,o>>24,o>>16&255,o>>8&255,o&255,u>>24,u>>16&255,u>>8&255,u&255],s),s+=12}),r.box(r.types.stsc,Pe(new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255]),e))}},{key:"stsz",value:function(t){var i=t.length,e=new Uint8Array(4*i),s=0;return t.forEach(function(n){e.set([n>>24,n>>16&255,n>>8&255,n&255],s),s+=4}),r.box(r.types.stsz,Pe(new Uint8Array([0,0,0,0,0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255]),e))}},{key:"stco",value:function(t){var i=t.length,e=new Uint8Array(4*i),s=0;return t.forEach(function(n){e.set([n>>24,n>>16&255,n>>8&255,n&255],s),s+=4}),r.box(r.types.stco,Pe(new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255]),e))}},{key:"stss",value:function(t){var i=t.length,e=new Uint8Array(4*i),s=0;return t.forEach(function(n){e.set([n>>24,n>>16&255,n>>8&255,n&255],s),s+=4}),r.box(r.types.stss,Pe(new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255]),e))}},{key:"ctts",value:function(t){var i=t.length,e=new Uint8Array(8*i),s=0;return t.forEach(function(n){var l=n.value,o=n.count;e.set([o>>24,o>>16&255,o>>8&255,o&255,l>>24,l>>16&255,l>>8&255,l&255],s),s+=8}),r.box(r.types.ctts,Pe(new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255]),e))}},{key:"styp",value:function(){return r.box(r.types.styp,new Uint8Array([109,115,100,104,0,0,0,0,109,115,100,104,109,115,105,120]))}},{key:"sidx",value:function(t){var i=t.timescale,e=t.samples[0].duration,s=e*t.samples.length,n=t.samples[0].sampleOffset*e,l=8;t.samples.forEach(function(c){l+=c.size});var o=0;if(t.isVideo){var u=0,h;t.videoSenc&&(h=t.videoSenc),t.isVideo&&h.forEach(function(c){u=u+8,c.subsamples&&c.subsamples.length&&(u=u+2,u=u+c.subsamples.length*6)}),t.videoSencLength=u,o=l+141+t.samples.length*16+u,t.useEME&&t.isAudioEncryption&&!t.isVideoEncryption&&(o=l+t.samples.length*16+84)}else o=l+116+t.samples.length*12,t.useEME&&t.isAudioEncryption&&(o=l+169+t.samples.length*12+8*t.audioSenc.length);var d=new Uint8Array([0,0,0,0,0,0,0,t.id&255,i>>24&255,i>>16&255,i>>8&255,i&255,n>>24&255,n>>16&255,n>>8&255,n&255,0,0,0,0,0,0,0,1,0,o>>16&255,o>>8&255,o&255,s>>24&255,s>>16&255,s>>8&255,s&255,144,0,0,0]);return r.box(r.types.sidx,d)}},{key:"mdat",value:function(t){var i=r.box(r.types.mdat,t);return i}}]),r}();Y($,"types",["av01","av1C","avc1","avcC","hvc1","hvcC","dinf","dref","esds","ftyp","hdlr","mdat","mdhd","mdia","mfhd","minf","moof","moov","mp4a","mvex","mvhd","pasp","stbl","stco","stsc","stsd","stsz","stts","tfdt","tfhd","traf","trak","trex","tkhd","vmhd","smhd","ctts","stss","styp","pssh","sidx","sbgp","saiz","saio","senc","trun","encv","enca","sinf","btrt","frma","tenc","schm","schi","mehd","fiel","sdtp"].reduce(function(r,a){return r[a]=[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3)],r},Object.create(null)));Y($,"HDLR_TYPES",{video:new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),audio:new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0])});Y($,"FTYPAVC1",$.box($.types.ftyp,new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49])));Y($,"FTYPHEV1",$.box($.types.ftyp,new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,104,101,118,49])));Y($,"DINF",$.box($.types.dinf,$.box($.types.dref,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]))));Y($,"VMHD",$.box($.types.vmhd,new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])));Y($,"SMHD",$.box($.types.smhd,new Uint8Array([0,0,0,0,0,0,0,0])));Y($,"StblTable",new Uint8Array([0,0,0,0,0,0,0,0]));Y($,"STTS",$.box($.types.stts,$.StblTable));Y($,"STSC",$.box($.types.stsc,$.StblTable));Y($,"STSZ",$.box($.types.stsz,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0])));Y($,"STCO",$.box($.types.stco,$.StblTable));var ys=function(){function r(a,t){ue(this,r),this.name=a||"",this._prefix="[".concat(this.name,"]"),r.disabled=t}return he(r,[{key:"debug",value:function(){var t;if(!r.disabled){for(var i=arguments.length,e=new Array(i),s=0;s<i;s++)e[s]=arguments[s];(t=console).debug.apply(t,[this._prefix].concat(e))}}},{key:"log",value:function(){var t;if(!r.disabled){for(var i=arguments.length,e=new Array(i),s=0;s<i;s++)e[s]=arguments[s];(t=console).log.apply(t,[this._prefix].concat(e))}}},{key:"warn",value:function(){var t;if(!r.disabled){for(var i=arguments.length,e=new Array(i),s=0;s<i;s++)e[s]=arguments[s];(t=console).warn.apply(t,[this._prefix].concat(e))}}},{key:"error",value:function(){var t;if(!r.disabled){for(var i=arguments.length,e=new Array(i),s=0;s<i;s++)e[s]=arguments[s];(t=console).error.apply(t,[this._prefix].concat(e))}}},{key:"table",value:function(){var t;r.disabled||(console.group(this._prefix),(t=console).table.apply(t,arguments),console.groupEnd())}}],[{key:"enable",value:function(){r.disabled=!1}},{key:"disable",value:function(){r.disabled=!0}}]),r}();Y(ys,"disabled",!0);var vs=function(){function r(a,t,i){ue(this,r),this.videoTrack=a,this.audioTrack=t;var e=/Chrome\/([^.]+)/.exec(navigator.userAgent);this.forceFirstIDR=e&&Number(e[1])<50,this.log=new ys("FMP4Remuxer",i&&i.openLog?!i.openLog:!0)}return he(r,[{key:"remux",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=this.videoTrack,s=this.audioTrack,n=e.exist(),l=s.exist(),o,u,h,d=[];t&&(i&&i.initMerge?(n&&d.push(this.videoTrack),l&&d.push(this.audioTrack),h=$.initSegment(d)):(n&&(o=$.initSegment([this.videoTrack])),l&&(u=$.initSegment([this.audioTrack]))));var c,f;return n&&e.hasSample()&&(c=this._remuxVideo()),l&&s.hasSample()&&(f=this._remuxAudio()),e.samples=[],s.samples=[],{initSegment:h,videoInitSegment:o,audioInitSegment:u,videoSegment:c,audioSegment:f}}},{key:"_remuxVideo",value:function(){var t=this.videoTrack;this.forceFirstIDR&&(t.samples[0].flag={dependsOn:2,isNonSyncSample:0});var i=t.samples,e=/av01/.test(t.codec),s=0;e?i.forEach(function(X){s+=X.data.byteLength}):i.forEach(function(X){s+=X.units.reduce(function(L,k){return L+k.byteLength},0),s+=X.units.length*4});var n=new Uint8Array(s);if(e)for(var l=0,o=i.length,u=0,h;l<o;l++)h=i[l],n.set(h.data,u),h.size=h.data.byteLength,u+=h.size;else for(var d=new DataView(n.buffer),c=function(L,k){k=i[f];var W=0;k.units.forEach(function(V){d.setUint32(L,V.byteLength),L+=4,n.set(V,L),L+=V.byteLength,W+=4+V.byteLength}),k.size=W,g=L,b=k},f=0,y=i.length,g=0,b;f<y;f++)c(g,b);var S=$.mdat(n),G=$.moof([t]);return Pe(G,S)}},{key:"_remuxAudio",value:function(){var t=this.audioTrack,i=new Uint8Array(t.samples.reduce(function(n,l){return n+l.size},0));t.samples.reduce(function(n,l){return i.set(l.data,n),n+l.size},0);var e=$.mdat(i),s=$.moof([t]);return Pe(s,e)}},{key:"reset",value:function(){this.videoTrack.reset(),this.audioTrack.reset()}}]),r}();class Ye{static create(...a){return new this(...a)}mixIn(a){return Object.assign(this,a)}clone(){const a=new this.constructor;return Object.assign(a,this),a}}class Ie extends Ye{constructor(a=[],t=a.length*4){super();let i=a;if(i instanceof ArrayBuffer&&(i=new Uint8Array(i)),(i instanceof Int8Array||i instanceof Uint8ClampedArray||i instanceof Int16Array||i instanceof Uint16Array||i instanceof Int32Array||i instanceof Uint32Array||i instanceof Float32Array||i instanceof Float64Array)&&(i=new Uint8Array(i.buffer,i.byteOffset,i.byteLength)),i instanceof Uint8Array){const e=i.byteLength,s=[];for(let n=0;n<e;n+=1)s[n>>>2]|=i[n]<<24-n%4*8;this.words=s,this.sigBytes=e}else this.words=a,this.sigBytes=t}static random(a){const t=[],i=e=>{let s=e,n=987654321;const l=4294967295;return()=>{n=36969*(n&65535)+(n>>16)&l,s=18e3*(s&65535)+(s>>16)&l;let o=(n<<16)+s&l;return o/=4294967296,o+=.5,o*(Math.random()>.5?1:-1)}};for(let e=0,s;e<a;e+=4){const n=i((s||Math.random())*4294967296);s=n()*987654071,t.push(n()*4294967296|0)}return new Ie(t,a)}toString(a=ss){return a.stringify(this)}concat(a){const t=this.words,i=a.words,e=this.sigBytes,s=a.sigBytes;if(this.clamp(),e%4)for(let n=0;n<s;n+=1){const l=i[n>>>2]>>>24-n%4*8&255;t[e+n>>>2]|=l<<24-(e+n)%4*8}else for(let n=0;n<s;n+=4)t[e+n>>>2]=i[n>>>2];return this.sigBytes+=s,this}clamp(){const{words:a,sigBytes:t}=this;a[t>>>2]&=4294967295<<32-t%4*8,a.length=Math.ceil(t/4)}clone(){const a=super.clone.call(this);return a.words=this.words.slice(0),a}}const ss={stringify(r){const{words:a,sigBytes:t}=r,i=[];for(let e=0;e<t;e+=1){const s=a[e>>>2]>>>24-e%4*8&255;i.push((s>>>4).toString(16)),i.push((s&15).toString(16))}return i.join("")},parse(r){const a=r.length,t=[];for(let i=0;i<a;i+=2)t[i>>>3]|=parseInt(r.substr(i,2),16)<<24-i%8*4;return new Ie(t,a/2)}},$s={stringify(r){const{words:a,sigBytes:t}=r,i=[];for(let e=0;e<t;e+=1){const s=a[e>>>2]>>>24-e%4*8&255;i.push(String.fromCharCode(s))}return i.join("")},parse(r){const a=r.length,t=[];for(let i=0;i<a;i+=1)t[i>>>2]|=(r.charCodeAt(i)&255)<<24-i%4*8;return new Ie(t,a)}},er={stringify(r){try{return decodeURIComponent(escape($s.stringify(r)))}catch{throw new Error("Malformed UTF-8 data")}},parse(r){return $s.parse(unescape(encodeURIComponent(r)))}};class tr extends Ye{constructor(){super(),this._minBufferSize=0}reset(){this._data=new Ie,this._nDataBytes=0}_append(a){let t=a;typeof t=="string"&&(t=er.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes}_process(a){let t;const{_data:i,blockSize:e}=this,s=i.words,n=i.sigBytes,l=e*4;let o=n/l;a?o=Math.ceil(o):o=Math.max((o|0)-this._minBufferSize,0);const u=o*e,h=Math.min(u*4,n);if(u){for(let d=0;d<u;d+=e)this._doProcessBlock(s,d);t=s.splice(0,u),i.sigBytes-=h}return new Ie(t,h)}clone(){const a=super.clone.call(this);return a._data=this._data.clone(),a}}class Aa extends tr{constructor(a){super(),this.blockSize=512/32,this.cfg=Object.assign(new Ye,a),this.reset()}static _createHelper(a){return(t,i)=>new a(i).finalize(t)}static _createHmacHelper(a){return(t,i)=>new ja(a,i).finalize(t)}reset(){super.reset.call(this),this._doReset()}update(a){return this._append(a),this._process(),this}finalize(a){return a&&this._append(a),this._doFinalize()}}class ja extends Ye{constructor(a,t){super();const i=new a;this._hasher=i;let e=t;typeof e=="string"&&(e=er.parse(e));const s=i.blockSize,n=s*4;e.sigBytes>n&&(e=i.finalize(t)),e.clamp();const l=e.clone();this._oKey=l;const o=e.clone();this._iKey=o;const u=l.words,h=o.words;for(let d=0;d<s;d+=1)u[d]^=1549556828,h[d]^=909522486;l.sigBytes=n,o.sigBytes=n,this.reset()}reset(){const a=this._hasher;a.reset(),a.update(this._iKey)}update(a){return this._hasher.update(a),this}finalize(a){const t=this._hasher,i=t.finalize(a);return t.reset(),t.finalize(this._oKey.clone().concat(i))}}const Qa=(r,a,t)=>{const i=[];let e=0;for(let s=0;s<a;s+=1)if(s%4){const n=t[r.charCodeAt(s-1)]<<s%4*2,l=t[r.charCodeAt(s)]>>>6-s%4*2,o=n|l;i[e>>>2]|=o<<24-e%4*8,e+=1}return Ie.create(i,e)},en={stringify(r){const{words:a,sigBytes:t}=r,i=this._map;r.clamp();const e=[];for(let n=0;n<t;n+=3){const l=a[n>>>2]>>>24-n%4*8&255,o=a[n+1>>>2]>>>24-(n+1)%4*8&255,u=a[n+2>>>2]>>>24-(n+2)%4*8&255,h=l<<16|o<<8|u;for(let d=0;d<4&&n+d*.75<t;d+=1)e.push(i.charAt(h>>>6*(3-d)&63))}const s=i.charAt(64);if(s)for(;e.length%4;)e.push(s);return e.join("")},parse(r){let a=r.length;const t=this._map;let i=this._reverseMap;if(!i){this._reverseMap=[],i=this._reverseMap;for(let s=0;s<t.length;s+=1)i[t.charCodeAt(s)]=s}const e=t.charAt(64);if(e){const s=r.indexOf(e);s!==-1&&(a=s)}return Qa(r,a,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},z=[];for(let r=0;r<64;r+=1)z[r]=Math.abs(Math.sin(r+1))*4294967296|0;const Ee=(r,a,t,i,e,s,n)=>{const l=r+(a&t|~a&i)+e+n;return(l<<s|l>>>32-s)+a},Xe=(r,a,t,i,e,s,n)=>{const l=r+(a&i|t&~i)+e+n;return(l<<s|l>>>32-s)+a},Ge=(r,a,t,i,e,s,n)=>{const l=r+(a^t^i)+e+n;return(l<<s|l>>>32-s)+a},We=(r,a,t,i,e,s,n)=>{const l=r+(t^(a|~i))+e+n;return(l<<s|l>>>32-s)+a};class qa extends Aa{_doReset(){this._hash=new Ie([1732584193,4023233417,2562383102,271733878])}_doProcessBlock(a,t){const i=a;for(let M=0;M<16;M+=1){const C=t+M,U=a[C];i[C]=(U<<8|U>>>24)&16711935|(U<<24|U>>>8)&4278255360}const e=this._hash.words,s=i[t+0],n=i[t+1],l=i[t+2],o=i[t+3],u=i[t+4],h=i[t+5],d=i[t+6],c=i[t+7],f=i[t+8],y=i[t+9],g=i[t+10],b=i[t+11],S=i[t+12],G=i[t+13],X=i[t+14],L=i[t+15];let k=e[0],W=e[1],V=e[2],w=e[3];k=Ee(k,W,V,w,s,7,z[0]),w=Ee(w,k,W,V,n,12,z[1]),V=Ee(V,w,k,W,l,17,z[2]),W=Ee(W,V,w,k,o,22,z[3]),k=Ee(k,W,V,w,u,7,z[4]),w=Ee(w,k,W,V,h,12,z[5]),V=Ee(V,w,k,W,d,17,z[6]),W=Ee(W,V,w,k,c,22,z[7]),k=Ee(k,W,V,w,f,7,z[8]),w=Ee(w,k,W,V,y,12,z[9]),V=Ee(V,w,k,W,g,17,z[10]),W=Ee(W,V,w,k,b,22,z[11]),k=Ee(k,W,V,w,S,7,z[12]),w=Ee(w,k,W,V,G,12,z[13]),V=Ee(V,w,k,W,X,17,z[14]),W=Ee(W,V,w,k,L,22,z[15]),k=Xe(k,W,V,w,n,5,z[16]),w=Xe(w,k,W,V,d,9,z[17]),V=Xe(V,w,k,W,b,14,z[18]),W=Xe(W,V,w,k,s,20,z[19]),k=Xe(k,W,V,w,h,5,z[20]),w=Xe(w,k,W,V,g,9,z[21]),V=Xe(V,w,k,W,L,14,z[22]),W=Xe(W,V,w,k,u,20,z[23]),k=Xe(k,W,V,w,y,5,z[24]),w=Xe(w,k,W,V,X,9,z[25]),V=Xe(V,w,k,W,o,14,z[26]),W=Xe(W,V,w,k,f,20,z[27]),k=Xe(k,W,V,w,G,5,z[28]),w=Xe(w,k,W,V,l,9,z[29]),V=Xe(V,w,k,W,c,14,z[30]),W=Xe(W,V,w,k,S,20,z[31]),k=Ge(k,W,V,w,h,4,z[32]),w=Ge(w,k,W,V,f,11,z[33]),V=Ge(V,w,k,W,b,16,z[34]),W=Ge(W,V,w,k,X,23,z[35]),k=Ge(k,W,V,w,n,4,z[36]),w=Ge(w,k,W,V,u,11,z[37]),V=Ge(V,w,k,W,c,16,z[38]),W=Ge(W,V,w,k,g,23,z[39]),k=Ge(k,W,V,w,G,4,z[40]),w=Ge(w,k,W,V,s,11,z[41]),V=Ge(V,w,k,W,o,16,z[42]),W=Ge(W,V,w,k,d,23,z[43]),k=Ge(k,W,V,w,y,4,z[44]),w=Ge(w,k,W,V,S,11,z[45]),V=Ge(V,w,k,W,L,16,z[46]),W=Ge(W,V,w,k,l,23,z[47]),k=We(k,W,V,w,s,6,z[48]),w=We(w,k,W,V,c,10,z[49]),V=We(V,w,k,W,X,15,z[50]),W=We(W,V,w,k,h,21,z[51]),k=We(k,W,V,w,S,6,z[52]),w=We(w,k,W,V,o,10,z[53]),V=We(V,w,k,W,g,15,z[54]),W=We(W,V,w,k,n,21,z[55]),k=We(k,W,V,w,f,6,z[56]),w=We(w,k,W,V,L,10,z[57]),V=We(V,w,k,W,d,15,z[58]),W=We(W,V,w,k,G,21,z[59]),k=We(k,W,V,w,u,6,z[60]),w=We(w,k,W,V,b,10,z[61]),V=We(V,w,k,W,l,15,z[62]),W=We(W,V,w,k,y,21,z[63]),e[0]=e[0]+k|0,e[1]=e[1]+W|0,e[2]=e[2]+V|0,e[3]=e[3]+w|0}_doFinalize(){const a=this._data,t=a.words,i=this._nDataBytes*8,e=a.sigBytes*8;t[e>>>5]|=128<<24-e%32;const s=Math.floor(i/4294967296),n=i;t[(e+64>>>9<<4)+15]=(s<<8|s>>>24)&16711935|(s<<24|s>>>8)&4278255360,t[(e+64>>>9<<4)+14]=(n<<8|n>>>24)&16711935|(n<<24|n>>>8)&4278255360,a.sigBytes=(t.length+1)*4,this._process();const l=this._hash,o=l.words;for(let u=0;u<4;u+=1){const h=o[u];o[u]=(h<<8|h>>>24)&16711935|(h<<24|h>>>8)&4278255360}return l}clone(){const a=super.clone.call(this);return a._hash=this._hash.clone(),a}}class $a extends Ye{constructor(a){super(),this.cfg=Object.assign(new Ye,{keySize:128/32,hasher:qa,iterations:1},a)}compute(a,t){let i;const{cfg:e}=this,s=e.hasher.create(),n=Ie.create(),l=n.words,{keySize:o,iterations:u}=e;for(;l.length<o;){i&&s.update(i),i=s.update(a).finalize(t),s.reset();for(let h=1;h<u;h+=1)i=s.finalize(i),s.reset();n.concat(i)}return n.sigBytes=o*4,n}}class $t extends tr{constructor(a,t,i){super(),this.cfg=Object.assign(new Ye,i),this._xformMode=a,this._key=t,this.reset()}static createEncryptor(a,t){return this.create(this._ENC_XFORM_MODE,a,t)}static createDecryptor(a,t){return this.create(this._DEC_XFORM_MODE,a,t)}static _createHelper(a){const t=i=>typeof i=="string"?rr:Ft;return{encrypt(i,e,s){return t(e).encrypt(a,i,e,s)},decrypt(i,e,s){return t(e).decrypt(a,i,e,s)}}}reset(){super.reset.call(this),this._doReset()}process(a){return this._append(a),this._process()}finalize(a){return a&&this._append(a),this._doFinalize()}}$t._ENC_XFORM_MODE=1;$t._DEC_XFORM_MODE=2;$t.keySize=128/32;$t.ivSize=128/32;class ir extends Ye{constructor(a,t){super(),this._cipher=a,this._iv=t}static createEncryptor(a,t){return this.Encryptor.create(a,t)}static createDecryptor(a,t){return this.Decryptor.create(a,t)}}function sr(r,a,t){const i=r;let e;const s=this._iv;s?(e=s,this._iv=void 0):e=this._prevBlock;for(let n=0;n<t;n+=1)i[a+n]^=e[n]}class Ot extends ir{}Ot.Encryptor=class extends Ot{processBlock(r,a){const t=this._cipher,{blockSize:i}=t;sr.call(this,r,a,i),t.encryptBlock(r,a),this._prevBlock=r.slice(a,a+i)}};Ot.Decryptor=class extends Ot{processBlock(r,a){const t=this._cipher,{blockSize:i}=t,e=r.slice(a,a+i);t.decryptBlock(r,a),sr.call(this,r,a,i),this._prevBlock=e}};const el={pad(r,a){const t=a*4,i=t-r.sigBytes%t,e=i<<24|i<<16|i<<8|i,s=[];for(let l=0;l<i;l+=4)s.push(e);const n=Ie.create(s,i);r.concat(n)},unpad(r){const a=r,t=a.words[a.sigBytes-1>>>2]&255;a.sigBytes-=t}};class nr extends $t{constructor(a,t,i){super(a,t,Object.assign({mode:Ot,padding:el},i)),this.blockSize=128/32}reset(){let a;super.reset.call(this);const{cfg:t}=this,{iv:i,mode:e}=t;this._xformMode===this.constructor._ENC_XFORM_MODE?a=e.createEncryptor:(a=e.createDecryptor,this._minBufferSize=1),this._mode=a.call(e,this,i&&i.words),this._mode.__creator=a}_doProcessBlock(a,t){this._mode.processBlock(a,t)}_doFinalize(){let a;const{padding:t}=this.cfg;return this._xformMode===this.constructor._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),a=this._process(!0)):(a=this._process(!0),t.unpad(a)),a}}class Wi extends Ye{constructor(a){super(),this.mixIn(a)}toString(a){return(a||this.formatter).stringify(this)}}const tl={stringify(r){let a;const{ciphertext:t,salt:i}=r;return i?a=Ie.create([1398893684,1701076831]).concat(i).concat(t):a=t,a.toString(en)},parse(r){let a;const t=en.parse(r),i=t.words;return i[0]===1398893684&&i[1]===1701076831&&(a=Ie.create(i.slice(2,4)),i.splice(0,4),t.sigBytes-=16),Wi.create({ciphertext:t,salt:a})}};class Ft extends Ye{static encrypt(a,t,i,e){const s=Object.assign(new Ye,this.cfg,e),n=a.createEncryptor(i,s),l=n.finalize(t),o=n.cfg;return Wi.create({ciphertext:l,key:i,iv:o.iv,algorithm:a,mode:o.mode,padding:o.padding,blockSize:n.blockSize,formatter:s.format})}static decrypt(a,t,i,e){let s=t;const n=Object.assign(new Ye,this.cfg,e);return s=this._parse(s,n.format),a.createDecryptor(i,n).finalize(s.ciphertext)}static _parse(a,t){return typeof a=="string"?t.parse(a,this):a}}Ft.cfg=Object.assign(new Ye,{format:tl});const il={execute(r,a,t,i){let e=i;e||(e=Ie.random(64/8));const s=$a.create({keySize:a+t}).compute(r,e),n=Ie.create(s.words.slice(a),t*4);return s.sigBytes=a*4,Wi.create({key:s,iv:n,salt:e})}};class rr extends Ft{static encrypt(a,t,i,e){const s=Object.assign(new Ye,this.cfg,e),n=s.kdf.execute(i,a.keySize,a.ivSize);s.iv=n.iv;const l=Ft.encrypt.call(this,a,t,n.key,s);return l.mixIn(n),l}static decrypt(a,t,i,e){let s=t;const n=Object.assign(new Ye,this.cfg,e);s=this._parse(s,n.format);const l=n.kdf.execute(i,a.keySize,a.ivSize,s.salt);return n.iv=l.iv,Ft.decrypt.call(this,a,s,l.key,n)}}rr.cfg=Object.assign(Ft.cfg,{kdf:il});const Ke=[],ar=[],lr=[],or=[],ur=[],hr=[],ns=[],rs=[],as=[],ls=[],Qe=[];for(let r=0;r<256;r+=1)r<128?Qe[r]=r<<1:Qe[r]=r<<1^283;let je=0,ot=0;for(let r=0;r<256;r+=1){let a=ot^ot<<1^ot<<2^ot<<3^ot<<4;a=a>>>8^a&255^99,Ke[je]=a,ar[a]=je;const t=Qe[je],i=Qe[t],e=Qe[i];let s=Qe[a]*257^a*16843008;lr[je]=s<<24|s>>>8,or[je]=s<<16|s>>>16,ur[je]=s<<8|s>>>24,hr[je]=s,s=e*16843009^i*65537^t*257^je*16843008,ns[a]=s<<24|s>>>8,rs[a]=s<<16|s>>>16,as[a]=s<<8|s>>>24,ls[a]=s,je?(je=t^Qe[Qe[Qe[e^t]]],ot^=Qe[Qe[ot]]):(ot=1,je=ot)}const sl=[0,1,2,4,8,16,32,64,128,27,54];class dr extends nr{_doReset(){let a;if(this._nRounds&&this._keyPriorReset===this._key)return;this._keyPriorReset=this._key;const t=this._keyPriorReset,i=t.words,e=t.sigBytes/4;this._nRounds=e+6;const n=(this._nRounds+1)*4;this._keySchedule=[];const l=this._keySchedule;for(let u=0;u<n;u+=1)u<e?l[u]=i[u]:(a=l[u-1],u%e?e>6&&u%e===4&&(a=Ke[a>>>24]<<24|Ke[a>>>16&255]<<16|Ke[a>>>8&255]<<8|Ke[a&255]):(a=a<<8|a>>>24,a=Ke[a>>>24]<<24|Ke[a>>>16&255]<<16|Ke[a>>>8&255]<<8|Ke[a&255],a^=sl[u/e|0]<<24),l[u]=l[u-e]^a);this._invKeySchedule=[];const o=this._invKeySchedule;for(let u=0;u<n;u+=1){const h=n-u;u%4?a=l[h]:a=l[h-4],u<4||h<=4?o[u]=a:o[u]=ns[Ke[a>>>24]]^rs[Ke[a>>>16&255]]^as[Ke[a>>>8&255]]^ls[Ke[a&255]]}}encryptBlock(a,t){this._doCryptBlock(a,t,this._keySchedule,lr,or,ur,hr,Ke)}decryptBlock(a,t){const i=a;let e=i[t+1];i[t+1]=i[t+3],i[t+3]=e,this._doCryptBlock(i,t,this._invKeySchedule,ns,rs,as,ls,ar),e=i[t+1],i[t+1]=i[t+3],i[t+3]=e}_doCryptBlock(a,t,i,e,s,n,l,o){const u=a,h=this._nRounds;let d=u[t]^i[0],c=u[t+1]^i[1],f=u[t+2]^i[2],y=u[t+3]^i[3],g=4;for(let L=1;L<h;L+=1){const k=e[d>>>24]^s[c>>>16&255]^n[f>>>8&255]^l[y&255]^i[g];g+=1;const W=e[c>>>24]^s[f>>>16&255]^n[y>>>8&255]^l[d&255]^i[g];g+=1;const V=e[f>>>24]^s[y>>>16&255]^n[d>>>8&255]^l[c&255]^i[g];g+=1;const w=e[y>>>24]^s[d>>>16&255]^n[c>>>8&255]^l[f&255]^i[g];g+=1,d=k,c=W,f=V,y=w}const b=(o[d>>>24]<<24|o[c>>>16&255]<<16|o[f>>>8&255]<<8|o[y&255])^i[g];g+=1;const S=(o[c>>>24]<<24|o[f>>>16&255]<<16|o[y>>>8&255]<<8|o[d&255])^i[g];g+=1;const G=(o[f>>>24]<<24|o[y>>>16&255]<<16|o[d>>>8&255]<<8|o[c&255])^i[g];g+=1;const X=(o[y>>>24]<<24|o[d>>>16&255]<<16|o[c>>>8&255]<<8|o[f&255])^i[g];g+=1,u[t]=b,u[t+1]=S,u[t+2]=G,u[t+3]=X}}dr.keySize=256/32;const nl=nr._createHelper(dr);class At extends ir{}At.Encryptor=class extends At{processBlock(r,a){const t=r,i=this._cipher,{blockSize:e}=i,s=this._iv;let n=this._counter;s&&(this._counter=s.slice(0),n=this._counter,this._iv=void 0);const l=n.slice(0);i.encryptBlock(l,0),n[e-1]=n[e-1]+1|0;for(let o=0;o<e;o+=1)t[a+o]^=l[o]}};At.Decryptor=At.Encryptor;const rl={pad(){},unpad(){}};var ci={decryptWordArray:function(a,t,i){var e=ss.parse(t),s=ss.parse(Fa(i)),n=Ie.create(new Uint8Array(a)),l=nl.decrypt(Wi.create({ciphertext:n}),e,{iv:s,mode:At,padding:rl});return ci.wordArrayToUint8Array(l)},wordArrayToUint8Array:function(a){for(var t=a.sigBytes,i=a.words,e=new Uint8Array(t),s=0,n=0;s!==t;){var l=i[n++];if(e[s++]=(l&4278190080)>>>24,s===t||(e[s++]=(l&16711680)>>>16,s===t)||(e[s++]=(l&65280)>>>8,s===t))break;e[s++]=l&255}return e},decoderAESCTRData:function(a,t,i){if(a.videoSenc){var e=a.kidValue,s=a.videoSenc;a.samples.forEach(function(o,u){var h=s[u],d=o.data,c=[],f=[],y=h.InitializationVector;if(h.subsamples&&h.subsamples.length)h.subsamples.forEach(function(X){var L=X.BytesOfClearData+X.BytesOfProtectedData,k=d.slice(0,L);c.push(k.slice(0,X.BytesOfClearData)),f.push(k.slice(X.BytesOfClearData)),d=d.slice(L)});else{var g=o.size;c.push(d.slice(0,0)),f.push(d.slice(0,g)),d=d.slice(g)}var b=new Se;b.write.apply(b,f);var S=i?i(b.buffer,e,y):ci.decryptWordArray(b.buffer,e,y),G=new Se;c.forEach(function(X,L){var k=f[L].length,W=S.slice(0,k);G.write(X),G.write(W),S=S.slice(k)}),a.samples[u].data=G.buffer})}if(t.audioSenc){var n=t.kidValue,l=t.audioSenc;t.samples.forEach(function(o,u){var h=l[u],d=i?i(o.data,n,h.InitializationVector):ci.decryptWordArray(o.data,n,h.InitializationVector);t.samples[u].data=d})}}},tn=20,al=function(){function r(a,t,i,e){var s=this;ue(this,r),Y(this,"_videoSamples",[]),Y(this,"_audioSamples",[]),Y(this,"_lastRemainBuffer",[]),Y(this,"_lastRemainBufferStartPos",0),this.videoTrack=new Li,this.audioTrack=new Ei,this.metadataTrack=i||new Xi,this.log=new ys("MP4Demuxer",e&&e.openLog?!e.openLog:!0),a&&a.forEach(function(n){var l;(l=s._videoSamples).push.apply(l,Re(n.frames))}),t&&t.forEach(function(n){var l;(l=s._audioSamples).push.apply(l,Re(n.frames))})}return he(r,[{key:"parseSamples",value:function(t){if(!t)throw new Error("moov is required");if(!this.videoTrack.codec&&!this.audioTrack.codec&&(q.moovToTrack(t,this.videoTrack,this.audioTrack),this.videoSenc=this.videoTrack.videoSenc,this.audioSenc=this.audioTrack.audioSenc),!this._audioSamples.length&&!this._videoSamples.length){var i=q.moovToSamples(t);if(!i)throw new Error("cannot parse samples from moov box");this._videoSamples=i.videoSamples||[],this._audioSamples=i.audioSamples||[]}}},{key:"demux",value:function(t,i,e,s,n){this.parseSamples(n);var l=this.videoTrack,o=this.audioTrack;l.samples=[],o.samples=[];var u,h,d;if(e){for(var c,f=0,y=e[0],g=e[1];y<=g;y++){if(u=this._videoSamples[y],!u)throw new Error("cannot found video frame #".concat(y));d=u.offset-i,h=t.subarray(d,d+u.size),c=new Dt(u.pts||u.dts,u.dts),c.duration=u.duration,c.gopId=u.gopId,u.keyframe&&c.setToKeyframe();for(var b=0,S=h.length-1;b<S;)f=H(h,b),b+=4,c.units.push(h.subarray(b,b+f)),b+=f;l.samples.push(c)}l.baseMediaDecodeTime=l.samples[0].dts}if(s){for(var G=s[0],X=s[1];G<=X;G++){if(u=this._audioSamples[G],!u)throw new Error("cannot found video frame #".concat(G));d=u.offset-i,h=t.subarray(d,d+u.size),o.samples.push(new nt(u.dts,h,u.duration))}o.baseMediaDecodeTime=o.samples[0].dts}return{videoTrack:l,audioTrack:o,metadataTrack:this.metadataTrack}}},{key:"demuxPart",value:function(t,i,e,s,n,l,o,u){if(this.parseSamples(n),this.videoTrack.useEME=l,this.audioTrack.useEME=l,this._lastRemainBuffer&&this._lastRemainBuffer.byteLength>0&&i>this._lastRemainBufferStartPos&&i<=this._lastRemainBufferStartPos+this._lastRemainBuffer.byteLength)for(var h=0;h<tn;)try{var d=this._lastRemainBuffer.subarray(0,i-this._lastRemainBufferStartPos),c=new Uint8Array(t.byteLength+d.byteLength);c.set(d,0),c.set(new Uint8Array(t),d.byteLength),t=c,i-=d.byteLength,this._lastRemainBuffer=null,this._lastRemainBufferStartPos=0;break}catch(p){if(h<tn)h++;else throw new Error("new Uint8Array error:,"+p.errorMessage)}var f=this.videoTrack,y=this.audioTrack;f.samples=[],y.samples=[],f.videoSenc=null,y.audioSenc=null;var g,b,S,G=0,X=0;if(this._videoSamples.length>0&&e.length>0){for(var L,k=t.byteLength+i,W=e[0];W<=e[1];W++){if(g=this._videoSamples[W],!g)throw new Error("cannot found video frame #".concat(W));g.offset>=i&&g.offset+g.size<=k&&(S=g.offset-i,G=S+g.size,b=t.subarray(S,G),L=new Dt(g.pts||g.dts,g.dts),L.duration=g.duration,L.gopId=g.gopId,L.sampleOffset=g.index,g.keyframe&&L.setToKeyframe(),L.data=b,L.size=g.size,f.samples.push(L))}f.samples.length>0&&(f.gopId=f.samples[0].gopId,f.baseMediaDecodeTime=f.samples[0].dts,f.startPts=f.samples[0].pts/f.timescale,f.endPts=f.samples[f.samples.length-1].pts/f.timescale,this.videoSenc&&(f.videoSenc=this.videoSenc.slice(f.samples[0].sampleOffset,f.samples[0].sampleOffset+f.samples.length),f.kidValue=o))}if(this._audioSamples.length>0&&s.length>0){for(var V=s[0];V<=s[1];V++){if(g=this._audioSamples[V],!g)throw new Error("cannot found video frame #".concat(V));g.offset>=i&&g.offset+g.size<=t.byteLength+i&&(S=g.offset-i,X=S+g.size,b=t.subarray(S,X),y.samples.push(new nt(g.dts,b,g.duration,g.index)))}y.samples.length>0&&(y.gopId=y.samples[0].gopId||f.gopId,y.baseMediaDecodeTime=y.samples[0].dts,y.startPts=y.samples[0].pts/y.timescale,y.endPts=y.samples[y.samples.length-1].pts/y.timescale,this.audioSenc&&(y.audioSenc=this.audioSenc.slice(y.samples[0].sampleOffset,y.samples[0].sampleOffset+y.samples.length),y.kidValue=o))}this.decoderData(f,y,u);for(var w=0,M=0;M<f.samples.length;M++)for(var C=0,U=f.samples[M].data,m=U.length-1;C<m;)w=H(U,C),C+=4,f.samples[M].units.push(U.subarray(C,C+w)),C+=w;return this._lastRemainBuffer=t.subarray(Math.max(G,X)),this._lastRemainBuffer.byteLength>0?this._lastRemainBufferStartPos=i+t.byteLength-this._lastRemainBuffer.byteLength:this._lastRemainBufferStartPos=0,{videoTrack:f,audioTrack:y,metadataTrack:this.metadataTrack}}},{key:"reset",value:function(){this._videoSamples=[],this._audioSamples=[],this._lastRemainBuffer=null,this._lastRemainBufferStartPos=0,this.videoTrack.reset(),this.audioTrack.reset(),this.metadataTrack.reset()}},{key:"decoderData",value:function(t,i,e){t.useEME||i.useEME||ci.decoderAESCTRData(t,i,e)}}],[{key:"probe",value:function(t){return q.probe(t)}}]),r}(),ut=new Te("BufferService"),ll=function(){function r(a,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};ki(this,r),B(this,"flv",null),B(this,"_demuxer",new Qn),B(this,"_remuxer",null),B(this,"_mse",null),B(this,"_softVideo",null),B(this,"_sourceCreated",!1),B(this,"_needInitSegment",!0),B(this,"_discontinuity",!0),B(this,"_contiguous",!1),B(this,"_initSegmentId",""),B(this,"_cachedBuffer",null),B(this,"_demuxStartTime",0),B(this,"_opts",null),this.flv=a,this._opts=i,t?this._softVideo=t:(this._remuxer=new vs(this._demuxer.videoTrack,this._demuxer.audioTrack),this._mse=new ce(null,{preferMMS:typeof i.preferMMS=="boolean"?i.preferMMS:!!i.perferMMS}),this._mse.bindMedia(a.media))}return Si(r,[{key:"baseDts",get:function(){var t,i;return(t=this._demuxer)===null||t===void 0||(i=t._fixer)===null||i===void 0?void 0:i._baseDts}},{key:"blobUrl",get:function(){var t;return(t=this._mse)===null||t===void 0?void 0:t.url}},{key:"isFull",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ce.VIDEO;return this._mse.isFull(t)}},{key:"seamlessSwitch",value:function(){this._needInitSegment=!0,this._discontinuity=!0,this._contiguous=!0,this._initSegmentId=""}},{key:"unContiguous",value:function(t){this._contiguous=!1,this._demuxStartTime=t}},{key:"reset",value:function(){var a=Ve(se().mark(function i(){var e,s=arguments;return se().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(e=s.length>0&&s[0]!==void 0?s[0]:!1,!(this._mse&&!e)){l.next=6;break}return l.next=4,this._mse.unbindMedia();case 4:return l.next=6,this._mse.bindMedia(this.flv.media);case 6:this._needInitSegment=!0,this._discontinuity=!0,this._contiguous=!1,this._sourceCreated=!1,this._initSegmentId="";case 11:case"end":return l.stop()}},i,this)}));function t(){return a.apply(this,arguments)}return t}()},{key:"endOfStream",value:function(){var a=Ve(se().mark(function i(){return se().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this._mse){s.next=7;break}if(!this._sourceCreated){s.next=5;break}return s.next=4,this._mse.endOfStream();case 4:this.flv.emit(F.BUFFEREOS);case 5:s.next=8;break;case 7:this._softVideo&&this._softVideo.endOfStream();case 8:case"end":return s.stop()}},i,this)}));function t(){return a.apply(this,arguments)}return t}()},{key:"updateDuration",value:function(){var a=Ve(se().mark(function i(e){return se().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!this._mse){n.next=7;break}if(this._mse.isOpened){n.next=4;break}return n.next=4,this._mse.open();case 4:return ut.debug("update duration",e),n.next=7,this._mse.updateDuration(e);case 7:case"end":return n.stop()}},i,this)}));function t(i){return a.apply(this,arguments)}return t}()},{key:"destroy",value:function(){var a=Ve(se().mark(function i(){return se().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this._mse){s.next=3;break}return s.next=3,this._mse.unbindMedia();case 3:this._mse=null,this._softVideo=null,this._demuxer=null,this._remuxer=null;case 7:case"end":return s.stop()}},i,this)}));function t(){return a.apply(this,arguments)}return t}()},{key:"appendBuffer",value:function(){var a=Ve(se().mark(function i(e){var s,n,l,o,u,h,d,c,f,y,g,b,S,G;return se().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(this._cachedBuffer&&(e=Gt(this._cachedBuffer,e),this._cachedBuffer=null),s=this._demuxer,!(!e||!e.length||!s)){L.next=4;break}return L.abrupt("return");case 4:L.prev=4,s.demuxAndFix(e,this._discontinuity,this._contiguous,this._demuxStartTime),L.next=11;break;case 8:throw L.prev=8,L.t0=L.catch(4),new oe(N.DEMUX,N.SUB_TYPES.FLV,L.t0);case 11:if(n=s.videoTrack,l=s.audioTrack,o=s.metadataTrack,u=n.exist(),h=l.exist(),this._opts.onlyAudio&&(u=!1,n.present=!1),this._opts.onlyVideo&&(h=!1,l.present=!1),!(!u&&n.present||!h&&l.present)){L.next=29;break}if(d=0,c=u?n:h?l:void 0,c&&c.samples.length&&(d=(c.samples[c.samples.length-1].originPts-c.samples[0].originPts)/c.timescale*1e3),!(d>this._opts.analyzeDuration)){L.next=27;break}ut.warn("analyze duration exceeded, ".concat(d,"ms"),c),n.present=u,l.present=h,this.flv.emit(F.ANALYZE_DURATION_EXCEEDED,{duration:d}),L.next=29;break;case 27:return this._cachedBuffer=e,L.abrupt("return");case 29:if(f=n.type,y=l.type,this._fireEvents(n,l,o),this._discontinuity=!1,this._contiguous=!0,this._demuxStartTime=0,g=this._mse,this.flv.emit(F.DEMUXED_TRACK,{videoTrack:n}),b="".concat(n.codec,"/").concat(n.width,"/").concat(n.height,"/").concat(l.codec,"/").concat(l.config),b!==this._initSegmentId&&(this._needInitSegment=!0,this._initSegmentId=b,this._emitMetaParsedEvent(n,l)),!g){L.next=66;break}if(this._sourceCreated){L.next=47;break}return L.next=43,g.open();case 43:u&&(ut.log("codec: video/mp4;codecs=".concat(n.codec)),g.createSource(f,"video/mp4;codecs=".concat(n.codec))),h&&(ut.log("codec: audio/mp4;codecs=".concat(l.codec)),g.createSource(y,"audio/mp4;codecs=".concat(l.codec))),this._sourceCreated=!0,this.flv.emit(F.SOURCEBUFFER_CREATED);case 47:L.prev=47,this._needInitSegment&&!this._opts.mseLowLatency&&(n.duration=this._opts.durationForMSELowLatencyOff*n.timescale,l.duration=this._opts.durationForMSELowLatencyOff*h.timescale),S=this._remuxer.remux(this._needInitSegment),L.next=55;break;case 52:throw L.prev=52,L.t1=L.catch(47),new oe(N.REMUX,N.SUB_TYPES.FMP4,L.t1);case 55:if(!(this._needInitSegment&&!S.videoInitSegment&&!S.audioInitSegment)){L.next=57;break}return L.abrupt("return");case 57:return this._needInitSegment=!1,G=[],S.videoInitSegment&&G.push(g.append(f,S.videoInitSegment)),S.audioInitSegment&&G.push(g.append(y,S.audioInitSegment)),S.videoSegment&&G.push(g.append(f,S.videoSegment)),S.audioSegment&&G.push(g.append(y,S.audioSegment)),L.abrupt("return",Promise.all(G));case 66:this._softVideo&&this._softVideo.appendBuffer(n,l);case 67:case"end":return L.stop()}},i,this,[[4,8],[47,52]])}));function t(i){return a.apply(this,arguments)}return t}()},{key:"evictBuffer",value:function(){var a=Ve(se().mark(function i(e){var s=this,n,l,o,u;return se().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(n=this.flv.media,!(!this._mse||!this._demuxer||!n||!e||e<0)){d.next=3;break}return d.abrupt("return");case 3:if(l=n.currentTime,o=l-e,!(o<=0)){d.next=7;break}return d.abrupt("return");case 7:if(u=me.start(me.get(n)),!(u+1>=o)){d.next=10;break}return d.abrupt("return");case 10:return d.abrupt("return",this._mse.clearBuffer(0,o).then(function(){return s.flv.emit(F.REMOVE_BUFFER,{removeEnd:o})}));case 11:case"end":return d.stop()}},i,this)}));function t(i){return a.apply(this,arguments)}return t}()},{key:"_emitMetaParsedEvent",value:function(t,i){t.exist()&&this.flv.emit(F.METADATA_PARSED,{type:"video",track:t,meta:{codec:t.codec,timescale:t.timescale,width:t.width,height:t.height,sarRatio:t.sarRatio,baseDts:t.baseDts}}),i.exist()&&this.flv.emit(F.METADATA_PARSED,{type:"audio",track:i,meta:{codec:i.codec,channelCount:i.channelCount,sampleRate:i.sampleRate,timescale:i.timescale,baseDts:i.baseDts}}),ut.debug("track parsed",t,i)}},{key:"_fireEvents",value:function(t,i,e){var s=this;ut.debug(t.samples,i.samples),e.flvScriptSamples.forEach(function(n){s.flv.emit(F.FLV_SCRIPT_DATA,n),ut.debug("flvScriptData",n)}),t.samples.forEach(function(n){n.keyframe&&s.flv.emit(F.KEYFRAME,{pts:n.pts})}),t.warnings.forEach(function(n){var l;switch(n.type){case fe.LARGE_AV_SHIFT:l=F.LARGE_AV_FIRST_FRAME_GAP_DETECT;break;case fe.LARGE_VIDEO_GAP:l=F.LARGE_VIDEO_DTS_GAP_DETECT;break;case fe.LARGE_VIDEO_GAP_BETWEEN_CHUNK:l=F.MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT;break}l&&s.flv.emit(F.STREAM_EXCEPTION,Ce(Ce({},n),{},{type:l})),ut.warn("video exception",n)}),i.warnings.forEach(function(n){var l;switch(n.type){case fe.LARGE_AUDIO_GAP:l=F.LARGE_AUDIO_DTS_GAP_DETECT;break;case fe.AUDIO_FILLED:l=F.AUDIO_GAP_DETECT;break;case fe.AUDIO_DROPPED:l=F.AUDIO_OVERLAP_DETECT;break}l&&s.flv.emit(F.STREAM_EXCEPTION,Ce(Ce({},n),{},{type:l})),ut.warn("audio exception",n)}),e.seiSamples.forEach(function(n){s.flv.emit(F.SEI,Ce(Ce({},n),{},{sei:{code:n.data.type,content:n.data.payload,dts:n.pts}}))})}}]),r}();function ol(r){var a=Ce({retryCount:3,retryDelay:1e3,disconnectRetryCount:0,loadTimeout:1e4,maxReaderInterval:5e3,preloadTime:5,defaultVodLoadSize:1e7,isLive:!1,softDecode:!1,bufferBehind:10,maxJumpDistance:3,analyzeDuration:2e4,seamlesslyReload:!1,keepStatusAfterSwitch:!0,onlyVideo:!1,onlyAudio:!1,preferMMS:!1,mseLowLatency:!0,durationForMSELowLatencyOff:6,chunkCountForSpeed:50,skipChunkSize:1e3,longtimeNoReceived:3e3},r);return a.isLive&&a.preloadTime&&(a.maxLatency||(a.maxLatency=a.preloadTime*2),a.targetLatency||(a.targetLatency=a.preloadTime),(a.disconnectTime===null||a.disconnectTime===void 0)&&(a.disconnectTime=a.maxLatency)),a}function sn(r,a){var t=0,i=r.length-1,e=0,s=0,n=i;for(a<r[0]&&(t=0,s=n+1);s<=n;)if(e=s+Math.floor((n-s)/2),e===i||a>=r[e]&&a<r[e+1]){t=e;break}else r[e]<a?s=e+1:n=e-1;return t}var ht=new Te("flv"),ni=.1,ul=.3,jt=function(r){wn(t,r);var a=Vn(t);function t(i){var e;return ki(this,t),e=a.call(this),B(ee(e),"media",null),B(ee(e),"_loading",!1),B(ee(e),"_opts",null),B(ee(e),"_bufferService",null),B(ee(e),"_gapService",null),B(ee(e),"_stats",null),B(ee(e),"_mediaLoader",null),B(ee(e),"_maxChunkWaitTimer",null),B(ee(e),"_tickTimer",null),B(ee(e),"_tickInterval",500),B(ee(e),"_urlSwitching",!1),B(ee(e),"_seamlessSwitching",!1),B(ee(e),"_disconnectRetryCount",0),B(ee(e),"_preLoadEndPoint",0),B(ee(e),"_keyframes",null),B(ee(e),"_acceptRanges",!0),B(ee(e),"_onProgress",function(){var s=Ve(se().mark(function n(l,o,u,h){var d,c,f,y,g,b,S,G,X;return se().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(d=u.startTime,c=u.endTime,f=u.st,y=u.firstByteTime,e._loading=!o,e._firstProgressEmit){k.next=11;break}if(e.media){k.next=6;break}return(g=e._mediaLoader)===null||g===void 0||g.cancel(),k.abrupt("return");case 6:b=h.headers,e.emit(F.TTFB,{url:e._opts.url,responseUrl:h.url,elapsed:f?y-f:c-d}),e.emit(F.LOAD_RESPONSE_HEADERS,{headers:b}),e._acceptRanges=!!(b!=null&&b.get("Accept-Ranges"))||!!(b!=null&&b.get("Content-Range")),e._firstProgressEmit=!0;case 11:if(e._bufferService){k.next=13;break}return k.abrupt("return");case 13:return clearTimeout(e._maxChunkWaitTimer),e._bandwidthService.addChunkRecord(l==null?void 0:l.byteLength,c-d),k.prev=15,k.next=18,e._bufferService.appendBuffer(l);case 18:(S=e._bufferService)===null||S===void 0||S.evictBuffer(e._opts.bufferBehind),k.next=31;break;case 21:if(k.prev=21,k.t0=k.catch(15),!(!e.isLive&&e._bufferService.isFull())){k.next=30;break}return k.next=26,e._mediaLoader.cancel();case 26:return e._loading=!1,G=e.bufferInfo().remaining,e._opts.preloadTime=parseInt(G)/2,k.abrupt("return");case 30:return k.abrupt("return",e._emitError(oe.create(k.t0)));case 31:if(e._urlSwitching&&(e._urlSwitching=!1,e.emit(F.SWITCH_URL_SUCCESS,{url:e._opts.url})),e._seamlessSwitching&&(e._seamlessSwitching=!1,e._tick()),!(o&&!e.media.seeking)){k.next=38;break}return e.emit(F.LOAD_COMPLETE),ht.debug("load done"),e.isLive&&e._disconnectRetryCount<=0&&e._end(),k.abrupt("return");case 38:if(e.isLive){k.next=40;break}return k.abrupt("return");case 40:X=e._opts.maxReaderInterval,X&&e._firstProgressEmit&&(clearTimeout(e._maxChunkWaitTimer),e._maxChunkWaitTimer=setTimeout(function(){if(e._disconnectRetryCount){e._disconnectRetryCount--,e.load();return}ht.debug("onMaxChunkWait",X),e._end()},X));case 42:case"end":return k.stop()}},n,null,[[15,21]])}));return function(n,l,o,u){return s.apply(this,arguments)}}()),B(ee(e),"_onRetryError",function(s,n){ht.debug("load retry",s,n),e.emit(F.LOAD_RETRY,{error:oe.network(s),retryTime:n})}),B(ee(e),"_end",function(){e._clear(),e._bufferService&&e._bufferService.endOfStream(),ht.debug("end stream")}),B(ee(e),"_resetDisconnectCount",function(){e._disconnectRetryCount=e._opts.disconnectRetryCount}),B(ee(e),"_tick",function(){clearTimeout(e._tickTimer);var s=ee(e),n=s.media;if(n){e._tickTimer=setTimeout(e._tick,e._tickInterval);var l=me.end(me.get(n));if(!(l<ni||!n.readyState)){var o=e._opts;if(_n(n))e._gapService&&e._gapService.do(n,o.maxJumpDistance,e.isLive,3);else{if(!n.currentTime&&e._gapService){var u=e._opts.mseLowLatency||e._opts.mseLowLatency===!1&&e.bufferInfo(ul).nextStart;u&&e._gapService.do(n,o.maxJumpDistance,e.isLive,3);return}o.isLive&&n.readyState===4&&l-n.currentTime>o.disconnectTime&&e.disconnect()}}}}),B(ee(e),"_onPlay",function(){var s,n,l=e._opts.softDecode||((s=e.media)===null||s===void 0||(n=s.buffered)===null||n===void 0?void 0:n.length);if(e.isLive){!e._loading&&l&&e.replay(void 0,!0);return}var o=e.bufferInfo();(o.start||o.nextStart)>ni&&e._tick()}),B(ee(e),"_onLoadeddata",function(){e.isLive&&!e._opts.mseLowLatency&&e.media.duration!==1/0&&e._bufferService.updateDuration(1/0).catch(function(s){})}),B(ee(e),"_onSeeking",Ve(se().mark(function s(){return se().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:!e.isLive&&e.seekable&&(e._preLoadEndPoint=-1,e._checkPreload());case 1:case"end":return l.stop()}},s)}))),B(ee(e),"_onTimeupdate",function(){if(e.media){var s=e._opts,n=e.media.currentTime;if(s.isLive&&s.maxLatency&&s.targetLatency){var l=me.end(me.get(e.media)),o=l-n;o>=s.maxLatency&&(e.media.currentTime=l-s.targetLatency,e.emit(F.CHASEFRAME,{currentTime:e.media.currentTime,latency:s.targetLatency}))}e._seiService.throw(n,!0),!(s.isLive||!e.seekable||e._loading)&&e._checkPreload()}}),B(ee(e),"_onWaiting",function(){e.isLive&&!e._loading&&e._disconnectRetryCount&&(e._disconnectRetryCount--,e.load())}),B(ee(e),"_onBufferUpdate",function(){if(!e._opts.isLive){var s=e.bufferInfo(),n=s.end,l=s.nextEnd;Math.abs((n||l)-e.media.duration)<1&&(e._end(),e.media.readyState<=2&&e._tick())}}),B(ee(e),"_checkPreload",Ve(se().mark(function s(){var n,l,o,u,h,d,c,f,y,g;return se().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(n=e.bufferInfo(),l=n.remaining,o=l===void 0?0:l,u=e._opts,h=e._keyframes.filepositions,d=e._keyframes.times,c=e.media.currentTime,!(o<u.preloadTime)){S.next=19;break}if(f=sn(e._keyframes.times,c+o+ni),y=sn(e._keyframes.times,c+o+e._opts.preloadTime),y===f&&(y=f+1),e._preLoadEndPoint!==y){S.next=11;break}return S.abrupt("return");case 11:if(g=h[f],g!=null){S.next=14;break}return S.abrupt("return");case 14:return S.next=16,e._mediaLoader.cancel();case 16:e._loadData(null,[g,h[y]]),e._preLoadEndPoint=y,e._bufferService.unContiguous(d[f]);case 19:case"end":return S.stop()}},s)}))),B(ee(e),"_onFlvScriptData",function(s){var n,l,o,u,h=(n=s.data)===null||n===void 0||(l=n.onMetaData)===null||l===void 0?void 0:l.keyframes,d=(o=s.data)===null||o===void 0||(u=o.onMetaData)===null||u===void 0?void 0:u.duration;h&&(e._keyframes=h),!e._opts.isLive&&d&&e._bufferService.updateDuration(d)}),e._opts=ol(i),e.media=e._opts.media||document.createElement("video"),e._opts.media=null,e._firstProgressEmit=!1,e._mediaLoader=new ft(Ce(Ce({},e._opts.fetchOptions),{},{retry:e._opts.retryCount,retryDelay:e._opts.retryDelay,timeout:e._opts.loadTimeout,onRetryError:e._onRetryError,onProgress:e._onProgress,responseType:"arraybuffer"})),e._disconnectRetryCount=e._opts.disconnectRetryCount,e._bufferService=new ll(ee(e),e._opts.softDecode?e.media:void 0,e._opts),e._seiService=new Dn(ee(e)),e._bandwidthService=new Pn({chunkCountForSpeed:e._opts.chunkCountForSpeed,skipChunkSize:e._opts.skipChunkSize,longtimeNoReceived:e._opts.longtimeNoReceived}),e._stats=new Hn(ee(e)),e._opts.softDecode||(e._gapService=new Kn),e.media.addEventListener("play",e._onPlay),e.media.addEventListener("loadeddata",e._onLoadeddata),e.media.addEventListener("seeking",e._onSeeking),e.media.addEventListener("timeupdate",e._onTimeupdate),e.media.addEventListener("progress",e._onBufferUpdate),e.media.addEventListener("waiting",e._onWaiting),e.on(F.FLV_SCRIPT_DATA,e._onFlvScriptData),e}return Si(t,[{key:"version",get:function(){return"3.0.19"}},{key:"isLive",get:function(){return this._opts.isLive}},{key:"baseDts",get:function(){var e;return(e=this._bufferService)===null||e===void 0?void 0:e.baseDts}},{key:"seekable",get:function(){return!!this._keyframes&&this._acceptRanges}},{key:"loader",get:function(){return this._mediaLoader}},{key:"blobUrl",get:function(){var e;return(e=this._bufferService)===null||e===void 0?void 0:e.blobUrl}},{key:"speedInfo",value:function(){return{speed:this._bandwidthService.getLatestSpeed(),avgSpeed:this._bandwidthService.getAvgSpeed(),totalSize:this._bandwidthService.getTotalSize(),totalCost:this._bandwidthService.getTotalCost()}}},{key:"getStats",value:function(){return this._stats.getStats()}},{key:"bufferInfo",value:function(){var e,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ni;return me.info(me.get(this.media),(e=this.media)===null||e===void 0?void 0:e.currentTime,s)}},{key:"playbackQuality",value:function(){return Fn(this.media)}},{key:"load",value:function(){var i=Ve(se().mark(function s(n){var l,o=arguments;return se().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(l=o.length>1&&o[1]!==void 0?o[1]:!1,this._bufferService){h.next=3;break}return h.abrupt("return");case 3:return h.next=5,this._reset(l);case 5:this._loadData(n,this._opts.isLive?[]:[0,this._opts.defaultVodLoadSize]),clearTimeout(this._tickTimer),this._tickTimer=setTimeout(this._tick,this._tickInterval);case 8:case"end":return h.stop()}},s,this)}));function e(s){return i.apply(this,arguments)}return e}()},{key:"replay",value:function(){var i=Ve(se().mark(function s(){var n=this,l,o,u=arguments;return se().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(l=u.length>0&&u[0]!==void 0?u[0]:this._opts.seamlesslyReload,o=u.length>1?u[1]:void 0,this.media){d.next=4;break}return d.abrupt("return");case 4:if(this._resetDisconnectCount(),!l){d.next=11;break}return d.next=8,this._clear();case 8:setTimeout(function(){n._loadData(n._opts.url),n._bufferService.seamlessSwitch(),n._seamlessSwitching=!0}),d.next=13;break;case 11:return d.next=13,this.load();case 13:return d.abrupt("return",this.media.play(!o).catch(function(){}));case 14:case"end":return d.stop()}},s,this)}));function e(){return i.apply(this,arguments)}return e}()},{key:"disconnect",value:function(){return ht.debug("disconnect!"),this._clear()}},{key:"switchURL",value:function(){var i=Ve(se().mark(function s(n,l){var o=this;return se().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this._bufferService){h.next=2;break}return h.abrupt("return");case 2:if(this._resetDisconnectCount(),!(!l||!this._opts.isLive)){h.next=8;break}return h.next=6,this.load(n);case 6:return this._urlSwitching=!0,h.abrupt("return",this.media.play(!0).catch(function(){}));case 8:return h.next=10,this._clear();case 10:setTimeout(function(){o._urlSwitching=!0,o._seamlessSwitching=!0,o._loadData(n),o._bufferService.seamlessSwitch()});case 11:case"end":return h.stop()}},s,this)}));function e(s,n){return i.apply(this,arguments)}return e}()},{key:"destroy",value:function(){var i=Ve(se().mark(function s(){return se().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this.media){l.next=2;break}return l.abrupt("return");case 2:return this.removeAllListeners(),this._seiService.reset(),this.media.removeEventListener("play",this._onPlay),this.media.removeEventListener("loadeddata",this._onLoadeddata),this.media.removeEventListener("seeking",this._onSeeking),this.media.removeEventListener("timeupdate",this._onTimeupdate),this.media.removeEventListener("waiting",this._onWaiting),this.media.removeEventListener("progress",this._onBufferUpdate),l.next=12,Promise.all([this._clear(),this._bufferService.destroy()]);case 12:this.media=null,this._bufferService=null;case 14:case"end":return l.stop()}},s,this)}));function e(){return i.apply(this,arguments)}return e}()},{key:"_emitError",value:function(e){var s,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;ht.table(e),ht.error(e),ht.error((s=this.media)===null||s===void 0?void 0:s.error),this._urlSwitching&&(this._urlSwitching=!1,this._seamlessSwitching=!1,this.emit(F.SWITCH_URL_FAILED,e)),this.emit(F.ERROR,e),n&&(this._seiService.reset(),this._end())}},{key:"_reset",value:function(){var i=Ve(se().mark(function s(){var n,l=arguments;return se().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return n=l.length>0&&l[0]!==void 0?l[0]:!1,this._seiService.reset(),this._bandwidthService.reset(),this._stats.reset(),u.next=6,this._clear();case 6:return u.next=8,this._bufferService.reset(n);case 8:case"end":return u.stop()}},s,this)}));function e(){return i.apply(this,arguments)}return e}()},{key:"_loadData",value:function(){var i=Ve(se().mark(function s(n,l){var o;return se().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(n&&(this._opts.url=n),o=n=this._opts.url,n){h.next=4;break}throw new Error("Source url is missing");case 4:if(this._opts.preProcessUrl&&(o=this._opts.preProcessUrl(n).url),this._mediaLoader.finnalUrl=o,this.emit(F.LOAD_START,{url:o,seamlessSwitching:this._seamlessSwitching}),ht.debug("load data, loading:",this._loading,o),!this._loading){h.next=11;break}return h.next=11,this._mediaLoader.cancel();case 11:return this._loading=!0,h.prev=12,h.next=15,this._mediaLoader.load({url:o,range:l});case 15:h.next=21;break;case 17:return h.prev=17,h.t0=h.catch(12),this._loading=!1,h.abrupt("return",this._emitError(oe.network(h.t0),!1));case 21:case"end":return h.stop()}},s,this,[[12,17]])}));function e(s,n){return i.apply(this,arguments)}return e}()},{key:"_clear",value:function(){var i=Ve(se().mark(function s(){return se().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!this._mediaLoader){l.next=3;break}return l.next=3,this._mediaLoader.cancel();case 3:clearTimeout(this._maxChunkWaitTimer),clearTimeout(this._tickTimer),this._loading=!1,this._firstProgressEmit=!1;case 7:case"end":return l.stop()}},s,this)}));function e(){return i.apply(this,arguments)}return e}()}],[{key:"isSupported",value:function(e){return!e||e==="video"||e==="audio"?ce.isSupported():typeof WebAssembly<"u"}},{key:"enableLogger",value:function(){Te.enable(),Vt.enable()}},{key:"disableLogger",value:function(){Te.disable(),Vt.disable()}}]),t}(vt);try{localStorage.getItem("xgd")?jt.enableLogger():jt.disableLogger()}catch{}var hl=function(){function r(a,t){var i=this;ki(this,r),B(this,"_onLowDecode",function(){var e,s,n,l,o=i._opts,u=o.media,h=o.innerDegrade,d=o.backupURL;(e=i._plugin)===null||e===void 0||(s=e.player)===null||s===void 0||s.emit("lowdecode",u.degradeInfo),(n=i._plugin)===null||n===void 0||(l=n.player)===null||l===void 0||l.emit("core_event",Ce(Ce({},u.degradeInfo),{},{eventName:F.LOWDECODE})),(h===1||h===3)&&d&&i._degrade(d)}),B(this,"_degrade",function(e){var s=i._plugin.player,n=s.video;if((n==null?void 0:n.TAG)==="MVideo"){var l=s.video.degradeVideo;s.video=l,n.degrade(e),e&&(s.config.url=e);var o=s.root.firstChild;o.TAG==="MVideo"&&s.root.replaceChild(l,o);var u=i._plugin.constructor.pluginName.toLowerCase();s.unRegisterPlugin(u),s.once("canplay",function(){s.play()})}}),B(this,"forceDegradeToVideo",function(e){var s=i._opts.innerDegrade;(s===1||s===3)&&i._degrade(e)}),this._opts=a,this._plugin=t,this._init()}return Si(r,[{key:"_init",value:function(){var t=this._opts,i=t.media,e=t.preloadTime,s=t.innerDegrade,n=t.decodeMode;i&&(s&&i.setAttribute("innerdegrade",s),e&&i.setAttribute("preloadtime",e),i.setDecodeMode&&i.setDecodeMode(n),this._bindEvents())}},{key:"_bindEvents",value:function(){var t=this._opts.media;t.addEventListener("lowdecode",this._onLowDecode)}},{key:"destroy",value:function(){var t,i;(t=this._opts)===null||t===void 0||(i=t.media)===null||i===void 0||i.removeEventListener("lowdecode",this._onLowDecode),this._plugin=null}}]),r}(),cr=function(r){wn(t,r);var a=Vn(t);function t(){var i;ki(this,t);for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];return i=a.call.apply(a,[this].concat(s)),B(ee(i),"flv",null),B(ee(i),"pluginExtension",null),B(ee(i),"getStats",function(){var l;return(l=i.flv)===null||l===void 0?void 0:l.getStats()}),B(ee(i),"destroy",function(){var l;i.flv&&(i.flv.destroy(),i.flv=null),(l=i.pluginExtension)===null||l===void 0||l.destroy(),i.pluginExtension=null}),B(ee(i),"_onSwitchURL",function(l,o){if(i.flv){var u,h;i.player.config.url=l,Oi(o)==="object"&&(o=o.seamless),i.flv.switchURL(l,o),!o&&(u=i.player.config)!==null&&u!==void 0&&(h=u.flv)!==null&&h!==void 0&&h.keepStatusAfterSwitch&&i._keepPauseStatus()}}),B(ee(i),"_keepPauseStatus",function(){var l=i.player.paused;l&&i.player.once("canplay",function(){i.player.pause()})}),B(ee(i),"_onDefinitionChange",function(l){var o=l.to;i.flv&&i.flv.switchURL(o)}),i}return Si(t,[{key:"core",get:function(){return this.flv}},{key:"version",get:function(){var e;return(e=this.flv)===null||e===void 0?void 0:e.version}},{key:"softDecode",get:function(){var e,s,n=(e=this.player)===null||e===void 0||(s=e.config)===null||s===void 0?void 0:s.mediaType;return!!n&&n!=="video"&&n!=="audio"}},{key:"loader",get:function(){var e;return(e=this.flv)===null||e===void 0?void 0:e.loader}},{key:"beforePlayerInit",value:function(){var e=this,s=this.player.config;if(s.url){this.flv&&this.flv.destroy(),this.player.switchURL=this._onSwitchURL;var n=s.flv||{};if((n.disconnectTime===null||n.disconnectTime===void 0)&&(n.disconnectTime=0),this.flv=new jt(Ce({softDecode:this.softDecode,isLive:s.isLive,media:this.player.video,preProcessUrl:function(u,h){var d,c;return((d=e.player)===null||d===void 0||(c=d.preProcessUrl)===null||c===void 0?void 0:c.call(d,u,h))||{url:u,ext:h}}},n)),this.softDecode||Kt.defineGetterOrSetter(this.player,{url:{get:function(){var u;return(u=e.flv)===null||u===void 0?void 0:u.blobUrl},configurable:!0}}),this.softDecode&&(this.pluginExtension=new hl(Ce({media:this.player.video},s.flv),this),this.player.forceDegradeToVideo=function(){for(var o,u=arguments.length,h=new Array(u),d=0;d<u;d++)h[d]=arguments[d];return(o=e.pluginExtension)===null||o===void 0?void 0:o.forceDegradeToVideo.apply(o,h)}),s.isLive){var l;(l=this.player)===null||l===void 0||l.useHooks("replay",function(){var o;return(o=e.flv)===null||o===void 0?void 0:o.replay()})}this.on(Ut,this._onSwitchURL),this.on(Xn,this.destroy),this._transError(),this._transCoreEvent(F.TTFB),this._transCoreEvent(F.LOAD_START),this._transCoreEvent(F.LOAD_RESPONSE_HEADERS),this._transCoreEvent(F.LOAD_COMPLETE),this._transCoreEvent(F.LOAD_RETRY),this._transCoreEvent(F.SOURCEBUFFER_CREATED),this._transCoreEvent(F.ANALYZE_DURATION_EXCEEDED),this._transCoreEvent(F.REMOVE_BUFFER),this._transCoreEvent(F.BUFFEREOS),this._transCoreEvent(F.KEYFRAME),this._transCoreEvent(F.CHASEFRAME),this._transCoreEvent(F.METADATA_PARSED),this._transCoreEvent(F.SEI),this._transCoreEvent(F.SEI_IN_TIME),this._transCoreEvent(F.FLV_SCRIPT_DATA),this._transCoreEvent(F.STREAM_EXCEPTION),this._transCoreEvent(F.SWITCH_URL_SUCCESS),this._transCoreEvent(F.SWITCH_URL_FAILED),this.flv.load(s.url,!0)}}},{key:"_transError",value:function(){var e=this;this.flv.on(F.ERROR,function(s){e.player&&e.player.emit(Gn,new St(e.player,s))})}},{key:"_transCoreEvent",value:function(e){var s=this;this.flv.on(e,function(n){s.player&&s.player.emit("core_event",Ce(Ce({},n),{},{eventName:e}))})}}],[{key:"pluginName",get:function(){return"flv"}},{key:"isSupported",value:function(e,s){return jt.isSupported(e,s)}},{key:"isSupportedMMS",value:function(){return typeof ManagedMediaSource<"u"}}]),t}(Kt);B(cr,"Flv",jt);function dl(r,a){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var i,e,s,n,l=[],o=!0,u=!1;try{if(s=(t=t.call(r)).next,a===0){if(Object(t)!==t)return;o=!1}else for(;!(o=(i=s.call(t)).done)&&(l.push(i.value),l.length!==a);o=!0);}catch(h){u=!0,e=h}finally{try{if(!o&&t.return!=null&&(n=t.return(),Object(n)!==n))return}finally{if(u)throw e}}return l}}function nn(r,a){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);a&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),t.push.apply(t,i)}return t}function ne(r){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?nn(Object(t),!0).forEach(function(i){T(r,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):nn(Object(t)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(t,i))})}return r}function J(){J=function(){return r};var r={},a=Object.prototype,t=a.hasOwnProperty,i=Object.defineProperty||function(m,p,v){m[p]=v.value},e=typeof Symbol=="function"?Symbol:{},s=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",l=e.toStringTag||"@@toStringTag";function o(m,p,v){return Object.defineProperty(m,p,{value:v,enumerable:!0,configurable:!0,writable:!0}),m[p]}try{o({},"")}catch{o=function(p,v,E){return p[v]=E}}function u(m,p,v,E){var Z=p&&p.prototype instanceof c?p:c,R=Object.create(Z.prototype),x=new M(E||[]);return i(R,"_invoke",{value:k(m,v,x)}),R}function h(m,p,v){try{return{type:"normal",arg:m.call(p,v)}}catch(E){return{type:"throw",arg:E}}}r.wrap=u;var d={};function c(){}function f(){}function y(){}var g={};o(g,s,function(){return this});var b=Object.getPrototypeOf,S=b&&b(b(C([])));S&&S!==a&&t.call(S,s)&&(g=S);var G=y.prototype=c.prototype=Object.create(g);function X(m){["next","throw","return"].forEach(function(p){o(m,p,function(v){return this._invoke(p,v)})})}function L(m,p){function v(Z,R,x,D){var _=h(m[Z],m,R);if(_.type!=="throw"){var K=_.arg,j=K.value;return j&&typeof j=="object"&&t.call(j,"__await")?p.resolve(j.__await).then(function(P){v("next",P,x,D)},function(P){v("throw",P,x,D)}):p.resolve(j).then(function(P){K.value=P,x(K)},function(P){return v("throw",P,x,D)})}D(_.arg)}var E;i(this,"_invoke",{value:function(Z,R){function x(){return new p(function(D,_){v(Z,R,D,_)})}return E=E?E.then(x,x):x()}})}function k(m,p,v){var E="suspendedStart";return function(Z,R){if(E==="executing")throw new Error("Generator is already running");if(E==="completed"){if(Z==="throw")throw R;return U()}for(v.method=Z,v.arg=R;;){var x=v.delegate;if(x){var D=W(x,v);if(D){if(D===d)continue;return D}}if(v.method==="next")v.sent=v._sent=v.arg;else if(v.method==="throw"){if(E==="suspendedStart")throw E="completed",v.arg;v.dispatchException(v.arg)}else v.method==="return"&&v.abrupt("return",v.arg);E="executing";var _=h(m,p,v);if(_.type==="normal"){if(E=v.done?"completed":"suspendedYield",_.arg===d)continue;return{value:_.arg,done:v.done}}_.type==="throw"&&(E="completed",v.method="throw",v.arg=_.arg)}}}function W(m,p){var v=p.method,E=m.iterator[v];if(E===void 0)return p.delegate=null,v==="throw"&&m.iterator.return&&(p.method="return",p.arg=void 0,W(m,p),p.method==="throw")||v!=="return"&&(p.method="throw",p.arg=new TypeError("The iterator does not provide a '"+v+"' method")),d;var Z=h(E,m.iterator,p.arg);if(Z.type==="throw")return p.method="throw",p.arg=Z.arg,p.delegate=null,d;var R=Z.arg;return R?R.done?(p[m.resultName]=R.value,p.next=m.nextLoc,p.method!=="return"&&(p.method="next",p.arg=void 0),p.delegate=null,d):R:(p.method="throw",p.arg=new TypeError("iterator result is not an object"),p.delegate=null,d)}function V(m){var p={tryLoc:m[0]};1 in m&&(p.catchLoc=m[1]),2 in m&&(p.finallyLoc=m[2],p.afterLoc=m[3]),this.tryEntries.push(p)}function w(m){var p=m.completion||{};p.type="normal",delete p.arg,m.completion=p}function M(m){this.tryEntries=[{tryLoc:"root"}],m.forEach(V,this),this.reset(!0)}function C(m){if(m){var p=m[s];if(p)return p.call(m);if(typeof m.next=="function")return m;if(!isNaN(m.length)){var v=-1,E=function Z(){for(;++v<m.length;)if(t.call(m,v))return Z.value=m[v],Z.done=!1,Z;return Z.value=void 0,Z.done=!0,Z};return E.next=E}}return{next:U}}function U(){return{value:void 0,done:!0}}return f.prototype=y,i(G,"constructor",{value:y,configurable:!0}),i(y,"constructor",{value:f,configurable:!0}),f.displayName=o(y,l,"GeneratorFunction"),r.isGeneratorFunction=function(m){var p=typeof m=="function"&&m.constructor;return!!p&&(p===f||(p.displayName||p.name)==="GeneratorFunction")},r.mark=function(m){return Object.setPrototypeOf?Object.setPrototypeOf(m,y):(m.__proto__=y,o(m,l,"GeneratorFunction")),m.prototype=Object.create(G),m},r.awrap=function(m){return{__await:m}},X(L.prototype),o(L.prototype,n,function(){return this}),r.AsyncIterator=L,r.async=function(m,p,v,E,Z){Z===void 0&&(Z=Promise);var R=new L(u(m,p,v,E),Z);return r.isGeneratorFunction(p)?R:R.next().then(function(x){return x.done?x.value:R.next()})},X(G),o(G,l,"Generator"),o(G,s,function(){return this}),o(G,"toString",function(){return"[object Generator]"}),r.keys=function(m){var p=Object(m),v=[];for(var E in p)v.push(E);return v.reverse(),function Z(){for(;v.length;){var R=v.pop();if(R in p)return Z.value=R,Z.done=!1,Z}return Z.done=!0,Z}},r.values=C,M.prototype={constructor:M,reset:function(m){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!m)for(var p in this)p.charAt(0)==="t"&&t.call(this,p)&&!isNaN(+p.slice(1))&&(this[p]=void 0)},stop:function(){this.done=!0;var m=this.tryEntries[0].completion;if(m.type==="throw")throw m.arg;return this.rval},dispatchException:function(m){if(this.done)throw m;var p=this;function v(_,K){return R.type="throw",R.arg=m,p.next=_,K&&(p.method="next",p.arg=void 0),!!K}for(var E=this.tryEntries.length-1;E>=0;--E){var Z=this.tryEntries[E],R=Z.completion;if(Z.tryLoc==="root")return v("end");if(Z.tryLoc<=this.prev){var x=t.call(Z,"catchLoc"),D=t.call(Z,"finallyLoc");if(x&&D){if(this.prev<Z.catchLoc)return v(Z.catchLoc,!0);if(this.prev<Z.finallyLoc)return v(Z.finallyLoc)}else if(x){if(this.prev<Z.catchLoc)return v(Z.catchLoc,!0)}else{if(!D)throw new Error("try statement without catch or finally");if(this.prev<Z.finallyLoc)return v(Z.finallyLoc)}}}},abrupt:function(m,p){for(var v=this.tryEntries.length-1;v>=0;--v){var E=this.tryEntries[v];if(E.tryLoc<=this.prev&&t.call(E,"finallyLoc")&&this.prev<E.finallyLoc){var Z=E;break}}Z&&(m==="break"||m==="continue")&&Z.tryLoc<=p&&p<=Z.finallyLoc&&(Z=null);var R=Z?Z.completion:{};return R.type=m,R.arg=p,Z?(this.method="next",this.next=Z.finallyLoc,d):this.complete(R)},complete:function(m,p){if(m.type==="throw")throw m.arg;return m.type==="break"||m.type==="continue"?this.next=m.arg:m.type==="return"?(this.rval=this.arg=m.arg,this.method="return",this.next="end"):m.type==="normal"&&p&&(this.next=p),d},finish:function(m){for(var p=this.tryEntries.length-1;p>=0;--p){var v=this.tryEntries[p];if(v.finallyLoc===m)return this.complete(v.completion,v.afterLoc),w(v),d}},catch:function(m){for(var p=this.tryEntries.length-1;p>=0;--p){var v=this.tryEntries[p];if(v.tryLoc===m){var E=v.completion;if(E.type==="throw"){var Z=E.arg;w(v)}return Z}}throw new Error("illegal catch attempt")},delegateYield:function(m,p,v){return this.delegate={iterator:C(m),resultName:p,nextLoc:v},this.method==="next"&&(this.arg=void 0),d}},r}function yi(r){"@babel/helpers - typeof";return yi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},yi(r)}function rn(r,a,t,i,e,s,n){try{var l=r[s](n),o=l.value}catch(u){t(u);return}l.done?a(o):Promise.resolve(o).then(i,e)}function re(r){return function(){var a=this,t=arguments;return new Promise(function(i,e){var s=r.apply(a,t);function n(o){rn(s,i,e,n,l,"next",o)}function l(o){rn(s,i,e,n,l,"throw",o)}n(void 0)})}}function Ze(r,a){if(!(r instanceof a))throw new TypeError("Cannot call a class as a function")}function an(r,a){for(var t=0;t<a.length;t++){var i=a[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,mr(i.key),i)}}function ke(r,a,t){return a&&an(r.prototype,a),t&&an(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function T(r,a,t){return a=mr(a),a in r?Object.defineProperty(r,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[a]=t,r}function wi(r,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(a&&a.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),a&&os(r,a)}function vi(r){return vi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vi(r)}function os(r,a){return os=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,e){return i.__proto__=e,i},os(r,a)}function cl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pl(r,a){if(r==null)return{};var t={},i=Object.keys(r),e,s;for(s=0;s<i.length;s++)e=i[s],!(a.indexOf(e)>=0)&&(t[e]=r[e]);return t}function ln(r,a){if(r==null)return{};var t=pl(r,a),i,e;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(e=0;e<s.length;e++)i=s[e],!(a.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(t[i]=r[i])}return t}function Q(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function ml(r,a){if(a&&(typeof a=="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Q(r)}function Vi(r){var a=cl();return function(){var i=vi(r),e;if(a){var s=vi(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return ml(this,e)}}function ct(r,a){return vl(r)||dl(r,a)||pr(r,a)||Zl()}function fl(r){return yl(r)||bl(r)||pr(r)||gl()}function yl(r){if(Array.isArray(r))return us(r)}function vl(r){if(Array.isArray(r))return r}function bl(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function pr(r,a){if(r){if(typeof r=="string")return us(r,a);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return us(r,a)}}function us(r,a){(a==null||a>r.length)&&(a=r.length);for(var t=0,i=new Array(a);t<a;t++)i[t]=r[t];return i}function gl(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zl(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kl(r,a){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var i=t.call(r,a||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(r)}function mr(r){var a=kl(r,"string");return typeof a=="symbol"?a:String(a)}var Sl=function(){function r(){Ze(this,r);var a=window.crypto||window.msCrypto;this.subtle=a&&(a.subtle||a.webkitSubtle),this.externalDecryptor=null}return ke(r,[{key:"destroy",value:function(){var t;(t=this.externalDecryptor)!==null&&t!==void 0&&t.destroy&&this.externalDecryptor.destroy()}},{key:"decrypt",value:function(t,i){if(!(!t&&!i)){var e=[];return t&&(e[0]=this._decryptSegment(t)),i&&(e[1]=this._decryptSegment(i)),Promise.all(e)}}},{key:"_decryptSegment",value:function(){var a=re(J().mark(function i(e){var s;return J().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(s=e.data,!e.key){l.next=5;break}return l.next=4,this._decryptData(e.data,e.key,e.keyIv);case 4:s=l.sent;case 5:if(e.map){l.next=7;break}return l.abrupt("return",s);case 7:return l.abrupt("return",Gt(e.map,s));case 8:case"end":return l.stop()}},i,this)}));function t(i){return a.apply(this,arguments)}return t}()},{key:"_decryptData",value:function(){var a=re(J().mark(function i(e,s,n){var l;return J().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!this.externalDecryptor){u.next=6;break}return u.next=3,this.externalDecryptor.decrypt(e,s,n);case 3:return u.abrupt("return",u.sent);case 6:if(this.subtle){u.next=8;break}throw new Error("crypto is not defined");case 8:return u.next=10,this.subtle.importKey("raw",s,{name:"AES-CBC"},!1,["encrypt","decrypt"]);case 10:return l=u.sent,u.t0=Uint8Array,u.next=14,this.subtle.decrypt({name:"AES-CBC",iv:n},l,e);case 14:return u.t1=u.sent,u.abrupt("return",new u.t0(u.t1));case 16:case"end":return u.stop()}},i,this)}));function t(i,e,s){return a.apply(this,arguments)}return t}()}]),r}(),te=ne(ne({},F),{},{STREAM_PARSED:"core.streamparsed",NO_AUDIO_TRACK:"core.noaudiotrack",SUBTITLE_SEGMENTS:"core.subtitlesegments",SUBTITLE_PLAYLIST:"core.subtitleplaylist",SEI_PAYLOAD_TIME:"core.seipayloadtime",APPEND_COST:"core.appendcost"}),Ni=new Te("Transmuxer"),on=function(){function r(a,t,i,e){Ze(this,r),T(this,"_initSegmentId",""),this.hls=a,this._demuxer=t?new $n:new qn(null,null,null,e),this._isMP4=t,i&&(this._remuxer=new vs(this._demuxer.videoTrack,this._demuxer.audioTrack))}return ke(r,[{key:"transmux",value:function(t,i,e,s,n,l){var o=this._demuxer;try{this._isMP4?o.demux(t,i):o.demuxAndFix(Gt(t,i),e,s,n)}catch(W){throw new oe(N.DEMUX,N.SUB_TYPES.HLS,W)}var u=o.videoTrack,h=o.audioTrack,d=o.metadataTrack,c={codec:u.codec,timescale:u.timescale,firstDts:u.firstDts/u.timescale,firstPts:u.firstPts/u.timescale,duration:u.samplesDuration/u.timescale},f={codec:h.codec,timescale:h.timescale,firstDts:h.firstDts/u.timescale,firstPts:h.firstPts/u.timescale,duration:h.samplesDuration/u.timescale},y="".concat(u.codec,"/").concat(u.width,"/").concat(u.height,"/").concat(h.codec,"/").concat(h.config);if(y!==this._initSegmentId&&(this._initSegmentId=y,l=!0),this._fireEvents(u,h,d,e||l),this.hls.emit(te.DEMUXED_TRACK,{videoTrack:u,audioTrack:h}),this._remuxer){l&&this.hls.isLive&&!this.hls.config.mseLowLatency&&(u.duration=this.hls.totalDuration*u.timescale,h.duration=this.hls.totalDuration*h.timescale);try{var g=this._remuxer.remux(l),b=g.videoInitSegment,S=g.videoSegment,G=g.audioInitSegment,X=g.audioSegment,L=Gt(b,S),k=Gt(G,X);return[L?ne(ne({},c),{},{data:L}):void 0,k?ne(ne({},f),{},{data:k}):void 0]}catch(W){throw new oe(N.REMUX,N.SUB_TYPES.FMP4,W)}}else return[u,h]}},{key:"_fireEvents",value:function(t,i,e,s){var n=this,l=[t,i],o="discontinuity: ".concat(s);l.forEach(function(u){var h;(h=u.samples)!==null&&h!==void 0&&h.length&&(o+="; ".concat(u.samples.length," ").concat(u.type===yt.VIDEO?"video":"audio"," samples, firstDts/firstPts/duration: ").concat((u.firstDts/u.timescale).toFixed(3),"/").concat((u.firstPts/u.timescale).toFixed(3),"/").concat((u.samplesDuration/u.timescale).toFixed(3))),s&&u.exist()&&n.hls.emit(te.METADATA_PARSED,{type:u.type,track:u,meta:ne({codec:u.codec,timescale:u.timescale,baseDts:u.baseDts},u.type===yt.VIDEO?{width:u.width,height:u.height,sarRatio:u.sarRatio}:{codec:u.codec,channelCount:u.channelCount,sampleRate:u.sampleRate})})}),Ni.debug(o),t.warnings.forEach(function(u){var h;switch(u.type){case fe.LARGE_AV_SHIFT:h=te.LARGE_AV_FIRST_FRAME_GAP_DETECT;break;case fe.LARGE_VIDEO_GAP:h=te.LARGE_VIDEO_DTS_GAP_DETECT;break;case fe.LARGE_VIDEO_GAP_BETWEEN_CHUNK:h=te.MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT;break}h&&n.hls.emit(te.STREAM_EXCEPTION,ne(ne({},u),{},{type:h})),Ni.warn("video exception",u)}),i.warnings.forEach(function(u){var h;switch(u.type){case fe.LARGE_AUDIO_GAP:h=te.LARGE_AUDIO_DTS_GAP_DETECT;break;case fe.AUDIO_FILLED:h=te.AUDIO_GAP_DETECT;break;case fe.AUDIO_DROPPED:h=te.AUDIO_OVERLAP_DETECT;break}h&&n.hls.emit(te.STREAM_EXCEPTION,ne(ne({},u),{},{type:h})),Ni.warn("audio exception",u)}),t.samples.forEach(function(u){u.keyframe&&n.hls.emit(te.KEYFRAME,{pts:u.pts})}),e.seiSamples.forEach(function(u){n.hls.emit(te.SEI,ne(ne({},u),{},{originPts:u.originPts/90,sei:{code:u.data.type,content:u.data.payload,dts:u.pts}}))})}}]),r}(),Ll=["data"],El=["data"],un=new Te("BufferService"),Xl=function(){function r(a){var t=this;Ze(this,r),T(this,"_decryptor",new Sl),T(this,"_transmuxer",null),T(this,"_mse",null),T(this,"_softVideo",null),T(this,"_sourceCreated",!1),T(this,"_needInitSegment",!0),T(this,"_directAppend",!1),this.hls=a,a.config.softDecode?this._softVideo=a.media:(this._mse=new ce(null,{preferMMS:a.config.preferMMS}),a.config.url&&this._mse.bindMedia(a.media).then(function(i){t.hls.emit(F.MEDIASOURCE_OPENED,i)})),a.config.decryptor&&(this._decryptor.externalDecryptor=a.config.decryptor)}return ke(r,[{key:"baseDts",get:function(){var t,i,e;return(t=this._transmuxer)===null||t===void 0||(i=t._demuxer)===null||i===void 0||(e=i._fixer)===null||e===void 0?void 0:e._baseDts}},{key:"nbSb",get:function(){var t;return(t=this._mse)!==null&&t!==void 0&&t._sourceBuffer?Object.keys(this._mse._sourceBuffer).length:0}},{key:"msIsOpened",get:function(){var t;return(t=this._mse)===null||t===void 0?void 0:t.isOpened}},{key:"msHasOpTasks",get:function(){var t;return(t=this._mse)===null||t===void 0?void 0:t.hasOpTasks}},{key:"msStreaming",get:function(){var t;return(t=this._mse)===null||t===void 0?void 0:t.streaming}},{key:"updateDuration",value:function(){var a=re(J().mark(function i(e){return J().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(un.debug("update duration",e),!this._mse){n.next=9;break}if(this._mse.isOpened){n.next=5;break}return n.next=5,this._mse.open();case 5:return n.next=7,this._mse.updateDuration(e);case 7:n.next=10;break;case 9:this._softVideo&&(this._softVideo.duration=e);case 10:case"end":return n.stop()}},i,this)}));function t(i){return a.apply(this,arguments)}return t}()},{key:"createSource",value:function(t,i,e,s){if(!this._sourceCreated){var n=t||i;if(n){if(qn.probe(n))this._transmuxer||(this._transmuxer=new on(this.hls,!1,!this._softVideo,this.hls.config.fixerConfig));else if(q.probe(n))if(this._softVideo)this._transmuxer||(this._transmuxer=new on(this.hls,!0,null,this.hls.config.fixerConfig));else{this._directAppend=!0;var l=!1;t&&!e&&q.findBox(t,["moov","trak"]).forEach(function(o){var u=q.findBox(o.data,["trak","mdia","minf","stbl","stsd"])[0];if(u){var h=q.stsd(u).entries[0];if(h){if(h.hvcC)e=h.hvcC.codec||"hev1.1.6.L93.B0";else if(h.avcC)e=h.avcC.codec;else if(h.sampleRate||h.esds){var d;s=((d=h.esds)===null||d===void 0?void 0:d.codec)||"mp4a.40.2",l=!0}}}}),i&&!s&&q.findBox(i,["moov","trak","mdia","minf","stbl","stsd"]).forEach(function(o){var u=q.stsd(o).entries[0];u&&u.esds&&(s=u.esds.codec)}),t&&!e&&(e="avc1.42e01e"),i&&!s&&(s="mp4a.40.2"),l&&(e+=", ".concat(s),s=""),this._createMseSource(e,s)}else throw new oe(N.OTHER,null,null,null,"unsupported stream");this._softVideo&&(this._sourceCreated=!0)}}}},{key:"appendBuffer",value:function(){var a=re(J().mark(function i(e,s,n,l,o,u,h){var d,c,f,y,g,b,S,G,X,L,k,W,V;return J().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(!(!(n!=null&&n.length)&&!(l!=null&&l.length))){M.next=2;break}return M.abrupt("return");case 2:if(!this._directAppend){M.next=7;break}return d=[],n&&d.push(this._mse.append(ce.VIDEO,n)),l&&d.push(this._mse.append(ce.AUDIO,l)),M.abrupt("return",Promise.all(d));case 7:if(c=this._needInitSegment||o,f=this._transmuxer.transmux(n,l,c,u,h,this._needInitSegment||o),y=ct(f,2),g=y[0],b=y[1],l&&s&&(s==null||s.setTrackExist(!1,!0)),l&&e&&(e==null||e.setTrackExist(!0,!1)),s||e==null||e.setTrackExist(!!g,!!b),g&&!b&&this.hls.emit(te.NO_AUDIO_TRACK),!this._softVideo){M.next=18;break}this._softVideo.appendBuffer(g,b),this._needInitSegment=!1,M.next=28;break;case 18:if(!this._mse){M.next=28;break}return S=!this._sourceCreated,S&&this._createMseSource(g==null?void 0:g.codec,b==null?void 0:b.codec),this._needInitSegment=!1,G=this._mse,X=[],c&&!S&&this._handleCodecChange(g,b).forEach(function(C){return X.push(C)}),g&&(L=g.data,k=ln(g,Ll),X.push(G.append(ce.VIDEO,L,k))),b&&(W=b.data,V=ln(b,El),X.push(G.append(ce.AUDIO,W,V))),M.abrupt("return",Promise.all(X));case 28:case"end":return M.stop()}},i,this)}));function t(i,e,s,n,l,o,u){return a.apply(this,arguments)}return t}()},{key:"removeBuffer",value:function(){var a=re(J().mark(function i(){var e=this,s,n,l,o=arguments;return J().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(s=o.length>0&&o[0]!==void 0?o[0]:0,n=o.length>1&&o[1]!==void 0?o[1]:1/0,l=this.hls.media,!(!this._mse||!l||s<0||n<s||s>=this._mse.duration)){h.next=5;break}return h.abrupt("return");case 5:return h.abrupt("return",this._mse.clearBuffer(s,n).then(function(){return e.hls.emit(F.REMOVE_BUFFER,{start:s,end:n,removeEnd:n})}));case 6:case"end":return h.stop()}},i,this)}));function t(){return a.apply(this,arguments)}return t}()},{key:"evictBuffer",value:function(){var a=re(J().mark(function i(e){var s,n,l,o;return J().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(s=this.hls.media,!(!this._mse||!s||!e||e<0)){h.next=3;break}return h.abrupt("return");case 3:if(n=s.currentTime,l=n-e,!(l<=0)){h.next=7;break}return h.abrupt("return");case 7:if(o=me.start(me.get(s)),!(o+1>=l)){h.next=10;break}return h.abrupt("return");case 10:return h.abrupt("return",this.removeBuffer(0,l));case 11:case"end":return h.stop()}},i,this)}));function t(i){return a.apply(this,arguments)}return t}()},{key:"clearAllBuffer",value:function(){var a=re(J().mark(function i(){return J().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this._mse){s.next=2;break}return s.abrupt("return",this._mse.clearAllBuffer());case 2:case"end":return s.stop()}},i,this)}));function t(){return a.apply(this,arguments)}return t}()},{key:"decryptBuffer",value:function(t,i){return this._decryptor.decrypt(t,i)}},{key:"reset",value:function(){var a=re(J().mark(function i(){var e,s=arguments;return J().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(e=s.length>0&&s[0]!==void 0?s[0]:!1,!(this._mse&&!e)){l.next=8;break}return this._transmuxer=null,this._sourceCreated=!1,l.next=6,this._mse.unbindMedia();case 6:return l.next=8,this._mse.bindMedia(this.hls.media);case 8:this._needInitSegment=!0,this._directAppend=!1;case 10:case"end":return l.stop()}},i,this)}));function t(){return a.apply(this,arguments)}return t}()},{key:"endOfStream",value:function(){var a=re(J().mark(function i(){return J().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!this._mse){s.next=5;break}if(!this._sourceCreated){s.next=5;break}return s.next=4,this._mse.endOfStream();case 4:this.hls.emit(F.BUFFEREOS);case 5:this._softVideo&&this._softVideo.endOfStream();case 6:case"end":return s.stop()}},i,this)}));function t(){return a.apply(this,arguments)}return t}()},{key:"setLiveSeekableRange",value:function(){var a=re(J().mark(function i(e,s){return J().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:this._mse&&this._mse.setLiveSeekableRange(e,s);case 1:case"end":return l.stop()}},i,this)}));function t(i,e){return a.apply(this,arguments)}return t}()},{key:"destroy",value:function(){var a=re(J().mark(function i(){var e;return J().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if((e=this._decryptor)===null||e===void 0||e.destroy(),!this._mse){n.next=4;break}return n.next=4,this._mse.unbindMedia();case 4:this._decryptor=null,this._mse=null,this._softVideo=null;case 7:case"end":return n.stop()}},i,this)}));function t(){return a.apply(this,arguments)}return t}()},{key:"_createMseSource",value:function(t,i){un.debug("create mse source, videoCodec=".concat(t,", audioCodec=").concat(i));var e=this._mse;e&&(t&&(e.createSource(ce.VIDEO,"video/mp4;codecs=".concat(t)),this._sourceCreated=!0),i&&(e.createSource(ce.AUDIO,"audio/mp4;codecs=".concat(i)),this._sourceCreated=!0),this.hls.emit(F.SOURCEBUFFER_CREATED))}},{key:"_handleCodecChange",value:function(t,i){var e=[],s=this._mse,n=[{type:ce.VIDEO,codecs:t==null?void 0:t.codec},{type:ce.AUDIO,codecs:i==null?void 0:i.codec}];return n.filter(function(l){return!!l.codecs}).forEach(function(l){var o=l.type,u=l.codecs,h=s.getSourceBuffer(o);if(h){var d=u.split(",")[0];new RegExp(d,"ig").test(h.mimeType)||e.push(s.changeType(o,"".concat(o,"/mp4;codecs=").concat(u)))}}),e}},{key:"seamlessSwitch",value:function(){this._needInitSegment=!0}},{key:"isFull",value:function(){var t,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ce.VIDEO;return(t=this._mse)===null||t===void 0?void 0:t.isFull(i)}}]),r}();function Gl(r){var a=(r==null?void 0:r.media)||document.createElement("video");return ne(ne({maxPlaylistSize:50,retryCount:3,retryDelay:1e3,pollRetryCount:2,loadTimeout:1e4,manifestLoadTimeout:1e4,preloadTime:30,softDecode:!1,bufferBehind:10,maxJumpDistance:3,startTime:0,useLowLatency:!0,targetLatency:10,maxLatency:20,allowedStreamTrackChange:!0,seiInTime:!1,manifestList:[],minSegmentsStartPlay:3,preferMMS:!1,preferMMSStreaming:!1,mseLowLatency:!0,fixerConfig:{forceFixLargeGap:!1,largeGapThreshold:5}},r),{},{media:a})}var Wl=ke(function r(){Ze(this,r),T(this,"version",0),T(this,"streams",[]),T(this,"isMaster",!0)}),fr={Audio:"AUDIO",Video:"VIDEO",SubTitle:"SUBTITLE",ClosedCaptions:"CLOSED-CAPTIONS"},ri={CLEAR_KEY:"org.w3.clearkey",FAIRPLAY:["urn:uuid:94ce86fb-07ff-4f43-adb8-93d2fa968ca2","com.apple.streamingkeydelivery"],WIDEVINE:["urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha","com.widevine"],PLAYREADY:["urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready"]};function yr(r){for(var a=[],t=0;t<r.length;t++)Array.isArray(r[t])?a=a.concat(yr(r[t])):a.push(r[t]);return a}var bs=ke(function r(){Ze(this,r),T(this,"id",0),T(this,"url",""),T(this,"default",!1),T(this,"autoSelect",!1),T(this,"forced",!1),T(this,"group",""),T(this,"name",""),T(this,"lang",""),T(this,"segments",[]),T(this,"endSN",0)}),wl=function(r){wi(t,r);var a=Vi(t);function t(){var i;Ze(this,t);for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];return i=a.call.apply(a,[this].concat(s)),T(Q(i),"mediaType",fr.Audio),T(Q(i),"channels",0),i}return ke(t)}(bs),Vl=function(r){wi(t,r);var a=Vi(t);function t(){var i;Ze(this,t);for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];return i=a.call.apply(a,[this].concat(s)),T(Q(i),"mediaType",fr.SubTitle),i}return ke(t)}(bs),Rl=ke(function r(){Ze(this,r),T(this,"id",0),T(this,"bitrate",0),T(this,"width",0),T(this,"height",0),T(this,"name",""),T(this,"url",""),T(this,"audioCodec",""),T(this,"videoCodec",""),T(this,"textCodec",""),T(this,"audioGroup",""),T(this,"audioStreams",[]),T(this,"subtitleStreams",[]),T(this,"closedCaptionsStream",[])}),Tl=ke(function r(){Ze(this,r),T(this,"version",0),T(this,"url",""),T(this,"type",""),T(this,"startCC",0),T(this,"endCC",0),T(this,"startSN",0),T(this,"endSN",0),T(this,"totalDuration",0),T(this,"targetDuration",0),T(this,"partTargetDuration",0),T(this,"canSkipUntil",0),T(this,"canSkipDateRanges",!1),T(this,"skippedSegments",0),T(this,"canBlockReload",!1),T(this,"partHoldBack",0),T(this,"live",!0),T(this,"lowLatency",!1),T(this,"endPartIndex",0),T(this,"segments",[])}),ai=function(){function r(a){Ze(this,r),T(this,"sn",0),T(this,"cc",0),T(this,"url",""),T(this,"parentUrl",""),T(this,"title",""),T(this,"start",0),T(this,"duration",0),T(this,"dataTime",""),T(this,"key",null),T(this,"byteRange",null),T(this,"isInitSegment",!1),T(this,"initSegment",null),T(this,"isLast",!1),T(this,"hasAudio",!1),T(this,"hasVideo",!1),T(this,"independent",!1),T(this,"partIndex",0),this.parentUrl=a}return ke(r,[{key:"end",get:function(){return this.start+this.duration}},{key:"setTrackExist",value:function(t,i){this.hasVideo=t,this.hasAudio=i}},{key:"setByteRange",value:function(t,i){this.byteRange=[0];var e=t.split("@");e.length===1&&i&&i.byteRange?(this.byteRange[0]=i.byteRange[1]||0,this.byteRange[0]&&(this.byteRange[0]+=1)):this.byteRange[0]=parseInt(e[1]),this.byteRange[1]=this.byteRange[0]+parseInt(e[0])-1}}]),r}(),xl=function(){function r(a){Ze(this,r),T(this,"method",""),T(this,"url",""),T(this,"iv",null),T(this,"keyFormat",""),T(this,"keyFormatVersions",""),a instanceof r&&(this.method=a.method,this.url=a.url,this.keyFormat=a.keyFormat,this.keyFormatVersions=a.keyFormatVersions,a.iv&&(this.iv=new Uint8Array(a.iv)))}return ke(r,[{key:"clone",value:function(t){var i=new r(this);return t!=null&&i.setIVFromSN(t),i}},{key:"setIVFromSN",value:function(t){if(!this.iv&&this.method==="AES-128"&&typeof t=="number"&&this.url){this.iv=new Uint8Array(16);for(var i=12;i<16;i++)this.iv[i]=t>>8*(15-i)&255}}},{key:"isSegmentEncrypted",value:function(){var t=this.method;return t==="AES-128"}},{key:"isValidKeySystem",value:function(){var t=yr([ri.CLEAR_KEY,ri.FAIRPLAY,ri.WIDEVINE,ri.PLAYREADY]).indexOf(this.keyFormat)>-1;if(!t)return!1;var i=["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)>-1;return!!i}},{key:"isSupported",value:function(){return this.method?this.isSegmentEncrypted()?!0:!!this.isValidKeySystem():!1}}]),r}(),Ml=/^#(EXT[^:]*)(?::(.*))?$/,hn=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g,Cl=/^(?:[a-zA-Z0-9+\-.]+:)?\/\//,Yl=/^((?:[a-zA-Z0-9+\-.]+:)?\/\/[^/?#]*)?([^?#]*\/)?/;function Il(r){return r.split(/[\r\n]/).map(function(a){return a.trim()}).filter(Boolean)}function vr(r){var a=r.match(Ml);if(!(!a||!a[1]))return[a[1].replace("EXT-X-",""),a[2]]}function Et(r){for(var a={},t=hn.exec(r);t;)a[t[1]]=t[2]||t[3],t=hn.exec(r);return a}function _t(r,a){if(!a||!r||Cl.test(r))return r;var t=Yl.exec(a);return t?r[0]==="/"?t[1]+r:t[1]+t[2]+r:r}var _l={audio:[/^mp4a/,/^vorbis$/,/^opus$/,/^flac$/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]};function Ui(r,a){var t=_l[r];if(!(!t||!a||!a.length)){for(var i=0;i<t.length;i++)for(var e=0;e<a.length;e++)if(t[i].test(a[e]))return a[e]}}function Fl(r,a){for(var t=new Wl,i=0,e,s=[],n=[];e=r[i++];){var l=vr(e);if(l){var o=ct(l,2),u=o[0],h=o[1];if(u==="VERSION")t.version=parseInt(h);else if(u==="MEDIA"&&h){var d=Et(h),c=void 0;switch(d.TYPE){case"AUDIO":c=new wl;break;case"SUBTITLES":c=new Vl;break;default:c=new bs}c.url=_t(d.URI,a),c.default=d.DEFAULT==="YES",c.autoSelect=d.AUTOSELECT==="YES",c.group=d["GROUP-ID"],c.name=d.NAME,c.lang=d.LANGUAGE,d.CHANNELS&&(c.channels=Number(d.CHANNELS.split("/")[0]),Number.isNaN(c.channels)&&(c.channels=0)),d.TYPE==="AUDIO"&&d.URI&&s.push(c),d.TYPE==="SUBTITLES"&&n.push(c)}else if(u==="STREAM-INF"&&h){var f=new Rl,y=Et(h);if(f.bitrate=parseInt(y["AVERAGE-BANDWIDTH"]||y.BANDWIDTH),f.name=y.NAME,f.url=_t(r[i++],a),y.RESOLUTION){var g=y.RESOLUTION.split("x"),b=ct(g,2),S=b[0],G=b[1];f.width=parseInt(S),f.height=parseInt(G)}if(y.CODECS){var X=y.CODECS.split(/[ ,]+/).filter(Boolean);f.videoCodec=Ui("video",X),f.audioCodec=Ui("audio",X),f.textCodec=Ui("text",X)}f.audioGroup=y.AUDIO,f.subtitleGroup=y.SUBTITLES,t.streams.push(f)}}}return t.streams.forEach(function(L,k){L.id=k}),s.length&&(s.forEach(function(L,k){L.id=k}),t.streams.forEach(function(L){L.audioGroup&&(L.audioStreams=s.filter(function(k){return k.group===L.audioGroup}))})),n.length&&(n.forEach(function(L,k){L.id=k}),t.streams.forEach(function(L){L.subtitleGroup&&(L.subtitleStreams=n.filter(function(k){return k.group===L.subtitleGroup}))})),t}function Kl(r,a,t){var i=new Tl;i.url=a;for(var e=new ai(a),s=null,n=null,l=0,o=0,u=0,h=0,d,c=!1,f=0;d=r[h++];){if(d[0]!=="#"){if(i.lowLatency){o++;continue}e.sn=o,e.cc=u,e.url=_t(d,a),n&&(e.key=n.clone(o)),s&&(e.initSegment=s),i.segments.push(e),e=new ai(a),o++;continue}var y=vr(d);if(y){var g=ct(y,2),b=g[0],S=g[1];switch(b){case"VERSION":i.version=parseInt(S);break;case"PLAYLIST-TYPE":i.type=S==null?void 0:S.toUpperCase();break;case"TARGETDURATION":i.targetDuration=parseFloat(S);break;case"PART-INF":{t&&(i.lowLatency=!0);var G=Et(S);G["PART-TARGET"]&&(i.partTargetDuration=parseFloat(G["PART-TARGET"]))}break;case"SERVER-CONTROL":{var X=Et(S);i.canBlockReload=X["CAN-BLOCK-RELOAD"]==="YES",i.partHoldBack=parseFloat(X["PART-HOLD-BACK"]||0),i.canSkipUntil=parseFloat(X["CAN-SKIP-UNTIL"]||0),i.canSkipDateRanges=X["CAN-SKIP-DATERANGES"]==="YES"}break;case"ENDLIST":c=!0;break;case"MEDIA-SEQUENCE":o=i.startSN=parseInt(S);break;case"DISCONTINUITY-SEQUENCE":u=i.startCC=parseInt(S);break;case"DISCONTINUITY":u++;break;case"BYTERANGE":e.setByteRange(S,i.segments[i.segments.length-1]);break;case"PART":{if(!i.lowLatency)break;var L=Et(S);e.duration=parseFloat(L.DURATION),e.independent=L.INDEPENDENT==="YES",e.sn=o,e.cc=u,e.partIndex=f,e.start=l,e.duration=parseFloat(L.DURATION),l+=e.duration,e.url=_t(L.URI,a),n&&(e.key=n.clone(o)),s&&(e.initSegment=s),i.segments.push(e),e=new ai(a),f++}break;case"PRELOAD-HINT":break;case"PROGRAM-DATE-TIME":e.dataTime=S;break;case"EXTINF":{if(i.lowLatency){f=0;break}var k=S.split(","),W=ct(k,2),V=W[0],w=W[1];e.start=l,e.duration=parseFloat(V),l+=e.duration,e.title=w}break;case"KEY":{var M=Et(S);if(M.METHOD==="NONE"){n=null;break}if(n=new xl,n.method=M.METHOD,n.url=/^blob:/.test(M.URI)?M.URI:_t(M.URI,a),n.keyFormat=M.KEYFORMAT||"identity",n.keyFormatVersions=M.KEYFORMATVERSIONS,!n.isSupported())throw new Error("encrypt ".concat(M.METHOD,"/").concat(M.KEYFORMAT," is not supported"));if(M.IV){var C=M.IV.slice(2);C=(C.length&1?"0":"")+C,n.iv=new Uint8Array(C.length/2);for(var U=0,m=C.length/2;U<m;U++)n.iv[U]=parseInt(C.slice(U*2,U*2+2),16)}}break;case"MAP":{var p=Et(S);e.url=_t(p.URI,a),p.BYTERANGE&&e.setByteRange(p.BYTERANGE),e.isInitSegment=!0,e.sn=0,n&&(e.key=n.clone(0)),s=e,e=new ai(a)}break}}}i.segments=i.segments.filter(function(E){return E.duration!==0});var v=i.segments[i.segments.length-1];return v&&(c&&(v.isLast=!0),i.endSN=v.sn,i.endPartIndex=v.partIndex),c&&(i.live=!1),i.totalDuration=l,i.endCC=u,i}var li=function(){function r(){Ze(this,r)}return ke(r,null,[{key:"parse",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1?arguments[1]:void 0,e=arguments.length>2?arguments[2]:void 0;if(!t.includes("#EXTM3U"))throw new Error("Invalid m3u8 file");var s=Il(t);return r.isMediaPlaylist(t)?Kl(s,i,e):Fl(s,i)}},{key:"isMediaPlaylist",value:function(t){return t.includes("#EXTINF:")||t.includes("#EXT-X-TARGETDURATION:")}}]),r}(),Dl=function(){function r(a){var t=this;Ze(this,r),T(this,"_emitOnLoaded",function(o,u){var h=o.response,d=o.options,c=d||{},f=c.firstByteTime,y=c.startTime,g=c.endTime,b=c.contentLength,S=g-y;t.hls.emit(F.SPEED,{time:S,byteLength:b,url:u}),t.hls.emit(F.LOAD_COMPLETE,{url:u,elapsed:S||0}),t.hls.emit(F.TTFB,{url:u,responseUrl:h.url,elapsed:f-y}),t.hls.emit(F.LOAD_RESPONSE_HEADERS,{headers:h.headers,url:u})}),T(this,"_onLoaderRetry",function(o,u){t.hls.emit(te.LOAD_RETRY,{error:oe.network(o),retryTime:u})}),this.hls=a,this._timer=null,this._useLowLatency=a.config.useLowLatency;var i=this.hls.config,e=i.retryCount,s=i.retryDelay,n=i.manifestLoadTimeout,l=i.fetchOptions;this._loader=new ft(ne(ne({},l),{},{responseType:"text",retry:e,retryDelay:s,timeout:n,onRetryError:this._onLoaderRetry})),this._audioLoader=new ft(ne(ne({},l),{},{responseType:"text",retry:e,retryDelay:s,timeout:n,onRetryError:this._onLoaderRetry})),this._subtitleLoader=new ft(ne(ne({},l),{},{responseType:"text",retry:e,retryDelay:s,timeout:n,onRetryError:this._onLoaderRetry}))}return ke(r,[{key:"load",value:function(){var a=re(J().mark(function i(e,s,n){var l,o,u,h,d,c,f,y,g,b,S,G,X,L,k,W,V,w,M,C;return J().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return l=[this._loader.load(e)],s&&l.push(this._audioLoader.load(s)),n&&l.push(this._subtitleLoader.load(n)),m.prev=3,m.next=6,Promise.all(l);case 6:if(y=m.sent,g=ct(y,3),b=g[0],S=g[1],G=g[2],b){m.next=13;break}return m.abrupt("return",[]);case 13:this._emitOnLoaded(b,e),o=b.data,d=b.response.url||e,s?(u=S==null?void 0:S.data,h=G==null?void 0:G.data,c=(S==null||(X=S.response)===null||X===void 0?void 0:X.url)||s,f=(G==null||(L=G.response)===null||L===void 0?void 0:L.url)||n,u&&this._emitOnLoaded(S,s),h&&this._emitOnLoaded(G,n)):(h=S==null?void 0:S.data,f=(S==null||(k=S.response)===null||k===void 0?void 0:k.url)||n,h&&this._emitOnLoaded(S,n)),m.next=22;break;case 19:throw m.prev=19,m.t0=m.catch(3),oe.network(m.t0);case 22:if(W=this.hls.config.onPreM3U8Parse,m.prev=23,W&&(o=W(o)||o,u&&(u=W(u,!0)||u),h&&(h=W(h,!0)||h)),V=li.parse(o,d,this._useLowLatency),!(((C=V)===null||C===void 0?void 0:C.live)===!1&&V.segments&&!V.segments.length)){m.next=28;break}throw new Error("empty segments list");case 28:u&&(w=li.parse(u,c,this._useLowLatency)),h&&(M=li.parse(h,f,this._useLowLatency)),m.next=35;break;case 32:throw m.prev=32,m.t1=m.catch(23),new oe(N.MANIFEST,N.SUB_TYPES.HLS,m.t1);case 35:return V&&(V.isMaster?this.hls.emit(te.HLS_MANIFEST_LOADED,{playlist:V}):this.hls.emit(te.HLS_LEVEL_LOADED,{playlist:V})),m.abrupt("return",[V,w,M]);case 37:case"end":return m.stop()}},i,this,[[3,19],[23,32]])}));function t(i,e,s){return a.apply(this,arguments)}return t}()},{key:"parseText",value:function(t,i){var e=this.hls.config.onPreM3U8Parse,s;try{var n;if(e&&(t=e(t)||t),s=li.parse(t,i,this._useLowLatency),((n=s)===null||n===void 0?void 0:n.live)===!1&&s.segments&&!s.segments.length)throw new Error("empty segments list")}catch(l){throw new oe(N.MANIFEST,N.SUB_TYPES.HLS,l)}return s&&(s.isMaster?this.hls.emit(te.HLS_MANIFEST_LOADED,{playlist:s}):this.hls.emit(te.HLS_LEVEL_LOADED,{playlist:s})),[s]}},{key:"poll",value:function(t,i,e,s,n,l){var o=this;clearTimeout(this._timer),l=l||3e3;var u=this.hls.config.pollRetryCount,h=function(){var d=re(J().mark(function c(){var f;return J().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return clearTimeout(o._timer),g.prev=1,g.next=4,o.load(t,i,e);case 4:if(f=g.sent,f[0]){g.next=7;break}return g.abrupt("return");case 7:u=o.hls.config.pollRetryCount,s(f[0],f[1],f[2]),g.next=15;break;case 11:g.prev=11,g.t0=g.catch(1),u--,u<=0&&n(g.t0);case 15:o._timer=setTimeout(h,l);case 16:case"end":return g.stop()}},c,null,[[1,11]])}));return function(){return d.apply(this,arguments)}}();this._timer=setTimeout(h,l)}},{key:"stopPoll",value:function(){return clearTimeout(this._timer),this.cancel()}},{key:"cancel",value:function(){return Promise.all([this._loader.cancel(),this._audioLoader.cancel()])}}]),r}();function br(r,a,t){return a>t&&(t=a),Math.min(Math.max(r,a),t)}var zi=new Te("playlist"),dn=function(){function r(a,t,i){Ze(this,r),T(this,"live",void 0),T(this,"id",0),T(this,"bitrate",0),T(this,"width",0),T(this,"height",0),T(this,"name",""),T(this,"url",""),T(this,"audioCodec",""),T(this,"videoCodec",""),T(this,"textCodec",""),T(this,"startCC",0),T(this,"endCC",0),T(this,"startSN",0),T(this,"endSN",-1),T(this,"totalDuration",0),T(this,"targetDuration",0),T(this,"partTargetDuration",0),T(this,"canSkipUntil",0),T(this,"canSkipDateRanges",!1),T(this,"skippedSegments",0),T(this,"canBlockReload",!1),T(this,"partHoldBack",0),T(this,"lowLatency",!1),T(this,"endPartIndex",0),T(this,"snDiff",null),T(this,"segments",[]),T(this,"audioStreams",[]),T(this,"subtitleStreams",[]),T(this,"closedCaptions",[]),T(this,"currentAudioStream",null),T(this,"currentSubtitleStream",null),this.update(this._setLLPlaybackPoint(a),t,i)}return ke(r,[{key:"lastSegment",get:function(){return this.segments.length?this.segments[this.segments.length-1]:null}},{key:"segmentDuration",get:function(){var t;return this.targetDuration||((t=this.segments[0])===null||t===void 0?void 0:t.duration)||0}},{key:"liveEdge",get:function(){return this.endTime},set:function(t){this.endTime=t}},{key:"endTime",get:function(){var t;return((t=this.lastSegment)===null||t===void 0?void 0:t.end)||0},set:function(t){var i=this.lastSegment;i&&(i.duration=t-i.start)}},{key:"currentSubtitleEndSn",get:function(){var t;return((t=this.currentSubtitleStream)===null||t===void 0?void 0:t.endSN)||0}},{key:"clearOldSegment",value:function(t,i){return this.currentAudioStream&&this._clearSegments(t,i),this._clearSegments(t,i)}},{key:"getAudioSegment",value:function(t){if(!(!t||!this.currentAudioStream)){var i=t.sn-this.snDiff;return this.currentAudioStream.segments.find(function(e){return e.sn===i})}}},{key:"update",value:function(t,i){this.url=t.url,Array.isArray(t.segments)?((this.live===null||this.live===void 0)&&(this.live=t.live),this._updateSegments(t,this),this.startCC=t.startCC,this.endCC=t.endCC,this.startSN=t.startSN,this.endSN=t.endSN||-1,this.totalDuration=t.totalDuration,this.targetDuration=t.targetDuration,this.live=t.live,this.lowLatency=t.lowLatency,this.canBlockReload=t.canBlockReload,this.canSkipDateRanges=t.canSkipDateRanges,this.canSkipUntil=t.canSkipUntil,this.partHoldBack=t.partHoldBack,this.partTargetDuration=t.partTargetDuration,this.skippedSegments=t.skippedSegments,this.endPartIndex=t.endPartIndex,i&&this.currentAudioStream&&Array.isArray(i.segments)&&(this._updateSegments(i,this.currentAudioStream),(this.snDiff===null||this.snDiff===void 0)&&t.segments.length&&i.segments.length&&(this.snDiff=t.segments[0].sn-i.segments[0].sn))):(this.id=t.id,this.bitrate=t.bitrate,this.width=t.width,this.height=t.height,this.name=t.name,this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.textCodec=t.textCodec,this.audioStreams=t.audioStreams,this.subtitleStreams=t.subtitleStreams,!this.currentAudioStream&&this.audioStreams.length&&(this.currentAudioStream=this.audioStreams.find(function(e){return e.default})||this.audioStreams[0]),!this.currentSubtitleStream&&this.subtitleStreams.length&&(this.currentSubtitleStream=this.subtitleStreams.find(function(e){return e.default})||this.subtitleStreams[0]))}},{key:"updateSubtitle",value:function(t){var i=this;if(t&&this.currentSubtitleStream&&Array.isArray(t.segments)){var e=this._updateSegments(t,this.currentSubtitleStream),s=this.currentSubtitleStream.segments;if(s.length>100&&(this.currentSubtitleStream.segments=s.slice(100)),!!e)return e.map(function(n){return{sn:n.sn,url:n.url,duration:n.duration,start:n.start,end:n.end,lang:i.currentSubtitleStream.lang}})}}},{key:"switchSubtitle",value:function(t){var i=this.subtitleStreams.find(function(s){return s.lang===t}),e=this.currentSubtitleStream;i&&(this.currentSubtitleStream=i,e.segments=[])}},{key:"_setLLPlaybackPoint",value:function(t){if(!t.lowLatency||!t.segments.length)return t;for(var i=t.totalDuration-t.partHoldBack,e=t.segments,s=0,n=0,l=e.length;n<l;n++)e[n].start<=i&&e[n].independent&&(s=n);var o=e.slice(s),u=0;return o.forEach(function(h){h.start=u,u=h.end}),t.segments=o,t.totalDuration=u,t.startSN=o[0].sn,t.startCC=o[0].cc,zi.log("set ll-hls playback point: SN=".concat(t.startSN," partIndex=").concat(o[0].partIndex,", duration=").concat(u)),t}},{key:"_clearSegments",value:function(t,i){for(var e=0,s=this.segments,n=0,l=s.length;n<l;n++)if(s[n].end>=t){e=n;break}return e>i&&(e=i),e&&(this.segments=this.segments.slice(e),this.currentAudioStream&&(this.currentAudioStream.segments=this.currentAudioStream.segments.slice(e))),i-e}},{key:"_updateSegments",value:function(t,i){var e=i.segments;if(this.live){var s,n=t.lowLatency,l=e[e.length-1],o=(s=l==null?void 0:l.sn)!==null&&s!==void 0?s:-1,u=(l==null?void 0:l.partIndex)||0,h=o<t.endSN&&t.segments.length;if(n&&(h=h||u<t.endPartIndex),h){zi.log("update segments: endSN:".concat(o,", partIndex:").concat(u," --> endSN:").concat(t.endSN,", partIndex:").concat(t.endPartIndex));var d=t.segments.findIndex(function(b){return b.sn===o&&b.partIndex===u}),c=d<0?t.segments:t.segments.slice(d+1);if(e.length&&c.length){var f=l.end,y=f;c.forEach(function(b){b.start=f,f=b.end}),zi.log("liveEdge: ".concat(y," -> ").concat(f));var g=(l==null?void 0:l.cc)||-1;g>c[0].cc&&c.forEach(function(b){return b.cc+=g})}return i.endSN=t.endSN,i.segments=e.concat(c),c}}else i.segments=t.segments}}]),r}(),Pl=function(){function r(a){Ze(this,r),T(this,"streams",[]),T(this,"currentStream",null),T(this,"dvrWindow",0),T(this,"_segmentPointer",-1),this.hls=a}return ke(r,[{key:"lowLatency",get:function(){var t;return(t=this.currentStream)===null||t===void 0?void 0:t.lowLatency}},{key:"lastSegment",get:function(){var t;return(t=this.currentStream)===null||t===void 0?void 0:t.lastSegment}},{key:"currentSegment",get:function(){var t;return(t=this.currentSegments)===null||t===void 0?void 0:t[this._segmentPointer]}},{key:"nextSegment",get:function(){var t;return(t=this.currentSegments)===null||t===void 0?void 0:t[this._segmentPointer+1]}},{key:"currentSegments",get:function(){var t;return(t=this.currentStream)===null||t===void 0?void 0:t.segments}},{key:"currentSubtitleEndSn",get:function(){var t;return(t=this.currentStream)===null||t===void 0?void 0:t.currentSubtitleEndSn}},{key:"liveEdge",get:function(){var t;return(t=this.currentStream)===null||t===void 0?void 0:t.liveEdge},set:function(t){this.currentStream&&(this.currentStream.liveEdge=t)}},{key:"totalDuration",get:function(){var t;return((t=this.currentStream)===null||t===void 0?void 0:t.totalDuration)||0}},{key:"seekRange",get:function(){var t=this.currentSegments;if(!(!t||!t.length))return[t[0].start,t[t.length-1].end]}},{key:"nbSegments",get:function(){var t;return((t=this.currentSegments)===null||t===void 0?void 0:t.length)||0}},{key:"isEmpty",get:function(){var t;return!((t=this.currentSegments)!==null&&t!==void 0&&t.length)}},{key:"isLive",get:function(){var t;return(t=this.currentStream)===null||t===void 0?void 0:t.live}},{key:"hadSegmentLoaded",get:function(){return this._segmentPointer!==-1}},{key:"hasSubtitle",get:function(){var t;return!!((t=this.currentStream)!==null&&t!==void 0&&t.currentSubtitleStream)}},{key:"getAudioSegment",value:function(t){var i;return(i=this.currentStream)===null||i===void 0?void 0:i.getAudioSegment(t)}},{key:"moveSegmentPointer",value:function(t){var i;t==null&&(t=this._segmentPointer+1),this._segmentPointer=br(t,-1,(i=this.currentSegments)===null||i===void 0?void 0:i.length)}},{key:"reset",value:function(){this.streams=[],this.currentStream=null,this.dvrWindow=0,this._segmentPointer=-1}},{key:"getSegmentByIndex",value:function(t){var i;return(i=this.currentSegments)===null||i===void 0?void 0:i[t]}},{key:"setNextSegmentByIndex",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this._segmentPointer=t-1}},{key:"setNextSegmentBySN",value:function(){var t,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=(t=this.currentSegments)===null||t===void 0?void 0:t.findIndex(function(s){return s.sn===i});return e!==-1&&this.setNextSegmentByIndex(e+1),e}},{key:"findSegmentIndexByTime",value:function(t){var i=this.currentSegments;if(i){for(var e=0,s=i.length,n;e<s;e++)if(n=i[e],t>=n.start&&t<n.end)return e;var l=i[i.length-1];if(Math.abs(t-(l==null?void 0:l.end))<.2)return i.length-1}}},{key:"upsertPlaylist",value:function(t,i,e){var s=this;if(t){if(t.isMaster)this.streams.length=t.streams.length,t.streams.filter(function(u){return u.url}).forEach(function(u,h){s.streams[h]?s.streams[h].update(u):s.streams[h]=new dn(u)}),this.currentStream=this.streams[0];else if(Array.isArray(t.segments)){var n=this.currentStream;if(n){n.update(t,i,e);var l=n.updateSubtitle(e);l&&this.hls.emit(te.SUBTITLE_SEGMENTS,{list:l})}else this.reset(),this.currentStream=this.streams[0]=new dn(t,i,e)}var o=this.currentStream;o&&this.hls.isLive&&!this.dvrWindow&&(this.dvrWindow=this.currentSegments.reduce(function(u,h){return u+=h.duration,u},0))}}},{key:"updateSegmentsRanges",value:function(t,i){var e,s=(e=this.currentSegments)===null||e===void 0?void 0:e.filter(function(n){return n.sn>=t});s.forEach(function(n){n.start=i,i=n.end})}},{key:"switchSubtitle",value:function(t){var i;(i=this.currentStream)===null||i===void 0||i.switchSubtitle(t)}},{key:"clearOldSegment",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,i=this.currentStream;if(!(!this.dvrWindow||!i)){var e=i.endTime-this.dvrWindow;if(!(e<=0)){var s=i.segments;s.length<=t||(this._segmentPointer=i.clearOldSegment(e,this._segmentPointer))}}}},{key:"checkSegmentTrackChange",value:function(t,i){var e=this.findSegmentIndexByTime(t),s=this.getSegmentByIndex(e);if(s&&!(!s.hasAudio&&!s.hasVideo)){if(i!==2&&s.hasAudio&&s.hasVideo)return s;if(!(s.end-t>.3)){var n=this.getSegmentByIndex(e+1);if(n&&!(!n.hasAudio&&!n.hasVideo)&&(n.hasAudio!==s.hasAudio||n.hasVideo!==s.hasVideo))return n}}}},{key:"feedbackLiveEdge",value:function(t,i){var e,s=this.currentSegments;if(s){var n=((e=this.lastSegment)===null||e===void 0?void 0:e.sn)===t.sn;if(n){this.liveEdge=i;return}this.updateSegmentsRanges(t.sn+1,i)}}}]),r}(),Hl=function(){function r(a){var t=this;Ze(this,r),T(this,"error",null),T(this,"_emitOnLoaded",function(o,u){var h=o.data,d=o.response,c=o.options,f=c||{},y=f.firstByteTime,g=f.startTime,b=f.endTime,S=f.contentLength,G=b-g;t._bandwidthService.addRecord(S||h.byteLength,G),t.hls.emit(F.SPEED,{time:G,byteLength:S,url:u}),t.hls.emit(F.LOAD_COMPLETE,{url:u,elapsed:G||0}),t.hls.emit(F.TTFB,{url:u,responseUrl:d.url,elapsed:y-g}),t.hls.emit(F.LOAD_RESPONSE_HEADERS,{headers:d.headers,url:u})}),T(this,"_onLoaderRetry",function(o,u){t.hls.emit(F.LOAD_RETRY,{error:oe.network(o),retryTime:u})}),this.hls=a,this._bandwidthService=new Pn,this._mapCache={},this._keyCache={};var i=this.hls.config,e=i.retryCount,s=i.retryDelay,n=i.loadTimeout,l=i.fetchOptions;this._segmentLoader=new ft(ne(ne({},l),{},{responseType:"arraybuffer",retry:e,retryDelay:s,timeout:n,onRetryError:this._onLoaderRetry})),this._audioSegmentLoader=new ft(ne(ne({},l),{},{responseType:"arraybuffer",retry:e,retryDelay:s,timeout:n,onRetryError:this._onLoaderRetry})),this._keyLoader=new ft(ne(ne({},l),{},{responseType:"arraybuffer",retry:e,retryDelay:s,timeout:n,onRetryError:this._onLoaderRetry}))}return ke(r,[{key:"speedInfo",value:function(){return{speed:this._bandwidthService.getLatestSpeed(),avgSpeed:this._bandwidthService.getAvgSpeed()}}},{key:"load",value:function(t,i,e){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e,n=[];return t&&(n[0]=this.loadVideoSegment(t,e)),i&&(n[1]=this.loadAudioSegment(i,s)),Promise.all(n)}},{key:"loadVideoSegment",value:function(t,i){return this._loadSegment(this._segmentLoader,t,i)}},{key:"loadAudioSegment",value:function(t,i){return this._loadSegment(this._audioSegmentLoader,t,i)}},{key:"_loadSegment",value:function(){var a=re(J().mark(function i(e,s,n){var l=this,o,u,h,d,c,f,y,g,b,S,G,X,L,k,W;return J().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return y=[],this.hls.emit(F.LOAD_START,{url:s.url}),y[0]=e.load(s.url),n&&s.initSegment&&(b=s.initSegment.url,u=this._mapCache[b],u||(this.hls.emit(F.LOAD_START,{url:b}),y[1]=e.load(b).then(function(M){if(M){var C=Object.keys(l._mapCache);C>30&&(l._mapCache={}),u=l._mapCache[b]=M.data,l._emitOnLoaded(M,b)}})),S=(g=s.initSegment.key)===null||g===void 0?void 0:g.url,S&&(f=s.initSegment.key.iv,c=this._keyCache[S],c||(this.hls.emit(F.LOAD_START,{url:S}),y[2]=this._keyLoader.load(S).then(function(M){M&&(c=l._keyCache[S]=M.data,l._emitOnLoaded(M,S))})))),G=(o=s.key)===null||o===void 0?void 0:o.url,G&&s.key.isSegmentEncrypted()&&(d=s.key.iv,h=this._keyCache[G],h||(this.hls.emit(F.LOAD_START,{url:G}),y[3]=this._keyLoader.load(G).then(function(M){M&&(h=l._keyCache[G]=M.data,l._emitOnLoaded(M,G))}))),w.next=8,Promise.all(y);case 8:if(X=w.sent,L=ct(X,1),k=L[0],k){w.next=13;break}return w.abrupt("return");case 13:return W=k.data,this._emitOnLoaded(k,s.url),w.abrupt("return",{data:W,map:u,key:h,mapKey:c,keyIv:d,mapKeyIv:f});case 16:case"end":return w.stop()}},i,this)}));function t(i,e,s){return a.apply(this,arguments)}return t}()},{key:"reset",value:function(){this.error=null,this._mapCache={},this._keyCache={},this._bandwidthService.reset()}},{key:"cancel",value:function(){var a=re(J().mark(function i(){return J().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Promise.all([this._keyLoader.cancel(),this._segmentLoader.cancel(),this._audioSegmentLoader.cancel()]);case 2:case"end":return s.stop()}},i,this)}));function t(){return a.apply(this,arguments)}return t}()}]),r}(),xe=new Te("hls"),Pt=function(r){wi(t,r);var a=Vi(t);function t(i){var e;return Ze(this,t),e=a.call(this),T(Q(e),"version",t.version),T(Q(e),"media",null),T(Q(e),"config",null),T(Q(e),"_manifestLoader",null),T(Q(e),"_segmentLoader",null),T(Q(e),"_playlist",null),T(Q(e),"_bufferService",null),T(Q(e),"_gapService",null),T(Q(e),"_seiService",null),T(Q(e),"_stats",null),T(Q(e),"_prevSegSn",null),T(Q(e),"_prevSegCc",null),T(Q(e),"_tickTimer",null),T(Q(e),"_tickInterval",500),T(Q(e),"_segmentProcessing",!1),T(Q(e),"_reloadOnPlay",!1),T(Q(e),"_switchUrlOpts",null),T(Q(e),"_isProcessQuotaExceeded",!1),T(Q(e),"_loadSegment",re(J().mark(function s(){var n,l,o,u,h,d,c,f,y;return J().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(!(e._segmentProcessing||!e.media)){b.next=2;break}return b.abrupt("return");case 2:if(n=e._playlist,l=n.nextSegment,o=n.lastSegment,u=Q(e),h=u.config,d=.016,c=Math.min(Math.max((o==null?void 0:o.duration)-d/2||0,d),.1),l){b.next=8;break}return b.abrupt("return");case 8:if(e.isLive){b.next=18;break}if(f=e.bufferInfo(),e.media.paused&&!e.media.currentTime&&(f=e.bufferInfo(f.nextStart||.5)),y=Math.abs(f.end-e.media.duration)<c,!(f.remaining>=h.preloadTime||y)){b.next=15;break}return e._tryEos(),b.abrupt("return");case 15:if(!(h.preferMMSStreaming&&!e._bufferService.msStreaming)){b.next=17;break}return b.abrupt("return");case 17:!e._urlSwitching&&e._prevSegSn!==l.sn-1&&f.end&&Math.abs(l.start-f.end)>1&&e._playlist.setNextSegmentByIndex(e._playlist.findSegmentIndexByTime(f.end+.1));case 18:return b.abrupt("return",e._loadSegmentDirect());case 19:case"end":return b.stop()}},s)}))),T(Q(e),"_onLoadeddata",function(){e.isLive&&!e.config.mseLowLatency&&e.media.duration!==1/0&&e._bufferService.updateDuration(1/0).catch(function(s){})}),T(Q(e),"_onPlay",re(J().mark(function s(){return J().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(e.media.seeking&&e.media.currentTime===0)){l.next=3;break}return xe.debug("replay currentTime 0, return"),l.abrupt("return");case 3:if(clearTimeout(e._disconnectTimer),!e._reloadOnPlay){l.next=9;break}e._reloadOnPlay=!1,e.replay(!0),l.next=12;break;case 9:return l.next=11,e._loadSegment();case 11:e._startTick();case 12:case"end":return l.stop()}},s)}))),T(Q(e),"_onPause",function(){if(e.isLive){if(!e._reloadOnPlay){var s=e.config.disconnectTime;if(s==null&&(s=e._playlist.dvrWindow),!Number.isFinite(s))return;clearTimeout(e._disconnectTimer),e._disconnectTimer=setTimeout(function(){e._reloadOnPlay=!0,e._clear()},s||0)}}else e._stopTick()}),T(Q(e),"_onSeeking",re(J().mark(function s(){var n,l,o,u,h,d,c;return J().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(e.media){y.next=2;break}return y.abrupt("return");case 2:if(e._onCheckQuotaExceeded(),n=e.media.currentTime,l=e._playlist.seekRange,!l){y.next=10;break}if(o=br(n,l[0],e.isLive?l[1]:e.media.duration),!(o>=0&&Math.abs(n-o)>=.1)){y.next=10;break}return e.media.currentTime=o,y.abrupt("return");case 10:if(u=e._playlist.currentSegment,h=me.info(me.get(e.media),n,.1),!u){y.next=17;break}if(!(h.end&&Math.abs(h.end-u.end)<.2)){y.next=15;break}return y.abrupt("return");case 15:if(!(e.isLive&&h.end)){y.next=17;break}return y.abrupt("return");case 17:if(d=e._playlist.findSegmentIndexByTime(n),c=e._playlist.getSegmentByIndex(d),!(d==null||!c||e._segmentProcessing&&c===e._playlist.nextSegment)){y.next=21;break}return y.abrupt("return");case 21:return xe.debug("seek to",n,c),e._playlist.setNextSegmentByIndex(d),e._stopTick(),y.next=26,e._segmentLoader.cancel();case 26:if(e._segmentProcessing=!1,!(!h.end||e.isLive)){y.next=30;break}return y.next=30,e._loadSegmentDirect(!0);case 30:e._startTick();case 31:case"end":return y.stop()}},s)}))),T(Q(e),"_onTimeupdate",function(){if(e.media){var s=e.config;if(s.isLive&&s.maxLatency&&s.targetLatency&&e.media){var n=e._playlist.liveEdge;if(!n)return;var l=n-e.media.currentTime;l>=s.maxLatency&&(xe.debug("latency jump, currentTime:".concat(e.media.currentTime,", liveEdge:").concat(n,",  latency=").concat(l)),e.media.currentTime=n-s.targetLatency)}if(s.seiInTime){var o;(o=e._seiService)===null||o===void 0||o.throw(e.media.currentTime)}e.config.allowedStreamTrackChange&&!e.config.softDecode&&e._checkStreamTrackChange(e.media.currentTime)}}),T(Q(e),"_tick",function(){if(e.media){e._startTick();var s=e.media,n=me.get(s),l=e._segmentLoader.error;if(e._onCheckQuotaExceeded(),e._isProcessQuotaExceeded&&(e._bufferService.isFull()||(e._isProcessQuotaExceeded=!1,e._segmentProcessing=!1)),l){var o=.5;(!s.readyState||e.bufferInfo(o).remaining<1)&&(l.fatal=!0,e._emitError(oe.network(l)));return}me.end(n)>=.1&&s.readyState&&(_n(s)?(e._loadSegment(),e._gapService&&e._gapService.do(s,e.config.maxJumpDistance,e.isLive)):s.readyState<2&&e._gapService&&e._gapService.do(s,e.config.maxJumpDistance,s.currentTime?e.isLive:!0)),e.isLive||e._tryEos()}}),e.config=i=Gl(i),e.media=e.config.media,e._manifestLoader=new Dl(Q(e)),e._segmentLoader=new Hl(Q(e)),e._playlist=new Pl(Q(e)),e._bufferService=new Xl(Q(e)),i.seiInTime&&(e._seiService=new Dn(Q(e))),i.softDecode||(e._gapService=new Kn),e._stats=new Hn(Q(e),9e4),e.media.addEventListener("loadeddata",e._onLoadeddata),e.media.addEventListener("play",e._onPlay),e.media.addEventListener("pause",e._onPause),e.media.addEventListener("seeking",e._onSeeking),e.media.addEventListener("timeupdate",e._onTimeupdate),e}return ke(t,[{key:"isLive",get:function(){return this._playlist.isLive}},{key:"streams",get:function(){return this._playlist.streams}},{key:"currentStream",get:function(){return this._playlist.currentStream}},{key:"hasSubtitle",get:function(){return this._playlist.hasSubtitle}},{key:"totalDuration",get:function(){return this._playlist.totalDuration}},{key:"baseDts",get:function(){var e;return(e=this._bufferService)===null||e===void 0?void 0:e.baseDts}},{key:"speedInfo",value:function(){return this._segmentLoader.speedInfo()}},{key:"bufferInfo",value:function(){var e,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:.1;return me.info(me.get(this.media),(e=this.media)===null||e===void 0?void 0:e.currentTime,s)}},{key:"getStats",value:function(){return this._stats.getStats()}},{key:"playbackQuality",value:function(){return Fn(this.media)}},{key:"load",value:function(){var i=re(J().mark(function s(n){var l,o=arguments;return J().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return l=o.length>1&&o[1]!==void 0?o[1]:!1,n&&(this.config.url=n),n=this.config.url,h.next=5,this._reset(l);case 5:return h.next=7,this._loadData(n);case 7:this._startTick();case 8:case"end":return h.stop()}},s,this)}));function e(s){return i.apply(this,arguments)}return e}()},{key:"_loadData",value:function(){var i=re(J().mark(function s(n){var l,o,u,h,d,c,f,y,g,b,S;return J().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:try{n&&(n=n.trim())}catch{}if(n){X.next=3;break}throw this._emitError(new oe(N.OTHER,N.SUB_TYPES.OPTION,null,null,"m3u8 url is missing"));case 3:return X.next=5,this._loadM3U8(n);case 5:if(l=X.sent,o=this._playlist.currentStream,!(this._urlSwitching&&!this.isLive)){X.next=17;break}if(o.bitrate===0&&(u=this._switchUrlOpts)!==null&&u!==void 0&&u.bitrate&&(o.bitrate=(h=this._switchUrlOpts)===null||h===void 0?void 0:h.bitrate),d=this._getSeamlessSwitchPoint(),this.config.startTime=d,c=this._playlist.findSegmentIndexByTime(d),f=this._playlist.getSegmentByIndex(c+1),!f){X.next=17;break}return y=f.start,X.next=17,this._bufferService.removeBuffer(y);case 17:if(this._urlSwitching&&this.isLive&&(g=this._playlist.setNextSegmentBySN(this._prevSegSn),xe.log("segment nb=".concat(this._prevSegSn," index of ").concat(g," in the new playlist")),g===-1&&(this._prevSegCc=null,this._prevSegSn=null)),l){X.next=20;break}return X.abrupt("return");case 20:if(!this.isLive){X.next=31;break}if(this._bufferService.setLiveSeekableRange(0,4294967295),xe.log("totalDuration first time got:",this._playlist.totalDuration),xe.log("nb segments got:",this._playlist.nbSegments),this.config.targetLatency<this._playlist.totalDuration&&(this.config.targetLatency=this._playlist.totalDuration,this.config.maxLatency=1.5*this.config.targetLatency),l.isMaster||this._pollM3U8(n),!(this._playlist.nbSegments<this.config.minSegmentsStartPlay)){X.next=28;break}return X.abrupt("return");case 28:return X.next=30,this._loadSegment();case 30:return X.abrupt("return");case 31:return X.next=33,this._bufferService.updateDuration(o.totalDuration);case 33:return b=this.config.startTime,b&&((S=this._switchUrlOpts)!==null&&S!==void 0&&S.seamless||(this.media.currentTime=b),this._playlist.setNextSegmentByIndex(this._playlist.findSegmentIndexByTime(b)||0)),X.next=37,this._loadSegment();case 37:case"end":return X.stop()}},s,this)}));function e(s){return i.apply(this,arguments)}return e}()},{key:"replay",value:function(){var i=re(J().mark(function s(n){return J().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.config.startTime=0,o.next=3,this.load();case 3:return this._reloadOnPlay=!1,o.abrupt("return",this.media.play(!n));case 5:case"end":return o.stop()}},s,this)}));function e(s){return i.apply(this,arguments)}return e}()},{key:"switchURL",value:function(){var i=re(J().mark(function s(n){var l,o,u,h,d,c,f,y=arguments;return J().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:l=y.length>1&&y[1]!==void 0?y[1]:{},o={seamless:!1,startTime:0,bitrate:0},b.t0=yi(l),b.next=b.t0==="number"?5:b.t0==="boolean"?7:b.t0==="object"?9:11;break;case 5:return l={startTime:l},b.abrupt("break",12);case 7:return l={seamless:l},b.abrupt("break",12);case 9:for(u in l)(l[u]===void 0||l[u]===null)&&delete l[u];return b.abrupt("break",12);case 11:throw"unsupported switchURL args: ".concat(l);case 12:if(l=Object.assign({},o,l),h=l,d=h.seamless,c=h.startTime,this.config.url=n,this.config.startTime=c,this._switchUrlOpts=l,d){b.next=38;break}if(b.prev=18,!this.config.softDecode){b.next=23;break}b.t1=this.load(n),b.next=26;break;case 23:return b.next=25,this.load(n);case 25:b.t1=b.sent;case 26:f=b.t1,b.next=33;break;case 29:throw b.prev=29,b.t2=b.catch(18),this.emit(te.SWITCH_URL_FAILED,b.t2),b.t2;case 33:return this._reloadOnPlay=!1,f&&this.emit(te.SWITCH_URL_SUCCESS,{url:n}),b.abrupt("return",this.media.play(!0));case 38:return this._urlSwitching=!0,this.isLive||(this._prevSegSn=null,this._prevSegCc=null),this._playlist.reset(),this._bufferService.seamlessSwitch(),b.next=44,this._clear();case 44:return b.next=46,this._loadData(n);case 46:this._startTick();case 47:this._switchUrlOpts=null;case 48:case"end":return b.stop()}},s,this,[[18,29]])}));function e(s){return i.apply(this,arguments)}return e}()},{key:"switchStream",value:function(){var i=re(J().mark(function s(n){var l,o,u,h,d,c=arguments;return J().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(l=c.length>1&&c[1]!==void 0?c[1]:!0,o=this.currentStream,u=this.streams,!(!o||o.id===n||!u||u.length<2)){y.next=5;break}return y.abrupt("return");case 5:if(h=u.find(function(g){return g.id===n}),h){y.next=8;break}return y.abrupt("return");case 8:return y.prev=8,y.next=11,this._clear();case 11:if(!l){y.next=14;break}return y.next=14,this._bufferService.clearAllBuffer();case 14:y.next=19;break;case 16:throw y.prev=16,y.t0=y.catch(8),this._emitError(oe.create(y.t0));case 19:if(o.currentAudioStream&&h.audioStreams.length>2&&(d=o.currentAudioStream.id,h.currentAudioStream=h.audioStreams.find(function(g){return g.id===d})||h.currentAudioStream),this._playlist.currentStream=h,y.prev=21,!(this.isLive||!h.segments.length)){y.next=25;break}return y.next=25,this._refreshM3U8();case 25:return this._playlist.setNextSegmentByIndex(this._playlist.findSegmentIndexByTime(this.media.currentTime)||0),this._prevSegCc=null,y.next=29,this._loadSegmentDirect();case 29:y.next=35;break;case 31:throw y.prev=31,y.t1=y.catch(21),this._playlist.currentStream=o,y.t1;case 35:return this._startTick(),y.abrupt("return",h);case 37:case"end":return y.stop()}},s,this,[[8,16],[21,31]])}));function e(s){return i.apply(this,arguments)}return e}()},{key:"switchAudioStream",value:function(){var i=re(J().mark(function s(n){var l,o,u,h,d=arguments;return J().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(l=d.length>1&&d[1]!==void 0?d[1]:!0,o=this.currentStream,o){f.next=4;break}return f.abrupt("return");case 4:if(u=o.currentAudioStream,!(!u||u.id===n||o.audioStreams.length<2)){f.next=7;break}return f.abrupt("return");case 7:if(h=o.audioStreams.find(function(y){return y.id===n}),h){f.next=10;break}return f.abrupt("return");case 10:return f.prev=10,f.next=13,this._clear();case 13:if(!l){f.next=16;break}return f.next=16,this._bufferService.clearAllBuffer();case 16:f.next=21;break;case 18:throw f.prev=18,f.t0=f.catch(10),this._emitError(oe.create(f.t0));case 21:if(o.currentAudioStream=h,f.prev=22,!(this.isLive||!h.segments.length)){f.next=26;break}return f.next=26,this._refreshM3U8();case 26:return this._playlist.setNextSegmentByIndex(this._playlist.findSegmentIndexByTime(this.media.currentTime)||0),this._prevSegCc=null,f.next=30,this._loadSegmentDirect();case 30:f.next=36;break;case 32:throw f.prev=32,f.t1=f.catch(22),o.currentAudioStream=u,f.t1;case 36:return this._startTick(),f.abrupt("return",h);case 38:case"end":return f.stop()}},s,this,[[10,18],[22,32]])}));function e(s){return i.apply(this,arguments)}return e}()},{key:"switchSubtitleStream",value:function(){var i=re(J().mark(function s(n){return J().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this._playlist.switchSubtitle(n),o.next=3,this._manifestLoader.stopPoll();case 3:return o.next=5,this._refreshM3U8();case 5:case"end":return o.stop()}},s,this)}));function e(s){return i.apply(this,arguments)}return e}()},{key:"destroy",value:function(){var i=re(J().mark(function s(){var n;return J().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.media){o.next=2;break}return o.abrupt("return");case 2:return this.removeAllListeners(),this._playlist.reset(),this._segmentLoader.reset(),(n=this._seiService)===null||n===void 0||n.reset(),this.media.removeEventListener("loadeddata",this._onLoadeddata),this.media.removeEventListener("play",this._onPlay),this.media.removeEventListener("pause",this._onPause),this.media.removeEventListener("seeking",this._onSeeking),this.media.removeEventListener("timeupdate",this._onTimeupdate),o.next=13,Promise.all([this._clear(),this._bufferService.destroy()]);case 13:this.media=null;case 14:case"end":return o.stop()}},s,this)}));function e(){return i.apply(this,arguments)}return e}()},{key:"_loadM3U8",value:function(){var i=re(J().mark(function s(n){var l,o,u,h,d,c,f;return J().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(g.prev=0,h=(o=this.config.manifestList)===null||o===void 0||(u=o.filter(function(b){return b.url===n})[0])===null||u===void 0?void 0:u.manifest,!h){g.next=6;break}g.t0=this._manifestLoader.parseText(h,n),g.next=9;break;case 6:return g.next=8,this._manifestLoader.load(n);case 8:g.t0=g.sent;case 9:d=g.t0,c=ct(d,1),l=c[0],g.next=17;break;case 14:throw g.prev=14,g.t1=g.catch(0),this._emitError(oe.create(g.t1));case 17:if(l){g.next=19;break}return g.abrupt("return");case 19:if(this._playlist.upsertPlaylist(l),!l.isMaster){g.next=24;break}return(f=this._playlist.currentStream.subtitleStreams)!==null&&f!==void 0&&f.length&&this.emit(te.SUBTITLE_PLAYLIST,{list:this._playlist.currentStream.subtitleStreams}),g.next=24,this._refreshM3U8();case 24:return this.emit(te.STREAM_PARSED),g.abrupt("return",l);case 26:case"end":return g.stop()}},s,this,[[0,14]])}));function e(s){return i.apply(this,arguments)}return e}()},{key:"_refreshM3U8",value:function(){var e,s,n=this,l=this._playlist.currentStream;if(!l||!l.url)throw this._emitError(oe.create(null,null,new Error("m3u8 url is not defined")));var o=l.url,u=(e=l.currentAudioStream)===null||e===void 0?void 0:e.url,h=(s=l.currentSubtitleStream)===null||s===void 0?void 0:s.url;return this._manifestLoader.load(o,u,h).then(function(d){var c=ct(d,3),f=c[0],y=c[1],g=c[2];f&&(n._playlist.upsertPlaylist(f,y,g),n.isLive&&n._pollM3U8(o,u,h))}).catch(function(d){throw n._emitError(oe.create(d))})}},{key:"_pollM3U8",value:function(e,s,n){var l=this,o=this._playlist.isEmpty,u;if(this._playlist.lowLatency)u=(this._playlist.currentStream.partTargetDuration*2||0)*1e3;else{var h;u=(((h=this._playlist.lastSegment)===null||h===void 0?void 0:h.duration)||0)*1e3}this._manifestLoader.poll(e,s,n,function(d,c,f){l._playlist.upsertPlaylist(d,c,f),l._playlist.clearOldSegment();var y=d&&o&&!l._playlist.isEmpty;(y||!l._playlist.hadSegmentLoaded&&l._playlist.nbSegments>=l.config.minSegmentsStartPlay)&&l._loadSegment(),o&&(o=l._playlist.isEmpty)},function(d){l._emitError(oe.create(d))},u)}},{key:"_loadSegmentDirect",value:function(){var i=re(J().mark(function s(n){var l,o,u,h,d,c;return J().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(l=this._playlist.nextSegment,l){y.next=3;break}return y.abrupt("return");case 3:return o=!1,u=null,y.prev=5,this._segmentProcessing=!0,xe.log("load segment, sn:".concat(l.sn,", [").concat(l.start,", ").concat(l.end,"], partIndex:").concat(l.partIndex)),y.next=10,this._reqAndBufferSegment(l,this._playlist.getAudioSegment(l));case 10:o=y.sent,y.next=16;break;case 13:y.prev=13,y.t0=y.catch(5),u=y.t0;case 16:return y.prev=16,this._segmentProcessing=!1,y.finish(16);case 19:if(!u){y.next=26;break}if(!this._bufferService.isFull()){y.next=25;break}return xe.log("load segment, sn:".concat(l.sn,", partIndex:").concat(l.partIndex)),this._segmentProcessing=!0,this._isProcessQuotaExceeded=!0,y.abrupt("return",!1);case 25:return y.abrupt("return",this._emitError(oe.create(u)));case 26:return o&&(d=this.bufferInfo().end,this.isLive&&!this.media.seeking&&d&&Math.abs(l.end-d)>1&&(xe.warn("segment: ".concat(l.sn," expected end=").concat(l.end,", real end=").concat(d)),this._playlist.feedbackLiveEdge(l,d)),c=((h=this._playlist.currentStream)===null||h===void 0?void 0:h.url)===l.parentUrl,this._urlSwitching&&!c&&(xe.warn("pre playlist segment appended!"),this._bufferService.seamlessSwitch()),this.isLive&&this._urlSwitching&&c&&(this._urlSwitching=!1,this.emit(te.SWITCH_URL_SUCCESS,{url:this.config.url})),this._playlist.moveSegmentPointer(),l.isLast?this._end():n||this._loadSegment()),y.abrupt("return",o);case 28:case"end":return y.stop()}},s,this,[[5,13,16,19]])}));function e(s){return i.apply(this,arguments)}return e}()},{key:"_reqAndBufferSegment",value:function(){var i=re(J().mark(function s(n,l){var o,u,h,d,c,f,y,g,b,S,G;return J().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return u=n?n.cc:l.cc,h=this._prevSegCc!==u,d=[],L.prev=3,L.next=6,this._segmentLoader.load(n,l,h);case 6:d=L.sent,L.next=14;break;case 9:throw L.prev=9,L.t0=L.catch(3),L.t0.fatal=!1,this._segmentLoader.error=L.t0,L.t0;case 14:if(d[0]){L.next=16;break}return L.abrupt("return");case 16:return L.next=18,(o=this._bufferService).decryptBuffer.apply(o,fl(d));case 18:if(c=L.sent,c){L.next=21;break}return L.abrupt("return");case 21:return f=n?n.sn:l.sn,y=n?n.start:l.start,g=this._playlist.currentStream,this._bufferService.createSource(c[0],c[1],g==null?void 0:g.videoCodec,g==null?void 0:g.audioCodec),b=Date.now(),S=this._prevSegSn===f-1,this.isLive&&this._urlSwitching&&(G=this.bufferInfo().end,this._playlist.updateSegmentsRanges(f,G),xe.warn("update the new playlist liveEdge, segment id=".concat(f,", buffer start=").concat(G,", liveEdge=").concat(this._playlist.liveEdge)),y=G),L.next=30,this._bufferService.appendBuffer(n,l,c[0],c[1],h,S,y);case 30:return this.emit(te.APPEND_COST,{elapsed:Date.now()-b,url:n.url}),L.next=33,this._bufferService.evictBuffer(this.config.bufferBehind);case 33:return this._prevSegCc=u,this._prevSegSn=f,L.abrupt("return",!0);case 36:case"end":return L.stop()}},s,this,[[3,9]])}));function e(s,n){return i.apply(this,arguments)}return e}()},{key:"_onCheckQuotaExceeded",value:function(){var i=re(J().mark(function s(){var n,l,o,u,h,d;return J().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:n=this.media.currentTime,l=this.media.buffered,o=!1,u=0;case 4:if(!(u<l.length)){f.next=11;break}if(!(l.start(0)>=n&&n<l.end(u))){f.next=8;break}return o=!0,f.abrupt("break",11);case 8:u++,f.next=4;break;case 11:if(!this._bufferService.isFull()){f.next=17;break}if(h=o?this.config.bufferBehind:5,d=this.media.currentTime,!(d-h>0)){f.next=17;break}return f.next=17,this._bufferService.removeBuffer(0,d-h);case 17:case"end":return f.stop()}},s,this)}));function e(){return i.apply(this,arguments)}return e}()},{key:"_checkStreamTrackChange",value:function(e){var s=this._playlist.checkSegmentTrackChange(e,this._bufferService.nbSb);s&&this.switchURL(this.config.url,s.start+.2)}},{key:"_clear",value:function(){var i=re(J().mark(function s(){return J().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return clearTimeout(this._disconnectTimer),this._stopTick(),l.next=4,Promise.all([this._segmentLoader.cancel(),this._manifestLoader.stopPoll()]);case 4:this._segmentProcessing=!1;case 5:case"end":return l.stop()}},s,this)}));function e(){return i.apply(this,arguments)}return e}()},{key:"_reset",value:function(){var i=re(J().mark(function s(){var n,l,o=arguments;return J().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return l=o.length>0&&o[0]!==void 0?o[0]:!1,this._reloadOnPlay=!1,this._prevSegSn=null,this._prevSegCc=null,this._switchUrlOpts=null,this._playlist.reset(),this._segmentLoader.reset(),(n=this._seiService)===null||n===void 0||n.reset(),this._stats.reset(),h.next=11,this._clear();case 11:return h.abrupt("return",this._bufferService.reset(l));case 12:case"end":return h.stop()}},s,this)}));function e(){return i.apply(this,arguments)}return e}()},{key:"_end",value:function(){this._clear(),this._bufferService.endOfStream(),(this.media.readyState<=2||this.media.buffered.length>1)&&this._startTick()}},{key:"_stopTick",value:function(){this._tickTimer&&clearTimeout(this._tickTimer),this._tickTimer=null}},{key:"_startTick",value:function(){this._stopTick(),this._tickTimer=setTimeout(this._tick,this._tickInterval)}},{key:"_emitError",value:function(e){var s,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(((s=e.originError)===null||s===void 0?void 0:s.fatal)===!1)xe.warn(e);else{var l,o,u;xe.table(e),xe.error(e),xe.error((l=this.media)===null||l===void 0?void 0:l.error),(o=this.media)!==null&&o!==void 0&&o.readyState&&this.media.pause(),this._stopTick(),this._urlSwitching&&(this._urlSwitching=!1,this.emit(te.SWITCH_URL_FAILED,e)),this.emit(te.ERROR,e),n&&this._end(),(u=this._seiService)===null||u===void 0||u.reset()}return e}},{key:"_getSeamlessSwitchPoint",value:function(){var e=this.media,s=e.currentTime;if(!e.paused){var n,l=this._playlist.findSegmentIndexByTime(e.currentTime),o=this._playlist.getSegmentByIndex(l),u=(n=this._stats)===null||n===void 0?void 0:n.getStats().downloadSpeed;if(u&&o){var h=o.duration*this._playlist.currentStream.bitrate/u+1;s+=h}else s+=5}return s}},{key:"_tryEos",value:function(){var e,s,n=this.media,l=this._playlist,o=l.nextSegment,u=l.lastSegment,h=(!o||u&&me.isBuffered(n,u.start+u.duration/2))&&n.readyState&&n.duration>0&&((e=this._bufferService)===null||e===void 0?void 0:e.msIsOpened)&&!((s=this._bufferService)!==null&&s!==void 0&&s.msHasOpTasks);if(h){var d=this.bufferInfo();n.paused&&!n.currentTime&&(d=this.bufferInfo(d.nextStart||.5));var c=Math.abs(d.end-n.duration)<.1||!this.isLive&&u&&d.end>=u.start+u.duration;c&&this._bufferService.endOfStream()}}}],[{key:"isSupported",value:function(e){return!e||e==="video"||e==="audio"?ce.isSupported():typeof WebAssembly<"u"}},{key:"enableLogger",value:function(){Te.enable(),Vt.enable()}},{key:"disableLogger",value:function(){Te.disable(),Vt.disable()}}]),t}(vt);T(Pt,"version","3.0.19");try{localStorage.getItem("xgd")?Pt.enableLogger():Pt.disableLogger()}catch{}var Nl=function(){function r(a,t){var i=this;Ze(this,r),T(this,"_opts",null),T(this,"_plugin",null),T(this,"_onLowDecode",function(){var e,s,n,l,o=i._opts,u=o.media,h=o.innerDegrade;(e=i._plugin)===null||e===void 0||(s=e.player)===null||s===void 0||s.emit("lowdecode",u.degradeInfo),(n=i._plugin)===null||n===void 0||(l=n.player)===null||l===void 0||l.emit("core_event",ne(ne({},u.degradeInfo),{},{eventName:te.LOWDECODE})),h===1&&i._degrade(u.src)}),T(this,"_degrade",function(e){var s=i._plugin.player,n=s.video;if(!(n&&n.TAG!=="MVideo")){var l=s.video.degradeVideo;s.video=l,n.degrade(e),e&&(s.config.url=e);var o=s.root.firstChild;o.TAG==="MVideo"&&s.root.replaceChild(l,o);var u=i._plugin.constructor.pluginName.toLowerCase();s.unRegisterPlugin(u),s.once("canplay",function(){s.play()})}}),T(this,"forceDegradeToVideo",function(e){var s=i._opts.innerDegrade;s===1&&i._degrade(e)}),this._opts=a,this._plugin=t,this._init()}return ke(r,[{key:"_init",value:function(){var t=this._opts,i=t.media,e=t.preloadTime,s=t.innerDegrade,n=t.isLive;if(i){if(!n&&i.setPlayMode){i.setPlayMode("VOD");return}s&&i.setAttribute("innerdegrade",s),e&&i.setAttribute("preloadtime",e),this._bindEvents()}}},{key:"_bindEvents",value:function(){var t=this._opts.media;t.addEventListener("lowdecode",this._onLowDecode)}},{key:"destroy",value:function(){var t,i;(t=this._opts)===null||t===void 0||(i=t.media)===null||i===void 0||i.removeEventListener("lowdecode",this._onLowDecode),this._plugin=null}}]),r}();function Ul(r,a){var t=a.player,i=t.currentTime,e={startTime:i};switch(yi(r)){case"boolean":e.seamless=r;break;case"object":Object.assign(e,r);break}return e}var bi=function(r){wi(t,r);var a=Vi(t);function t(){var i;Ze(this,t);for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];return i=a.call.apply(a,[this].concat(s)),T(Q(i),"hls",null),T(Q(i),"pluginExtension",null),T(Q(i),"getStats",function(){var l;return(l=i.hls)===null||l===void 0?void 0:l.getStats()}),T(Q(i),"_onSwitchSubtitle",function(l){var o,u=l.lang;(o=i.hls)===null||o===void 0||o.switchSubtitleStream(u)}),T(Q(i),"_onSwitchURL",function(l,o){return new Promise(function(u,h){var d=Q(i),c=d.player,f=d.hls;if(f){var y,g,b=Ul(o,Q(i));c.config.url=l,f.switchURL(l,b).then(function(){return u(!0)}).catch(h),!b.seamless&&(y=i.player.config)!==null&&y!==void 0&&(g=y.hls)!==null&&g!==void 0&&g.keepStatusAfterSwitch&&i._keepPauseStatus()}else h()})}),T(Q(i),"_keepPauseStatus",function(){var l=i.player.paused;l&&i.player.once("canplay",function(){i.player.pause()})}),i}return ke(t,[{key:"core",get:function(){return this.hls}},{key:"version",get:function(){var e;return(e=this.hls)===null||e===void 0?void 0:e.version}},{key:"softDecode",get:function(){var e,s,n=(e=this.player)===null||e===void 0||(s=e.config)===null||s===void 0?void 0:s.mediaType;return!!n&&n!=="video"&&n!=="audio"}},{key:"beforePlayerInit",value:function(){var e=this,s=this.player.config,n=s.hls||{};if(!(!s.url&&!s.__allowHlsEmptyUrl__||!n.preferMMS&&ce.isMMSOnly())){if(this.hls&&this.hls.destroy(),this.player.switchURL=this._onSwitchURL,this.player.handleSource=!1,n.innerDegrade=n.innerDegrade||s.innerDegrade,(n.disconnectTime===null||n.disconnectTime===void 0)&&(n.disconnectTime=0),this.hls=new Pt(ne({softDecode:this.softDecode,isLive:s.isLive,media:this.player.media||this.player.video,startTime:s.startTime,url:s.url},n)),this.softDecode||Kt.defineGetterOrSetter(this.player,{url:{get:function(){var u,h;return(u=e.hls)===null||u===void 0||(h=u.media)===null||h===void 0?void 0:h.src},configurable:!0}}),this.softDecode&&(this.pluginExtension=new Nl(ne({isLive:s.isLive,media:this.player.video},n),this),this.player.forceDegradeToVideo=function(){for(var o,u=arguments.length,h=new Array(u),d=0;d<u;d++)h[d]=arguments[d];return(o=e.pluginExtension)===null||o===void 0?void 0:o.forceDegradeToVideo.apply(o,h)}),s.isLive){var l;(l=this.player)===null||l===void 0||l.useHooks("replay",function(){var o;return(o=e.hls)===null||o===void 0?void 0:o.replay()})}this.on(xr,this._onSwitchSubtitle),this.on(Ut,this._onSwitchURL),this.on(Xn,this.destroy.bind(this)),this._transError(),this._transCoreEvent(F.TTFB),this._transCoreEvent(F.LOAD_START),this._transCoreEvent(F.LOAD_RESPONSE_HEADERS),this._transCoreEvent(F.LOAD_COMPLETE),this._transCoreEvent(F.LOAD_RETRY),this._transCoreEvent(F.SOURCEBUFFER_CREATED),this._transCoreEvent(F.MEDIASOURCE_OPENED),this._transCoreEvent(F.REMOVE_BUFFER),this._transCoreEvent(F.BUFFEREOS),this._transCoreEvent(F.KEYFRAME),this._transCoreEvent(F.METADATA_PARSED),this._transCoreEvent(F.DEMUXED_TRACK),this._transCoreEvent(F.SEI),this._transCoreEvent(F.SEI_IN_TIME),this._transCoreEvent(F.SPEED),this._transCoreEvent(F.HLS_MANIFEST_LOADED),this._transCoreEvent(F.HLS_LEVEL_LOADED),this._transCoreEvent(F.STREAM_EXCEPTION),this._transCoreEvent(F.SWITCH_URL_SUCCESS),this._transCoreEvent(F.SWITCH_URL_FAILED),this._transCoreEvent(te.NO_AUDIO_TRACK),this._transCoreEvent(te.STREAM_PARSED),this._transCoreEvent(te.SUBTITLE_SEGMENTS),this._transCoreEvent(te.SUBTITLE_PLAYLIST),this._transCoreEvent(te.APPEND_COST),s.url&&this.hls.load(s.url,!0).catch(function(o){})}}},{key:"destroy",value:function(){var e;this.hls&&(this.hls.destroy(),this.hls=null),(e=this.pluginExtension)===null||e===void 0||e.destroy(),this.pluginExtension=null}},{key:"_transError",value:function(){var e=this;this.hls.on(te.ERROR,function(s){e.player&&e.player.emit(Gn,new St(e.player,s))})}},{key:"_transCoreEvent",value:function(e){var s=this;this.hls.on(e,function(n){s.player&&(s.player.emit("core_event",ne(ne({},n),{},{eventName:e})),e===F.SEI_IN_TIME&&s.hls.hasSubtitle&&s._emitSeiPaylodTime(n))})}},{key:"_emitSeiPaylodTime",value:function(e){try{var s=JSON.parse(Array.from(e.data.payload).map(function(n){return String.fromCharCode(n)}).join("").slice(0,-1));if(!s.rtmp_dts)return;this.player.emit("core_event",{eventName:te.SEI_PAYLOAD_TIME,time:s.rtmp_dts})}catch{}}}],[{key:"pluginName",get:function(){return"hls"}},{key:"isSupported",value:function(e,s){return Pt.isSupported(e,s)}}]),t}(Kt);T(bi,"Hls",Pt);T(bi,"EVENT",te);function cn(r,a){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);a&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),t.push.apply(t,i)}return t}function mt(r){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?cn(Object(t),!0).forEach(function(i){ze(r,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):cn(Object(t)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(t,i))})}return r}function ie(){ie=function(){return r};var r={},a=Object.prototype,t=a.hasOwnProperty,i=Object.defineProperty||function(m,p,v){m[p]=v.value},e=typeof Symbol=="function"?Symbol:{},s=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",l=e.toStringTag||"@@toStringTag";function o(m,p,v){return Object.defineProperty(m,p,{value:v,enumerable:!0,configurable:!0,writable:!0}),m[p]}try{o({},"")}catch{o=function(p,v,E){return p[v]=E}}function u(m,p,v,E){var Z=p&&p.prototype instanceof c?p:c,R=Object.create(Z.prototype),x=new M(E||[]);return i(R,"_invoke",{value:k(m,v,x)}),R}function h(m,p,v){try{return{type:"normal",arg:m.call(p,v)}}catch(E){return{type:"throw",arg:E}}}r.wrap=u;var d={};function c(){}function f(){}function y(){}var g={};o(g,s,function(){return this});var b=Object.getPrototypeOf,S=b&&b(b(C([])));S&&S!==a&&t.call(S,s)&&(g=S);var G=y.prototype=c.prototype=Object.create(g);function X(m){["next","throw","return"].forEach(function(p){o(m,p,function(v){return this._invoke(p,v)})})}function L(m,p){function v(Z,R,x,D){var _=h(m[Z],m,R);if(_.type!=="throw"){var K=_.arg,j=K.value;return j&&typeof j=="object"&&t.call(j,"__await")?p.resolve(j.__await).then(function(P){v("next",P,x,D)},function(P){v("throw",P,x,D)}):p.resolve(j).then(function(P){K.value=P,x(K)},function(P){return v("throw",P,x,D)})}D(_.arg)}var E;i(this,"_invoke",{value:function(Z,R){function x(){return new p(function(D,_){v(Z,R,D,_)})}return E=E?E.then(x,x):x()}})}function k(m,p,v){var E="suspendedStart";return function(Z,R){if(E==="executing")throw new Error("Generator is already running");if(E==="completed"){if(Z==="throw")throw R;return U()}for(v.method=Z,v.arg=R;;){var x=v.delegate;if(x){var D=W(x,v);if(D){if(D===d)continue;return D}}if(v.method==="next")v.sent=v._sent=v.arg;else if(v.method==="throw"){if(E==="suspendedStart")throw E="completed",v.arg;v.dispatchException(v.arg)}else v.method==="return"&&v.abrupt("return",v.arg);E="executing";var _=h(m,p,v);if(_.type==="normal"){if(E=v.done?"completed":"suspendedYield",_.arg===d)continue;return{value:_.arg,done:v.done}}_.type==="throw"&&(E="completed",v.method="throw",v.arg=_.arg)}}}function W(m,p){var v=p.method,E=m.iterator[v];if(E===void 0)return p.delegate=null,v==="throw"&&m.iterator.return&&(p.method="return",p.arg=void 0,W(m,p),p.method==="throw")||v!=="return"&&(p.method="throw",p.arg=new TypeError("The iterator does not provide a '"+v+"' method")),d;var Z=h(E,m.iterator,p.arg);if(Z.type==="throw")return p.method="throw",p.arg=Z.arg,p.delegate=null,d;var R=Z.arg;return R?R.done?(p[m.resultName]=R.value,p.next=m.nextLoc,p.method!=="return"&&(p.method="next",p.arg=void 0),p.delegate=null,d):R:(p.method="throw",p.arg=new TypeError("iterator result is not an object"),p.delegate=null,d)}function V(m){var p={tryLoc:m[0]};1 in m&&(p.catchLoc=m[1]),2 in m&&(p.finallyLoc=m[2],p.afterLoc=m[3]),this.tryEntries.push(p)}function w(m){var p=m.completion||{};p.type="normal",delete p.arg,m.completion=p}function M(m){this.tryEntries=[{tryLoc:"root"}],m.forEach(V,this),this.reset(!0)}function C(m){if(m){var p=m[s];if(p)return p.call(m);if(typeof m.next=="function")return m;if(!isNaN(m.length)){var v=-1,E=function Z(){for(;++v<m.length;)if(t.call(m,v))return Z.value=m[v],Z.done=!1,Z;return Z.value=void 0,Z.done=!0,Z};return E.next=E}}return{next:U}}function U(){return{value:void 0,done:!0}}return f.prototype=y,i(G,"constructor",{value:y,configurable:!0}),i(y,"constructor",{value:f,configurable:!0}),f.displayName=o(y,l,"GeneratorFunction"),r.isGeneratorFunction=function(m){var p=typeof m=="function"&&m.constructor;return!!p&&(p===f||(p.displayName||p.name)==="GeneratorFunction")},r.mark=function(m){return Object.setPrototypeOf?Object.setPrototypeOf(m,y):(m.__proto__=y,o(m,l,"GeneratorFunction")),m.prototype=Object.create(G),m},r.awrap=function(m){return{__await:m}},X(L.prototype),o(L.prototype,n,function(){return this}),r.AsyncIterator=L,r.async=function(m,p,v,E,Z){Z===void 0&&(Z=Promise);var R=new L(u(m,p,v,E),Z);return r.isGeneratorFunction(p)?R:R.next().then(function(x){return x.done?x.value:R.next()})},X(G),o(G,l,"Generator"),o(G,s,function(){return this}),o(G,"toString",function(){return"[object Generator]"}),r.keys=function(m){var p=Object(m),v=[];for(var E in p)v.push(E);return v.reverse(),function Z(){for(;v.length;){var R=v.pop();if(R in p)return Z.value=R,Z.done=!1,Z}return Z.done=!0,Z}},r.values=C,M.prototype={constructor:M,reset:function(m){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!m)for(var p in this)p.charAt(0)==="t"&&t.call(this,p)&&!isNaN(+p.slice(1))&&(this[p]=void 0)},stop:function(){this.done=!0;var m=this.tryEntries[0].completion;if(m.type==="throw")throw m.arg;return this.rval},dispatchException:function(m){if(this.done)throw m;var p=this;function v(_,K){return R.type="throw",R.arg=m,p.next=_,K&&(p.method="next",p.arg=void 0),!!K}for(var E=this.tryEntries.length-1;E>=0;--E){var Z=this.tryEntries[E],R=Z.completion;if(Z.tryLoc==="root")return v("end");if(Z.tryLoc<=this.prev){var x=t.call(Z,"catchLoc"),D=t.call(Z,"finallyLoc");if(x&&D){if(this.prev<Z.catchLoc)return v(Z.catchLoc,!0);if(this.prev<Z.finallyLoc)return v(Z.finallyLoc)}else if(x){if(this.prev<Z.catchLoc)return v(Z.catchLoc,!0)}else{if(!D)throw new Error("try statement without catch or finally");if(this.prev<Z.finallyLoc)return v(Z.finallyLoc)}}}},abrupt:function(m,p){for(var v=this.tryEntries.length-1;v>=0;--v){var E=this.tryEntries[v];if(E.tryLoc<=this.prev&&t.call(E,"finallyLoc")&&this.prev<E.finallyLoc){var Z=E;break}}Z&&(m==="break"||m==="continue")&&Z.tryLoc<=p&&p<=Z.finallyLoc&&(Z=null);var R=Z?Z.completion:{};return R.type=m,R.arg=p,Z?(this.method="next",this.next=Z.finallyLoc,d):this.complete(R)},complete:function(m,p){if(m.type==="throw")throw m.arg;return m.type==="break"||m.type==="continue"?this.next=m.arg:m.type==="return"?(this.rval=this.arg=m.arg,this.method="return",this.next="end"):m.type==="normal"&&p&&(this.next=p),d},finish:function(m){for(var p=this.tryEntries.length-1;p>=0;--p){var v=this.tryEntries[p];if(v.finallyLoc===m)return this.complete(v.completion,v.afterLoc),w(v),d}},catch:function(m){for(var p=this.tryEntries.length-1;p>=0;--p){var v=this.tryEntries[p];if(v.tryLoc===m){var E=v.completion;if(E.type==="throw"){var Z=E.arg;w(v)}return Z}}throw new Error("illegal catch attempt")},delegateYield:function(m,p,v){return this.delegate={iterator:C(m),resultName:p,nextLoc:v},this.method==="next"&&(this.arg=void 0),d}},r}function pn(r,a,t,i,e,s,n){try{var l=r[s](n),o=l.value}catch(u){t(u);return}l.done?a(o):Promise.resolve(o).then(i,e)}function we(r){return function(){var a=this,t=arguments;return new Promise(function(i,e){var s=r.apply(a,t);function n(o){pn(s,i,e,n,l,"next",o)}function l(o){pn(s,i,e,n,l,"throw",o)}n(void 0)})}}function Rt(r,a){if(!(r instanceof a))throw new TypeError("Cannot call a class as a function")}function mn(r,a){for(var t=0;t<a.length;t++){var i=a[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,gr(i.key),i)}}function Tt(r,a,t){return a&&mn(r.prototype,a),t&&mn(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function ze(r,a,t){return a=gr(a),a in r?Object.defineProperty(r,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[a]=t,r}function gs(r,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(a&&a.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),a&&hs(r,a)}function gi(r){return gi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},gi(r)}function hs(r,a){return hs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,e){return i.__proto__=e,i},hs(r,a)}function zl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Le(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Jl(r,a){if(a&&(typeof a=="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Le(r)}function Zs(r){var a=zl();return function(){var i=gi(r),e;if(a){var s=gi(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return Jl(this,e)}}function Bl(r,a){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var i=t.call(r,a||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(r)}function gr(r){var a=Bl(r,"string");return typeof a=="symbol"?a:String(a)}var ks={};Object.defineProperty(ks,"__esModule",{value:!0});ks.default=function(r){for(var a=0,t=arguments.length,i=Array(t>1?t-1:0),e=1;e<t;e++)i[e-1]=arguments[e];var s=!0,n=!1,l=void 0;try{for(var o=i[Symbol.iterator](),u;!(s=(u=o.next()).done);s=!0){var h=u.value;a+=h.length}}catch(X){n=!0,l=X}finally{try{!s&&o.return&&o.return()}finally{if(n)throw l}}var d=new r(a),c=0,f=!0,y=!1,g=void 0;try{for(var b=i[Symbol.iterator](),S;!(f=(S=b.next()).done);f=!0){var G=S.value;d.set(G,c),c+=G.length}}catch(X){y=!0,g=X}finally{try{!f&&b.return&&b.return()}finally{if(y)throw g}}return d};var Ol=ks,Al=jl(Ol);function jl(r){return r&&r.__esModule?r:{default:r}}var Ql=Al.default;const ql=Gr(Ql);var Zr="3.0.19",qe={416:ye[N.NETWROK_RANGE_NOT_SATISFIABLE],403:ye[N.NETWORK_FORBIDDEN],404:ye[N.NETWORK_NOTFOUND],timeout:ye[N.NETWORK_TIMEOUT],"4xx":"".concat(ye[N.NETWORK],"4XX"),"5xx":"".concat(ye[N.NETWORK],"5XX"),networkError:ye[N.NETWORK],contentError:"".concat(ye[N.NETWORK],"contentError"),mse:ye[N.MEDIA][N.SUB_TYPES.MSE_OTHER],mseOpen:ye[N.MEDIA][N.SUB_TYPES.MSE_ADD_SB],mseAppend:ye[N.MEDIA][N.SUB_TYPES.MSE_APPEND_BUFFER],mse_hijack:ye[N.MEDIA][N.SUB_TYPES.MSE_HIJACK],eme_hijack:ye[N.MEDIA][N.SUB_TYPES.EME_HIJACK],metaError:ye[N.DEMUX][N.SUB_TYPES.MP4],muxError:ye[N.REMUX][N.SUB_TYPES.FMP4],other:ye[N.OTHER],waitTimeout:ye[N.RUNTIME][N.SUB_TYPES.BUFFERBREAK_ERROR],waitTimeoutWithHidden:ye[N.RUNTIME][N.SUB_TYPES.WAITING_TIMEOUT_ERROR],drm:ye[N.DRM][N.SUB_TYPES.LICENSE]},It=N;function $l(r){return qe[r]||r}var eo=Tt(function r(a,t,i){Rt(this,r);var e=0,s=0;i&&i.range&&i.range.length>1&&(e=i.range[0],s=i.range[1]);var n=$l(t);return{errorCode:n,errorType:a,errorMessage:(i==null?void 0:i.httpText)||(i==null?void 0:i.message),url:i==null?void 0:i.url,httpCode:t,version:Zr,rangeStart:e,rangeEnd:s,ext:i,mediaError:{code:n,message:(i==null?void 0:i.httpText)||(i==null?void 0:i.message)}}}),to=Tt(function r(a,t,i){return Rt(this,r),{errorCode:t,errorType:a,version:Zr,errorMessage:i.msg,ext:i,mediaError:{code:t,message:i.msg}}}),et={};et.nowTime=function(){try{return parseInt(performance.now(),10)}catch{return new Date().getTime()}};et.concatData=function(r,a){var t=[],i=0;r&&t.push(r),a&&t.push(a),t.every(function(n){return n&&(i+=n.byteLength),!0});var e=new Uint8Array(i),s=0;return t.every(function(n){return n&&(e.set(n,s),s+=n.byteLength),!0}),e};function io(r,a){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var i,e,s,n,l=[],o=!0,u=!1;try{if(s=(t=t.call(r)).next,a!==0)for(;!(o=(i=s.call(t)).done)&&(l.push(i.value),l.length!==a);o=!0);}catch(h){u=!0,e=h}finally{try{if(!o&&t.return!=null&&(n=t.return(),Object(n)!==n))return}finally{if(u)throw e}}return l}}function fn(r,a){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);a&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),t.push.apply(t,i)}return t}function ds(r){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?fn(Object(t),!0).forEach(function(i){De(r,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):fn(Object(t)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(t,i))})}return r}function le(){le=function(){return r};var r={},a=Object.prototype,t=a.hasOwnProperty,i=Object.defineProperty||function(m,p,v){m[p]=v.value},e=typeof Symbol=="function"?Symbol:{},s=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",l=e.toStringTag||"@@toStringTag";function o(m,p,v){return Object.defineProperty(m,p,{value:v,enumerable:!0,configurable:!0,writable:!0}),m[p]}try{o({},"")}catch{o=function(p,v,E){return p[v]=E}}function u(m,p,v,E){var Z=p&&p.prototype instanceof c?p:c,R=Object.create(Z.prototype),x=new M(E||[]);return i(R,"_invoke",{value:k(m,v,x)}),R}function h(m,p,v){try{return{type:"normal",arg:m.call(p,v)}}catch(E){return{type:"throw",arg:E}}}r.wrap=u;var d={};function c(){}function f(){}function y(){}var g={};o(g,s,function(){return this});var b=Object.getPrototypeOf,S=b&&b(b(C([])));S&&S!==a&&t.call(S,s)&&(g=S);var G=y.prototype=c.prototype=Object.create(g);function X(m){["next","throw","return"].forEach(function(p){o(m,p,function(v){return this._invoke(p,v)})})}function L(m,p){function v(Z,R,x,D){var _=h(m[Z],m,R);if(_.type!=="throw"){var K=_.arg,j=K.value;return j&&typeof j=="object"&&t.call(j,"__await")?p.resolve(j.__await).then(function(P){v("next",P,x,D)},function(P){v("throw",P,x,D)}):p.resolve(j).then(function(P){K.value=P,x(K)},function(P){return v("throw",P,x,D)})}D(_.arg)}var E;i(this,"_invoke",{value:function(Z,R){function x(){return new p(function(D,_){v(Z,R,D,_)})}return E=E?E.then(x,x):x()}})}function k(m,p,v){var E="suspendedStart";return function(Z,R){if(E==="executing")throw new Error("Generator is already running");if(E==="completed"){if(Z==="throw")throw R;return U()}for(v.method=Z,v.arg=R;;){var x=v.delegate;if(x){var D=W(x,v);if(D){if(D===d)continue;return D}}if(v.method==="next")v.sent=v._sent=v.arg;else if(v.method==="throw"){if(E==="suspendedStart")throw E="completed",v.arg;v.dispatchException(v.arg)}else v.method==="return"&&v.abrupt("return",v.arg);E="executing";var _=h(m,p,v);if(_.type==="normal"){if(E=v.done?"completed":"suspendedYield",_.arg===d)continue;return{value:_.arg,done:v.done}}_.type==="throw"&&(E="completed",v.method="throw",v.arg=_.arg)}}}function W(m,p){var v=p.method,E=m.iterator[v];if(E===void 0)return p.delegate=null,v==="throw"&&m.iterator.return&&(p.method="return",p.arg=void 0,W(m,p),p.method==="throw")||v!=="return"&&(p.method="throw",p.arg=new TypeError("The iterator does not provide a '"+v+"' method")),d;var Z=h(E,m.iterator,p.arg);if(Z.type==="throw")return p.method="throw",p.arg=Z.arg,p.delegate=null,d;var R=Z.arg;return R?R.done?(p[m.resultName]=R.value,p.next=m.nextLoc,p.method!=="return"&&(p.method="next",p.arg=void 0),p.delegate=null,d):R:(p.method="throw",p.arg=new TypeError("iterator result is not an object"),p.delegate=null,d)}function V(m){var p={tryLoc:m[0]};1 in m&&(p.catchLoc=m[1]),2 in m&&(p.finallyLoc=m[2],p.afterLoc=m[3]),this.tryEntries.push(p)}function w(m){var p=m.completion||{};p.type="normal",delete p.arg,m.completion=p}function M(m){this.tryEntries=[{tryLoc:"root"}],m.forEach(V,this),this.reset(!0)}function C(m){if(m){var p=m[s];if(p)return p.call(m);if(typeof m.next=="function")return m;if(!isNaN(m.length)){var v=-1,E=function Z(){for(;++v<m.length;)if(t.call(m,v))return Z.value=m[v],Z.done=!1,Z;return Z.value=void 0,Z.done=!0,Z};return E.next=E}}return{next:U}}function U(){return{value:void 0,done:!0}}return f.prototype=y,i(G,"constructor",{value:y,configurable:!0}),i(y,"constructor",{value:f,configurable:!0}),f.displayName=o(y,l,"GeneratorFunction"),r.isGeneratorFunction=function(m){var p=typeof m=="function"&&m.constructor;return!!p&&(p===f||(p.displayName||p.name)==="GeneratorFunction")},r.mark=function(m){return Object.setPrototypeOf?Object.setPrototypeOf(m,y):(m.__proto__=y,o(m,l,"GeneratorFunction")),m.prototype=Object.create(G),m},r.awrap=function(m){return{__await:m}},X(L.prototype),o(L.prototype,n,function(){return this}),r.AsyncIterator=L,r.async=function(m,p,v,E,Z){Z===void 0&&(Z=Promise);var R=new L(u(m,p,v,E),Z);return r.isGeneratorFunction(p)?R:R.next().then(function(x){return x.done?x.value:R.next()})},X(G),o(G,l,"Generator"),o(G,s,function(){return this}),o(G,"toString",function(){return"[object Generator]"}),r.keys=function(m){var p=Object(m),v=[];for(var E in p)v.push(E);return v.reverse(),function Z(){for(;v.length;){var R=v.pop();if(R in p)return Z.value=R,Z.done=!1,Z}return Z.done=!0,Z}},r.values=C,M.prototype={constructor:M,reset:function(m){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!m)for(var p in this)p.charAt(0)==="t"&&t.call(this,p)&&!isNaN(+p.slice(1))&&(this[p]=void 0)},stop:function(){this.done=!0;var m=this.tryEntries[0].completion;if(m.type==="throw")throw m.arg;return this.rval},dispatchException:function(m){if(this.done)throw m;var p=this;function v(_,K){return R.type="throw",R.arg=m,p.next=_,K&&(p.method="next",p.arg=void 0),!!K}for(var E=this.tryEntries.length-1;E>=0;--E){var Z=this.tryEntries[E],R=Z.completion;if(Z.tryLoc==="root")return v("end");if(Z.tryLoc<=this.prev){var x=t.call(Z,"catchLoc"),D=t.call(Z,"finallyLoc");if(x&&D){if(this.prev<Z.catchLoc)return v(Z.catchLoc,!0);if(this.prev<Z.finallyLoc)return v(Z.finallyLoc)}else if(x){if(this.prev<Z.catchLoc)return v(Z.catchLoc,!0)}else{if(!D)throw new Error("try statement without catch or finally");if(this.prev<Z.finallyLoc)return v(Z.finallyLoc)}}}},abrupt:function(m,p){for(var v=this.tryEntries.length-1;v>=0;--v){var E=this.tryEntries[v];if(E.tryLoc<=this.prev&&t.call(E,"finallyLoc")&&this.prev<E.finallyLoc){var Z=E;break}}Z&&(m==="break"||m==="continue")&&Z.tryLoc<=p&&p<=Z.finallyLoc&&(Z=null);var R=Z?Z.completion:{};return R.type=m,R.arg=p,Z?(this.method="next",this.next=Z.finallyLoc,d):this.complete(R)},complete:function(m,p){if(m.type==="throw")throw m.arg;return m.type==="break"||m.type==="continue"?this.next=m.arg:m.type==="return"?(this.rval=this.arg=m.arg,this.method="return",this.next="end"):m.type==="normal"&&p&&(this.next=p),d},finish:function(m){for(var p=this.tryEntries.length-1;p>=0;--p){var v=this.tryEntries[p];if(v.finallyLoc===m)return this.complete(v.completion,v.afterLoc),w(v),d}},catch:function(m){for(var p=this.tryEntries.length-1;p>=0;--p){var v=this.tryEntries[p];if(v.tryLoc===m){var E=v.completion;if(E.type==="throw"){var Z=E.arg;w(v)}return Z}}throw new Error("illegal catch attempt")},delegateYield:function(m,p,v){return this.delegate={iterator:C(m),resultName:p,nextLoc:v},this.method==="next"&&(this.arg=void 0),d}},r}function yn(r,a,t,i,e,s,n){try{var l=r[s](n),o=l.value}catch(u){t(u);return}l.done?a(o):Promise.resolve(o).then(i,e)}function Fe(r){return function(){var a=this,t=arguments;return new Promise(function(i,e){var s=r.apply(a,t);function n(o){yn(s,i,e,n,l,"next",o)}function l(o){yn(s,i,e,n,l,"throw",o)}n(void 0)})}}function Ss(r,a){if(!(r instanceof a))throw new TypeError("Cannot call a class as a function")}function so(r,a){for(var t=0;t<a.length;t++){var i=a[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,Sr(i.key),i)}}function Ls(r,a,t){return a&&so(r.prototype,a),Object.defineProperty(r,"prototype",{writable:!1}),r}function De(r,a,t){return a=Sr(a),a in r?Object.defineProperty(r,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[a]=t,r}function no(r,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(a&&a.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),a&&cs(r,a)}function Zi(r){return Zi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zi(r)}function cs(r,a){return cs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,e){return i.__proto__=e,i},cs(r,a)}function ro(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ao(r,a){if(r==null)return{};var t={},i=Object.keys(r),e,s;for(s=0;s<i.length;s++)e=i[s],!(a.indexOf(e)>=0)&&(t[e]=r[e]);return t}function lo(r,a){if(r==null)return{};var t=ao(r,a),i,e;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(e=0;e<s.length;e++)i=s[e],!(a.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(r,i)&&(t[i]=r[i])}return t}function Ue(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function oo(r,a){if(a&&(typeof a=="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ue(r)}function uo(r){var a=ro();return function(){var i=Zi(r),e;if(a){var s=Zi(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return oo(this,e)}}function ho(r,a){return mo(r)||io(r,a)||kr(r,a)||vo()}function co(r){return po(r)||fo(r)||kr(r)||yo()}function po(r){if(Array.isArray(r))return ps(r)}function mo(r){if(Array.isArray(r))return r}function fo(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function kr(r,a){if(r){if(typeof r=="string")return ps(r,a);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ps(r,a)}}function ps(r,a){(a==null||a>r.length)&&(a=r.length);for(var t=0,i=new Array(a);t<a;t++)i[t]=r[t];return i}function yo(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vo(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bo(r,a){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var i=t.call(r,a||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(r)}function Sr(r){var a=bo(r,"string");return typeof a=="symbol"?a:String(a)}function go(r){return ds({vid:"",moovEnd:8e4,segmentDuration:2,maxDownloadInfoSize:30,responseType:"arraybuffer",cache:null},r)}var oi=Ls(function r(a,t){Ss(this,r),this.type="file",this.message=a,this.data=t}),Zo=function(){function r(){Ss(this,r),De(this,"_data",Object.create(null))}return Ls(r,[{key:"set",value:function(t,i){this._data[t]=i}},{key:"get",value:function(t){return this._data[t]}},{key:"clear",value:function(){this._data=Object.create(null)}}]),r}();function vn(r,a){var t=r.trak;if(!(!t||!t.length)){var i=t.find(function(f){var y,g;return((y=f.mdia)===null||y===void 0||(g=y.hdlr)===null||g===void 0?void 0:g.handlerType)==="vide"}),e=t.find(function(f){var y,g;return((y=f.mdia)===null||y===void 0||(g=y.hdlr)===null||g===void 0?void 0:g.handlerType)==="soun"});if(!(!i&&!e)){var s=[],n=[];if(a){var l=[],o=0,u=a.start+a.size;a.references.forEach(function(f,y){l.push({index:y,startTime:o,endTime:o+f.subsegment_duration/a.timescale,duration:f.subsegment_duration/a.timescale,range:[u,u+f.referenced_size],frames:[]}),o+=f.subsegment_duration/a.timescale,u+=f.referenced_size}),s=l,n=l}else{var h,d,c=function(y){return y?[{index:0,startTime:0,endTime:y.duration/y.timescale,duration:y.duration/y.timescale,range:[r.start+r.size,""],frames:[]}]:[]};n=c(r.mvhd.duration?r.mvhd:(h=i.mdia)===null||h===void 0?void 0:h.mdhd),s=c(r.mvhd.duration?r.mvhd:(d=e.mdia)===null||d===void 0?void 0:d.mdhd)}return{videoSegments:n,audioSegments:s}}}}function Ji(r,a){var t=r.trak;if(!(!t||!t.length)){var i=t.find(function(m){var p,v;return((p=m.mdia)===null||p===void 0||(v=p.hdlr)===null||v===void 0?void 0:v.handlerType)==="vide"}),e=t.find(function(m){var p,v;return((p=m.mdia)===null||p===void 0||(v=p.hdlr)===null||v===void 0?void 0:v.handlerType)==="soun"});if(!(!i&&!e)){var s=[],n=[],l;if(i){var o,u,h,d=(o=i.mdia)===null||o===void 0||(u=o.minf)===null||u===void 0?void 0:u.stbl;if(!d)return;var c=(h=i.mdia.mdhd)===null||h===void 0?void 0:h.timescale,f=d.stts,y=d.stsc,g=d.stsz,b=d.stco,S=d.stss,G=d.ctts;if(!c||!f||!y||!g||!b||!S)return;s=bn(a,c,f,y,g,b,S,G),l=s.map(function(m){return m.duration})}if(e){var X,L,k,W=(X=e.mdia)===null||X===void 0||(L=X.minf)===null||L===void 0?void 0:L.stbl;if(!W)return;var V=(k=e.mdia.mdhd)===null||k===void 0?void 0:k.timescale,w=W.stts,M=W.stsc,C=W.stsz,U=W.stco;if(!V||!w||!M||!C||!U)return;n=bn(a,V,w,M,C,U,null,null,l)}return{videoSegments:s,audioSegments:n}}}}function bn(r,a,t,i,e,s,n,l,o){var u,h=[],d=[],c=[],f=i.entries,y=s.entries,g=e.entrySizes,b=n==null?void 0:n.entries,S=l==null?void 0:l.entries,G;S&&(G=[],S.forEach(function(ae){for(var rt=ae.count,Be=ae.offset,at=0;at<rt;at++)G.push(Be)}));var X;b&&(X={},b.forEach(function(ae){X[ae-1]=!0}));var L,k,W=0,V=0,w=0,M=0,C=0,U=(u=f[0])===null||u===void 0?void 0:u.samplesPerChunk,m=f[1]?f[1].firstChunk-1:1/0,p=0,v=-1;t.entries.forEach(function(ae){var rt=ae.count,Be=ae.delta;k=Be;for(var at=0;at<rt;at++)L={dts:p,startTime:W,duration:k,size:g[V]||e.sampleSize,offset:y[w]+C,index:V},b&&(L.keyframe=X[V],L.keyframe?(v++,d.push([L]),c.push(L.duration)):(d[d.length-1].push(L),c[d.length-1]+=L.duration),L.gopId=v),G&&V<G.length&&(L.pts=p+G[V]),V===0&&(L.pts=0),h.push(L),W+=k,p+=Be,V++,V<U?C+=L.size:(w++,C=0,w>=m&&(M++,m=f[M+1]?f[M+1].firstChunk-1:1/0),U+=f[M].samplesPerChunk)});var E=h.length;if(!E||n&&!h[0].keyframe)return[];var Z=[],R=[],x=0,D,_=0,K=function(rt){var Be;D=R[R.length-1],Z.push({index:Z.length,startTime:((Be=Z[Z.length-1])===null||Be===void 0?void 0:Be.endTime)||R[0].startTime/a,endTime:(D.startTime+D.duration)/a,duration:rt,range:[R[0].offset,D.offset+D.size],frames:R}),x=0,R=[]};if(n)for(var j=r*a,P=0,ve=d.length;P<ve;P++){var be;x+=c[P],(be=R).push.apply(be,co(d[P])),P+1<ve?(P===0||x>j)&&K(x/a):K(x/a)}else{o=o||[];for(var Je=o[0]||r,pe=0;pe<E;pe++){R.push(h[pe]),x+=h[pe].duration;var pt=x/a;(pe+1>=E||pt+_>=Je)&&(_+=pt-Je,K(pt),Je=o[Z.length]||r)}}return Z}function gn(r,a){var t="",i="",e=0,s=0,n=0,l=0,o=0,u=0,h=0;r.mvhd&&(o=r.mvhd.duration/r.mvhd.timescale);var d=r.trak;if(d){var c=d.find(function(Z){var R,x;return((R=Z.mdia)===null||R===void 0||(x=R.hdlr)===null||x===void 0?void 0:x.handlerType)==="vide"}),f=d.find(function(Z){var R,x;return((R=Z.mdia)===null||R===void 0||(x=R.hdlr)===null||x===void 0?void 0:x.handlerType)==="soun"}),y=null,g;if(c){var b,S,G;if(y=(b=c.mdia)===null||b===void 0||(S=b.minf)===null||S===void 0||(G=S.stbl)===null||G===void 0?void 0:G.stsd.entries[0],y){var X,L,k;if(e=y.width,s=y.height,u=(X=c.mdia)===null||X===void 0||(L=X.mdhd)===null||L===void 0?void 0:L.timescale,t=(k=y.avcC||y.hvcC||y.av1C)===null||k===void 0?void 0:k.codec,y.type==="encv"){var W,V;g=(W=y.sinf)===null||W===void 0||(V=W.schi)===null||V===void 0?void 0:V.tenc.default_KID}}}if(f){var w,M,C;if(y=(w=f.mdia)===null||w===void 0||(M=w.minf)===null||M===void 0||(C=M.stbl)===null||C===void 0?void 0:C.stsd.entries[0],y){var U,m,p;if(n=y.channelCount,l=y.sampleRate,i=(U=y.esds)===null||U===void 0?void 0:U.codec,h=(m=f.mdia)===null||m===void 0||(p=m.mdhd)===null||p===void 0?void 0:p.timescale,y.type==="enca"){var v,E;g=g||((v=y.sinf)===null||v===void 0||(E=v.schi)===null||E===void 0?void 0:E.tenc.default_KID)}}}return{kid:g?g.join(""):null,videoCodec:t,audioCodec:i,width:e,height:s,videoTimescale:u,audioChannelCount:n,audioSampleRate:l,duration:o,audioTimescale:h,moov:r,isFragmentMP4:a}}}function Zn(r){return typeof r=="number"&&!Number.isNaN(r)}var ko=["vid","cache"],So=function(r){no(t,r);var a=uo(t);function t(i){var e;Ss(this,t),e=a.call(this),De(Ue(e),"vid",""),De(Ue(e),"url",""),De(Ue(e),"meta",{}),De(Ue(e),"downloadInfo",[]),De(Ue(e),"videoSegments",[]),De(Ue(e),"audioSegments",[]),De(Ue(e),"cache",null),De(Ue(e),"_currentSegmentIndex",-1),De(Ue(e),"_currentLoadingSegmentIndex",-1),De(Ue(e),"buffer",void 0),De(Ue(e),"_error",void 0),De(Ue(e),"_transformError",function(u){return u}),e._config=go(i);var s=e._config,n=s.vid,l=s.cache,o=lo(s,ko);return e.cache=l||new Zo,e.vid=n||o.url,e.url=o.url,o.transformError=e._transformError,e.logger=new Te("MP4Loader_"+e.vid),i.openLog&&Te.enable(),o.logger=e.logger,e._loader=new ft(o),e._loader.on(F.REAL_TIME_SPEED,function(u){e.emit(F.REAL_TIME_SPEED,u)}),e}return Ls(t,[{key:"isMetaLoaded",get:function(){return this.videoSegments.length||this.audioSegments.length}},{key:"setCurrentSegment",value:function(e){Zn(e)&&(this._currentSegmentIndex=e)}},{key:"isLastSegment",value:function(e){if(Zn(e)){var s,n,l=((s=this.videoSegments[this.videoSegments.length-1])===null||s===void 0?void 0:s.index)||((n=this.audioSegments[this.audioSegments.length-1])===null||n===void 0?void 0:n.index)||0;return e>=l}return!1}},{key:"isSegmentLoading",value:function(e){return e===this._currentLoadingSegmentIndex}},{key:"changeUrl",value:function(){var i=Fe(le().mark(function s(n){var l,o,u,h=arguments;return le().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return l=h.length>1&&h[1]!==void 0?h[1]:n,o=h.length>2?h[2]:void 0,u=h.length>3?h[3]:void 0,c.next=5,this.reset(u);case 5:n&&(this.url=n),l&&(this.vid=l),o&&(this._config.moovEnd=o);case 8:case"end":return c.stop()}},s,this)}));function e(s){return i.apply(this,arguments)}return e}()},{key:"getOrLoadMeta",value:function(){var i=Fe(le().mark(function s(n){return le().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.isMetaLoaded){o.next=3;break}return o.next=3,this.loadMeta(n);case 3:return o.abrupt("return",this.meta);case 4:case"end":return o.stop()}},s,this)}));function e(s){return i.apply(this,arguments)}return e}()},{key:"loadMetaProcess",value:function(){var i=Fe(le().mark(function s(n,l,o,u){var h=this,d,c,f,y;return le().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return d=ho(l,2),c=d[0],f=d[1],this._error=!1,this.logger.debug("[loadMetaProcess start], range,",[c,f]),y=function(){var S=Fe(le().mark(function G(X,L,k){var W,V,w,M,C,U,m,p,v,E,Z,R,x;return le().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(h.meta&&k!==null&&k!==void 0&&k.range&&k.range.length>0&&k.range[1]>=f&&(L=!0,h.logger.debug("[loadMetaProcess],data done,setstate true,[",c,f,"]")),L&&k!==null&&k!==void 0&&k.range&&k.range.length>0&&k.range[1]<f&&(L=!1,h.logger.debug("[loadMetaProcess],data not done,setstate false,[",c,f,"]")),h.logger.debug("[loadMetaProcess],task,[",c,f,"], range,",k.range,",dataLen,",X?X.byteLength:void 0,", state,",L,",err,",h._error),!h._error&&X&&X.byteLength>0&&o(X,L,k),!(h.meta.moov||h._error)){_.next=6;break}return _.abrupt("return");case 6:if(!(X&&X.byteLength>0)){_.next=51;break}if(h.buffer=Gt(h.buffer,X),W=q.findBox(h.buffer,["moov"])[0],W){_.next=23;break}if(V=q.findBox(h.buffer,["mdat"])[0],!L){_.next=23;break}if(V){_.next=18;break}return h._error=!0,o(null,L,k,{err:"cannot find moov or mdat box"}),_.abrupt("return");case 18:return w=V.start+V.size,_.next=21,h.loadData([w,""],n,u);case 21:M=_.sent,M&&(W=q.findBox(M.data,["moov"])[0]);case 23:if(!(W&&L&&W.size>W.data.length)){_.next=27;break}return h.logger.debug("[loadMetaProcess],moov not all, range,",k.range[1],",dataLen,",h.buffer.byteLength,", state,",L),_.next=27,h.loadMetaProcess(n,[k.range[1],W.start+W.size-1],o);case 27:if(!(W&&W.size<=W.data.length&&!h.meta.moov)){_.next=51;break}if(C=q.moov(W),C){_.next=33;break}return h._error=!0,o(null,L,k,{err:"cannot parse moov box"}),_.abrupt("return");case 33:if(U=Ji(C,h._config.segmentDuration),m=function(){var K=Fe(le().mark(function j(P){var ve,be;return le().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:if(ve=q.findBox(h.buffer,[P])[0],!ve){pe.next=11;break}if(!(ve.size>ve.data.length)){pe.next=10;break}return pe.next=5,h.loadData([ve.start,ve.start+ve.size-1],n,u);case 5:if(be=pe.sent,!be){pe.next=8;break}return pe.abrupt("return",q.findBox(be.data,[P])[0]);case 8:pe.next=11;break;case 10:return pe.abrupt("return",ve);case 11:case"end":return pe.stop()}},j)}));return function(P){return K.apply(this,arguments)}}(),p=!1,U&&U.videoSegments.length&&U.audioSegments.length){_.next=41;break}return _.next=39,m("sidx");case 39:v=_.sent,v&&(E=q.sidx(v),E&&(U=vn(C,E),p=!0));case 41:if(U){_.next=45;break}return h._error=!0,o(null,L,k,{err:"cannot parse segments"}),_.abrupt("return");case 45:h.meta=gn(C,p),Z=U,R=Z.videoSegments,x=Z.audioSegments,h.videoSegments=R,h.audioSegments=x,h.logger.debug("[loadMetaProcess] moov ok"),o(void 0,L,{meta:{meta:h.meta,videoSegments:R,audioSegments:x}});case 51:case"end":return _.stop()}},G)}));return function(X,L,k){return S.apply(this,arguments)}}(),b.next=6,this.loadData([c,f||this._config.moovEnd],n,ds({onProgress:y},u));case 6:case"end":return b.stop()}},s,this)}));function e(s,n,l,o){return i.apply(this,arguments)}return e}()},{key:"loadMeta",value:function(){var i=Fe(le().mark(function s(n,l,o){var u,h,d,c,f,y,g,b,S,G,X,L,k,W;return le().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return u=[],this.logger.debug("[loadMeta start]"),w.next=4,this.loadData([0,l||this._config.moovEnd],n,o);case 4:if(h=w.sent,h){w.next=7;break}return w.abrupt("return");case 7:if(u.push(h),d=q.findBox(h.data,["moov"])[0],d){w.next=23;break}if(c=q.findBox(h.data,["mdat"])[0],c){w.next=13;break}throw new oi("cannot find moov or mdat box",h.data);case 13:return f=c.start+c.size,w.next=16,this.loadData([f],n,o);case 16:if(h=w.sent,h){w.next=19;break}return w.abrupt("return");case 19:if(u.push(h),d=q.findBox(h.data,["moov"],f)[0],d){w.next=23;break}throw new oi("cannot find moov box",h.data);case 23:if(!(d.size>d.data.length)){w.next=31;break}return w.next=26,this.loadData([h.data.length,d.start+d.size-1],n,o);case 26:if(h=w.sent,h){w.next=29;break}return w.abrupt("return");case 29:u.push(h),d.data=Gt(d.data,h.data);case 31:if(y=q.moov(d),y){w.next=34;break}throw new oi("cannot parse moov box",d.data);case 34:if(g=Ji(y,this._config.segmentDuration),g){w.next=37;break}throw new oi("cannot parse segments",d.data);case 37:return g.videoSegments.length&&g.audioSegments.length||(S=q.findBox(this.buffer,["moof"])[0],G=q.findBox(this.buffer,["sidx"])[0],S&&S.size<=S.data.length&&G&&(X=q.moof(S),b=q.sidx(G),X&&b&&(g=vn(y,b)))),this.meta=gn(y,b),L=g,k=L.videoSegments,W=L.audioSegments,this.videoSegments=k,this.audioSegments=W,this.logger.debug("[load moov end!!!!!]"),w.abrupt("return",{meta:this.meta,videoSegments:k,audioSegments:W,responses:u});case 44:case"end":return w.stop()}},s,this)}));function e(s,n,l){return i.apply(this,arguments)}return e}()},{key:"loadCacheMeta",value:function(e,s){var n=e.moov,l=Ji(n,this._config.segmentDuration),o=l.videoSegments,u=l.audioSegments;this.videoSegments=o,this.audioSegments=u,this._currentSegmentIndex=s,this.meta=e}},{key:"getSegmentByTime",value:function(e){var s,n;return this.videoSegments.length?(s=this.videoSegments.find(function(l){return l.startTime<=e&&l.endTime>e}),s&&(n=this.audioSegments[s.index])):n=this.audioSegments.find(function(l){return l.startTime<=e&&l.endTime>e}),{video:s,audio:n}}},{key:"loadSegmentByTime",value:function(){var i=Fe(le().mark(function s(n,l){var o,u,h,d,c,f=arguments;return le().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(o=f.length>2&&f[2]!==void 0?f[2]:!0,u=f.length>3&&f[3]!==void 0?f[3]:{},this.isMetaLoaded){g.next=5;break}return g.next=5,this.loadMeta(l);case 5:return h=this.getSegmentByTime(n),d=h.video,c=h.audio,g.abrupt("return",this._loadSegment(d,c,l,o,u));case 7:case"end":return g.stop()}},s,this)}));function e(s,n){return i.apply(this,arguments)}return e}()},{key:"loadNextSegment",value:function(){var i=Fe(le().mark(function s(n){var l,o,u,h,d=arguments;return le().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(l=d.length>1&&d[1]!==void 0?d[1]:!0,o=d.length>2&&d[2]!==void 0?d[2]:{},this.isMetaLoaded){f.next=5;break}return f.next=5,this.loadMeta();case 5:return u=this.videoSegments[this._currentSegmentIndex+1],h=this.audioSegments[this._currentSegmentIndex+1],f.abrupt("return",this._loadSegment(u,h,n,l,o));case 8:case"end":return f.stop()}},s,this)}));function e(s){return i.apply(this,arguments)}return e}()},{key:"preload",value:function(){var i=Fe(le().mark(function s(n){var l=this,o,u,h,d,c,f,y;return le().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(this.isMetaLoaded){b.next=3;break}return b.next=3,this.loadMeta(!0);case 3:if(!(!n||n<0)){b.next=5;break}return b.abrupt("return");case 5:if(o=this.getSegmentByTime(n),u=o.video,h=o.audio,d=Math.max((u==null?void 0:u.index)||0,(h==null?void 0:h.index)||0),d){b.next=9;break}return b.abrupt("return");case 9:return c=this.videoSegments.slice(0,d),f=this.audioSegments.slice(0,d),y=function(){var S=Fe(le().mark(function G(X){return le().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(!(X>d)){k.next=2;break}return k.abrupt("return");case 2:return k.next=4,l._loadSegment(c[X],f[X],!0,!1);case 4:return k.next=6,y(X+1);case 6:case"end":return k.stop()}},G)}));return function(X){return S.apply(this,arguments)}}(),b.next=14,y(0);case 14:case"end":return b.stop()}},s,this)}));function e(s){return i.apply(this,arguments)}return e}()},{key:"cancel",value:function(){return this._loader.cancel()}},{key:"reset",value:function(){var i=Fe(le().mark(function s(){var n,l=arguments;return le().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(n=l.length>0&&l[0]!==void 0?l[0]:!1,n){u.next=5;break}return this.logger.debug("[MP4loader reset func call loader.cancel]"),u.next=5,this._loader.cancel();case 5:this.vid=this.url="",this.meta={},this.downloadInfo=[],this.videoSegments=[],this.audioSegments=[],this._currentSegmentIndex=-1,this._currentLoadingSegmentIndex=-1;case 12:case"end":return u.stop()}},s,this)}));function e(){return i.apply(this,arguments)}return e}()},{key:"destroy",value:function(){var i=Fe(le().mark(function s(){return le().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.reset();case 2:this.cache.clear();case 3:case"end":return l.stop()}},s,this)}));function e(){return i.apply(this,arguments)}return e}()},{key:"_loadSegment",value:function(){var i=Fe(le().mark(function s(n,l,o,u,h){var d,c;return le().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!(!n&&!l)){y.next=2;break}return y.abrupt("return");case 2:return d=(n==null?void 0:n.index)||(l==null?void 0:l.index)||0,this._currentLoadingSegmentIndex=d,y.prev=4,y.next=7,this.loadData([Math.min((n==null?void 0:n.range[0])||1/0,(l==null?void 0:l.range[0])||1/0),Math.max((n==null?void 0:n.range[1])||0,(l==null?void 0:l.range[1])||0)],o,h);case 7:c=y.sent;case 8:return y.prev=8,this._currentLoadingSegmentIndex=-1,y.finish(8);case 11:if(c){y.next=13;break}return y.abrupt("return");case 13:return u&&(this._currentSegmentIndex=d),c.video=n,c.audio=l,y.abrupt("return",c);case 17:case"end":return y.stop()}},s,this,[[4,,8,11]])}));function e(s,n,l,o,u){return i.apply(this,arguments)}return e}()},{key:"loadData",value:function(){var i=Fe(le().mark(function s(n,l,o){var u,h,d,c;return le().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return u=this._getCacheKey(n),y.next=3,this.cache.get(u);case 3:if(h=y.sent,h){y.next=11;break}return c=o&&o.url?o.url:this.url,y.next=8,this._loader.load(c,ds({range:n,vid:this.vid},o));case 8:d=y.sent,y.next=12;break;case 11:d={data:h,state:!0,options:{fromCache:!0,range:n,vid:this.vid}};case 12:if(d){y.next=14;break}return y.abrupt("return");case 14:return h||(d.data&&this.downloadInfo.push({startTime:d.startTime,endTime:d.endTime,size:d.data.byteLength,range:n}),this.downloadInfo&&this.downloadInfo.length>this._config.maxDownloadInfoSize&&(this.downloadInfo=this.downloadInfo.slice(-this._config.maxDownloadInfoSize))),y.abrupt("return",d);case 17:case"end":return y.stop()}},s,this)}));function e(s,n,l){return i.apply(this,arguments)}return e}()},{key:"_getCacheKey",value:function(e){return(this.vid||this.url)+":"+e}}]),t}(vt),Lr=Go(),Lo=Nt();Wo();function Eo(){try{return typeof localStorage<"u"&&"setItem"in window.localStorage&&!!window.localStorage.setItem}catch{return!1}}function Xo(){var r="_localstorage_support_test";try{return window.localStorage.setItem(r,!0),window.localStorage.removeItem(r),!1}catch{return!0}}function Nt(){if(Lr)try{return!!window.localStorage.getItem("playerlog")}catch{return!1}return!1}function Go(){return Eo()&&!Xo()}function Er(r){for(var a,t=arguments.length,i=new Array(t>1?t-1:0),e=1;e<t;e++)i[e-1]=arguments[e];Lo&&console.log&&(a=console).log.apply(a,["[logger]",et.nowTime(),r].concat(i))}function Wo(){if(Lr)try{return!!window.localStorage.getItem("playertestlog")}catch{return!1}return!1}var Xr="IWZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUoZSx0KXt2YXIgcj1PYmplY3Qua2V5cyhlKTtpZihPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgYT1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3QmJihhPWEuZmlsdGVyKChmdW5jdGlvbih0KXtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLHQpLmVudW1lcmFibGV9KSkpLHIucHVzaC5hcHBseShyLGEpfXJldHVybiByfWZ1bmN0aW9uIHQodCl7Zm9yKHZhciByPTE7cjxhcmd1bWVudHMubGVuZ3RoO3IrKyl7dmFyIGE9bnVsbCE9YXJndW1lbnRzW3JdP2FyZ3VtZW50c1tyXTp7fTtyJTI/ZShPYmplY3QoYSksITApLmZvckVhY2goKGZ1bmN0aW9uKGUpe2kodCxlLGFbZV0pfSkpOk9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzP09iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHQsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoYSkpOmUoT2JqZWN0KGEpKS5mb3JFYWNoKChmdW5jdGlvbihlKXtPYmplY3QuZGVmaW5lUHJvcGVydHkodCxlLE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoYSxlKSl9KSl9cmV0dXJuIHR9ZnVuY3Rpb24gcihlLHQpe2lmKCEoZSBpbnN0YW5jZW9mIHQpKXRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpfWZ1bmN0aW9uIGEoZSx0KXtmb3IodmFyIHI9MDtyPHQubGVuZ3RoO3IrKyl7dmFyIGE9dFtyXTthLmVudW1lcmFibGU9YS5lbnVtZXJhYmxlfHwhMSxhLmNvbmZpZ3VyYWJsZT0hMCwidmFsdWUiaW4gYSYmKGEud3JpdGFibGU9ITApLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLGsoYS5rZXkpLGEpfX1mdW5jdGlvbiBuKGUsdCxyKXtyZXR1cm4gdCYmYShlLnByb3RvdHlwZSx0KSxyJiZhKGUsciksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsInByb3RvdHlwZSIse3dyaXRhYmxlOiExfSksZX1mdW5jdGlvbiBpKGUsdCxyKXtyZXR1cm4odD1rKHQpKWluIGU/T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCx7dmFsdWU6cixlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMH0pOmVbdF09cixlfWZ1bmN0aW9uIHMoZSx0KXtpZigiZnVuY3Rpb24iIT10eXBlb2YgdCYmbnVsbCE9PXQpdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTtlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHQmJnQucHJvdG90eXBlLHtjb25zdHJ1Y3Rvcjp7dmFsdWU6ZSx3cml0YWJsZTohMCxjb25maWd1cmFibGU6ITB9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsInByb3RvdHlwZSIse3dyaXRhYmxlOiExfSksdCYmdShlLHQpfWZ1bmN0aW9uIG8oZSl7cmV0dXJuKG89T2JqZWN0LnNldFByb3RvdHlwZU9mP09iamVjdC5nZXRQcm90b3R5cGVPZi5iaW5kKCk6ZnVuY3Rpb24oZSl7cmV0dXJuIGUuX19wcm90b19ffHxPYmplY3QuZ2V0UHJvdG90eXBlT2YoZSl9KShlKX1mdW5jdGlvbiB1KGUsdCl7cmV0dXJuKHU9T2JqZWN0LnNldFByb3RvdHlwZU9mP09iamVjdC5zZXRQcm90b3R5cGVPZi5iaW5kKCk6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5fX3Byb3RvX189dCxlfSkoZSx0KX1mdW5jdGlvbiBjKCl7aWYoInVuZGVmaW5lZCI9PXR5cGVvZiBSZWZsZWN0fHwhUmVmbGVjdC5jb25zdHJ1Y3QpcmV0dXJuITE7aWYoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSlyZXR1cm4hMTtpZigiZnVuY3Rpb24iPT10eXBlb2YgUHJveHkpcmV0dXJuITA7dHJ5e3JldHVybiBCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoQm9vbGVhbixbXSwoZnVuY3Rpb24oKXt9KSkpLCEwfWNhdGNoKGUpe3JldHVybiExfX1mdW5jdGlvbiBsKGUsdCxyKXtyZXR1cm4obD1jKCk/UmVmbGVjdC5jb25zdHJ1Y3QuYmluZCgpOmZ1bmN0aW9uKGUsdCxyKXt2YXIgYT1bbnVsbF07YS5wdXNoLmFwcGx5KGEsdCk7dmFyIG49bmV3KEZ1bmN0aW9uLmJpbmQuYXBwbHkoZSxhKSk7cmV0dXJuIHImJnUobixyLnByb3RvdHlwZSksbn0pLmFwcGx5KG51bGwsYXJndW1lbnRzKX1mdW5jdGlvbiBmKGUsdCl7aWYodCYmKCJvYmplY3QiPT10eXBlb2YgdHx8ImZ1bmN0aW9uIj09dHlwZW9mIHQpKXJldHVybiB0O2lmKHZvaWQgMCE9PXQpdGhyb3cgbmV3IFR5cGVFcnJvcigiRGVyaXZlZCBjb25zdHJ1Y3RvcnMgbWF5IG9ubHkgcmV0dXJuIG9iamVjdCBvciB1bmRlZmluZWQiKTtyZXR1cm4gZnVuY3Rpb24oZSl7aWYodm9pZCAwPT09ZSl0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpO3JldHVybiBlfShlKX1mdW5jdGlvbiBkKGUpe3ZhciB0PWMoKTtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgcixhPW8oZSk7aWYodCl7dmFyIG49byh0aGlzKS5jb25zdHJ1Y3RvcjtyPVJlZmxlY3QuY29uc3RydWN0KGEsYXJndW1lbnRzLG4pfWVsc2Ugcj1hLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm4gZih0aGlzLHIpfX1mdW5jdGlvbiBoKGUsdCl7Zm9yKDshT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsdCkmJm51bGwhPT0oZT1vKGUpKTspO3JldHVybiBlfWZ1bmN0aW9uIHAoKXtyZXR1cm4gcD0idW5kZWZpbmVkIiE9dHlwZW9mIFJlZmxlY3QmJlJlZmxlY3QuZ2V0P1JlZmxlY3QuZ2V0LmJpbmQoKTpmdW5jdGlvbihlLHQscil7dmFyIGE9aChlLHQpO2lmKGEpe3ZhciBuPU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoYSx0KTtyZXR1cm4gbi5nZXQ/bi5nZXQuY2FsbChhcmd1bWVudHMubGVuZ3RoPDM/ZTpyKTpuLnZhbHVlfX0scC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9ZnVuY3Rpb24gdihlLHQpe3JldHVybiBmdW5jdGlvbihlKXtpZihBcnJheS5pc0FycmF5KGUpKXJldHVybiBlfShlKXx8ZnVuY3Rpb24oZSx0KXt2YXIgcj1udWxsPT1lP251bGw6InVuZGVmaW5lZCIhPXR5cGVvZiBTeW1ib2wmJmVbU3ltYm9sLml0ZXJhdG9yXXx8ZVsiQEBpdGVyYXRvciJdO2lmKG51bGwhPXIpe3ZhciBhLG4saSxzLG89W10sdT0hMCxjPSExO3RyeXtpZihpPShyPXIuY2FsbChlKSkubmV4dCwwPT09dCl7aWYoT2JqZWN0KHIpIT09cilyZXR1cm47dT0hMX1lbHNlIGZvcig7ISh1PShhPWkuY2FsbChyKSkuZG9uZSkmJihvLnB1c2goYS52YWx1ZSksby5sZW5ndGghPT10KTt1PSEwKTt9Y2F0Y2gobCl7Yz0hMCxuPWx9ZmluYWxseXt0cnl7aWYoIXUmJm51bGwhPXIucmV0dXJuJiYocz1yLnJldHVybigpLE9iamVjdChzKSE9PXMpKXJldHVybn1maW5hbGx5e2lmKGMpdGhyb3cgbn19cmV0dXJuIG99fShlLHQpfHxtKGUsdCl8fGZ1bmN0aW9uKCl7dGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC4iKX0oKX1mdW5jdGlvbiB5KGUpe3JldHVybiBmdW5jdGlvbihlKXtpZihBcnJheS5pc0FycmF5KGUpKXJldHVybiBnKGUpfShlKXx8ZnVuY3Rpb24oZSl7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiBTeW1ib2wmJm51bGwhPWVbU3ltYm9sLml0ZXJhdG9yXXx8bnVsbCE9ZVsiQEBpdGVyYXRvciJdKXJldHVybiBBcnJheS5mcm9tKGUpfShlKXx8bShlKXx8ZnVuY3Rpb24oKXt0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC4iKX0oKX1mdW5jdGlvbiBtKGUsdCl7aWYoZSl7aWYoInN0cmluZyI9PXR5cGVvZiBlKXJldHVybiBnKGUsdCk7dmFyIHI9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUpLnNsaWNlKDgsLTEpO3JldHVybiJPYmplY3QiPT09ciYmZS5jb25zdHJ1Y3RvciYmKHI9ZS5jb25zdHJ1Y3Rvci5uYW1lKSwiTWFwIj09PXJ8fCJTZXQiPT09cj9BcnJheS5mcm9tKGUpOiJBcmd1bWVudHMiPT09cnx8L14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3Qocik/ZyhlLHQpOnZvaWQgMH19ZnVuY3Rpb24gZyhlLHQpeyhudWxsPT10fHx0PmUubGVuZ3RoKSYmKHQ9ZS5sZW5ndGgpO2Zvcih2YXIgcj0wLGE9bmV3IEFycmF5KHQpO3I8dDtyKyspYVtyXT1lW3JdO3JldHVybiBhfWZ1bmN0aW9uIGsoZSl7dmFyIHQ9ZnVuY3Rpb24oZSx0KXtpZigib2JqZWN0IiE9dHlwZW9mIGV8fG51bGw9PT1lKXJldHVybiBlO3ZhciByPWVbU3ltYm9sLnRvUHJpbWl0aXZlXTtpZih2b2lkIDAhPT1yKXt2YXIgYT1yLmNhbGwoZSx0fHwiZGVmYXVsdCIpO2lmKCJvYmplY3QiIT10eXBlb2YgYSlyZXR1cm4gYTt0aHJvdyBuZXcgVHlwZUVycm9yKCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLiIpfXJldHVybigic3RyaW5nIj09PXQ/U3RyaW5nOk51bWJlcikoZSl9KGUsInN0cmluZyIpO3JldHVybiJzeW1ib2wiPT10eXBlb2YgdD90OlN0cmluZyh0KX12YXIgYj0idmlkZW8iLF89ImF1ZGlvIix3PSJtZXRhZGF0YSIseD0iYXYxIixTPSJhdmMiLEE9ImhldmMiLEQ9ImFhYyIsQj0iZzcxMTBhIixFPSJnNzExMG0iLFQ9IkxBUkdFX0FWX1NISUZUIixVPSJMQVJHRV9WSURFT19HQVAiLEM9IkxBUkdFX1ZJREVPX0dBUF9CRVRXRUVOX0NIVU5LIixQPSJMQVJHRV9BVURJT19HQVAiLEk9IkFVRElPX0ZJTExFRCIsTT0iQVVESU9fRFJPUFBFRCIsej1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXtyKHRoaXMsZSksaSh0aGlzLCJpZCIsMSksaSh0aGlzLCJ0eXBlIixiKSxpKHRoaXMsImNvZGVjVHlwZSIsUyksaSh0aGlzLCJwaWQiLC0xKSxpKHRoaXMsImh2Y0MiLHZvaWQgMCksaSh0aGlzLCJjb2RlYyIsIiIpLGkodGhpcywidGltZXNjYWxlIiwwKSxpKHRoaXMsImZvcm1hdFRpbWVzY2FsZSIsMCksaSh0aGlzLCJzZXF1ZW5jZU51bWJlciIsMCksaSh0aGlzLCJiYXNlTWVkaWFEZWNvZGVUaW1lIiwwKSxpKHRoaXMsImJhc2VEdHMiLDApLGkodGhpcywiZHVyYXRpb24iLDApLGkodGhpcywid2FybmluZ3MiLFtdKSxpKHRoaXMsInNhbXBsZXMiLFtdKSxpKHRoaXMsInBwcyIsW10pLGkodGhpcywic3BzIixbXSksaSh0aGlzLCJ2cHMiLFtdKSxpKHRoaXMsImZwc051bSIsMCksaSh0aGlzLCJmcHNEZW4iLDApLGkodGhpcywic2FyUmF0aW8iLFtdKSxpKHRoaXMsIndpZHRoIiwwKSxpKHRoaXMsImhlaWdodCIsMCksaSh0aGlzLCJuYWxVbml0U2l6ZSIsNCksaSh0aGlzLCJwcmVzZW50IiwhMSksaSh0aGlzLCJpc1ZpZGVvRW5jcnlwdGlvbiIsITEpLGkodGhpcywiaXNBdWRpb0VuY3J5cHRpb24iLCExKSxpKHRoaXMsImlzVmlkZW8iLCEwKSxpKHRoaXMsImtpZCIsbnVsbCksaSh0aGlzLCJwc3NoIixudWxsKSxpKHRoaXMsImV4dCIsdm9pZCAwKX1yZXR1cm4gbihlLFt7a2V5OiJyZXNldCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLnNlcXVlbmNlTnVtYmVyPXRoaXMud2lkdGg9dGhpcy5oZWlnaHQ9dGhpcy5mcHNEZW49dGhpcy5mcHNOdW09dGhpcy5kdXJhdGlvbj10aGlzLmJhc2VNZWRpYURlY29kZVRpbWU9dGhpcy50aW1lc2NhbGU9MCx0aGlzLmNvZGVjPSIiLHRoaXMucHJlc2VudD0hMSx0aGlzLnBpZD0tMSx0aGlzLnBwcz1bXSx0aGlzLnNwcz1bXSx0aGlzLnZwcz1bXSx0aGlzLnNhclJhdGlvPVtdLHRoaXMuc2FtcGxlcz1bXSx0aGlzLndhcm5pbmdzPVtdLHRoaXMuaHZjQz1udWxsfX0se2tleToiZmlyc3REdHMiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNhbXBsZXMubGVuZ3RoP3RoaXMuc2FtcGxlc1swXS5kdHM6bnVsbH19LHtrZXk6ImZpcnN0UHRzIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zYW1wbGVzLmxlbmd0aD90aGlzLnNhbXBsZXNbMF0ucHRzOm51bGx9fSx7a2V5OiJzYW1wbGVzRHVyYXRpb24iLGdldDpmdW5jdGlvbigpe2lmKHRoaXMuc2FtcGxlcy5sZW5ndGg+MCl7dmFyIGU9dGhpcy5zYW1wbGVzWzBdLHQ9dGhpcy5zYW1wbGVzW3RoaXMuc2FtcGxlcy5sZW5ndGgtMV07cmV0dXJuIHQuZHRzLWUuZHRzK3QuZHVyYXRpb259cmV0dXJuIDB9fSx7a2V5OiJleGlzdCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4hIS9hdjAxLy50ZXN0KHRoaXMuY29kZWMpfHwhISh0aGlzLnBwcy5sZW5ndGgmJnRoaXMuc3BzLmxlbmd0aCYmdGhpcy5jb2RlYyl9fSx7a2V5OiJoYXNTYW1wbGUiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLnNhbXBsZXMubGVuZ3RofX0se2tleToiaXNFbmNyeXB0aW9uIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc1ZpZGVvRW5jcnlwdGlvbn19XSksZX0oKSxPPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe3IodGhpcyxlKSxpKHRoaXMsImlkIiwyKSxpKHRoaXMsInR5cGUiLF8pLGkodGhpcywiY29kZWNUeXBlIixEKSxpKHRoaXMsInBpZCIsLTEpLGkodGhpcywiY29kZWMiLCIiKSxpKHRoaXMsInNlcXVlbmNlTnVtYmVyIiwwKSxpKHRoaXMsInNhbXBsZUR1cmF0aW9uIiwwKSxpKHRoaXMsInRpbWVzY2FsZSIsMCksaSh0aGlzLCJmb3JtYXRUaW1lc2NhbGUiLDApLGkodGhpcywiYmFzZU1lZGlhRGVjb2RlVGltZSIsMCksaSh0aGlzLCJkdXJhdGlvbiIsMCksaSh0aGlzLCJ3YXJuaW5ncyIsW10pLGkodGhpcywic2FtcGxlcyIsW10pLGkodGhpcywiYmFzZUR0cyIsMCksaSh0aGlzLCJzYW1wbGVTaXplIiwxNiksaSh0aGlzLCJzYW1wbGVSYXRlIiwwKSxpKHRoaXMsImNoYW5uZWxDb3VudCIsMCksaSh0aGlzLCJvYmplY3RUeXBlIiwwKSxpKHRoaXMsInNhbXBsZVJhdGVJbmRleCIsMCksaSh0aGlzLCJjb25maWciLFtdKSxpKHRoaXMsInByZXNlbnQiLCExKSxpKHRoaXMsImlzVmlkZW9FbmNyeXB0aW9uIiwhMSksaSh0aGlzLCJpc0F1ZGlvRW5jcnlwdGlvbiIsITEpLGkodGhpcywia2lkIixudWxsKSxpKHRoaXMsImV4dCIsdm9pZCAwKX1yZXR1cm4gbihlLFt7a2V5OiJyZXNldCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLnNlcXVlbmNlTnVtYmVyPTAsdGhpcy50aW1lc2NhbGU9MCx0aGlzLnNhbXBsZUR1cmF0aW9uPTAsdGhpcy5zYW1wbGVSYXRlPTAsdGhpcy5jaGFubmVsQ291bnQ9MCx0aGlzLmJhc2VNZWRpYURlY29kZVRpbWU9MCx0aGlzLnByZXNlbnQ9ITEsdGhpcy5waWQ9LTEsdGhpcy5jb2RlYz0iIix0aGlzLnNhbXBsZXM9W10sdGhpcy5jb25maWc9W10sdGhpcy53YXJuaW5ncz1bXX19LHtrZXk6ImV4aXN0Iix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiEhKHRoaXMuc2FtcGxlUmF0ZSYmdGhpcy5jaGFubmVsQ291bnQmJnRoaXMuY29kZWMmJnRoaXMuY29kZWNUeXBlPT09RCl9fSx7a2V5OiJoYXNTYW1wbGUiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLnNhbXBsZXMubGVuZ3RofX0se2tleToiaXNFbmNyeXB0aW9uIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc0F1ZGlvRW5jcnlwdGlvbn19LHtrZXk6ImZpcnN0RHRzIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zYW1wbGVzLmxlbmd0aD90aGlzLnNhbXBsZXNbMF0uZHRzOm51bGx9fSx7a2V5OiJmaXJzdFB0cyIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2FtcGxlcy5sZW5ndGg/dGhpcy5zYW1wbGVzWzBdLnB0czpudWxsfX0se2tleToic2FtcGxlc0R1cmF0aW9uIixnZXQ6ZnVuY3Rpb24oKXtpZih0aGlzLnNhbXBsZXMubGVuZ3RoPjApe3ZhciBlPXRoaXMuc2FtcGxlc1swXSx0PXRoaXMuc2FtcGxlc1t0aGlzLnNhbXBsZXMubGVuZ3RoLTFdO3JldHVybiB0LmR0cy1lLmR0cyt0LmR1cmF0aW9ufXJldHVybiAwfX1dKSxlfSgpLFI9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQsYSxuKXtyKHRoaXMsZSksaSh0aGlzLCJmbGFnIix7fSksaSh0aGlzLCJrZXlmcmFtZSIsITEpLGkodGhpcywiZ29wSWQiLDApLGkodGhpcywiZHVyYXRpb24iLDApLGkodGhpcywic2l6ZSIsMCksaSh0aGlzLCJ1bml0cyIsW10pLGkodGhpcywiY2hyb21hRm9ybWF0Iiw0MjApLHRoaXMub3JpZ2luUHRzPXRoaXMucHRzPXQsdGhpcy5vcmlnaW5EdHM9dGhpcy5kdHM9YSxuJiYodGhpcy51bml0cz1uKX1yZXR1cm4gbihlLFt7a2V5OiJjdHMiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnB0cy10aGlzLmR0c319LHtrZXk6InNldFRvS2V5ZnJhbWUiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5rZXlmcmFtZT0hMCx0aGlzLmZsYWcuZGVwZW5kc09uPTIsdGhpcy5mbGFnLmlzTm9uU3luY1NhbXBsZT0wfX1dKSxlfSgpLEw9bigoZnVuY3Rpb24gZSh0LGEsbixzKXtyKHRoaXMsZSksaSh0aGlzLCJkdXJhdGlvbiIsMTAyNCksaSh0aGlzLCJmbGFnIix7ZGVwZW5kc09uOjIsaXNOb25TeW5jU2FtcGxlOjB9KSxpKHRoaXMsImtleWZyYW1lIiwhMCksdGhpcy5vcmlnaW5QdHM9dGhpcy5wdHM9dGhpcy5kdHM9dCx0aGlzLmRhdGE9YSx0aGlzLnNpemU9YS5ieXRlTGVuZ3RoLHRoaXMuc2FtcGxlT2Zmc2V0PXMsbiYmKHRoaXMuZHVyYXRpb249bil9KSksVj1uKChmdW5jdGlvbiBlKHQsYSl7cih0aGlzLGUpLGkodGhpcywidGltZSIsMCksdGhpcy5kYXRhPXQsdGhpcy5vcmlnaW5QdHM9dGhpcy5wdHM9YX0pKSxGPWZ1bmN0aW9uKGUpe3MoYSxlKTt2YXIgdD1kKGEpO2Z1bmN0aW9uIGEoKXtyZXR1cm4gcih0aGlzLGEpLHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiBuKGEpfShWKSxOPWZ1bmN0aW9uKGUpe3MoYSxlKTt2YXIgdD1kKGEpO2Z1bmN0aW9uIGEoKXtyZXR1cm4gcih0aGlzLGEpLHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiBuKGEpfShWKSxqPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe3IodGhpcyxlKSxpKHRoaXMsImlkIiwzKSxpKHRoaXMsInR5cGUiLHcpLGkodGhpcywidGltZXNjYWxlIiwwKSxpKHRoaXMsImZsdlNjcmlwdFNhbXBsZXMiLFtdKSxpKHRoaXMsInNlaVNhbXBsZXMiLFtdKX1yZXR1cm4gbihlLFt7a2V5OiJleGlzdCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4hKCF0aGlzLmZsdlNjcmlwdFNhbXBsZXMubGVuZ3RoJiYhdGhpcy5zZWlTYW1wbGVzLmxlbmd0aHx8IXRoaXMudGltZXNjYWxlKX19LHtrZXk6InJlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3RoaXMudGltZXNjYWxlPTAsdGhpcy5mbHZTY3JpcHRTYW1wbGVzPVtdLHRoaXMuc2VpU2FtcGxlcz1bXX19LHtrZXk6Imhhc1NhbXBsZSIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4hKCF0aGlzLmZsdlNjcmlwdFNhbXBsZXMubGVuZ3RoJiYhdGhpcy5zZWlTYW1wbGVzLmxlbmd0aCl9fV0pLGV9KCksRz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCl7aWYocih0aGlzLGUpLGkodGhpcywiX2J5dGVzQXZhaWxhYmxlIix2b2lkIDApLGkodGhpcywiX2JpdHNBdmFpbGFibGUiLDApLGkodGhpcywiX3dvcmQiLDApLCF0KXRocm93IG5ldyBFcnJvcigiRXhwR29sb21iIGRhdGEgcGFyYW1zIGlzIHJlcXVpcmVkIik7dGhpcy5fZGF0YT10LHRoaXMuX2J5dGVzQXZhaWxhYmxlPXQuYnl0ZUxlbmd0aCx0aGlzLl9ieXRlc0F2YWlsYWJsZSYmdGhpcy5fbG9hZFdvcmQoKX1yZXR1cm4gbihlLFt7a2V5OiJiaXRzQXZhaWxhYmxlIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYml0c0F2YWlsYWJsZX19LHtrZXk6Il9sb2FkV29yZCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLl9kYXRhLmJ5dGVMZW5ndGgtdGhpcy5fYnl0ZXNBdmFpbGFibGUsdD1NYXRoLm1pbig0LHRoaXMuX2J5dGVzQXZhaWxhYmxlKTtpZigwPT09dCl0aHJvdyBuZXcgRXJyb3IoIk5vIGJ5dGVzIGF2YWlsYWJsZSIpO3ZhciByPW5ldyBVaW50OEFycmF5KDQpO3Iuc2V0KHRoaXMuX2RhdGEuc3ViYXJyYXkoZSxlK3QpKSx0aGlzLl93b3JkPW5ldyBEYXRhVmlldyhyLmJ1ZmZlcikuZ2V0VWludDMyKDApLHRoaXMuX2JpdHNBdmFpbGFibGU9OCp0LHRoaXMuX2J5dGVzQXZhaWxhYmxlLT10fX0se2tleToic2tpcEJpdHMiLHZhbHVlOmZ1bmN0aW9uKGUpe2lmKHRoaXMuX2JpdHNBdmFpbGFibGU+ZSl0aGlzLl93b3JkPDw9ZSx0aGlzLl9iaXRzQXZhaWxhYmxlLT1lO2Vsc2V7ZS09dGhpcy5fYml0c0F2YWlsYWJsZTt2YXIgdD1NYXRoLmZsb29yKGUvOCk7ZS09OCp0LHRoaXMuX2J5dGVzQXZhaWxhYmxlLT10LHRoaXMuX2xvYWRXb3JkKCksdGhpcy5fd29yZDw8PWUsdGhpcy5fYml0c0F2YWlsYWJsZS09ZX19fSx7a2V5OiJyZWFkQml0cyIsdmFsdWU6ZnVuY3Rpb24oZSl7aWYoZT4zMil0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCByZWFkIG1vcmUgdGhhbiAzMiBiaXRzIik7dmFyIHQ9TWF0aC5taW4odGhpcy5fYml0c0F2YWlsYWJsZSxlKSxyPXRoaXMuX3dvcmQ+Pj4zMi10O3JldHVybiB0aGlzLl9iaXRzQXZhaWxhYmxlLT10LHRoaXMuX2JpdHNBdmFpbGFibGU+MD90aGlzLl93b3JkPDw9dDp0aGlzLl9ieXRlc0F2YWlsYWJsZT4wJiZ0aGlzLl9sb2FkV29yZCgpLCh0PWUtdCk+MCYmdGhpcy5fYml0c0F2YWlsYWJsZT9yPDx0fHRoaXMucmVhZEJpdHModCk6cn19LHtrZXk6InNraXBMWiIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZTtmb3IoZT0wO2U8dGhpcy5fYml0c0F2YWlsYWJsZTsrK2UpaWYoMCE9KHRoaXMuX3dvcmQmMjE0NzQ4MzY0OD4+PmUpKXJldHVybiB0aGlzLl93b3JkPDw9ZSx0aGlzLl9iaXRzQXZhaWxhYmxlLT1lLGU7cmV0dXJuIHRoaXMuX2xvYWRXb3JkKCksZSt0aGlzLnNraXBMWigpfX0se2tleToic2tpcFVFRyIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLnNraXBCaXRzKDErdGhpcy5za2lwTFooKSl9fSx7a2V5OiJyZWFkVUVHIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuc2tpcExaKCk7cmV0dXJuIHRoaXMucmVhZEJpdHMoZSsxKS0xfX0se2tleToicmVhZEVHIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMucmVhZFVFRygpO3JldHVybiAxJmU/MStlPj4+MTotMSooZT4+PjEpfX0se2tleToicmVhZEJvb2wiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIDE9PT10aGlzLnJlYWRCaXRzKDEpfX0se2tleToicmVhZFVCeXRlIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJlYWRCaXRzKDgpfX0se2tleToic2tpcFNjYWxpbmdMaXN0Iix2YWx1ZTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9OCxyPTgsYT0wO2E8ZTthKyspMCE9PXImJihyPSh0K3RoaXMucmVhZEVHKCkrMjU2KSUyNTYpLHQ9MD09PXI/dDpyfX1dKSxlfSgpLEg9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe3IodGhpcyxlKSx0aGlzLm5hbWU9dHx8IiIsdGhpcy5fcHJlZml4PSJbIi5jb25jYXQodGhpcy5uYW1lLCJdIil9cmV0dXJuIG4oZSxbe2tleToid2FybiIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgdDtpZighZS5kaXNhYmxlZCl7Zm9yKHZhciByPWFyZ3VtZW50cy5sZW5ndGgsYT1uZXcgQXJyYXkociksbj0wO248cjtuKyspYVtuXT1hcmd1bWVudHNbbl07KHQ9Y29uc29sZSkud2Fybi5hcHBseSh0LFt0aGlzLl9wcmVmaXhdLmNvbmNhdChhKSl9fX1dLFt7a2V5OiJlbmFibGUiLHZhbHVlOmZ1bmN0aW9uKCl7ZS5kaXNhYmxlZD0hMX19LHtrZXk6ImRpc2FibGUiLHZhbHVlOmZ1bmN0aW9uKCl7ZS5kaXNhYmxlZD0hMH19XSksZX0oKTtpKEgsImRpc2FibGVkIiwhMCk7dmFyIEs9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7cih0aGlzLGUpfXJldHVybiBuKGUsbnVsbCxbe2tleToiZGVjb2RlIix2YWx1ZTpmdW5jdGlvbih0KXtmb3IodmFyIHI9W10sYT10LG49MCxpPXQubGVuZ3RoO248aTspaWYoYVtuXTwxMjgpci5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoYVtuXSkpLCsrbjtlbHNle2lmKGFbbl08MTkyKTtlbHNlIGlmKGFbbl08MjI0KXtpZihlLl9jaGVja0NvbnRpbnVhdGlvbihhLG4sMSkpe3ZhciBzPSgzMSZhW25dKTw8Nnw2MyZhW24rMV07aWYocz49MTI4KXtyLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZSg2NTUzNSZzKSksbis9Mjtjb250aW51ZX19fWVsc2UgaWYoYVtuXTwyNDApe2lmKGUuX2NoZWNrQ29udGludWF0aW9uKGEsbiwyKSl7dmFyIG89KDE1JmFbbl0pPDwxMnwoNjMmYVtuKzFdKTw8Nnw2MyZhW24rMl07aWYobz49MjA0OCYmNTUyOTYhPSg2MzQ4OCZvKSl7ci5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoNjU1MzUmbykpLG4rPTM7Y29udGludWV9fX1lbHNlIGlmKGFbbl08MjQ4JiZlLl9jaGVja0NvbnRpbnVhdGlvbihhLG4sMykpe3ZhciB1PSg3JmFbbl0pPDwxOHwoNjMmYVtuKzFdKTw8MTJ8KDYzJmFbbisyXSk8PDZ8NjMmYVtuKzNdO2lmKHU+NjU1MzYmJnU8MTExNDExMil7dS09NjU1MzYsci5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUodT4+PjEwfDU1Mjk2KSksci5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoMTAyMyZ1fDU2MzIwKSksbis9NDtjb250aW51ZX19ci5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoNjU1MzMpKSwrK259cmV0dXJuIHIuam9pbigiIil9fSx7a2V5OiJfY2hlY2tDb250aW51YXRpb24iLHZhbHVlOmZ1bmN0aW9uKGUsdCxyKXt2YXIgYT1lO2lmKHQrcjxhLmxlbmd0aCl7Zm9yKDtyLS07KWlmKDEyOCE9KDE5MiZhWysrdF0pKXJldHVybiExO3JldHVybiEwfXJldHVybiExfX1dKSxlfSgpLHE9InVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3csVz1xJiZuYXZpZ2F0b3IudXNlckFnZW50LnRvTG9jYWxlTG93ZXJDYXNlKCksWD1xJiYvXigoPyFjaHJvbWV8YW5kcm9pZCkuKSpzYWZhcmkvLnRlc3QoVyksWT1xJiZXLmluY2x1ZGVzKCJmaXJlZm94IiksWj1xJiZXLmluY2x1ZGVzKCJhbmRyb2lkIik7ZnVuY3Rpb24gUSgpe2Zvcih2YXIgZT1hcmd1bWVudHMubGVuZ3RoLHQ9bmV3IEFycmF5KGUpLHI9MDtyPGU7cisrKXRbcl09YXJndW1lbnRzW3JdO3Q9dC5maWx0ZXIoQm9vbGVhbik7dmFyIGE9bmV3IFVpbnQ4QXJyYXkodC5yZWR1Y2UoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUrdC5ieXRlTGVuZ3RofSksMCkpLG49MDtyZXR1cm4gdC5mb3JFYWNoKChmdW5jdGlvbihlKXthLnNldChlLG4pLG4rPWUuYnl0ZUxlbmd0aH0pKSxhfXZhciBKPU1hdGgucG93KDIsMzIpO2Z1bmN0aW9uICQoZSl7dmFyIHQ9YXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0/YXJndW1lbnRzWzFdOjA7cmV0dXJuKGVbdF08PDgpKyhlW3QrMV18fDApfWZ1bmN0aW9uIGVlKGUpe3ZhciB0PWFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXTowO3JldHVybihlW3RdPDwyND4+PjApKyhlW3QrMV08PDE2KSsoZVt0KzJdPDw4KSsoZVt0KzNdfHwwKX1mdW5jdGlvbiB0ZShlKXt2YXIgdD1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06MDtyZXR1cm4gZWUoZSx0KSpKK2VlKGUsdCs0KX1mdW5jdGlvbiByZShlKXtmb3IodmFyIHQscj0iYXZjMS4iLGE9MDthPDM7YSsrKSh0PWVbYV0udG9TdHJpbmcoMTYpKS5sZW5ndGg8MiYmKHQ9IjAiLmNvbmNhdCh0KSkscis9dDtyZXR1cm4gcn1mdW5jdGlvbiBhZShlKXt2YXIgdD0iIjtpZihlLmZvckVhY2goKGZ1bmN0aW9uKGUpe3QrPWZ1bmN0aW9uKGUpe3JldHVybigiMCIrTnVtYmVyKGUpLnRvU3RyaW5nKDE2KSkuc2xpY2UoLTIpLnRvVXBwZXJDYXNlKCl9KGUpfSkpLHQubGVuZ3RoPD0zMilmb3IodmFyIHI9MzItdC5sZW5ndGgsYT0wO2E8cjthKyspdCs9IjAiO3JldHVybiB0fWZ1bmN0aW9uIG5lKGUpe2lmKCFBcnJheS5pc0FycmF5KGUpKXtmb3IodmFyIHQ9W10scj0iIixhPTA7YTxlLmxlbmd0aDthKyspYSUyJiYocj1lW2EtMV0rZVthXSx0LnB1c2gocGFyc2VJbnQociwxNikpLHI9IiIpO3JldHVybiB0fXJldHVybiBlLm1hcCgoZnVuY3Rpb24oZSl7cmV0dXJuIHBhcnNlSW50KGUsMTYpfSkpfWZ1bmN0aW9uIGllKGUsdCl7cmV0dXJuIE51bWJlcihlKyIuIit0KX12YXIgc2U9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7cih0aGlzLGUpfXJldHVybiBuKGUsbnVsbCxbe2tleToicGFyc2VBbm5leEIiLHZhbHVlOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLmxlbmd0aCxyPTIsYT0wO251bGwhPT1lW3JdJiZ2b2lkIDAhPT1lW3JdJiYxIT09ZVtyXTspcisrO2lmKChhPSsrcisyKT49dClyZXR1cm5bXTtmb3IodmFyIG49W107YTx0Oylzd2l0Y2goZVthXSl7Y2FzZSAwOmlmKDAhPT1lW2EtMV0pe2ErPTI7YnJlYWt9aWYoMCE9PWVbYS0yXSl7YSsrO2JyZWFrfXIhPT1hLTImJm4ucHVzaChlLnN1YmFycmF5KHIsYS0yKSk7ZG97YSsrfXdoaWxlKDEhPT1lW2FdJiZhPHQpO2E9KHI9YSsxKSsyO2JyZWFrO2Nhc2UgMTppZigwIT09ZVthLTFdfHwwIT09ZVthLTJdKXthKz0zO2JyZWFrfXIhPT1hLTImJm4ucHVzaChlLnN1YmFycmF5KHIsYS0yKSksYT0ocj1hKzEpKzI7YnJlYWs7ZGVmYXVsdDphKz0zfXJldHVybiByPHQmJm4ucHVzaChlLnN1YmFycmF5KHIpKSxufX0se2tleToicGFyc2VBdmNDIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06NDtpZighKGUubGVuZ3RoPDQpKXtmb3IodmFyIHIsYT1lLmxlbmd0aCxuPVtdLGk9MDtpK3Q8YTspaWYocj1lZShlLGkpLDM9PT10JiYocj4+Pj04KSxpKz10LHIpe2lmKGkrcj5hKWJyZWFrO24ucHVzaChlLnN1YmFycmF5KGksaStyKSksaSs9cn1yZXR1cm4gbn19fSx7a2V5OiJwYXJzZVNFSSIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtmb3IodmFyIHI9ZS5sZW5ndGgsYT10PzI6MSxuPTAsaT0wLHM9IiI7MjU1PT09ZVthXTspbis9MjU1LGErKztmb3Iobis9ZVthKytdOzI1NT09PWVbYV07KWkrPTI1NSxhKys7aWYoaSs9ZVthKytdLDU9PT1uJiZyPmErMTYpZm9yKHZhciBvPTA7bzwxNjtvKyspcys9ZVthXS50b1N0cmluZygxNiksYSsrO3JldHVybntwYXlsb2FkOmUuc3ViYXJyYXkoYSxhK2kpLHR5cGU6bixzaXplOmksdXVpZDpzfX19LHtrZXk6InJlbW92ZUVQQiIsdmFsdWU6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PWUuYnl0ZUxlbmd0aCxyPVtdLGE9MTthPHQtMjspMD09PWVbYV0mJjA9PT1lW2ErMV0mJjM9PT1lW2ErMl0/KHIucHVzaChhKzIpLGErPTIpOmErKztpZighci5sZW5ndGgpcmV0dXJuIGU7dmFyIG49dC1yLmxlbmd0aCxpPW5ldyBVaW50OEFycmF5KG4pLHM9MDtmb3IoYT0wO2E8bjtzKyssYSsrKXM9PT1yWzBdJiYocysrLHIuc2hpZnQoKSksaVthXT1lW3NdO3JldHVybiBpfX1dKSxlfSgpLG9lPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe3IodGhpcyxlKX1yZXR1cm4gbihlLG51bGwsW3trZXk6InBhcnNlQVZDRGVjb2RlckNvbmZpZ3VyYXRpb25SZWNvcmQiLHZhbHVlOmZ1bmN0aW9uKHQpe2lmKCEodC5sZW5ndGg8Nykpe2Zvcih2YXIgcixhLG49MSsoMyZ0WzRdKSxpPVtdLHM9W10sbz02LHU9MzEmdFs1XSxjPTA7Yzx1O2MrKylpZihhPXRbb108PDh8dFtvKzFdLG8rPTIsYSl7dmFyIGw9dC5zdWJhcnJheShvLG8rYSk7bys9YSxpLnB1c2gobCkscnx8KHI9ZS5wYXJzZVNQUyhzZS5yZW1vdmVFUEIobCkpKX12YXIgZixkPXRbb107bysrO2Zvcih2YXIgaD0wO2g8ZDtoKyspZj10W29dPDw4fHRbbysxXSxvKz0yLGYmJihzLnB1c2godC5zdWJhcnJheShvLG8rZikpLG8rPWYpO3JldHVybntzcHM6cixzcHNBcnI6aSxwcHNBcnI6cyxuYWxVbml0U2l6ZTpufX19fSx7a2V5OiJwYXJzZVNQUyIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9bmV3IEcoZSk7dC5yZWFkVUJ5dGUoKTt2YXIgcj10LnJlYWRVQnl0ZSgpLGE9dC5yZWFkVUJ5dGUoKSxuPXQucmVhZFVCeXRlKCk7dC5za2lwVUVHKCk7dmFyIGk9NDIwO2lmKDEwMD09PXJ8fDExMD09PXJ8fDEyMj09PXJ8fDI0ND09PXJ8fDQ0PT09cnx8ODM9PT1yfHw4Nj09PXJ8fDExOD09PXJ8fDEyOD09PXJ8fDEzOD09PXJ8fDE0ND09PXIpe3ZhciBzPXQucmVhZFVFRygpO2lmKHM8PTMmJihpPVswLDQyMCw0MjIsNDQ0XVtzXSksMz09PXMmJnQuc2tpcEJpdHMoMSksdC5za2lwVUVHKCksdC5za2lwVUVHKCksdC5za2lwQml0cygxKSx0LnJlYWRCb29sKCkpZm9yKHZhciBvPTMhPT1zPzg6MTIsdT0wO3U8bzt1KyspdC5yZWFkQm9vbCgpJiYodTw2P3Quc2tpcFNjYWxpbmdMaXN0KDE2KTp0LnNraXBTY2FsaW5nTGlzdCg2NCkpfXQuc2tpcFVFRygpO3ZhciBjPXQucmVhZFVFRygpO2lmKDA9PT1jKXQucmVhZFVFRygpO2Vsc2UgaWYoMT09PWMpe3Quc2tpcEJpdHMoMSksdC5za2lwVUVHKCksdC5za2lwVUVHKCk7Zm9yKHZhciBsPXQucmVhZFVFRygpLGY9MDtmPGw7ZisrKXQuc2tpcFVFRygpfXQuc2tpcFVFRygpLHQuc2tpcEJpdHMoMSk7dmFyIGQ9dC5yZWFkVUVHKCksaD10LnJlYWRVRUcoKSxwPXQucmVhZEJpdHMoMSk7MD09PXAmJnQuc2tpcEJpdHMoMSksdC5za2lwQml0cygxKTt2YXIgdix5LG0sZyxrLGI9MCxfPTAsdz0wLHg9MDtpZih0LnJlYWRCb29sKCkmJihiPXQucmVhZFVFRygpLF89dC5yZWFkVUVHKCksdz10LnJlYWRVRUcoKSx4PXQucmVhZFVFRygpKSx0LnJlYWRCb29sKCkpe2lmKHQucmVhZEJvb2woKSlzd2l0Y2godC5yZWFkVUJ5dGUoKSl7Y2FzZSAxOnY9WzEsMV07YnJlYWs7Y2FzZSAyOnY9WzEyLDExXTticmVhaztjYXNlIDM6dj1bMTAsMTFdO2JyZWFrO2Nhc2UgNDp2PVsxNiwxMV07YnJlYWs7Y2FzZSA1OnY9WzQwLDMzXTticmVhaztjYXNlIDY6dj1bMjQsMTFdO2JyZWFrO2Nhc2UgNzp2PVsyMCwxMV07YnJlYWs7Y2FzZSA4OnY9WzMyLDExXTticmVhaztjYXNlIDk6dj1bODAsMzNdO2JyZWFrO2Nhc2UgMTA6dj1bMTgsMTFdO2JyZWFrO2Nhc2UgMTE6dj1bMTUsMTFdO2JyZWFrO2Nhc2UgMTI6dj1bNjQsMzNdO2JyZWFrO2Nhc2UgMTM6dj1bMTYwLDk5XTticmVhaztjYXNlIDE0OnY9WzQsM107YnJlYWs7Y2FzZSAxNTp2PVszLDJdO2JyZWFrO2Nhc2UgMTY6dj1bMiwxXTticmVhaztjYXNlIDI1NTp2PVt0LnJlYWRVQnl0ZSgpPDw4fHQucmVhZFVCeXRlKCksdC5yZWFkVUJ5dGUoKTw8OHx0LnJlYWRVQnl0ZSgpXX1pZih0LnJlYWRCb29sKCkmJnQucmVhZEJvb2woKSx0LnJlYWRCb29sKCkmJih0LnJlYWRCaXRzKDQpLHQucmVhZEJvb2woKSYmdC5yZWFkQml0cygyNCkpLHQucmVhZEJvb2woKSYmKHQucmVhZFVFRygpLHQucmVhZFVFRygpKSx0LnJlYWRCb29sKCkpe3ZhciBTPXQucmVhZEJpdHMoMzIpLEE9dC5yZWFkQml0cygzMik7eT10LnJlYWRCb29sKCksaz0obT1BKS8oZz0yKlMpfX1yZXR1cm57Y29kZWM6cmUoZS5zdWJhcnJheSgxLDQpKSxwcm9maWxlSWRjOnIscHJvZmlsZUNvbXBhdGliaWxpdHk6YSxsZXZlbElkYzpuLGNocm9tYUZvcm1hdDppLHdpZHRoOk1hdGguY2VpbCgxNiooZCsxKS0yKihiK18pKSxoZWlnaHQ6KDItcCkqKGgrMSkqMTYtKHA/Mjo0KSoodyt4KSxzYXJSYXRpbzp2LGZwc051bTptLGZwc0RlbjpnLGZwczprLGZpeGVkRnJhbWU6eX19fV0pLGV9KCksdWU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7cih0aGlzLGUpfXJldHVybiBuKGUsbnVsbCxbe2tleToiZ2V0UmF0ZUluZGV4QnlSYXRlIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5GUkVRLmluZGV4T2YodCl9fSx7a2V5OiJwYXJzZUFEVFMiLHZhbHVlOmZ1bmN0aW9uKHQscil7Zm9yKHZhciBhPXQubGVuZ3RoLG49MDtuKzI8YSYmKDI1NSE9PXRbbl18fDI0MCE9KDI0NiZ0W24rMV0pKTspbisrO2lmKCEobj49YSkpe3ZhciBpPW4scz1bXSxvPSg2MCZ0W24rMl0pPj4+Mix1PWUuRlJFUVtvXTtpZighdSl0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgc2FtcGxpbmcgaW5kZXg6ICIuY29uY2F0KG8pKTtmb3IodmFyIGMsbCxmPTErKCgxOTImdFtuKzJdKT4+PjYpLGQ9KDEmdFtuKzJdKTw8MnwoMTkyJnRbbiszXSk+Pj42LGg9ZS5fZ2V0Q29uZmlnKG8sZCxmKSxwPWguY29uZmlnLHY9aC5jb2RlYyx5PTAsbT1lLmdldEZyYW1lRHVyYXRpb24odSk7bis3PGE7KWlmKDI1NT09PXRbbl0mJjI0MD09KDI0NiZ0W24rMV0pKXtpZighKGw9KDMmdFtuKzNdKTw8MTF8dFtuKzRdPDwzfCgyMjQmdFtuKzVdKT4+NSl8fGEtbjxsKWJyZWFrO2M9MiooMSZ+dFtuKzFdKSxzLnB1c2goe3B0czpyK3kqbSxkYXRhOnQuc3ViYXJyYXkobis3K2MsbitsKX0pLHkrKyxuKz1sfWVsc2UgbisrO3JldHVybntza2lwOmkscmVtYWluaW5nOm4+PWE/dm9pZCAwOnQuc3ViYXJyYXkobiksZnJhbWVzOnMsc2FtcGxpbmdGcmVxdWVuY3lJbmRleDpvLHNhbXBsZVJhdGU6dSxvYmplY3RUeXBlOmYsY2hhbm5lbENvdW50OmQsY29kZWM6dixjb25maWc6cCxvcmlnaW5Db2RlYzoibXA0YS40MC4iLmNvbmNhdChmKX19fX0se2tleToicGFyc2VBdWRpb1NwZWNpZmljQ29uZmlnIix2YWx1ZTpmdW5jdGlvbih0KXtpZih0Lmxlbmd0aCl7dmFyIHI9dFswXT4+PjMsYT0oNyZ0WzBdKTw8MXx0WzFdPj4+NyxuPSgxMjAmdFsxXSk+Pj4zLGk9ZS5GUkVRW2FdO2lmKGkpe3ZhciBzPWUuX2dldENvbmZpZyhhLG4scik7cmV0dXJue3NhbXBsaW5nRnJlcXVlbmN5SW5kZXg6YSxzYW1wbGVSYXRlOmksb2JqZWN0VHlwZTpyLGNoYW5uZWxDb3VudDpuLGNvbmZpZzpzLmNvbmZpZyxjb2RlYzpzLmNvZGVjLG9yaWdpbkNvZGVjOiJtcDRhLjQwLiIuY29uY2F0KHIpfX19fX0se2tleToiZ2V0RnJhbWVEdXJhdGlvbiIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9YXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0/YXJndW1lbnRzWzFdOjllNDtyZXR1cm4gMTAyNCp0L2V9fSx7a2V5OiJfZ2V0Q29uZmlnIix2YWx1ZTpmdW5jdGlvbihlLHQscil7dmFyIGEsbixpPVtdO3JldHVybiBZP2U+PTY/KGE9NSxuPWUtMyk6KGE9MixuPWUpOlo/KGE9MixuPWUpOihhPTI9PT1yfHw1PT09cj9yOjUsbj1lLGU+PTY/bj1lLTM6MT09PXQmJihhPTIsbj1lKSksaVswXT1hPDwzLGlbMF18PSgxNCZlKT4+MSxpWzFdPSgxJmUpPDw3LGlbMV18PXQ8PDMsNT09PWEmJihpWzFdfD0oMTQmbik+PjEsaVsyXT0oMSZuKTw8NyxpWzJdfD04LGlbM109MCkse2NvbmZpZzppLGNvZGVjOiJtcDRhLjQwLiIuY29uY2F0KGEpfX19LHtrZXk6ImdldFNpbGVudEZyYW1lIix2YWx1ZTpmdW5jdGlvbihlLHQpe2lmKCJtcDRhLjQwLjIiPT09ZSl7aWYoMT09PXQpcmV0dXJuIG5ldyBVaW50OEFycmF5KFswLDIwMCwwLDEyOCwzNSwxMjhdKTtpZigyPT09dClyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoWzMzLDAsNzMsMTQ0LDIsMjUsMCwzNSwxMjhdKTtpZigzPT09dClyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoWzAsMjAwLDAsMTI4LDMyLDEzMiwxLDM4LDY0LDgsMTAwLDAsMTQyXSk7aWYoND09PXQpcmV0dXJuIG5ldyBVaW50OEFycmF5KFswLDIwMCwwLDEyOCwzMiwxMzIsMSwzOCw2NCw4LDEwMCwwLDEyOCw0NCwxMjgsOCwyLDU2XSk7aWYoNT09PXQpcmV0dXJuIG5ldyBVaW50OEFycmF5KFswLDIwMCwwLDEyOCwzMiwxMzIsMSwzOCw2NCw4LDEwMCwwLDEzMCw0OCw0LDE1MywwLDMzLDE0NCwyLDU2XSk7aWYoNj09PXQpcmV0dXJuIG5ldyBVaW50OEFycmF5KFswLDIwMCwwLDEyOCwzMiwxMzIsMSwzOCw2NCw4LDEwMCwwLDEzMCw0OCw0LDE1MywwLDMzLDE0NCwyLDAsMTc4LDAsMzIsOCwyMjRdKX1lbHNle2lmKDE9PT10KXJldHVybiBuZXcgVWludDhBcnJheShbMSw2NCwzNCwxMjgsMTYzLDc4LDIzMCwxMjgsMTg2LDgsMCwwLDAsMjgsNiwyNDEsMTkzLDEwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDk0XSk7aWYoMj09PXQpcmV0dXJuIG5ldyBVaW50OEFycmF5KFsxLDY0LDM0LDEyOCwxNjMsOTQsMjMwLDEyOCwxODYsOCwwLDAsMCwwLDE0OSwwLDYsMjQxLDE2MSwxMCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5NF0pO2lmKDM9PT10KXJldHVybiBuZXcgVWludDhBcnJheShbMSw2NCwzNCwxMjgsMTYzLDk0LDIzMCwxMjgsMTg2LDgsMCwwLDAsMCwxNDksMCw2LDI0MSwxNjEsMTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTRdKX19fV0pLGV9KCk7aSh1ZSwiRlJFUSIsWzk2ZTMsODgyMDAsNjRlMyw0OGUzLDQ0MTAwLDMyZTMsMjRlMywyMjA1MCwxNmUzLDEyZTMsMTEwMjUsOGUzLDczNTBdKTt2YXIgY2U9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7cih0aGlzLGUpfXJldHVybiBuKGUsbnVsbCxbe2tleToicGFyc2VIRVZDRGVjb2RlckNvbmZpZ3VyYXRpb25SZWNvcmQiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPWFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXTp7fTtpZighKHQubGVuZ3RoPDIzKSl7cj1yfHx7fTtmb3IodmFyIGEsbixpLHMsbyx1PTErKDMmdFsyMV0pLGM9W10sbD1bXSxmPVtdLGQ9MjMsaD10WzIyXSxwPTA7cDxoO3ArKyl7aT02MyZ0W2RdLHM9dFtkKzFdPDw4fHRbZCsyXSxkKz0zO2Zvcih2YXIgdj0wO3Y8czt2KyspaWYobz10W2RdPDw4fHRbZCsxXSxkKz0yLG8pe3N3aXRjaChpKXtjYXNlIDMyOnZhciB5PXQuc3ViYXJyYXkoZCxkK28pO2F8fChhPWUucGFyc2VWUFMoc2UucmVtb3ZlRVBCKHkpLHIpKSxmLnB1c2goeSk7YnJlYWs7Y2FzZSAzMzp2YXIgbT10LnN1YmFycmF5KGQsZCtvKTtufHwobj1lLnBhcnNlU1BTKHNlLnJlbW92ZUVQQihtKSxyKSksYy5wdXNoKG0pO2JyZWFrO2Nhc2UgMzQ6bC5wdXNoKHQuc3ViYXJyYXkoZCxkK28pKX1kKz1vfX1yZXR1cm57aHZjQzpyLHNwczpuLHNwc0FycjpjLHBwc0FycjpsLHZwc0FycjpmLG5hbFVuaXRTaXplOnV9fX19LHtrZXk6InBhcnNlVlBTIix2YWx1ZTpmdW5jdGlvbih0LHIpe3I9cnx8e307dmFyIGE9bmV3IEcodCk7YS5yZWFkVUJ5dGUoKSxhLnJlYWRVQnl0ZSgpLGEucmVhZEJpdHMoMTIpO3ZhciBuPWEucmVhZEJpdHMoMyk7cmV0dXJuIHIubnVtVGVtcG9yYWxMYXllcnM9TWF0aC5tYXgoci5udW1UZW1wb3JhbExheWVyc3x8MCxuKzEpLGEucmVhZEJpdHMoMTcpLGUuX3BhcnNlUHJvZmlsZVRpZXJMZXZlbChhLG4scikscn19LHtrZXk6InBhcnNlU1BTIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06e307cj1yfHx7fTt2YXIgYT1uZXcgRyh0KTthLnJlYWRVQnl0ZSgpLGEucmVhZFVCeXRlKCksYS5yZWFkQml0cyg0KTt2YXIgbj1hLnJlYWRCaXRzKDMpO3IubnVtVGVtcG9yYWxMYXllcnM9TWF0aC5tYXgobisxLHIubnVtVGVtcG9yYWxMYXllcnN8fDApLHIudGVtcG9yYWxJZE5lc3RlZD1hLnJlYWRCaXRzKDEpLGUuX3BhcnNlUHJvZmlsZVRpZXJMZXZlbChhLG4sciksYS5yZWFkVUVHKCk7dmFyIGk9ci5jaHJvbWFGb3JtYXRJZGM9YS5yZWFkVUVHKCkscz00MjA7aTw9MyYmKHM9WzAsNDIwLDQyMiw0NDRdW2ldKTt2YXIgbz0wOzM9PT1pJiYobz1hLnJlYWRCaXRzKDEpKTt2YXIgdSxjLGwsZixkPWEucmVhZFVFRygpLGg9YS5yZWFkVUVHKCkscD1hLnJlYWRCaXRzKDEpO2lmKDE9PT1wJiYodT1hLnJlYWRVRUcoKSxjPWEucmVhZFVFRygpLGw9YS5yZWFkVUVHKCksZj1hLnJlYWRVRUcoKSksci5iaXREZXB0aEx1bWFNaW51czg9YS5yZWFkVUVHKCksci5iaXREZXB0aENocm9tYU1pbnVzOD1hLnJlYWRVRUcoKSwxPT09cCl7dmFyIHY9MSE9PWkmJjIhPT1pfHwwIT09bz8xOjIseT0xPT09aSYmMD09PW8/MjoxO2QtPXYqKGMrdSksaC09eSooZitsKX1yZXR1cm57Y29kZWM6ImhldjEuMS42Lkw5My5CMCIsd2lkdGg6ZCxoZWlnaHQ6aCxjaHJvbWFGb3JtYXQ6cyxodmNDOnJ9fX0se2tleToiX3BhcnNlUHJvZmlsZVRpZXJMZXZlbCIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIpe3ZhciBhPXIuZ2VuZXJhbFRpZXJGbGFnfHwwO3IuZ2VuZXJhbFByb2ZpbGVTcGFjZT1lLnJlYWRCaXRzKDIpLHIuZ2VuZXJhbFRpZXJGbGFnPU1hdGgubWF4KGUucmVhZEJpdHMoMSksYSksci5nZW5lcmFsUHJvZmlsZUlkYz1NYXRoLm1heChlLnJlYWRCaXRzKDUpLHIuZ2VuZXJhbFByb2ZpbGVJZGN8fDApLHIuZ2VuZXJhbFByb2ZpbGVDb21wYXRpYmlsaXR5RmxhZ3M9ZS5yZWFkQml0cygzMiksci5nZW5lcmFsQ29uc3RyYWludEluZGljYXRvckZsYWdzPVtlLnJlYWRCaXRzKDgpLGUucmVhZEJpdHMoOCksZS5yZWFkQml0cyg4KSxlLnJlYWRCaXRzKDgpLGUucmVhZEJpdHMoOCksZS5yZWFkQml0cyg4KV07dmFyIG49ZS5yZWFkQml0cyg4KTthPHIuZ2VuZXJhbFRpZXJGbGFnP3IuZ2VuZXJhbExldmVsSWRjPW46ci5nZW5lcmFsTGV2ZWxJZGM9TWF0aC5tYXgobixyLmdlbmVyYWxMZXZlbElkY3x8MCk7dmFyIGk9W10scz1bXTtpZih0PmUuYml0c0F2YWlsYWJsZSl0aHJvdyBuZXcgRXJyb3IoIm1heFN1YkxheWVyc01pbnVzIGluYXZsaWQgc2l6ZSAiLmNvbmNhdCh0KSk7Zm9yKHZhciBvPTA7bzx0O28rKylpW29dPWUucmVhZEJpdHMoMSksc1tvXT1lLnJlYWRCaXRzKDEpO3Q+MCYmZS5yZWFkQml0cygyKig4LXQpKTtmb3IodmFyIHU9MDt1PHQ7dSsrKTAhPT1pW3VdJiYoZS5yZWFkQml0cygyKSxlLnJlYWRCaXRzKDEpLGUucmVhZEJpdHMoNSksZS5yZWFkQml0cygxNiksZS5yZWFkQml0cygxNiksZS5yZWFkQml0cyg0KSxlLnJlYWRCaXRzKDE2KSxlLnJlYWRCaXRzKDE2KSxlLnJlYWRCaXRzKDEyKSksMCE9PXNbdV0mJmUucmVhZEJpdHMoOCl9fV0pLGV9KCksbGU9MWUzLGZlPTVlMyxkZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxhLG4pe3IodGhpcyxlKSx0aGlzLnZpZGVvVHJhY2s9dCx0aGlzLmF1ZGlvVHJhY2s9YSx0aGlzLm1ldGFkYXRhVHJhY2s9bix0aGlzLl9iYXNlRHRzPS0xLHRoaXMuX2Jhc2VEdHNJbml0ZWQ9ITEsdGhpcy5fYXVkaW9OZXh0UHRzPXZvaWQgMCx0aGlzLl92aWRlb05leHREdHM9dm9pZCAwLHRoaXMuX2F1ZGlvVGltZXN0YW1wQnJlYWs9MCx0aGlzLl92aWRlb1RpbWVzdGFtcEJyZWFrPTAsdGhpcy5fbGFzdFZpZGVvRHVyYXRpb249MCx0aGlzLl9rZXlGcmFtZUluTmV4dENodW5rPSExLHRoaXMuX2xhc3RBdWRpb0V4Y2VwdGlvbkdhcERvdD0tMS8wLHRoaXMuX2xhc3RBdWRpb0V4Y2VwdGlvbk92ZXJsYXBEb3Q9LTEvMCx0aGlzLl9sYXN0QXVkaW9FeGNlcHRpb25MYXJnZUdhcERvdD0tMS8wLHRoaXMuX2xhc3RWaWRlb0V4Y2VwdGlvbkxhcmdlR2FwRG90PS0xLzAsdGhpcy5fbGFzdFZpZGVvRXhjZXB0aW9uQ2h1bmtGaXJzdER0c0RvdD0tMS8wfXJldHVybiBuKGUsW3trZXk6ImZpeCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9YXJndW1lbnRzLmxlbmd0aD4wJiZ2b2lkIDAhPT1hcmd1bWVudHNbMF0/YXJndW1lbnRzWzBdOjAscj1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXSYmYXJndW1lbnRzWzFdLGE9IShhcmd1bWVudHMubGVuZ3RoPjImJnZvaWQgMCE9PWFyZ3VtZW50c1syXSl8fGFyZ3VtZW50c1syXTt0PU1hdGgucm91bmQoMWUzKnQpO3ZhciBuPXRoaXMudmlkZW9UcmFjayxpPXRoaXMuYXVkaW9UcmFjazshciYmYXx8KHRoaXMuX3ZpZGVvTGFzdFNhbXBsZT1udWxsLHRoaXMuX2F1ZGlvTmV4dFB0cz12b2lkIDAsdGhpcy5fdmlkZW9OZXh0RHRzPXZvaWQgMCx0aGlzLl9hdWRpb1RpbWVzdGFtcEJyZWFrPTAsdGhpcy5fdmlkZW9UaW1lc3RhbXBCcmVhaz0wLHRoaXMuX2xhc3RBdWRpb0V4Y2VwdGlvbkdhcERvdD0tMS8wLHRoaXMuX2xhc3RBdWRpb0V4Y2VwdGlvbk92ZXJsYXBEb3Q9LTEvMCx0aGlzLl9sYXN0QXVkaW9FeGNlcHRpb25MYXJnZUdhcERvdD0tMS8wLHRoaXMuX2xhc3RWaWRlb0V4Y2VwdGlvbkxhcmdlR2FwRG90PS0xLzAsdGhpcy5fbGFzdFZpZGVvRXhjZXB0aW9uQ2h1bmtGaXJzdER0c0RvdD0tMS8wKSxyJiYhYSYmKHRoaXMuX2Jhc2VEdHNJbml0ZWQ9ITEpLHRoaXMuX2Jhc2VEdHNJbml0ZWR8fHRoaXMuX2NhbGN1bGF0ZUJhc2VEdHMoaSxuKSwhYSYmdCYmKHRoaXMuX2F1ZGlvTmV4dFB0cz10aGlzLl92aWRlb05leHREdHM9dCk7dmFyIHM9dGhpcy5fYmFzZUR0c0luaXRlZCYmKHRoaXMuX3ZpZGVvVGltZXN0YW1wQnJlYWt8fCF0aGlzLnZpZGVvVHJhY2suZXhpc3QoKSkmJih0aGlzLl9hdWRpb1RpbWVzdGFtcEJyZWFrfHwhdGhpcy5hdWRpb1RyYWNrLmV4aXN0KCkpO2lmKHMmJnRoaXMuX3Jlc2V0QmFzZUR0c1doZW5TdHJlYW1CcmVha2VkKCksdGhpcy5fZml4QXVkaW8oaSksdGhpcy5fa2V5RnJhbWVJbk5leHRDaHVuaz0hMSx0aGlzLl9maXhWaWRlbyhuKSx0aGlzLm1ldGFkYXRhVHJhY2suZXhpc3QoKSl7dmFyIG89dGhpcy5tZXRhZGF0YVRyYWNrLnRpbWVzY2FsZTt0aGlzLm1ldGFkYXRhVHJhY2suc2VpU2FtcGxlcy5mb3JFYWNoKChmdW5jdGlvbih0KXt0LnB0cz10Lm9yaWdpblB0cy1lLl9iYXNlRHRzLHQudGltZT1NYXRoLm1heCgwLHQucHRzKS9vfSkpLHRoaXMubWV0YWRhdGFUcmFjay5mbHZTY3JpcHRTYW1wbGVzLmZvckVhY2goKGZ1bmN0aW9uKHQpe3QucHRzPXQub3JpZ2luUHRzLWUuX2Jhc2VEdHMsdC50aW1lPU1hdGgubWF4KDAsdC5wdHMpL299KSl9bi5zYW1wbGVzLmxlbmd0aCYmKG4uYmFzZU1lZGlhRGVjb2RlVGltZT1uLnNhbXBsZXNbMF0uZHRzKSxpLnNhbXBsZXMubGVuZ3RoJiYoaS5iYXNlTWVkaWFEZWNvZGVUaW1lPWkuc2FtcGxlc1swXS5wdHMqaS50aW1lc2NhbGUvMWUzKX19LHtrZXk6Il9maXhWaWRlbyIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxyPWUuc2FtcGxlcztpZihyLmxlbmd0aCl7dmFyIGE7aWYoci5mb3JFYWNoKChmdW5jdGlvbihlKXtlLmR0cy09dC5fYmFzZUR0cyxlLnB0cy09dC5fYmFzZUR0cyxlLmtleWZyYW1lJiYodC5fa2V5RnJhbWVJbk5leHRDaHVuaz0hMCl9KSksZS5mcHNOdW0mJmUuZnBzRGVuKWE9ZS50aW1lc2NhbGUqKGUuZnBzRGVuL2UuZnBzTnVtKTtlbHNlIGlmKGUubGVuZ3RoPjEpe3ZhciBuPWUuc2FtcGxlc1swXSxpPWUuc2FtcGxlc1tyLmxlbmd0aC0xXTthPU1hdGguZmxvb3IoKGkuZHRzLW4uZHRzKS8oci5sZW5ndGgtMSkpfWVsc2UgYT10aGlzLl9sYXN0VmlkZW9EdXJhdGlvbnx8NDA7dmFyIHM9ci5wb3AoKTtpZih0aGlzLl92aWRlb0xhc3RTYW1wbGUmJnIudW5zaGlmdCh0aGlzLl92aWRlb0xhc3RTYW1wbGUpLHRoaXMuX3ZpZGVvTGFzdFNhbXBsZT1zLHIubGVuZ3RoKXtpZih2b2lkIDA9PT10aGlzLl92aWRlb05leHREdHMpe3ZhciBvPXJbMF07dGhpcy5fdmlkZW9OZXh0RHRzPW8uZHRzfXZhciB1PXIubGVuZ3RoLGM9MCxsPXJbMF0sZj10aGlzLl92aWRlb05leHREdHMtbC5kdHM7aWYoTWF0aC5hYnMoZik+MjAwKXt2YXIgZDtpZihNYXRoLmFicyhsLmR0cy10aGlzLl9sYXN0VmlkZW9FeGNlcHRpb25DaHVua0ZpcnN0RHRzRG90KT41ZTMpdGhpcy5fbGFzdFZpZGVvRXhjZXB0aW9uQ2h1bmtGaXJzdER0c0RvdD1sLmR0cyxlLndhcm5pbmdzLnB1c2goe3R5cGU6QyxuZXh0RHRzOnRoaXMuX3ZpZGVvTmV4dER0cyxmaXJzdFNhbXBsZUR0czpsLmR0cyxuZXh0U2FtcGxlRHRzOm51bGw9PT0oZD1yWzFdKXx8dm9pZCAwPT09ZD92b2lkIDA6ZC5kdHMsc2FtcGxlRHVyYXRpb246Zn0pO3RoaXMuX3ZpZGVvVGltZXN0YW1wQnJlYWs+PTU/KHRoaXMuX3ZpZGVvTmV4dER0cz1sLmR0cyx0aGlzLl92aWRlb1RpbWVzdGFtcEJyZWFrPTApOihsLmR0cys9ZixsLnB0cys9Zix0aGlzLmF1ZGlvVHJhY2suZXhpc3QoKXx8KHRoaXMuX3ZpZGVvVGltZXN0YW1wQnJlYWs9MSkpfWZvcih2YXIgaD0wO2g8dTtoKyspe3ZhciBwPXJbaF0uZHRzLHY9cltoKzFdOygoYz1oPHUtMT92LmR0cy1wOnM/cy5kdHMtcDphKT4xZTN8fGM8MCkmJih0aGlzLl92aWRlb1RpbWVzdGFtcEJyZWFrKyssTWF0aC5hYnMocC10aGlzLl9sYXN0VmlkZW9FeGNlcHRpb25MYXJnZUdhcERvdCk+NWUzJiYodGhpcy5fbGFzdFZpZGVvRXhjZXB0aW9uTGFyZ2VHYXBEb3Q9cCxlLndhcm5pbmdzLnB1c2goe3R5cGU6VSx0aW1lOnAvZS50aW1lc2NhbGUsZHRzOnAsb3JpZ2luRHRzOnJbaF0ub3JpZ2luRHRzLG5leHREdHM6dGhpcy5fdmlkZW9OZXh0RHRzLHNhbXBsZUR1cmF0aW9uOmMscmVmU2FtcGxlRHVyYXRpb246YX0pKSxjPWEpLHJbaF0uZHVyYXRpb249Yyx0aGlzLl92aWRlb05leHREdHMrPWMsdGhpcy5fbGFzdFZpZGVvRHVyYXRpb249Y319fX19LHtrZXk6Il9maXhBdWRpbyIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxyPWUuc2FtcGxlcztyLmxlbmd0aCYmKHIuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ZS5kdHM9ZS5wdHMtPXQuX2Jhc2VEdHN9KSksdGhpcy5fZG9GaXhBdWRpb0ludGVybmFsKGUsciwxZTMpKX19LHtrZXk6Il9jYWxjdWxhdGVCYXNlRHRzIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciByPWUuc2FtcGxlcyxhPXQuc2FtcGxlcztpZighci5sZW5ndGgmJiFhLmxlbmd0aClyZXR1cm4hMTt2YXIgbj0xLzAsaT0xLzA7ci5sZW5ndGgmJihlLmJhc2VEdHM9bj1yWzBdLnB0cyksYS5sZW5ndGgmJih0LmJhc2VEdHM9aT1hWzBdLmR0cyksdGhpcy5fYmFzZUR0cz1NYXRoLm1pbihuLGkpO3ZhciBzPWktbjtyZXR1cm4gTnVtYmVyLmlzRmluaXRlKHMpJiZNYXRoLmFicyhzKT41MDAmJnQud2FybmluZ3MucHVzaCh7dHlwZTpULHZpZGVvQmFzZUR0czppLGF1ZGlvQmFzZVB0czpuLGJhc2VEdHM6dGhpcy5fYmFzZUR0cyxkZWx0YTpzfSksdGhpcy5fYmFzZUR0c0luaXRlZD0hMCwhMH19LHtrZXk6Il9yZXNldEJhc2VEdHNXaGVuU3RyZWFtQnJlYWtlZCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9jYWxjdWxhdGVCYXNlRHRzKHRoaXMuYXVkaW9UcmFjayx0aGlzLnZpZGVvVHJhY2spJiYodGhpcy5hdWRpb1RyYWNrLmV4aXN0KCk/dGhpcy52aWRlb1RyYWNrLmV4aXN0KCk/dGhpcy5fYmFzZUR0cy09TWF0aC5taW4odGhpcy5fYXVkaW9OZXh0UHRzLHRoaXMuX3ZpZGVvTmV4dER0cyk6dGhpcy5fYmFzZUR0cy09dGhpcy5fYXVkaW9OZXh0UHRzOnRoaXMuX2Jhc2VEdHMtPXRoaXMuX3ZpZGVvTmV4dER0cyx0aGlzLl92aWRlb1RpbWVzdGFtcEJyZWFrPTAsdGhpcy5fYXVkaW9UaW1lc3RhbXBCcmVhaz0wKX19LHtrZXk6Il9kb0ZpeEF1ZGlvSW50ZXJuYWwiLHZhbHVlOmZ1bmN0aW9uKGUsdCxyKXtlLnNhbXBsZUR1cmF0aW9ufHwoZS5zYW1wbGVEdXJhdGlvbj1lLmNvZGVjVHlwZT09PUQ/dWUuZ2V0RnJhbWVEdXJhdGlvbihlLnRpbWVzY2FsZSxyKTp0aGlzLl9nZXRHNzExRHVyYXRpb24oZSkpO3ZhciBhPWUuc2FtcGxlRHVyYXRpb24sbj1lLmNvZGVjVHlwZT09PUQ/MTAyNDphKmUudGltZXNjYWxlLzFlMztpZih2b2lkIDA9PT10aGlzLl9hdWRpb05leHRQdHMpe3ZhciBpPXRbMF07dGhpcy5fYXVkaW9OZXh0UHRzPWkucHRzfWZvcih2YXIgcz0wO3M8dC5sZW5ndGg7cysrKXt2YXIgbz10aGlzLl9hdWRpb05leHRQdHMsdT10W3NdLGM9dS5wdHMtbztpZigwPT09cyYmdGhpcy5fYXVkaW9UaW1lc3RhbXBCcmVhaz49NSYmdGhpcy5fa2V5RnJhbWVJbk5leHRDaHVuayYmKG89dGhpcy5fYXVkaW9OZXh0UHRzPXUuZHRzLGM9MCx0aGlzLl9hdWRpb1RpbWVzdGFtcEJyZWFrPTApLCF0aGlzLl9hdWRpb1RpbWVzdGFtcEJyZWFrJiZjPj0zKmEmJmM8PWxlJiYhWCl7dmFyIGw9dGhpcy5fZ2V0U2lsZW50RnJhbWUoZSl8fHRbMF0uZGF0YS5zdWJhcnJheSgpLGY9TWF0aC5mbG9vcihjL2EpO01hdGguYWJzKHUucHRzLXRoaXMuX2xhc3RBdWRpb0V4Y2VwdGlvbkdhcERvdCk+ZmUmJih0aGlzLl9sYXN0QXVkaW9FeGNlcHRpb25HYXBEb3Q9dS5wdHMsZS53YXJuaW5ncy5wdXNoKHt0eXBlOkkscHRzOnUucHRzLG9yaWdpblB0czp1Lm9yaWdpblB0cyxjb3VudDpmLG5leHRQdHM6byxyZWZTYW1wbGVEdXJhdGlvbjphfSkpO2Zvcih2YXIgZD0wO2Q8ZjtkKyspe3ZhciBoPW5ldyBMKE1hdGguZmxvb3IodGhpcy5fYXVkaW9OZXh0UHRzK2EpLU1hdGguZmxvb3IodGhpcy5fYXVkaW9OZXh0UHRzKSxsLG4pO2gub3JpZ2luUHRzPU1hdGguZmxvb3IodGhpcy5fYmFzZUR0cytvKSx0LnNwbGljZShzLDAsaCksdGhpcy5fYXVkaW9OZXh0UHRzKz1hLHMrK31zLS19ZWxzZSBjPD0tMyphJiZjPj0tMWUzPyhNYXRoLmFicyh1LnB0cy10aGlzLl9sYXN0QXVkaW9FeGNlcHRpb25PdmVybGFwRG90KT5mZSYmKHRoaXMuX2xhc3RBdWRpb0V4Y2VwdGlvbk92ZXJsYXBEb3Q9dS5wdHMsZS53YXJuaW5ncy5wdXNoKHt0eXBlOk0scHRzOnUucHRzLG9yaWdpblB0czp1Lm9yaWdpblB0cyxuZXh0UHRzOm8scmVmU2FtcGxlRHVyYXRpb246YX0pKSx0LnNwbGljZShzLDEpLHMtLSk6KE1hdGguYWJzKGMpPmxlJiYodGhpcy5fYXVkaW9UaW1lc3RhbXBCcmVhaysrLE1hdGguYWJzKHUucHRzLXRoaXMuX2xhc3RBdWRpb0V4Y2VwdGlvbkxhcmdlR2FwRG90KT5mZSYmKHRoaXMuX2xhc3RBdWRpb0V4Y2VwdGlvbkxhcmdlR2FwRG90PXUucHRzLGUud2FybmluZ3MucHVzaCh7dHlwZTpQLHRpbWU6dS5wdHMvMWUzLHB0czp1LnB0cyxvcmlnaW5QdHM6dS5vcmlnaW5QdHMsbmV4dFB0czpvLHNhbXBsZUR1cmF0aW9uOmMscmVmU2FtcGxlRHVyYXRpb246YX0pKSksdS5kdHM9dS5wdHM9byx1LmR1cmF0aW9uPW4sdGhpcy5fYXVkaW9OZXh0UHRzKz1hKX19fSx7a2V5OiJfZ2V0RzcxMUR1cmF0aW9uIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lLnNhbXBsZVNpemUscj1lLmNoYW5uZWxDb3VudCxhPWUuc2FtcGxlUmF0ZSxuPWUuc2FtcGxlc1swXTtpZihuKXJldHVybiAyKm4uZGF0YS5ieXRlTGVuZ3RoL3IvKHQvOCkvYSoxZTN9fSx7a2V5OiJfZ2V0U2lsZW50RnJhbWUiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBlLmNvZGVjVHlwZT09PUQ/dWUuZ2V0U2lsZW50RnJhbWUoZS5jb2RlYyxlLmNoYW5uZWxDb3VudCk6bmV3IFVpbnQ4QXJyYXkoOCplLnNhbXBsZUR1cmF0aW9uKmUuY2hhbm5lbENvdW50KX19XSksZX0oKSxoZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXtyKHRoaXMsZSl9cmV0dXJuIG4oZSxudWxsLFt7a2V5OiJwYXJzZSIsdmFsdWU6ZnVuY3Rpb24odCl7aWYoISh0Lmxlbmd0aDwzKSl7dmFyIHI9e30sYT1lLl9wYXJzZVZhbHVlKG5ldyBEYXRhVmlldyh0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQsdC5ieXRlTGVuZ3RoKSksbj1lLl9wYXJzZVZhbHVlKG5ldyBEYXRhVmlldyh0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQrYS5zaXplLHQuYnl0ZUxlbmd0aC1hLnNpemUpKTtyZXR1cm4gclthLmRhdGFdPW4uZGF0YSxyfX19LHtrZXk6Il9wYXJzZVZhbHVlIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcixhPXQuYnl0ZUxlbmd0aCxuPTEsaT0hMTtzd2l0Y2godC5nZXRVaW50OCgwKSl7Y2FzZSAwOnI9dC5nZXRGbG9hdDY0KDEpLG4rPTg7YnJlYWs7Y2FzZSAxOnI9ISF0LmdldFVpbnQ4KDEpLG4rPTE7YnJlYWs7Y2FzZSAyOnZhciBzPWUuX3BhcnNlU3RyaW5nKG5ldyBEYXRhVmlldyh0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQrbix0LmJ5dGVMZW5ndGgtbikpO3I9cy5kYXRhLG4rPXMuc2l6ZTticmVhaztjYXNlIDM6cj17fTt2YXIgbz0wO2Zvcig5PT0oMTY3NzcyMTUmdC5nZXRVaW50MzIoYS00KSkmJihvPTMpO248YS00Oyl7dmFyIHU9ZS5fcGFyc2VPYmplY3QobmV3IERhdGFWaWV3KHQuYnVmZmVyLHQuYnl0ZU9mZnNldCtuLHQuYnl0ZUxlbmd0aC1uLW8pKSxjPXUuc2l6ZSxsPXUuZGF0YTtpZih1LmlzRW5kKWJyZWFrO3JbbC5uYW1lXT1sLnZhbHVlLG4rPWN9aWYobjw9YS0zKTk9PT0oMTY3NzcyMTUmdC5nZXRVaW50MzIobi0xKSkmJihuKz0zKTticmVhaztjYXNlIDg6cj17fSxuKz00O3ZhciBmPTA7Zm9yKDk9PSgxNjc3NzIxNSZ0LmdldFVpbnQzMihhLTQpKSYmKGY9Myk7bjxhLTg7KXt2YXIgZD1lLl9wYXJzZU9iamVjdChuZXcgRGF0YVZpZXcodC5idWZmZXIsdC5ieXRlT2Zmc2V0K24sdC5ieXRlTGVuZ3RoLW4tZikpLGg9ZC5zaXplLHA9ZC5kYXRhO2lmKGQuaXNFbmQpYnJlYWs7cltwLm5hbWVdPXAudmFsdWUsbis9aH1pZihuPD1hLTMpOT09PSgxNjc3NzIxNSZ0LmdldFVpbnQzMihuLTEpKSYmKG4rPTMpO2JyZWFrO2Nhc2UgOTpyPXZvaWQgMCxuPTEsaT0hMDticmVhaztjYXNlIDEwOnI9W107dmFyIHY9dC5nZXRVaW50MzIoMSk7bis9NDtmb3IodmFyIHk9MDt5PHY7eSsrKXt2YXIgbT1lLl9wYXJzZVZhbHVlKG5ldyBEYXRhVmlldyh0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQrbix0LmJ5dGVMZW5ndGgtbikpLGc9bS5kYXRhLGs9bS5zaXplO3IucHVzaChnKSxuKz1rfWJyZWFrO2Nhc2UgMTE6dmFyIGI9dC5nZXRGbG9hdDY0KG4pKzZlNCp0LmdldEludDE2KG4rOCk7cj1uZXcgRGF0ZShiKSxuKz0xMDticmVhaztjYXNlIDEyOnZhciBfPXQuZ2V0VWludDMyKDEpO24rPTQscj0iIixfPjAmJihyPUsuZGVjb2RlKG5ldyBVaW50OEFycmF5KHQuYnVmZmVyLHQuYnl0ZU9mZnNldCtuLF8pKSksbis9XzticmVhaztkZWZhdWx0Om49YX1yZXR1cm57ZGF0YTpyLHNpemU6bixpc0VuZDppfX19LHtrZXk6Il9wYXJzZVN0cmluZyIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5nZXRVaW50MTYoMCkscj0iIjtyZXR1cm4gdD4wJiYocj1LLmRlY29kZShuZXcgVWludDhBcnJheShlLmJ1ZmZlcixlLmJ5dGVPZmZzZXQrMix0KSkpLHtkYXRhOnIsc2l6ZToyK3R9fX0se2tleToiX3BhcnNlT2JqZWN0Iix2YWx1ZTpmdW5jdGlvbih0KXtpZighKHQuYnl0ZUxlbmd0aDwzKSl7dmFyIHI9ZS5fcGFyc2VTdHJpbmcodCksYT1lLl9wYXJzZVZhbHVlKG5ldyBEYXRhVmlldyh0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQrci5zaXplLHQuYnl0ZUxlbmd0aC1yLnNpemUpKTtyZXR1cm57ZGF0YTp7bmFtZTpyLmRhdGEsdmFsdWU6YS5kYXRhfSxzaXplOnIuc2l6ZSthLnNpemUsaXNFbmQ6YS5pc0VuZH19fX1dKSxlfSgpLHBlPW5ldyBIKCJGbHZEZW11eGVyIiksdmU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQsYSxuKXtyKHRoaXMsZSksaSh0aGlzLCJfaGVhZGVyUGFyc2VkIiwhMSksaSh0aGlzLCJfcmVtYWluaW5nRGF0YSIsbnVsbCksaSh0aGlzLCJfZ29wSWQiLDApLGkodGhpcywiX25lZWRBZGRNZXRhQmVmb3JlS2V5RnJhbWVOYWwiLCEwKSx0aGlzLnZpZGVvVHJhY2s9dHx8bmV3IHosdGhpcy5hdWRpb1RyYWNrPWF8fG5ldyBPLHRoaXMubWV0YWRhdGFUcmFjaz1ufHxuZXcgaix0aGlzLl9maXhlcj1uZXcgZGUodGhpcy52aWRlb1RyYWNrLHRoaXMuYXVkaW9UcmFjayx0aGlzLm1ldGFkYXRhVHJhY2spfXJldHVybiBuKGUsW3trZXk6ImRlbXV4Iix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXSYmYXJndW1lbnRzWzFdLGE9IShhcmd1bWVudHMubGVuZ3RoPjImJnZvaWQgMCE9PWFyZ3VtZW50c1syXSl8fGFyZ3VtZW50c1syXSxuPXRoaXMuYXVkaW9UcmFjayxpPXRoaXMudmlkZW9UcmFjayxzPXRoaXMubWV0YWRhdGFUcmFjaztpZighciYmYXx8KHRoaXMuX3JlbWFpbmluZ0RhdGE9bnVsbCksciYmKHRoaXMuX2hlYWRlclBhcnNlZD0hMSkscj8oaS5yZXNldCgpLG4ucmVzZXQoKSxzLnJlc2V0KCkpOihpLnNhbXBsZXM9W10sbi5zYW1wbGVzPVtdLHMuc2VpU2FtcGxlcz1bXSxzLmZsdlNjcmlwdFNhbXBsZXM9W10saS53YXJuaW5ncz1bXSxuLndhcm5pbmdzPVtdLHRoaXMuX3JlbWFpbmluZ0RhdGEmJih0PVEodGhpcy5fcmVtYWluaW5nRGF0YSx0KSx0aGlzLl9yZW1haW5pbmdEYXRhPW51bGwpKSwhdC5sZW5ndGgpcmV0dXJue3ZpZGVvVHJhY2s6aSxhdWRpb1RyYWNrOm4sbWV0YWRhdGFUcmFjazpzfTt2YXIgbz0wO2lmKCF0aGlzLl9oZWFkZXJQYXJzZWQpe2lmKCFlLnByb2JlKHQpKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBmbHYgZmlsZSIpO24ucHJlc2VudD0oNCZ0WzRdKT4+PjIhPTAsaS5wcmVzZW50PTAhPSgxJnRbNF0pLHRoaXMuX2hlYWRlclBhcnNlZD0hMCxvPWVlKHQsNSkrNH1mb3IodmFyIHUsYyxsLGYsZCxoPXQubGVuZ3RoO28rMTU8aCYmKHU9dFtvXSwhKG8rMTUrKGM9dFtvKzFdPDwxNnx0W28rMl08PDh8dFtvKzNdKT5oKSk7KWw9KHRbbys3XTw8MjQ+Pj4wKSsodFtvKzRdPDwxNikrKHRbbys1XTw8OCkrdFtvKzZdLG8rPTExLGY9dC5zdWJhcnJheShvLG8rYyksOD09PXU/dGhpcy5fcGFyc2VBdWRpbyhmLGwpOjk9PT11P3RoaXMuX3BhcnNlVmlkZW8oZixsKToxOD09PXU/dGhpcy5fcGFyc2VTY3JpcHQoZixsKTpwZS53YXJuKCJJbnZhbGlkIHRhZyB0eXBlOiAiLmNvbmNhdCh1KSksKGQ9ZWUodCxvKz1jKSkhPT0xMStjJiZwZS53YXJuKCJJbnZhbGlkIFByZXZUYWdTaXplICIuY29uY2F0KGQsIiAoIikuY29uY2F0KDExK2MsIikiKSksbys9NDtyZXR1cm4gbzxoJiYodGhpcy5fcmVtYWluaW5nRGF0YT10LnN1YmFycmF5KG8pKSxuLmZvcm1hdFRpbWVzY2FsZT1pLmZvcm1hdFRpbWVzY2FsZT1pLnRpbWVzY2FsZT1zLnRpbWVzY2FsZT0xZTMsbi50aW1lc2NhbGU9bi5zYW1wbGVSYXRlfHwwLCFuLmV4aXN0KCkmJm4uaGFzU2FtcGxlKCkmJm4ucmVzZXQoKSwhaS5leGlzdCgpJiZpLmhhc1NhbXBsZSgpJiZpLnJlc2V0KCkse3ZpZGVvVHJhY2s6aSxhdWRpb1RyYWNrOm4sbWV0YWRhdGFUcmFjazpzfX19LHtrZXk6ImZpeCIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIpe3JldHVybiB0aGlzLl9maXhlci5maXgoZSx0LHIpLHt2aWRlb1RyYWNrOnRoaXMudmlkZW9UcmFjayxhdWRpb1RyYWNrOnRoaXMuYXVkaW9UcmFjayxtZXRhZGF0YVRyYWNrOnRoaXMubWV0YWRhdGFUcmFja319fSx7a2V5OiJkZW11eEFuZEZpeCIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIsYSl7cmV0dXJuIHRoaXMuZGVtdXgoZSx0LHIpLHRoaXMuZml4KGEsdCxyKX19LHtrZXk6Il9wYXJzZUF1ZGlvIix2YWx1ZTpmdW5jdGlvbih0LHIpe2lmKHQubGVuZ3RoKXt2YXIgYT0oMjQwJnRbMF0pPj4+NCxuPXRoaXMuYXVkaW9UcmFjaztpZigxMCE9PWEmJjchPT1hJiY4IT09YSlyZXR1cm4gcGUud2FybigiVW5zdXBwb3J0ZWQgc291bmQgZm9ybWF0OiAiLmNvbmNhdChhKSksdm9pZCBuLnJlc2V0KCk7aWYoMTAhPT1hKXt2YXIgaT0oMTImdFswXSk+PjIscz0oMiZ0WzBdKT4+MSxvPTEmdFswXTtuLnNhbXBsZVJhdGU9ZS5BVURJT19SQVRFW2ldLG4uc2FtcGxlU2l6ZT1zPzE2Ojgsbi5jaGFubmVsQ291bnQ9bysxfTEwPT09YT90aGlzLl9wYXJzZUFhYyh0LHIpOnRoaXMuX3BhcnNlRzcxMSh0LHIsYSl9fX0se2tleToiX3BhcnNlRzcxMSIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIpe3ZhciBhPXRoaXMuYXVkaW9UcmFjazthLmNvZGVjVHlwZT03PT09cj9COkUsYS5zYW1wbGVSYXRlPThlMyxhLmNvZGVjPWEuY29kZWNUeXBlLGEuc2FtcGxlcy5wdXNoKG5ldyBMKHQsZS5zdWJhcnJheSgxKSkpfX0se2tleToiX3BhcnNlQWFjIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciByPXRoaXMuYXVkaW9UcmFjaztpZihyLmNvZGVjVHlwZT1ELDA9PT1lWzFdKXt2YXIgYT11ZS5wYXJzZUF1ZGlvU3BlY2lmaWNDb25maWcoZS5zdWJhcnJheSgyKSk7YT8oci5jb2RlYz1hLmNvZGVjLHIuY2hhbm5lbENvdW50PWEuY2hhbm5lbENvdW50LHIuc2FtcGxlUmF0ZT1hLnNhbXBsZVJhdGUsci5jb25maWc9YS5jb25maWcsci5vYmplY3RUeXBlPWEub2JqZWN0VHlwZSxyLnNhbXBsZVJhdGVJbmRleD1hLnNhbXBsaW5nRnJlcXVlbmN5SW5kZXgpOihyLnJlc2V0KCkscGUud2FybigiQ2Fubm90IHBhcnNlIEF1ZGlvU3BlY2lmaWNDb25maWciLGUpKX1lbHNlIGlmKDE9PT1lWzFdKXtpZihudWxsPT10KXJldHVybjtyLnNhbXBsZXMucHVzaChuZXcgTCh0LGUuc3ViYXJyYXkoMikpKX1lbHNlIHBlLndhcm4oIlVua25vd24gQUFDUGFja2V0VHlwZTogIi5jb25jYXQoZVsxXSkpfX0se2tleToiX3BhcnNlVmlkZW8iLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9dGhpcztpZighKGUubGVuZ3RoPDYpKXt2YXIgYT0oMjQwJmVbMF0pPj4+NCxuPTE1JmVbMF0saT10aGlzLnZpZGVvVHJhY2s7aWYoNyE9PW4mJjEyIT09bilyZXR1cm4gaS5yZXNldCgpLHZvaWQgcGUud2FybigiVW5zdXBwb3J0ZWQgY29kZWNJZDogIi5jb25jYXQobikpO3ZhciBzPTEyPT09bjtpLmNvZGVjVHlwZT1zP0E6Uzt2YXIgbz1lWzFdLHU9KGVbMl08PDE2fGVbM108PDh8ZVs0XSk8PDg+Pjg7aWYoMD09PW8pe3ZhciBjPWUuc3ViYXJyYXkoNSksbD1zP2NlLnBhcnNlSEVWQ0RlY29kZXJDb25maWd1cmF0aW9uUmVjb3JkKGMpOm9lLnBhcnNlQVZDRGVjb2RlckNvbmZpZ3VyYXRpb25SZWNvcmQoYyk7aWYobCl7dmFyIGY9bC5odmNDLGQ9bC5zcHMsaD1sLnBwc0FycixwPWwuc3BzQXJyLHY9bC52cHNBcnIseT1sLm5hbFVuaXRTaXplO2YmJihpLmh2Y0M9aS5odmNDfHxmKSxkJiYoaS5jb2RlYz1kLmNvZGVjLGkud2lkdGg9ZC53aWR0aCxpLmhlaWdodD1kLmhlaWdodCxpLnNhclJhdGlvPWQuc2FyUmF0aW8saS5mcHNOdW09ZC5mcHNOdW0saS5mcHNEZW49ZC5mcHNEZW4pLHAubGVuZ3RoJiYoaS5zcHM9cCksaC5sZW5ndGgmJihpLnBwcz1oKSx2JiZ2Lmxlbmd0aCYmKGkudnBzPXYpLHkmJihpLm5hbFVuaXRTaXplPXkpfWVsc2UgcGUud2FybigiQ2Fubm90IHBhcnNlICIuY29uY2F0KHM/IkhFVkMiOiJBVkMiLCJEZWNvZGVyQ29uZmlndXJhdGlvblJlY29yZCIpLGUpfWVsc2UgaWYoMT09PW8pe3ZhciBtPXNlLnBhcnNlQXZjQyhlLnN1YmFycmF5KDUpLGkubmFsVW5pdFNpemUpO2lmKChtPXRoaXMuX2NoZWNrQWRkTWV0YU5hbFRvVW5pdHMocyxtLGkpKSYmbS5sZW5ndGgpe3ZhciBnPW5ldyBSKHQrdSx0LG0pOzE9PT1hJiZnLnNldFRvS2V5ZnJhbWUoKSxpLnNhbXBsZXMucHVzaChnKSxtLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciBhPXM/ZVswXT4+PjEmNjM6MzEmZVswXTtzd2l0Y2goYSl7Y2FzZSA1OmNhc2UgMTY6Y2FzZSAxNzpjYXNlIDE4OmNhc2UgMTk6Y2FzZSAyMDpjYXNlIDIxOmNhc2UgMjI6Y2FzZSAyMzppZighcyYmNSE9PWF8fHMmJjU9PT1hKWJyZWFrO2cuc2V0VG9LZXlmcmFtZSgpO2JyZWFrO2Nhc2UgNjpjYXNlIDM5OmNhc2UgNDA6aWYoIXMmJjYhPT1hfHxzJiY2PT09YSlicmVhaztyLm1ldGFkYXRhVHJhY2suc2VpU2FtcGxlcy5wdXNoKG5ldyBOKHNlLnBhcnNlU0VJKHNlLnJlbW92ZUVQQihlKSxzKSx0K3UpKX19KSksZy5rZXlmcmFtZSYmdGhpcy5fZ29wSWQrKyxnLmdvcElkPXRoaXMuX2dvcElkfWVsc2UgcGUud2FybigiQ2Fubm90IHBhcnNlIE5BTFVzIixlKX1lbHNlIDI9PT1vfHxwZS53YXJuKCJVbmtub3duIEFWQ1BhY2tldFR5cGU6ICIuY29uY2F0KG8pKX19fSx7a2V5OiJfY2hlY2tBZGRNZXRhTmFsVG9Vbml0cyIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBlJiZ0aGlzLl9uZWVkQWRkTWV0YUJlZm9yZUtleUZyYW1lTmFsP3QubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gZVswXT4+PjEmNjN9KSkuaW5jbHVkZXMoMzIpPyh0aGlzLl9uZWVkQWRkTWV0YUJlZm9yZUtleUZyYW1lTmFsPSExLHQpOih0LnVuc2hpZnQoci5wcHNbMF0pLHQudW5zaGlmdChyLnNwc1swXSksdC51bnNoaWZ0KHIudnBzWzBdKSx0LmZpbHRlcihCb29sZWFuKSk6KHRoaXMuX25lZWRBZGRNZXRhQmVmb3JlS2V5RnJhbWVOYWw9ITEsdCl9fSx7a2V5OiJfcGFyc2VTY3JpcHQiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dGhpcy5tZXRhZGF0YVRyYWNrLmZsdlNjcmlwdFNhbXBsZXMucHVzaChuZXcgRihoZS5wYXJzZShlKSx0KSl9fV0sW3trZXk6InByb2JlIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gNzA9PT1lWzBdJiY3Nj09PWVbMV0mJjg2PT09ZVsyXSYmMT09PWVbM10mJmVlKGUsNSk+PTl9fV0pLGV9KCk7aSh2ZSwiQVVESU9fUkFURSIsWzU1MDAsMTFlMywyMmUzLDQ0ZTNdKSxuZXcgSCgiVHNEZW11eGVyIik7dmFyIHllPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LGEsbil7cih0aGlzLGUpLHRoaXMuZHY9bmV3IERhdGFWaWV3KHQpLHRoaXMuc3RhcnQ9dGhpcy5vZmZzZXQ9YXx8dGhpcy5kdi5ieXRlT2Zmc2V0LHRoaXMuZW5kPW4/dGhpcy5zdGFydCtuOnRoaXMuc3RhcnQrdGhpcy5kdi5ieXRlTGVuZ3RofXJldHVybiBuKGUsW3trZXk6ImJ1ZmZlciIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZHYuYnVmZmVyfX0se2tleToidW5yZWFkTGVuZ3RoIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gTWF0aC5tYXgodGhpcy5lbmQtdGhpcy5vZmZzZXQsMCl9fSx7a2V5OiJzaXplIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbmQtdGhpcy5zdGFydH19LHtrZXk6InJlYWRGbG9hdCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9MDtzd2l0Y2goZSl7Y2FzZSA0OnQ9dGhpcy5kdi5nZXRGbG9hdDMyKHRoaXMub2Zmc2V0KTticmVhaztjYXNlIDg6dD10aGlzLmR2LmdldEZsb2F0NjQodGhpcy5vZmZzZXQpO2JyZWFrO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCJyZWFkICIuY29uY2F0KGUsIi1ieXRlIGZsb2F0IGlzIG5vdCBzdXBwb3J0ZWQiKSl9cmV0dXJuIHRoaXMub2Zmc2V0Kz1lLHR9fSx7a2V5OiJiYWNrIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLm9mZnNldC09ZX19LHtrZXk6InNraXAiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMub2Zmc2V0Kz1lfX0se2tleToicmVhZEludCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5vZmZzZXQ7c3dpdGNoKHRoaXMub2Zmc2V0Kz1lLGUpe2Nhc2UgMTpyZXR1cm4gdGhpcy5kdi5nZXRJbnQ4KHQpO2Nhc2UgMjpyZXR1cm4gdGhpcy5kdi5nZXRJbnQxNih0KTtjYXNlIDQ6cmV0dXJuIHRoaXMuZHYuZ2V0SW50MzIodCk7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoInJlYWQgIi5jb25jYXQoZSwiLWJ5dGUgaW50ZWdlcnMgaXMgbm90IHN1cHBvcnRlZCIpKX19fSx7a2V5OiJyZWFkIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLm9mZnNldDtzd2l0Y2godGhpcy5vZmZzZXQrPWUsZSl7Y2FzZSAxOnJldHVybiB0aGlzLmR2LmdldFVpbnQ4KHQpO2Nhc2UgMjpyZXR1cm4gdGhpcy5kdi5nZXRVaW50MTYodCk7Y2FzZSAzOnJldHVybih0aGlzLmR2LmdldFVpbnQxNih0KTw8OCkrdGhpcy5kdi5nZXRVaW50OCh0KzIpO2Nhc2UgNDpyZXR1cm4gdGhpcy5kdi5nZXRVaW50MzIodCk7ZGVmYXVsdDpyZXR1cm4gdGhpcy5iYWNrKGUtNCksdGhpcy5yZWFkKGUtNCkrdGhpcy5kdi5nZXRVaW50MzIodCkqTWF0aC5wb3coMjU2LGUtNCl9fX0se2tleToid3JpdGUiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9dGhpcy5vZmZzZXQ7c3dpdGNoKHRoaXMub2Zmc2V0Kz1lLGUpe2Nhc2UgMTpyZXR1cm4gdGhpcy5kdi5zZXRVaW50OChyLHQpO2Nhc2UgMjpyZXR1cm4gdGhpcy5kdi5zZXRVaW50MTYocix0KTtjYXNlIDM6cmV0dXJuIHRoaXMuZHYuc2V0VWludDgocix0Pj4+MTYpLHRoaXMuZHYuc2V0VWludDE2KHIrMSw2NTUzNSZ0KTtjYXNlIDQ6cmV0dXJuIHRoaXMuZHYuc2V0VWludDMyKHIsdCk7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoIndyaXRlICIuY29uY2F0KGUsIi1ieXRlIGludGVnZXJzIGlzIG5vdCBzdXBwb3J0ZWQiKSl9fX0se2tleToicmVhZFRvQnVmZmVyIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdDtyZXR1cm4gdD10aGlzLm9mZnNldHx8ZT90aGlzLmR2LmJ1ZmZlci5zbGljZSh0aGlzLm9mZnNldCxlP3RoaXMub2Zmc2V0K2U6dGhpcy5lbmQpOnRoaXMuZHYuYnVmZmVyLHRoaXMub2Zmc2V0Kz10LmJ5dGVMZW5ndGgsdH19LHtrZXk6InJlYWRUb1VpbnQ4Iix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1uZXcgVWludDhBcnJheSh0aGlzLmR2LmJ1ZmZlcix0aGlzLm9mZnNldCxlfHx0aGlzLnVucmVhZExlbmd0aCk7cmV0dXJuIHRoaXMub2Zmc2V0Kz10LmJ5dGVMZW5ndGgsdH19LHtrZXk6InJlYWRTdHJpbmciLHZhbHVlOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0wLHI9IiI7dDxlO3QrKylyKz1TdHJpbmcuZnJvbUNoYXJDb2RlKHRoaXMuZHYuZ2V0VWludDgodGhpcy5vZmZzZXQpKSx0aGlzLm9mZnNldCsrO3JldHVybiByfX1dLFt7a2V5OiJmcm9tVWludDgiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQsdC5ieXRlTGVuZ3RoKX19LHtrZXk6ImNvbmNhdFVpbnQ4cyIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9bmV3IFVpbnQ4QXJyYXkoZS5yZWR1Y2UoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUrdC5ieXRlTGVuZ3RofSksMCkpLHI9MDtyZXR1cm4gZS5mb3JFYWNoKChmdW5jdGlvbihlKXt0LnNldChlLHIpLHIrPWUuYnl0ZUxlbmd0aH0pKSx0fX0se2tleToiY29uY2F0VWludDgiLHZhbHVlOmZ1bmN0aW9uKCl7Zm9yKHZhciBlPWFyZ3VtZW50cy5sZW5ndGgsdD1uZXcgQXJyYXkoZSkscj0wO3I8ZTtyKyspdFtyXT1hcmd1bWVudHNbcl07cmV0dXJuIHRoaXMuY29uY2F0VWludDhzKHQpfX1dKSxlfSgpLG1lPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LGEpe3IodGhpcyxlKSx0aGlzLm9mZnNldD0wLHRoaXMudmFsPXQsdGhpcy5zaXplPWF9cmV0dXJuIG4oZSxbe2tleToic2tpcCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5vZmZzZXQrPWV9fSx7a2V5OiJyZWFkIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLnNpemUtdGhpcy5vZmZzZXQtZTtpZih0Pj0wKXt2YXIgcj0wLGE9MDtpZih0aGlzLm9mZnNldCs9ZSx0aGlzLnNpemU+MzEpe2Zvcig7YTxlO2ErKylyKz1NYXRoLnBvdygyLGEpO3JldHVybiB0aGlzLnZhbC9NYXRoLnBvdygyLHQpJnJ9Zm9yKDthPGU7YSsrKXIrPTE8PGE7cmV0dXJuIHRoaXMudmFsPj4+dCZyfXRocm93IG5ldyBFcnJvcigidGhlIG51bWJlciBvZiB0aGUgcmVhZCBvcGVyYXRpb24gZXhjZWVkcyB0aGUgdG90YWwgbGVuZ3RoIGxpbWl0IG9mIGJpdHMiKX19XSxbe2tleToiZnJvbUJ5dGUiLHZhbHVlOmZ1bmN0aW9uKHQscil7cmV0dXJuIG5ldyBlKHQucmVhZChyKSxyPDwzKX19XSksZX0oKSxnZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXtyKHRoaXMsZSl9cmV0dXJuIG4oZSxudWxsLFt7a2V5OiJmaW5kQm94Iix2YWx1ZTpmdW5jdGlvbih0LHIpe3ZhciBhPWFyZ3VtZW50cy5sZW5ndGg+MiYmdm9pZCAwIT09YXJndW1lbnRzWzJdP2FyZ3VtZW50c1syXTowLG49W107aWYoIXQpcmV0dXJuIG47Zm9yKHZhciBpPTAscz0iIixvPTA7dC5sZW5ndGg+Nzspe2lmKGk9ZWUodCkscz1TdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsdC5zdWJhcnJheSg0LDgpKSxvPTgsMT09PWk/KGk9dGUodCw4KSxvKz04KTppfHwoaT10Lmxlbmd0aCksIXJbMF18fHM9PT1yWzBdKXt2YXIgdT10LnN1YmFycmF5KDAsaSk7aWYoIShyLmxlbmd0aDwyKSlyZXR1cm4gZS5maW5kQm94KHUuc3ViYXJyYXkobyksci5zbGljZSgxKSxhK28pO24ucHVzaCh7c3RhcnQ6YSxzaXplOmksaGVhZGVyU2l6ZTpvLHR5cGU6cyxkYXRhOnV9KX1hKz1pLHQ9dC5zdWJhcnJheShpKX1yZXR1cm4gbn19LHtrZXk6InRmaGQiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB3ZShlLCEwLChmdW5jdGlvbihlLHQpe2UudHJhY2tJZD1lZSh0KTt2YXIgcj00LGE9MSZlLmZsYWdzLG49MiZlLmZsYWdzLGk9OCZlLmZsYWdzLHM9MTYmZS5mbGFncyxvPTMyJmUuZmxhZ3M7YSYmKHIrPTQsZS5iYXNlRGF0YU9mZnNldD1lZSh0LHIpLHIrPTQpLG4mJihlLnNhbXBsZURlc2NyaXB0aW9uSW5kZXg9ZWUodCxyKSxyKz00KSxpJiYoZS5kZWZhdWx0U2FtcGxlRHVyYXRpb249ZWUodCxyKSxyKz00KSxzJiYoZS5kZWZhdWx0U2FtcGxlU2l6ZT1lZSh0LHIpLHIrPTQpLG8mJihlLmRlZmF1bHRTYW1wbGVGbGFncz1lZSh0LHIpKX0pKX19LHtrZXk6InNpZHgiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB3ZShlLCEwLChmdW5jdGlvbihlLHQpe3ZhciByPTA7ZS5yZWZlcmVuY2VfSUQ9ZWUodCxyKSxyKz00LGUudGltZXNjYWxlPWVlKHQscikscis9NCwwPT09ZS52ZXJzaW9uPyhlLmVhcmxpZXN0X3ByZXNlbnRhdGlvbl90aW1lPWVlKHQscikscis9NCxlLmZpcnN0X29mZnNldD1lZSh0LHIpLHIrPTQpOihlLmVhcmxpZXN0X3ByZXNlbnRhdGlvbl90aW1lPXRlKHQscikscis9OCxlLmZpcnN0X29mZnNldD10ZSh0LHIpLHIrPTgpLHIrPTIsZS5yZWZlcmVuY2VzPVtdO3ZhciBhPSQodCxyKTtyKz0yO2Zvcih2YXIgbj0wO248YTtuKyspe3ZhciBpPXt9O2UucmVmZXJlbmNlcy5wdXNoKGkpO3ZhciBzPWVlKHQscik7cis9NCxpLnJlZmVyZW5jZV90eXBlPXM+PjMxJjEsaS5yZWZlcmVuY2VkX3NpemU9MjE0NzQ4MzY0NyZzLGkuc3Vic2VnbWVudF9kdXJhdGlvbj1lZSh0LHIpLHM9ZWUodCxyKz00KSxyKz00LGkuc3RhcnRzX3dpdGhfU0FQPXM+PjMxJjEsaS5TQVBfdHlwZT1zPj4yOCY3LGkuU0FQX2RlbHRhX3RpbWU9MjY4NDM1NDU1JnN9fSkpfX0se2tleToibW9vdiIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIHdlKHQsITEsKGZ1bmN0aW9uKHQscixhKXt0Lm12aGQ9ZS5tdmhkKGUuZmluZEJveChyLFsibXZoZCJdLGEpWzBdKSx0LnRyYWs9ZS5maW5kQm94KHIsWyJ0cmFrIl0sYSkubWFwKChmdW5jdGlvbih0KXtyZXR1cm4gZS50cmFrKHQpfSkpLHQucHNzaD1lLnBzc2goZS5maW5kQm94KHIsWyJwc3NoIl0sYSlbMF0pfSkpfX0se2tleToibXZoZCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHdlKGUsITAsKGZ1bmN0aW9uKGUsdCl7dmFyIHI9MDsxPT09ZS52ZXJzaW9uPyhlLnRpbWVzY2FsZT1lZSh0LDE2KSxlLmR1cmF0aW9uPXRlKHQsMjApLHIrPTI4KTooZS50aW1lc2NhbGU9ZWUodCw4KSxlLmR1cmF0aW9uPWVlKHQsMTIpLHIrPTE2KSxlLm5leHRUcmFja0lkPWVlKHQscis3Nil9KSl9fSx7a2V5OiJ0cmFrIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gd2UodCwhMSwoZnVuY3Rpb24odCxyLGEpe3QudGtoZD1lLnRraGQoZS5maW5kQm94KHIsWyJ0a2hkIl0sYSlbMF0pLHQubWRpYT1lLm1kaWEoZS5maW5kQm94KHIsWyJtZGlhIl0sYSlbMF0pfSkpfX0se2tleToidGtoZCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHdlKGUsITAsKGZ1bmN0aW9uKGUsdCl7dmFyIHI9eWUuZnJvbVVpbnQ4KHQpOzE9PT1lLnZlcnNpb24/KHIucmVhZCg4KSxyLnJlYWQoOCksZS50cmFja0lkPXIucmVhZCg0KSxyLnJlYWQoNCksZS5kdXJhdGlvbj1yLnJlYWQoOCkpOihyLnJlYWQoNCksci5yZWFkKDQpLGUudHJhY2tJZD1yLnJlYWQoNCksci5yZWFkKDQpLGUuZHVyYXRpb249ci5yZWFkKDQpKSxyLnNraXAoMTYpLGUubWF0cml4PVtdO2Zvcih2YXIgYT0wO2E8MzY7YSsrKWUubWF0cml4LnB1c2goci5yZWFkKDEpKTtyLmJhY2soMzYpO2Zvcih2YXIgbixpPVtdLHM9MDtzPDM7cysrKWkucHVzaChpZShyLnJlYWRJbnQoMiksci5yZWFkSW50KDIpKSksaS5wdXNoKGllKHIucmVhZEludCgyKSxyLnJlYWRJbnQoMikpKSxuPXIucmVhZEludCg0KSxpLnB1c2goaWUobj4+MzAsMTA3Mzc0MTgyMyZuKSk7ZS5yb3RhdGlvbj1mdW5jdGlvbihlKXtpZihlLmxlbmd0aDw1KXJldHVybiAwO3ZhciB0PU1hdGguaHlwb3QoZVswXSxlWzNdKSxyPU1hdGguaHlwb3QoZVsxXSxlWzRdKTtyZXR1cm4gMD09PXR8fDA9PT1yPzA6MTgwKk1hdGguYXRhbjIoZVsxXS9yLGVbMF0vdCkvTWF0aC5QSX0oaSksZS53aWR0aD1yLnJlYWQoNCksZS5oZWlnaHQ9ci5yZWFkKDQpfSkpfX0se2tleToibWRpYSIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIHdlKHQsITEsKGZ1bmN0aW9uKHQscixhKXt0Lm1kaGQ9ZS5tZGhkKGUuZmluZEJveChyLFsibWRoZCJdLGEpWzBdKSx0LmhkbHI9ZS5oZGxyKGUuZmluZEJveChyLFsiaGRsciJdLGEpWzBdKSx0Lm1pbmY9ZS5taW5mKGUuZmluZEJveChyLFsibWluZiJdLGEpWzBdKX0pKX19LHtrZXk6Im1kaGQiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB3ZShlLCEwLChmdW5jdGlvbihlLHQpe3ZhciByPTA7MT09PWUudmVyc2lvbj8oZS50aW1lc2NhbGU9ZWUodCwxNiksZS5kdXJhdGlvbj10ZSh0LDIwKSxyKz0yOCk6KGUudGltZXNjYWxlPWVlKHQsOCksZS5kdXJhdGlvbj1lZSh0LDEyKSxyKz0xNik7dmFyIGE9JCh0LHIpO2UubGFuZ3VhZ2U9U3RyaW5nLmZyb21DaGFyQ29kZSg5NisoYT4+MTAmMzEpLDk2KyhhPj41JjMxKSw5NisoMzEmYSkpfSkpfX0se2tleToiaGRsciIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHdlKGUsITAsKGZ1bmN0aW9uKGUsdCl7MD09PWUudmVyc2lvbiYmKGUuaGFuZGxlclR5cGU9U3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLHQuc3ViYXJyYXkoNCw4KSkpfSkpfX0se2tleToibWluZiIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIHdlKHQsITEsKGZ1bmN0aW9uKHQscixhKXt0LnZtaGQ9ZS52bWhkKGUuZmluZEJveChyLFsidm1oZCJdLGEpWzBdKSx0LnNtaGQ9ZS5zbWhkKGUuZmluZEJveChyLFsic21oZCJdLGEpWzBdKSx0LnN0Ymw9ZS5zdGJsKGUuZmluZEJveChyLFsic3RibCJdLGEpWzBdKX0pKX19LHtrZXk6InZtaGQiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB3ZShlLCEwLChmdW5jdGlvbihlLHQpe2UuZ3JhcGhpY3Ntb2RlPSQodCksZS5vcGNvbG9yPVskKHQsMiksJCh0LDQpLCQodCw2KV19KSl9fSx7a2V5OiJzbWhkIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gd2UoZSwhMCwoZnVuY3Rpb24oZSx0KXtlLmJhbGFuY2U9JCh0KX0pKX19LHtrZXk6InN0YmwiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiB3ZSh0LCExLChmdW5jdGlvbih0LHIsYSl7dmFyIG4saSxzO3Quc3RzZD1lLnN0c2QoZS5maW5kQm94KHIsWyJzdHNkIl0sYSlbMF0pLHQuc3R0cz1lLnN0dHMoZS5maW5kQm94KHIsWyJzdHRzIl0sYSlbMF0pLHQuY3R0cz1lLmN0dHMoZS5maW5kQm94KHIsWyJjdHRzIl0sYSlbMF0pLHQuc3RzYz1lLnN0c2MoZS5maW5kQm94KHIsWyJzdHNjIl0sYSlbMF0pLHQuc3Rzej1lLnN0c3ooZS5maW5kQm94KHIsWyJzdHN6Il0sYSlbMF0pLHQuc3Rjbz1lLnN0Y28oZS5maW5kQm94KHIsWyJzdGNvIl0sYSlbMF0pLHQuc3Rjb3x8KHQuY282ND1lLmNvNjQoZS5maW5kQm94KHIsWyJjbzY0Il0sYSlbMF0pLHQuc3Rjbz10LmNvNjQpO3ZhciBvPW51bGw9PT0obj10LnN0c2QuZW50cmllc1swXSl8fHZvaWQgMD09PW58fG51bGw9PT0oaT1uLnNpbmYpfHx2b2lkIDA9PT1pfHxudWxsPT09KHM9aS5zY2hpKXx8dm9pZCAwPT09cz92b2lkIDA6cy50ZW5jLmRlZmF1bHRfSVZfc2l6ZTt0LnN0c3M9ZS5zdHNzKGUuZmluZEJveChyLFsic3RzcyJdLGEpWzBdKSx0LnNlbmM9ZS5zZW5jKGUuZmluZEJveChyLFsic2VuYyJdLGEpWzBdLG8pfSkpfX0se2tleToic2VuYyIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9YXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0/YXJndW1lbnRzWzFdOjg7cmV0dXJuIHdlKGUsITAsKGZ1bmN0aW9uKGUscil7dmFyIGE9MCxuPWVlKHIsYSk7YSs9NCxlLnNhbXBsZXM9W107Zm9yKHZhciBpPTA7aTxuO2krKyl7Zm9yKHZhciBzPXtJbml0aWFsaXphdGlvblZlY3RvcjpbXX0sbz0wO288dDtvKyspcy5Jbml0aWFsaXphdGlvblZlY3RvcltvXT1yW2Erb107aWYoYSs9dCwyJmUuZmxhZ3Mpe3Muc3Vic2FtcGxlcz1bXTt2YXIgdT0kKHIsYSk7YSs9Mjtmb3IodmFyIGM9MDtjPHU7YysrKXt2YXIgbD17fTtsLkJ5dGVzT2ZDbGVhckRhdGE9JChyLGEpLGErPTIsbC5CeXRlc09mUHJvdGVjdGVkRGF0YT1lZShyLGEpLGErPTQscy5zdWJzYW1wbGVzLnB1c2gobCl9fWUuc2FtcGxlcy5wdXNoKHMpfX0pKX19LHtrZXk6InBzc2giLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB3ZShlLCEwLChmdW5jdGlvbihlLHQpe2Zvcih2YXIgcj1bXSxhPVtdLG49MCxpPTA7aTwxNjtpKyspYS5wdXNoKFNlKHRbbitpXSkpO2lmKG4rPTE2LGUudmVyc2lvbj4wKXt2YXIgcz1lZSh0LG4pO24rPTQ7Zm9yKHZhciBvPTA7bzwoIiIrcykubGVuZ3RoO28rKylmb3IodmFyIHU9MDt1PDE2O3UrKyl7dmFyIGM9dFtuXTtuKz0xLHIucHVzaChTZShjKSl9fXZhciBsPWVlKHQsbik7ZS5kYXRhX3NpemU9bCxuKz00LGUua2lkPXIsZS5zeXN0ZW1faWQ9YSxlLmJ1ZmZlcj10fSkpfX0se2tleToic3RzZCIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIHdlKHQsITAsKGZ1bmN0aW9uKHQscixhKXt0LmVudHJ5Q291bnQ9ZWUociksdC5lbnRyaWVzPWUuZmluZEJveChyLnN1YmFycmF5KDQpLFtdLGErNCkubWFwKChmdW5jdGlvbih0KXtzd2l0Y2godC50eXBlKXtjYXNlImF2MDEiOnJldHVybiBlLmF2MDEodCk7Y2FzZSJhdmMxIjpjYXNlImF2YzIiOmNhc2UiYXZjMyI6Y2FzZSJhdmM0IjpyZXR1cm4gZS5hdmMxKHQpO2Nhc2UiaHZjMSI6Y2FzZSJoZXYxIjpyZXR1cm4gZS5odmMxKHQpO2Nhc2UibXA0YSI6cmV0dXJuIGUubXA0YSh0KTtjYXNlImFsYXciOmNhc2UidWxhdyI6cmV0dXJuIGUuYWxhdyh0KTtjYXNlImVuY2EiOnJldHVybiB3ZSh0LCExLChmdW5jdGlvbih0LHIsYSl7dC5jaGFubmVsQ291bnQ9JChyLDE2KSx0LnNhbXBsZXNpemU9JChyLDE4KSx0LnNhbXBsZVJhdGU9ZWUociwyNCkvNjU1MzYscj1yLnN1YmFycmF5KDI4KSx0LnNpbmY9ZS5zaW5mKGUuZmluZEJveChyLFsic2luZiJdLGEpWzBdKSx0LmVzZHM9ZS5lc2RzKGUuZmluZEJveChyLFsiZXNkcyJdLGEpWzBdKX0pKTtjYXNlImVuY3YiOnJldHVybiB3ZSh0LCExLChmdW5jdGlvbih0LHIsYSl7dC53aWR0aD0kKHIsMjQpLHQuaGVpZ2h0PSQociwyNiksdC5ob3JpenJlc29sdXRpb249ZWUociwyOCksdC52ZXJ0cmVzb2x1dGlvbj1lZShyLDMyKSxyPXIuc3ViYXJyYXkoNzgpLHQuc2luZj1lLnNpbmYoZS5maW5kQm94KHIsWyJzaW5mIl0sYSlbMF0pLHQuYXZjQz1lLmF2Y0MoZS5maW5kQm94KHIsWyJhdmNDIl0sYSlbMF0pLHQuaHZjQz1lLmh2Y0MoZS5maW5kQm94KHIsWyJodmNDIl0sYSlbMF0pLHQucGFzcD1lLnBhc3AoZS5maW5kQm94KHIsWyJwYXNwIl0sYSlbMF0pfSkpfX0pKS5maWx0ZXIoQm9vbGVhbil9KSl9fSx7a2V5OiJ0ZW5jIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gd2UoZSwhMSwoZnVuY3Rpb24oZSx0KXt2YXIgcj02O2UuZGVmYXVsdF9Jc0VuY3J5cHRlZD10W3JdLHIrPTEsZS5kZWZhdWx0X0lWX3NpemU9dFtyXSxyKz0xLGUuZGVmYXVsdF9LSUQ9W107Zm9yKHZhciBhPTA7YTwxNjthKyspZS5kZWZhdWx0X0tJRC5wdXNoKFNlKHRbcl0pKSxyKz0xfSkpfX0se2tleToic2NoaSIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIHdlKHQsITEsKGZ1bmN0aW9uKHQscixhKXt0LnRlbmM9ZS50ZW5jKGUuZmluZEJveChyLFsidGVuYyJdLGEpWzBdKX0pKX19LHtrZXk6InNpbmYiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiB3ZSh0LCExLChmdW5jdGlvbih0LHIsYSl7dC5zY2hpPWUuc2NoaShlLmZpbmRCb3gocixbInNjaGkiXSxhKVswXSksdC5mcm1hPWUuZnJtYShlLmZpbmRCb3gocixbImZybWEiXSxhKVswXSl9KSl9fSx7a2V5OiJmcm1hIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gd2UoZSwhMSwoZnVuY3Rpb24oZSx0KXtlLmRhdGFfZm9ybWF0PSIiO2Zvcih2YXIgcj0wO3I8NDtyKyspZS5kYXRhX2Zvcm1hdCs9U3RyaW5nLmZyb21DaGFyQ29kZSh0W3JdKX0pKX19LHtrZXk6ImNvbHIiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB3ZShlLCExLChmdW5jdGlvbih0LHIpe3ZhciBhPXllLmZyb21VaW50OChyKTt0LmRhdGE9ZS5kYXRhLHQuY29sb3JUeXBlPWEucmVhZFN0cmluZyg0KSwibmNseCI9PT10LmNvbG9yVHlwZT8odC5jb2xvclByaW1hcmllcz1hLnJlYWQoMiksdC50cmFuc2ZlckNoYXJhY3RlcmlzdGljcz1hLnJlYWQoMiksdC5tYXRyaXhDb2VmZmljaWVudHM9YS5yZWFkKDIpLHQuZnVsbFJhbmdlRmxhZz1hLnJlYWQoMSk+PjcpOiJySUNDIiE9PXQuY29sb3JUeXBlJiYicHJvZiIhPT10LmNvbG9yVHlwZXx8KHQuaWNjUHJvZmlsZT1yLnJlYWRUb1VpbnQ4KCkpfSkpfX0se2tleToiYXYwMSIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIHdlKHQsITEsKGZ1bmN0aW9uKHQscixhKXt2YXIgbj1iZSh0LHIpLGk9ci5zdWJhcnJheShuKTthKz1uLHQuYXYxQz1lLmF2MUMoZS5maW5kQm94KGksWyJhdjFDIl0sYSlbMF0pLHQuY29scj1lLmNvbHIoZS5maW5kQm94KGksWyJjb2xyIl0sYSlbMF0pfSkpfX0se2tleToiYXYxQyIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHdlKGUsITEsKGZ1bmN0aW9uKHQscil7dC5kYXRhPWUuZGF0YTt2YXIgYSxuPXllLmZyb21VaW50OChyKSxpPW1lLmZyb21CeXRlKG4sNCk7dC5tYXJrZXI9aS5yZWFkKDEpLHQudmVyc2lvbj1pLnJlYWQoNyksdC5zZXFQcm9maWxlPWkucmVhZCgzKSx0LnNlcUxldmVsSWR4MD1pLnJlYWQoNSksdC5zZXFUaWVyMD1pLnJlYWQoMSksdC5oaWdoQml0ZGVwdGg9aS5yZWFkKDEpLHQudHdlbHZlQml0PWkucmVhZCgxKSx0Lm1vbm9jaHJvbWU9aS5yZWFkKDEpLHQuY2hyb21hU3Vic2FtcGxpbmdYPWkucmVhZCgxKSx0LmNocm9tYVN1YnNhbXBsaW5nWT1pLnJlYWQoMSksdC5jaHJvbWFTYW1wbGVQb3NpdGlvbj1pLnJlYWQoMiksdC5yZXNlcnZlZD1pLnJlYWQoMyksdC5pbml0aWFsUHJlc2VudGF0aW9uRGVsYXlQcmVzZW50PWkucmVhZCgxKSx0LmluaXRpYWxQcmVzZW50YXRpb25EZWxheVByZXNlbnQ/dC5pbml0aWFsUHJlc2VudGF0aW9uRGVsYXlNaW51c09uZT1pLnJlYWQoNCk6dC5pbml0aWFsUHJlc2VudGF0aW9uRGVsYXlNaW51c09uZT0wLHQuY29uZmlnT0JVcz1uLnJlYWRUb1VpbnQ4KCksMj09PXQuc2VxTGV2ZWxJZHgwJiYxPT09dC5oaWdoQml0ZGVwdGg/YT0xPT09dC50d2VsdmVCaXQ/IjEyIjoiMTAiOnQuc2VxUHJvZmlsZTw9MiYmKGE9MT09PXQuaGlnaEJpdGRlcHRoPyIxMCI6IjA4IiksdC5jb2RlYz1bImF2MDEiLHQuc2VxUHJvZmlsZSwodC5zZXFMZXZlbElkeDA8MTA/IjAiK3Quc2VxTGV2ZWxJZHgwOnQuc2VxTGV2ZWxJZHgwKSsodC5zZXFUaWVyMD8iSCI6Ik0iKSxhXS5qb2luKCIuIil9KSl9fSx7a2V5OiJhdmMxIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gd2UodCwhMSwoZnVuY3Rpb24odCxyLGEpe3ZhciBuPWJlKHQsciksaT1yLnN1YmFycmF5KG4pO2ErPW4sdC5hdmNDPWUuYXZjQyhlLmZpbmRCb3goaSxbImF2Y0MiXSxhKVswXSksdC5wYXNwPWUucGFzcChlLmZpbmRCb3goaSxbInBhc3AiXSxhKVswXSl9KSl9fSx7a2V5OiJhdmNDIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gd2UoZSwhMSwoZnVuY3Rpb24odCxyKXt0LmRhdGE9ZS5kYXRhLHQuY29uZmlndXJhdGlvblZlcnNpb249clswXSx0LkFWQ1Byb2ZpbGVJbmRpY2F0aW9uPXJbMV0sdC5wcm9maWxlQ29tcGF0aWJpbGl0eT1yWzJdLHQuQVZDTGV2ZWxJbmRpY2F0aW9uPXJbM10sdC5jb2RlYz1yZShbclsxXSxyWzJdLHJbM11dKSx0Lmxlbmd0aFNpemVNaW51c09uZT0zJnJbNF0sdC5zcHNMZW5ndGg9MzEmcls1XSx0LnNwcz1bXTtmb3IodmFyIGE9NixuPTA7bjx0LnNwc0xlbmd0aDtuKyspe3ZhciBpPSQocixhKTthKz0yLHQuc3BzLnB1c2goci5zdWJhcnJheShhLGEraSkpLGErPWl9dC5wcHNMZW5ndGg9clthXSxhKz0xLHQucHBzPVtdO2Zvcih2YXIgcz0wO3M8dC5wcHNMZW5ndGg7cysrKXt2YXIgbz0kKHIsYSk7YSs9Mix0LnBwcy5wdXNoKHIuc3ViYXJyYXkoYSxhKz1vKSksYSs9b319KSl9fSx7a2V5OiJodmMxIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gd2UodCwhMSwoZnVuY3Rpb24odCxyLGEpe3ZhciBuPWJlKHQsciksaT1yLnN1YmFycmF5KG4pO2ErPW4sdC5odmNDPWUuaHZjQyhlLmZpbmRCb3goaSxbImh2Y0MiXSxhKVswXSksdC5wYXNwPWUucGFzcChlLmZpbmRCb3goaSxbInBhc3AiXSxhKVswXSl9KSl9fSx7a2V5OiJodmNDIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gd2UoZSwhMSwoZnVuY3Rpb24odCxyKXt0LmRhdGE9ZS5kYXRhLHQuY29kZWM9ImhldjEuMS42Lkw5My5CMCIsdC5jb25maWd1cmF0aW9uVmVyc2lvbj1yWzBdO3ZhciBhPXJbMV07dC5nZW5lcmFsUHJvZmlsZVNwYWNlPWE+PjYsdC5nZW5lcmFsVGllckZsYWc9KDMyJmEpPj41LHQuZ2VuZXJhbFByb2ZpbGVJZGM9MzEmYSx0LmdlbmVyYWxQcm9maWxlQ29tcGF0aWJpbGl0eT1lZShyLDIpLHQuZ2VuZXJhbENvbnN0cmFpbnRJbmRpY2F0b3JGbGFncz1yLnN1YmFycmF5KDYsMTIpLHQuZ2VuZXJhbExldmVsSWRjPXJbMTJdLHQuYXZnRnJhbWVSYXRlPSQociwxOSksdC5udW1PZkFycmF5cz1yWzIyXSx0LnZwcz1bXSx0LnNwcz1bXSx0LnBwcz1bXTtmb3IodmFyIG49MjMsaT0wLHM9MCxvPTAsdT0wO3U8dC5udW1PZkFycmF5czt1Kyspe2k9NjMmcltuXSxzPSQocixuKzEpLG4rPTM7Zm9yKHZhciBjLGw9W10sZj0wO2Y8cztmKyspbz0kKHIsbiksbis9MixsLnB1c2goci5zdWJhcnJheShuLG4rbykpLG4rPW87aWYoMzI9PT1pKShjPXQudnBzKS5wdXNoLmFwcGx5KGMsbCk7ZWxzZSBpZigzMz09PWkpe3ZhciBkOyhkPXQuc3BzKS5wdXNoLmFwcGx5KGQsbCl9ZWxzZSBpZigzND09PWkpe3ZhciBoOyhoPXQucHBzKS5wdXNoLmFwcGx5KGgsbCl9fX0pKX19LHtrZXk6InBhc3AiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB3ZShlLCExLChmdW5jdGlvbihlLHQpe2UuaFNwYWNpbmc9ZWUodCksZS52U3BhY2luZz1lZSh0LDQpfSkpfX0se2tleToibXA0YSIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIHdlKHQsITEsKGZ1bmN0aW9uKHQscixhKXt2YXIgbj1fZSh0LHIpO3QuZXNkcz1lLmVzZHMoZS5maW5kQm94KHIuc3ViYXJyYXkobiksWyJlc2RzIl0sYStuKVswXSl9KSl9fSx7a2V5OiJlc2RzIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gd2UoZSwhMCwoZnVuY3Rpb24oZSx0KXtlLmNvZGVjPSJtcDRhLiI7Zm9yKHZhciByPTAsYT0wLG49MCxpPTA7dC5sZW5ndGg7KXtmb3IoaT10W3I9MF0sYT10W3IrMV0scis9MjsxMjgmYTspbj0oMTI3JmEpPDw3LGE9dFtyXSxyKz0xO2lmKG4rPTEyNyZhLDM9PT1pKXQ9dC5zdWJhcnJheShyKzMpO2Vsc2V7aWYoNCE9PWkpe2lmKDU9PT1pKXt2YXIgcz1lLmNvbmZpZz10LnN1YmFycmF5KHIscituKSxvPSgyNDgmc1swXSk+PjM7cmV0dXJuIDMxPT09byYmcy5sZW5ndGg+PTImJihvPTMyKygoNyZzWzBdKTw8MykrKCgyMjQmc1sxXSk+PjUpKSxlLm9iamVjdFR5cGU9byxlLmNvZGVjKz1vLnRvU3RyaW5nKDE2KSx2b2lkKCIuIj09PWUuY29kZWNbZS5jb2RlYy5sZW5ndGgtMV0mJihlLmNvZGVjPWUuY29kZWMuc3Vic3RyaW5nKDAsZS5jb2RlYy5sZW5ndGgtMSkpKX1yZXR1cm4gdm9pZCgiLiI9PT1lLmNvZGVjW2UuY29kZWMubGVuZ3RoLTFdJiYoZS5jb2RlYz1lLmNvZGVjLnN1YnN0cmluZygwLGUuY29kZWMubGVuZ3RoLTEpKSl9ZS5jb2RlYys9KHRbcl0udG9TdHJpbmcoMTYpKyIuIikucGFkU3RhcnQoMywiMCIpLHQ9dC5zdWJhcnJheShyKzEzKX19fSkpfX0se2tleToiYWxhdyIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHdlKGUsITEsKGZ1bmN0aW9uKGUsdCl7X2UoZSx0KX0pKX19LHtrZXk6InN0dHMiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB3ZShlLCEwLChmdW5jdGlvbihlLHQpe2Zvcih2YXIgcj1lZSh0KSxhPVtdLG49NCxpPTA7aTxyO2krKylhLnB1c2goe2NvdW50OmVlKHQsbiksZGVsdGE6ZWUodCxuKzQpfSksbis9ODtlLmVudHJ5Q291bnQ9cixlLmVudHJpZXM9YX0pKX19LHtrZXk6ImN0dHMiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB3ZShlLCEwLChmdW5jdGlvbihlLHQpe3ZhciByPWVlKHQpLGE9W10sbj00O2lmKDE9PT1lLnZlcnNpb24pZm9yKHZhciBpPTA7aTxyO2krKylhLnB1c2goe2NvdW50OmVlKHQsbiksb2Zmc2V0OmVlKHQsbis0KX0pLG4rPTg7ZWxzZSBmb3IodmFyIHM9MDtzPHI7cysrKWEucHVzaCh7Y291bnQ6ZWUodCxuKSxvZmZzZXQ6LSgxK35lZSh0LG4rNCkpfSksbis9ODtlLmVudHJ5Q291bnQ9cixlLmVudHJpZXM9YX0pKX19LHtrZXk6InN0c2MiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB3ZShlLCEwLChmdW5jdGlvbihlLHQpe2Zvcih2YXIgcj1lZSh0KSxhPVtdLG49NCxpPTA7aTxyO2krKylhLnB1c2goe2ZpcnN0Q2h1bms6ZWUodCxuKSxzYW1wbGVzUGVyQ2h1bms6ZWUodCxuKzQpLHNhbXBsZURlc2NyaXB0aW9uSW5kZXg6ZWUodCxuKzgpfSksbis9MTI7ZS5lbnRyeUNvdW50PXIsZS5lbnRyaWVzPWF9KSl9fSx7a2V5OiJzdHN6Iix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gd2UoZSwhMCwoZnVuY3Rpb24oZSx0KXt2YXIgcj1lZSh0KSxhPWVlKHQsNCksbj1bXTtpZighcilmb3IodmFyIGk9OCxzPTA7czxhO3MrKyluLnB1c2goZWUodCxpKSksaSs9NDtlLnNhbXBsZVNpemU9cixlLnNhbXBsZUNvdW50PWEsZS5lbnRyeVNpemVzPW59KSl9fSx7a2V5OiJzdGNvIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gd2UoZSwhMCwoZnVuY3Rpb24oZSx0KXtmb3IodmFyIHI9ZWUodCksYT1bXSxuPTQsaT0wO2k8cjtpKyspYS5wdXNoKGVlKHQsbikpLG4rPTQ7ZS5lbnRyeUNvdW50PXIsZS5lbnRyaWVzPWF9KSl9fSx7a2V5OiJjbzY0Iix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gd2UoZSwhMCwoZnVuY3Rpb24oZSx0KXtmb3IodmFyIHI9ZWUodCksYT1bXSxuPTQsaT0wO2k8cjtpKyspYS5wdXNoKHRlKHQsbikpLG4rPTg7ZS5lbnRyeUNvdW50PXIsZS5lbnRyaWVzPWF9KSl9fSx7a2V5OiJzdHNzIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gd2UoZSwhMCwoZnVuY3Rpb24oZSx0KXtmb3IodmFyIHI9ZWUodCksYT1bXSxuPTQsaT0wO2k8cjtpKyspYS5wdXNoKGVlKHQsbikpLG4rPTQ7ZS5lbnRyeUNvdW50PXIsZS5lbnRyaWVzPWF9KSl9fSx7a2V5OiJtb29mIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gd2UodCwhMSwoZnVuY3Rpb24odCxyLGEpe3QubWZoZD1lLm1maGQoZS5maW5kQm94KHIsWyJtZmhkIl0sYSlbMF0pLHQudHJhZj1lLmZpbmRCb3gocixbInRyYWYiXSxhKS5tYXAoKGZ1bmN0aW9uKHQpe3JldHVybiBlLnRyYWYodCl9KSl9KSl9fSx7a2V5OiJtZmhkIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gd2UoZSwhMCwoZnVuY3Rpb24oZSx0KXtlLnNlcXVlbmNlTnVtYmVyPWVlKHQpfSkpfX0se2tleToidHJhZiIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIHdlKHQsITEsKGZ1bmN0aW9uKHQscixhKXt0LnRmaGQ9ZS50ZmhkKGUuZmluZEJveChyLFsidGZoZCJdLGEpWzBdKSx0LnRmZHQ9ZS50ZmR0KGUuZmluZEJveChyLFsidGZkdCJdLGEpWzBdKSx0LnRydW49ZS50cnVuKGUuZmluZEJveChyLFsidHJ1biJdLGEpWzBdKX0pKX19LHtrZXk6InRydW4iLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB3ZShlLCEwLChmdW5jdGlvbihlLHQpe3ZhciByPWUudmVyc2lvbixhPWUuZmxhZ3Msbj10Lmxlbmd0aCxpPWUuc2FtcGxlQ291bnQ9ZWUodCkscz00O2lmKG4+cyYmMSZhJiYoZS5kYXRhT2Zmc2V0PS0oMSt+ZWUodCxzKSkscys9NCksbj5zJiY0JmEmJihlLmZpcnN0U2FtcGxlRmxhZ3M9ZWUodCxzKSxzKz00KSxlLnNhbXBsZXM9W10sbj5zKWZvcih2YXIgbyx1PTA7dTxpO3UrKylvPXt9LDI1NiZhJiYoby5kdXJhdGlvbj1lZSh0LHMpLHMrPTQpLDUxMiZhJiYoby5zaXplPWVlKHQscykscys9NCksMTAyNCZhJiYoby5mbGFncz1lZSh0LHMpLHMrPTQpLDIwNDgmYSYmKG8uY3RzPXI/LSgxK35lZSh0LHMrNCkpOmVlKHQscykscys9NCksZS5zYW1wbGVzLnB1c2gobyl9KSl9fSx7a2V5OiJ0ZmR0Iix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gd2UoZSwhMCwoZnVuY3Rpb24oZSx0KXsxPT09ZS52ZXJzaW9uP2UuYmFzZU1lZGlhRGVjb2RlVGltZT10ZSh0KTplLmJhc2VNZWRpYURlY29kZVRpbWU9ZWUodCl9KSl9fSx7a2V5OiJwcm9iZSIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuISFlLmZpbmRCb3godCxbImZ0eXAiXSl9fSx7a2V5OiJwYXJzZVNhbXBsZUZsYWdzIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm57aXNMZWFkaW5nOigxMiZlWzBdKT4+PjIsZGVwZW5kc09uOjMmZVswXSxpc0RlcGVuZGVkT246KDE5MiZlWzFdKT4+PjYsaGFzUmVkdW5kYW5jeTooNDgmZVsxXSk+Pj40LHBhZGRpbmdWYWx1ZTooMTQmZVsxXSk+Pj4xLGlzTm9uU3luY1NhbXBsZToxJmVbMV0sZGVncmFkYXRpb25Qcmlvcml0eTplWzJdPDw4fGVbM119fX0se2tleToibW9vdlRvVHJhY2siLHZhbHVlOmZ1bmN0aW9uKGUsdCxyKXt2YXIgYSxuLGk9ZS50cmFrO2lmKGkmJmkubGVuZ3RoKXt2YXIgcz1pLmZpbmQoKGZ1bmN0aW9uKGUpe3ZhciB0LHI7cmV0dXJuInZpZGUiPT09KG51bGw9PT0odD1lLm1kaWEpfHx2b2lkIDA9PT10fHxudWxsPT09KHI9dC5oZGxyKXx8dm9pZCAwPT09cj92b2lkIDA6ci5oYW5kbGVyVHlwZSl9KSksbz1pLmZpbmQoKGZ1bmN0aW9uKGUpe3ZhciB0LHI7cmV0dXJuInNvdW4iPT09KG51bGw9PT0odD1lLm1kaWEpfHx2b2lkIDA9PT10fHxudWxsPT09KHI9dC5oZGxyKXx8dm9pZCAwPT09cj92b2lkIDA6ci5oYW5kbGVyVHlwZSl9KSk7aWYocyYmdCl7dmFyIHUsYyxsLGYsZCxoLHAsdj10LHk9bnVsbD09PSh1PXMudGtoZCl8fHZvaWQgMD09PXU/dm9pZCAwOnUudHJhY2tJZDtudWxsIT15JiYodi5pZD1zLnRraGQudHJhY2tJZCksdi50a2hkRHVyYXRpb249cy50a2hkLmR1cmF0aW9uLHYubXZoZER1cnRpb249ZS5tdmhkLmR1cmF0aW9uLHYubXZoZFRpbWVjYWxlPWUubXZoZC50aW1lc2NhbGUsdi50aW1lc2NhbGU9di5mb3JtYXRUaW1lc2NhbGU9cy5tZGlhLm1kaGQudGltZXNjYWxlLHYuZHVyYXRpb249cy5tZGlhLm1kaGQuZHVyYXRpb258fHYubXZoZER1cnRpb24vdi5tdmhkVGltZWNhbGUqdi50aW1lc2NhbGUsdi5yb3RhdGlvbj1zLnRraGQucm90YXRpb24sdi5tYXRyaXg9cy50a2hkLm1hdHJpeDt2YXIgbSxnLGssYixfLHcsUyxELFQ9cy5tZGlhLm1pbmYuc3RibC5zdHNkLmVudHJpZXNbMF07aWYodi53aWR0aD1ULndpZHRoLHYuaGVpZ2h0PVQuaGVpZ2h0LFQucGFzcCYmKHYuc2FyUmF0aW89W1QucGFzcC5oU3BhY2luZyxULnBhc3AudlNwYWNpbmddKSxULmF2MUMpdi5jb2RlY1R5cGU9eCx2LmNvZGVjPVQuYXYxQy5jb2RlYyx2LmF2MUM9VC5hdjFDLmRhdGEsdi5jb2xyPVQuY29sci5kYXRhO2Vsc2UgaWYoVC5odmNDKXYuY29kZWNUeXBlPUEsdi5jb2RlYz1ULmh2Y0MuY29kZWMsdi52cHM9VC5odmNDLnZwcyx2LnNwcz1ULmh2Y0Muc3BzLHYucHBzPVQuaHZjQy5wcHMsdi5odmNDPVQuaHZjQy5kYXRhO2Vsc2V7aWYoIVQuYXZjQyl0aHJvdyBuZXcgRXJyb3IoInVua25vd24gdmlkZW8gc3RzZCBlbnRyeSIpO3YuY29kZWM9VC5hdmNDLmNvZGVjLHYuc3BzPVQuYXZjQy5zcHMsdi5wcHM9VC5hdmNDLnBwc31pZih2LnByZXNlbnQ9ITAsdi5leHQ9e30sdi5leHQuc3Rzcz1udWxsPT09KGM9cy5tZGlhKXx8dm9pZCAwPT09Y3x8bnVsbD09PShsPWMubWluZil8fHZvaWQgMD09PWx8fG51bGw9PT0oZj1sLnN0YmwpfHx2b2lkIDA9PT1mP3ZvaWQgMDpmLnN0c3Msdi5leHQuY3R0cz1udWxsPT09KGQ9cy5tZGlhKXx8dm9pZCAwPT09ZHx8bnVsbD09PShoPWQubWluZil8fHZvaWQgMD09PWh8fG51bGw9PT0ocD1oLnN0YmwpfHx2b2lkIDA9PT1wP3ZvaWQgMDpwLmN0dHMsVCYmImVuY3YiPT09VC50eXBlKXYuaXNWaWRlb0VuY3J5cHRpb249ITAsVC5kZWZhdWx0X0tJRD1udWxsPT09KG09VC5zaW5mKXx8dm9pZCAwPT09bXx8bnVsbD09PShnPW0uc2NoaSl8fHZvaWQgMD09PWc/dm9pZCAwOmcudGVuYy5kZWZhdWx0X0tJRCxULmRlZmF1bHRfSXNFbmNyeXB0ZWQ9bnVsbD09PShrPVQuc2luZil8fHZvaWQgMD09PWt8fG51bGw9PT0oYj1rLnNjaGkpfHx2b2lkIDA9PT1iP3ZvaWQgMDpiLnRlbmMuZGVmYXVsdF9Jc0VuY3J5cHRlZCxULmRlZmF1bHRfSVZfc2l6ZT1udWxsPT09KF89VC5zaW5mKXx8dm9pZCAwPT09X3x8bnVsbD09PSh3PV8uc2NoaSl8fHZvaWQgMD09PXc/dm9pZCAwOncudGVuYy5kZWZhdWx0X0lWX3NpemUsdi52aWRlb1NlbmM9cy5tZGlhLm1pbmYuc3RibC5zZW5jJiZzLm1kaWEubWluZi5zdGJsLnNlbmMuc2FtcGxlcyxULmRhdGFfZm9ybWF0PW51bGw9PT0oUz1ULnNpbmYpfHx2b2lkIDA9PT1TfHxudWxsPT09KEQ9Uy5mcm1hKXx8dm9pZCAwPT09RD92b2lkIDA6RC5kYXRhX2Zvcm1hdCx2LnVzZUVNRT1lLnVzZUVNRSx2LmtpZFZhbHVlPWUua2lkVmFsdWUsdi5wc3NoPWUucHNzaCx2LmVuY3Y9VH1pZihvJiZyKXt2YXIgVSxDLFAsSSxNLHosTyxSLEwsVj1yLEY9bnVsbD09PShVPW8udGtoZCl8fHZvaWQgMD09PVU/dm9pZCAwOlUudHJhY2tJZDtudWxsIT1GJiYoVi5pZD1vLnRraGQudHJhY2tJZCksVi50a2hkRHVyYXRpb249by50a2hkLmR1cmF0aW9uLFYubXZoZER1cnRpb249ZS5tdmhkLmR1cmF0aW9uLFYubXZoZFRpbWVjYWxlPWUubXZoZC50aW1lc2NhbGUsVi50aW1lc2NhbGU9Vi5mb3JtYXRUaW1lc2NhbGU9by5tZGlhLm1kaGQudGltZXNjYWxlLFYuZHVyYXRpb249by5tZGlhLm1kaGQuZHVyYXRpb258fFYubXZoZER1cnRpb24vVi5tdmhkVGltZWNhbGUqVi50aW1lc2NhbGU7dmFyIE4saixHLEgsSyxxLFcsWCxZPW8ubWRpYS5taW5mLnN0Ymwuc3RzZC5lbnRyaWVzWzBdO3N3aXRjaChWLnNhbXBsZVNpemU9WS5zYW1wbGVTaXplLFYuc2FtcGxlUmF0ZT1ZLnNhbXBsZVJhdGUsVi5jaGFubmVsQ291bnQ9WS5jaGFubmVsQ291bnQsVi5wcmVzZW50PSEwLFkudHlwZSl7Y2FzZSJhbGF3IjpWLmNvZGVjVHlwZT1WLmNvZGVjPUIsVi5zYW1wbGVSYXRlPThlMzticmVhaztjYXNlInVsYXciOlYuY29kZWNUeXBlPVYuY29kZWM9RSxWLnNhbXBsZVJhdGU9OGUzO2JyZWFrO2RlZmF1bHQ6Vi5zYW1wbGVEdXJhdGlvbj11ZS5nZXRGcmFtZUR1cmF0aW9uKFYuc2FtcGxlUmF0ZSxWLnRpbWVzY2FsZSksVi5zYW1wbGVSYXRlSW5kZXg9dWUuZ2V0UmF0ZUluZGV4QnlSYXRlKFYuc2FtcGxlUmF0ZSksVi5vYmplY3RUeXBlPShudWxsPT09KGE9WS5lc2RzKXx8dm9pZCAwPT09YT92b2lkIDA6YS5vYmplY3RUeXBlKXx8MixZLmVzZHMmJihWLmNvbmZpZz1BcnJheS5mcm9tKFkuZXNkcy5jb25maWcpKSxWLmNvZGVjPShudWxsPT09KG49WS5lc2RzKXx8dm9pZCAwPT09bj92b2lkIDA6bi5jb2RlYyl8fCJtcDRhLjQwLjIifWlmKFYuc2FtcGxlRHVyYXRpb249dWUuZ2V0RnJhbWVEdXJhdGlvbihWLnNhbXBsZVJhdGUsVi50aW1lc2NhbGUpLFYub2JqZWN0VHlwZT0obnVsbD09PShDPVkuZXNkcyl8fHZvaWQgMD09PUM/dm9pZCAwOkMub2JqZWN0VHlwZSl8fDIsWS5lc2RzJiYoWS5lc2RzLmNvbmZpZz9WLmNvbmZpZz1BcnJheS5mcm9tKFkuZXNkcy5jb25maWcpOmNvbnNvbGUud2FybigiZXNkcyBjb25maWcgaXMgbnVsbCIpKSxWLmNvZGVjPShudWxsPT09KFA9WS5lc2RzKXx8dm9pZCAwPT09UD92b2lkIDA6UC5jb2RlYyl8fCJtcDRhLjQwLjIiLFYuc2FtcGxlUmF0ZUluZGV4PXVlLmdldFJhdGVJbmRleEJ5UmF0ZShWLnNhbXBsZVJhdGUpLFYuZXh0PXt9LFYuZXh0LnN0c3M9bnVsbD09PShJPW8ubWRpYSl8fHZvaWQgMD09PUl8fG51bGw9PT0oTT1JLm1pbmYpfHx2b2lkIDA9PT1NfHxudWxsPT09KHo9TS5zdGJsKXx8dm9pZCAwPT09ej92b2lkIDA6ei5zdHNzLFYuZXh0LmN0dHM9bnVsbD09PShPPW8ubWRpYSl8fHZvaWQgMD09PU98fG51bGw9PT0oUj1PLm1pbmYpfHx2b2lkIDA9PT1SfHxudWxsPT09KEw9Ui5zdGJsKXx8dm9pZCAwPT09TD92b2lkIDA6TC5jdHRzLFYucHJlc2VudD0hMCxZJiYiZW5jYSI9PT1ZLnR5cGUpVi5pc0F1ZGlvRW5jcnlwdGlvbj0hMCxZLmRhdGFfZm9ybWF0PW51bGw9PT0oTj1ZLnNpbmYpfHx2b2lkIDA9PT1OfHxudWxsPT09KGo9Ti5mcm1hKXx8dm9pZCAwPT09aj92b2lkIDA6ai5kYXRhX2Zvcm1hdCxZLmRlZmF1bHRfS0lEPW51bGw9PT0oRz1ZLnNpbmYpfHx2b2lkIDA9PT1HfHxudWxsPT09KEg9Ry5zY2hpKXx8dm9pZCAwPT09SD92b2lkIDA6SC50ZW5jLmRlZmF1bHRfS0lELFkuZGVmYXVsdF9Jc0VuY3J5cHRlZD1udWxsPT09KEs9WS5zaW5mKXx8dm9pZCAwPT09S3x8bnVsbD09PShxPUsuc2NoaSl8fHZvaWQgMD09PXE/dm9pZCAwOnEudGVuYy5kZWZhdWx0X0lzRW5jcnlwdGVkLFkuZGVmYXVsdF9JVl9zaXplPW51bGw9PT0oVz1ZLnNpbmYpfHx2b2lkIDA9PT1XfHxudWxsPT09KFg9Vy5zY2hpKXx8dm9pZCAwPT09WD92b2lkIDA6WC50ZW5jLmRlZmF1bHRfSVZfc2l6ZSxWLmF1ZGlvU2VuYz1vLm1kaWEubWluZi5zdGJsLnNlbmMmJm8ubWRpYS5taW5mLnN0Ymwuc2VuYy5zYW1wbGVzLFYudXNlRU1FPWUudXNlRU1FLFYua2lkVmFsdWU9ZS5raWRWYWx1ZSxWLmVuY2E9WX1pZihyJiYoci5pc1ZpZGVvRW5jcnlwdGlvbj0hIXQmJnQuaXNWaWRlb0VuY3J5cHRpb24pLHQmJih0LmlzQXVkaW9FbmNyeXB0aW9uPSEhciYmci5pc0F1ZGlvRW5jcnlwdGlvbiksbnVsbCE9dCYmdC5lbmN2fHxudWxsIT1yJiZyLmVuY2Epe3ZhciBaLFEsSj1udWxsPT10fHxudWxsPT09KFo9dC5lbmN2KXx8dm9pZCAwPT09Wj92b2lkIDA6Wi5kZWZhdWx0X0tJRCwkPW51bGw9PXJ8fG51bGw9PT0oUT1yLmVuY2EpfHx2b2lkIDA9PT1RP3ZvaWQgMDpRLmRlZmF1bHRfS0lELGVlPUp8fCQ/KEp8fCQpLmpvaW4oIiIpOm51bGw7dCYmKHQua2lkPWVlKSxyJiYoci5raWQ9ZWUpfXJldHVybiB0JiYodC5mbGFncz0zODQxKSxyJiYoci5mbGFncz0xNzkzKSx7dmlkZW9UcmFjazp0LGF1ZGlvVHJhY2s6cn19fX0se2tleToiZXZhbHVhdGVEZWZhdWx0RHVyYXRpb24iLHZhbHVlOmZ1bmN0aW9uKGUsdCxyKXt2YXIgYSxuPW51bGw9PXR8fG51bGw9PT0oYT10LnNhbXBsZXMpfHx2b2lkIDA9PT1hP3ZvaWQgMDphLmxlbmd0aDtyZXR1cm4gbj8xMDI0Km4vdC50aW1lc2NhbGUqZS50aW1lc2NhbGUvcjoxMDI0fX0se2tleToibW9vZlRvU2FtcGxlcyIsdmFsdWU6ZnVuY3Rpb24odCxyLGEpe3ZhciBuPXt9O3JldHVybiB0Lm1maGQmJihyJiYoci5zZXF1ZW5jZU51bWJlcj10Lm1maGQuc2VxdWVuY2VOdW1iZXIpLGEmJihhLnNlcXVlbmNlTnVtYmVyPXQubWZoZC5zZXF1ZW5jZU51bWJlcikpLHQudHJhZi5mb3JFYWNoKChmdW5jdGlvbih0KXt2YXIgaT10LnRmaGQscz10LnRmZHQsbz10LnRydW47aWYoaSYmbyl7cyYmKHImJnIuaWQ9PT1pLnRyYWNrSWQmJihyLmJhc2VNZWRpYURlY29kZVRpbWU9cy5iYXNlTWVkaWFEZWNvZGVUaW1lKSxhJiZhLmlkPT09aS50cmFja0lkJiYoYS5iYXNlTWVkaWFEZWNvZGVUaW1lPXMuYmFzZU1lZGlhRGVjb2RlVGltZSkpO3ZhciB1PWkuZGVmYXVsdFNhbXBsZVNpemV8fDAsYz1pLmRlZmF1bHRTYW1wbGVEdXJhdGlvbnx8ZS5ldmFsdWF0ZURlZmF1bHREdXJhdGlvbihyLGEsby5zYW1wbGVzLmxlbmd0aHx8by5zYW1wbGVDb3VudCksbD1vLmRhdGFPZmZzZXR8fDAsZj0wLGQ9LTE7aWYoIW8uc2FtcGxlcy5sZW5ndGgmJm8uc2FtcGxlQ291bnQpe25baS50cmFja0lkXT1bXTtmb3IodmFyIGg9MDtoPG8uc2FtcGxlQ291bnQ7aCsrKW5baS50cmFja0lkXS5wdXNoKHtvZmZzZXQ6bCxkdHM6ZixkdXJhdGlvbjpjLHNpemU6dX0pLGYrPWMsbCs9dX1lbHNlIG5baS50cmFja0lkXT1vLnNhbXBsZXMubWFwKChmdW5jdGlvbihlLHQpe3JldHVybihlPXtvZmZzZXQ6bCxkdHM6ZixwdHM6ZisoZS5jdHN8fDApLGR1cmF0aW9uOmUuZHVyYXRpb258fGMsc2l6ZTplLnNpemV8fHUsZ29wSWQ6ZCxrZXlmcmFtZTowPT09dHx8bnVsbCE9PWUuZmxhZ3MmJnZvaWQgMCE9PWUuZmxhZ3MmJig2NTUzNiZlLmZsYWdzKT4+PjAhPTY1NTM2fSkua2V5ZnJhbWUmJihkKyssZS5nb3BJZD1kKSxmKz1lLmR1cmF0aW9uLGwrPWUuc2l6ZSxlfSkpfX0pKSxufX0se2tleToibW9vdlRvU2FtcGxlcyIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS50cmFrO2lmKHQmJnQubGVuZ3RoKXt2YXIgcj10LmZpbmQoKGZ1bmN0aW9uKGUpe3ZhciB0LHI7cmV0dXJuInZpZGUiPT09KG51bGw9PT0odD1lLm1kaWEpfHx2b2lkIDA9PT10fHxudWxsPT09KHI9dC5oZGxyKXx8dm9pZCAwPT09cj92b2lkIDA6ci5oYW5kbGVyVHlwZSl9KSksYT10LmZpbmQoKGZ1bmN0aW9uKGUpe3ZhciB0LHI7cmV0dXJuInNvdW4iPT09KG51bGw9PT0odD1lLm1kaWEpfHx2b2lkIDA9PT10fHxudWxsPT09KHI9dC5oZGxyKXx8dm9pZCAwPT09cj92b2lkIDA6ci5oYW5kbGVyVHlwZSl9KSk7aWYocnx8YSl7dmFyIG4saTtpZihyKXt2YXIgcyxvLHU9bnVsbD09PShzPXIubWRpYSl8fHZvaWQgMD09PXN8fG51bGw9PT0obz1zLm1pbmYpfHx2b2lkIDA9PT1vP3ZvaWQgMDpvLnN0Ymw7aWYoIXUpcmV0dXJuO3ZhciBjPXUuc3R0cyxsPXUuc3RzYyxmPXUuc3RzeixkPXUuc3RjbyxoPXUuc3RzcyxwPXUuY3R0cztpZighKGMmJmwmJmYmJmQmJmgpKXJldHVybjtuPWtlKGMsbCxmLGQscCxoKX1pZihhKXt2YXIgdix5LG0sZz1udWxsPT09KHY9YS5tZGlhKXx8dm9pZCAwPT09dnx8bnVsbD09PSh5PXYubWluZil8fHZvaWQgMD09PXk/dm9pZCAwOnkuc3RibDtpZighZylyZXR1cm47dmFyIGs9bnVsbD09PShtPWEubWRpYS5tZGhkKXx8dm9pZCAwPT09bT92b2lkIDA6bS50aW1lc2NhbGUsYj1nLnN0dHMsXz1nLnN0c2Msdz1nLnN0c3oseD1nLnN0Y287aWYoIShrJiZiJiZfJiZ3JiZ4KSlyZXR1cm47aT1rZShiLF8sdyx4KX1yZXR1cm57dmlkZW9TYW1wbGVzOm4sYXVkaW9TYW1wbGVzOml9fX19fV0pLGV9KCk7ZnVuY3Rpb24ga2UoZSx0LHIsYSxuLGkpe3ZhciBzLG8sdSxjPVtdLGw9bnVsbD09bj92b2lkIDA6bi5lbnRyaWVzLGY9dC5lbnRyaWVzLGQ9YS5lbnRyaWVzLGg9ci5lbnRyeVNpemVzLHA9bnVsbD09aT92b2lkIDA6aS5lbnRyaWVzO3AmJihzPXt9LHAuZm9yRWFjaCgoZnVuY3Rpb24oZSl7c1tlLTFdPSEwfSkpKSxsJiYobz1bXSxsLmZvckVhY2goKGZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLmNvdW50LHI9ZS5vZmZzZXQsYT0wO2E8dDthKyspby5wdXNoKHIpfSkpKTt2YXIgdj0tMSx5PTAsbT0wLGc9MCxrPTAsYj0wLF89ZlswXS5zYW1wbGVzUGVyQ2h1bmssdz1mWzFdP2ZbMV0uZmlyc3RDaHVuay0xOjEvMDtyZXR1cm4gZS5lbnRyaWVzLmZvckVhY2goKGZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLmNvdW50LGE9ZS5kZWx0YSxuPTA7bjx0O24rKyl1PXtkdHM6eSxkdXJhdGlvbjphLHNpemU6aFttXXx8ci5zYW1wbGVTaXplLG9mZnNldDpkW2ddK2IsaW5kZXg6bX0scCYmKHUua2V5ZnJhbWU9c1ttXSx1LmtleWZyYW1lJiZ2KyssdS5nb3BJZD12KSxvJiZtPG8ubGVuZ3RoJiYodS5wdHM9dS5kdHMrb1ttXSksYy5wdXNoKHUpLHkrPWEsKyttPF8/Yis9dS5zaXplOihnKyssYj0wLGc+PXcmJihrKyssdz1mW2srMV0/ZltrKzFdLmZpcnN0Q2h1bmstMToxLzApLF8rPWZba10uc2FtcGxlc1BlckNodW5rKX0pKSxjfWZ1bmN0aW9uIGJlKGUsdCl7cmV0dXJuIGUuZGF0YVJlZmVyZW5jZUluZGV4PSQodCw2KSxlLndpZHRoPSQodCwyNCksZS5oZWlnaHQ9JCh0LDI2KSxlLmhvcml6cmVzb2x1dGlvbj1lZSh0LDI4KSxlLnZlcnRyZXNvbHV0aW9uPWVlKHQsMzIpLGUuZnJhbWVDb3VudD0kKHQsNDApLGUuZGVwdGg9JCh0LDc0KSw3OH1mdW5jdGlvbiBfZShlLHQpe3JldHVybiBlLmRhdGFSZWZlcmVuY2VJbmRleD0kKHQsNiksZS5jaGFubmVsQ291bnQ9JCh0LDE2KSxlLnNhbXBsZVNpemU9JCh0LDE4KSxlLnNhbXBsZVJhdGU9ZWUodCwyNCkvNjU1MzYsMjh9ZnVuY3Rpb24gd2UoZSx0LHIpe2lmKGUpe2lmKGUuc2l6ZSE9PWUuZGF0YS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKCJib3ggIi5jb25jYXQoZS50eXBlLCIgc2l6ZSAhPT0gZGF0YS5sZW5ndGgiKSk7dmFyIGE9e3N0YXJ0OmUuc3RhcnQsc2l6ZTplLnNpemUsaGVhZGVyU2l6ZTplLmhlYWRlclNpemUsdHlwZTplLnR5cGV9O3JldHVybiB0JiYoYS52ZXJzaW9uPWUuZGF0YVtlLmhlYWRlclNpemVdLGEuZmxhZ3M9ZnVuY3Rpb24oZSl7dmFyIHQ9YXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0/YXJndW1lbnRzWzFdOjA7cmV0dXJuKGVbdF08PDE2KSsoZVt0KzFdPDw4KSsoZVt0KzJdfHwwKX0oZS5kYXRhLGUuaGVhZGVyU2l6ZSsxKSxhLmhlYWRlclNpemUrPTQpLHIoYSxlLmRhdGEuc3ViYXJyYXkoYS5oZWFkZXJTaXplKSxhLnN0YXJ0K2EuaGVhZGVyU2l6ZSksYX19dmFyIHhlPWZ1bmN0aW9uKGUsdCxyKXtmb3IodmFyIGE9U3RyaW5nKHIpLG49dD4+MCxpPU1hdGguY2VpbChuL2EubGVuZ3RoKSxzPVtdLG89U3RyaW5nKGUpO2ktLTspcy5wdXNoKGEpO3JldHVybiBzLmpvaW4oIiIpLnN1YnN0cmluZygwLG4tby5sZW5ndGgpK299LFNlPWZ1bmN0aW9uKCl7Zm9yKHZhciBlPVtdLHQ9YXJndW1lbnRzLmxlbmd0aCxyPW5ldyBBcnJheSh0KSxhPTA7YTx0O2ErKylyW2FdPWFyZ3VtZW50c1thXTtyZXR1cm4gci5mb3JFYWNoKChmdW5jdGlvbih0KXtlLnB1c2goeGUoTnVtYmVyKHQpLnRvU3RyaW5nKDE2KSwyLDApKX0pKSxlWzBdfTtmdW5jdGlvbiBBZShlKXtmb3IodmFyIHQ9MCxyPWFyZ3VtZW50cy5sZW5ndGgsYT1uZXcgQXJyYXkocj4xP3ItMTowKSxuPTE7bjxyO24rKylhW24tMV09YXJndW1lbnRzW25dO2EuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dCs9ZS5sZW5ndGh9KSk7dmFyIGk9bmV3IGUodCkscz0wO3JldHVybiBhLmZvckVhY2goKGZ1bmN0aW9uKGUpe2kuc2V0KGUscykscys9ZS5sZW5ndGh9KSksaX12YXIgRGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7cih0aGlzLGUpLHRoaXMuYnVmZmVyPW5ldyBVaW50OEFycmF5KDApfXJldHVybiBuKGUsW3trZXk6IndyaXRlIix2YWx1ZTpmdW5jdGlvbigpe2Zvcih2YXIgZT10aGlzLHQ9YXJndW1lbnRzLmxlbmd0aCxyPW5ldyBBcnJheSh0KSxhPTA7YTx0O2ErKylyW2FdPWFyZ3VtZW50c1thXTtyLmZvckVhY2goKGZ1bmN0aW9uKHQpe3Q/ZS5idWZmZXI9QWUoVWludDhBcnJheSxlLmJ1ZmZlcix0KTp3aW5kb3cuY29uc29sZS53YXJuKHQpfSkpfX1dLFt7a2V5OiJ3cml0ZVVpbnQxNiIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBVaW50OEFycmF5KFtlPj44JjI1NSwyNTUmZV0pfX0se2tleToid3JpdGVVaW50MzIiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBuZXcgVWludDhBcnJheShbZT4+MjQsZT4+MTYmMjU1LGU+PjgmMjU1LDI1NSZlXSl9fV0pLGV9KCksQmU9TWF0aC5wb3coMiwzMiktMSxFZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXtyKHRoaXMsZSl9cmV0dXJuIG4oZSxudWxsLFt7a2V5OiJib3giLHZhbHVlOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1hcmd1bWVudHMubGVuZ3RoLHI9bmV3IEFycmF5KHQ+MT90LTE6MCksYT0xO2E8dDthKyspclthLTFdPWFyZ3VtZW50c1thXTt2YXIgbj04KyhyPXIuZmlsdGVyKEJvb2xlYW4pKS5yZWR1Y2UoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUrdC5ieXRlTGVuZ3RofSksMCksaT1uZXcgVWludDhBcnJheShuKTtpWzBdPW4+PjI0JjI1NSxpWzFdPW4+PjE2JjI1NSxpWzJdPW4+PjgmMjU1LGlbM109MjU1Jm4saS5zZXQoZSw0KTt2YXIgcz04O3JldHVybiByLmZvckVhY2goKGZ1bmN0aW9uKGUpe2kuc2V0KGUscykscys9ZS5ieXRlTGVuZ3RofSkpLGl9fSx7a2V5OiJmdHlwIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gdC5maW5kKChmdW5jdGlvbihlKXtyZXR1cm4gZS50eXBlPT09YiYmZS5jb2RlY1R5cGU9PT1BfSkpP2UuRlRZUEhFVjE6ZS5GVFlQQVZDMX19LHtrZXk6ImluaXRTZWdtZW50Iix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gUShlLmZ0eXAodCksZS5tb292KHQpKX19LHtrZXk6InBzc2giLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPW5ldyBVaW50OEFycmF5KFsxLDAsMCwwXS5jb25jYXQoWzE2LDExOSwyMzksMjM2LDE5MiwxNzgsNzcsMiwxNzIsMjI3LDYwLDMwLDgyLDIyNiwyNTEsNzVdLFswLDAsMCwxXSxuZSh0LmtpZCksWzAsMCwwLDBdKSk7cmV0dXJuIGUuYm94KGUudHlwZXMucHNzaCxyKX19LHtrZXk6Im1vb3YiLHZhbHVlOmZ1bmN0aW9uKHQpe2lmKHRbMF0udXNlRU1FJiYodFswXS5lbmN2fHx0WzBdLmVuY2EpKXt0WzBdLnBzc2h8fCh0WzBdLnBzc2g9e2tpZDp0WzBdLmtpZH0pO3ZhciByPXRoaXMucHNzaCh0WzBdLnBzc2gpO3JldHVybiBlLmJveC5hcHBseShlLFtlLnR5cGVzLm1vb3YsZS5tdmhkKHRbMF0ubXZoZER1cnRpb258fHRbMF0uZHVyYXRpb24sdFswXS5tdmhkVGltZWNhbGV8fHRbMF0udGltZXNjYWxlKSxlLm12ZXgodCldLmNvbmNhdCh5KHQubWFwKChmdW5jdGlvbih0KXtyZXR1cm4gZS50cmFrKHQpfSkpKSxbcl0pKX1yZXR1cm4gZS5ib3guYXBwbHkoZSxbZS50eXBlcy5tb292LGUubXZoZCh0WzBdLm12aGREdXJ0aW9ufHx0WzBdLmR1cmF0aW9uLHRbMF0ubXZoZFRpbWVjYWxlfHx0WzBdLnRpbWVzY2FsZSldLmNvbmNhdCh5KHQubWFwKChmdW5jdGlvbih0KXtyZXR1cm4gZS50cmFrKHQpfSkpKSxbZS5tdmV4KHQpXSkpfX0se2tleToibXZoZCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9YXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0/YXJndW1lbnRzWzFdOjllNCxhPWUuYm94KGUudHlwZXMubXZoZCxuZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAscj4+MjQmMjU1LHI+PjE2JjI1NSxyPj44JjI1NSwyNTUmcix0Pj4yNCYyNTUsdD4+MTYmMjU1LHQ+PjgmMjU1LDI1NSZ0LDAsMSwwLDAsMSwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwxLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDEsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDY0LDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDI1NSwyNTUsMjU1LDI1NV0pKTtyZXR1cm4gYX19LHtrZXk6InRyYWsiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBlLmJveChlLnR5cGVzLnRyYWssZS50a2hkKHQuaWQsdC50a2hkRHVyYXRpb258fDAsdC53aWR0aCx0LmhlaWdodCksZS5tZGlhKHQpKX19LHtrZXk6InRraGQiLHZhbHVlOmZ1bmN0aW9uKHQscil7dmFyIGE9YXJndW1lbnRzLmxlbmd0aD4yJiZ2b2lkIDAhPT1hcmd1bWVudHNbMl0/YXJndW1lbnRzWzJdOjAsbj1hcmd1bWVudHMubGVuZ3RoPjMmJnZvaWQgMCE9PWFyZ3VtZW50c1szXT9hcmd1bWVudHNbM106MCxpPWUuYm94KGUudHlwZXMudGtoZCxuZXcgVWludDhBcnJheShbMCwwLDAsNywwLDAsMCwwLDAsMCwwLDAsdD4+MjQmMjU1LHQ+PjE2JjI1NSx0Pj44JjI1NSwyNTUmdCwwLDAsMCwwLHI+PjI0JjI1NSxyPj4xNiYyNTUscj4+OCYyNTUsMjU1JnIsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMSwwLDAsMCwwLDEsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMSwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsNjQsMCwwLDAsYT4+OCYyNTUsMjU1JmEsMCwwLG4+PjgmMjU1LDI1NSZuLDAsMF0pKTtyZXR1cm4gaX19LHtrZXk6Im1kaWEiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBlLmJveChlLnR5cGVzLm1kaWEsZS5tZGhkKHQuZHVyYXRpb24sdC50aW1lc2NhbGUpLGUuaGRscih0LnR5cGUpLGUubWluZih0KSl9fSx7a2V5OiJtZGhkIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06OWU0LGE9ZS5ib3goZS50eXBlcy5tZGhkLG5ldyBVaW50OEFycmF5KFswLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCxyPj4yNCYyNTUscj4+MTYmMjU1LHI+PjgmMjU1LDI1NSZyLHQ+PjI0JjI1NSx0Pj4xNiYyNTUsdD4+OCYyNTUsMjU1JnQsODUsMTk2LDAsMF0pKTtyZXR1cm4gYX19LHtrZXk6ImhkbHIiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBlLmJveChlLnR5cGVzLmhkbHIsZS5IRExSX1RZUEVTW3RdKX19LHtrZXk6Im1pbmYiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBlLmJveChlLnR5cGVzLm1pbmYsdC50eXBlPT09Yj9lLlZNSEQ6ZS5TTUhELGUuRElORixlLnN0YmwodCkpfX0se2tleToic3RibCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9W107cmV0dXJuIHQmJnQuZXh0JiZ0LmV4dC5zdHNzJiZyLnB1c2goZS5zdHNzKHQuZXh0LnN0c3MuZW50cmllcykpLGUuYm94KGUudHlwZXMuc3RibCxlLnN0c2QodCksZS5TVFRTLHJbMF0sZS5TVFNDLGUuU1RTWixlLlNUQ08pfX0se2tleToic3RzZCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI7cmV0dXJuIHI9ImF1ZGlvIj09PXQudHlwZT90LnVzZUVNRSYmdC5lbmNhP2UuZW5jYSh0KTplLm1wNGEodCk6dC51c2VFTUUmJnQuZW5jdj9lLmVuY3YodCk6dC5hdjFDP2UuYXYwMSh0KTplLmF2YzFoZXYxKHQpLGUuYm94KGUudHlwZXMuc3RzZCxuZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwxXSkscil9fSx7a2V5OiJlbmNhIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj10LmVuY2EuY2hhbm5lbENvdW50LGE9dC5lbmNhLnNhbXBsZVJhdGUsbj1uZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwxLDAsMCwwLDAsMCwwLDAsMCwwLHIsMCwxNiwwLDAsMCwwLGE+PjgmMjU1LDI1NSZhLDAsMF0pLGk9ZS5lc2RzKHQuY29uZmlnKSxzPWUuc2luZih0LmVuY2EpO3JldHVybiBlLmJveChlLnR5cGVzLmVuY2EsbixpLHMpfX0se2tleToiZW5jdiIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHIsYSxuPXQuc3BzLmxlbmd0aD4wP3Quc3BzWzBdOltdLGk9dC5wcHMubGVuZ3RoPjA/dC5wcHNbMF06W10scz10LndpZHRoLG89dC5oZWlnaHQsdT10LnNhclJhdGlvWzBdLGM9dC5zYXJSYXRpb1sxXSxsPW5ldyBVaW50OEFycmF5KFswLDAsMCwwLDAsMCwwLDEsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCxzPj44JjI1NSwyNTUmcyxvPj44JjI1NSwyNTUmbywwLDcyLDAsMCwwLDcyLDAsMCwwLDAsMCwwLDAsMSwxOCwxMDAsOTcsMTA1LDEwOCwxMjEsMTA5LDExMSwxMTYsMTA1LDExMSwxMTAsNDcsMTA0LDEwOCwxMTUsNDYsMTA2LDExNSwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMjQsMTcsMTddKSxmPW5ldyBVaW50OEFycmF5KChyPShhPVsxLG5bMV0sblsyXSxuWzNdLDI1NSwyMjUsbi5sZW5ndGg+Pj44JjI1NSwyNTUmbi5sZW5ndGhdKS5jb25jYXQuYXBwbHkoYSx5KG4pKS5jb25jYXQoWzEsaS5sZW5ndGg+Pj44JjI1NSwyNTUmaS5sZW5ndGhdKSkuY29uY2F0LmFwcGx5KHIseShpKSkpLGQ9bmV3IFVpbnQ4QXJyYXkoWzAsMCw4OCw1NywwLDE1LDIwMCwxOTIsMCw0LDg2LDcyXSksaD1lLnNpbmYodC5lbmN2KSxwPW5ldyBVaW50OEFycmF5KFt1Pj4yNCx1Pj4xNiYyNTUsdT4+OCYyNTUsMjU1JnUsYz4+MjQsYz4+MTYmMjU1LGM+PjgmMjU1LDI1NSZjXSk7cmV0dXJuIGUuYm94KGUudHlwZXMuZW5jdixsLGUuYm94KGUudHlwZXMuYXZjQyxmKSxlLmJveChlLnR5cGVzLmJ0cnQsZCksaCxlLmJveChlLnR5cGVzLnBhc3AscCkpfX0se2tleToic2NoaSIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9bmV3IFVpbnQ4QXJyYXkoW10pLGE9ZS50ZW5jKHQpO3JldHVybiBlLmJveChlLnR5cGVzLnNjaGkscixhKX19LHtrZXk6InRlbmMiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPW5ldyBVaW50OEFycmF5KFswLDAsMCwwLDAsMCwyNTUmdC5kZWZhdWx0X0lzRW5jcnlwdGVkLDI1NSZ0LmRlZmF1bHRfSVZfc2l6ZV0uY29uY2F0KG5lKHQuZGVmYXVsdF9LSUQpKSk7cmV0dXJuIGUuYm94KGUudHlwZXMudGVuYyxyKX19LHtrZXk6InNpbmYiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPW5ldyBVaW50OEFycmF5KFtdKSxhPW5ldyBVaW50OEFycmF5KFt0LmRhdGFfZm9ybWF0LmNoYXJDb2RlQXQoMCksdC5kYXRhX2Zvcm1hdC5jaGFyQ29kZUF0KDEpLHQuZGF0YV9mb3JtYXQuY2hhckNvZGVBdCgyKSx0LmRhdGFfZm9ybWF0LmNoYXJDb2RlQXQoMyldKSxuPW5ldyBVaW50OEFycmF5KFswLDAsMCwwLDk5LDEwMSwxMTAsOTksMCwxLDAsMF0pLGk9ZS5zY2hpKHQpO3JldHVybiBlLmJveChlLnR5cGVzLnNpbmYscixlLmJveChlLnR5cGVzLmZybWEsYSksZS5ib3goZS50eXBlcy5zY2htLG4pLGkpfX0se2tleToiYXYwMSIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94KGUudHlwZXMuYXYwMSxuZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwxLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsdC53aWR0aD4+OCYyNTUsMjU1JnQud2lkdGgsdC5oZWlnaHQ+PjgmMjU1LDI1NSZ0LmhlaWdodCwwLDcyLDAsMCwwLDcyLDAsMCwwLDAsMCwwLDAsMSwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwyNCwxNywxN10pLHQuYXYxQyx0LmNvbHIpfX0se2tleToiYXZjMWhldjEiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPXQuY29kZWNUeXBlPT09QSxhPXI/ZS50eXBlcy5odmMxOmUudHlwZXMuYXZjMSxuPXI/ZS5odmNDKHQpOmUuYXZjQyh0KSxpPVtuZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwxLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsdC53aWR0aD4+OCYyNTUsMjU1JnQud2lkdGgsdC5oZWlnaHQ+PjgmMjU1LDI1NSZ0LmhlaWdodCwwLDcyLDAsMCwwLDcyLDAsMCwwLDAsMCwwLDAsMSwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwyNCwxNywxN10pLG5dO3JldHVybiByP2kucHVzaChlLmJveChlLnR5cGVzLmZpZWwsbmV3IFVpbnQ4QXJyYXkoWzEsMF0pKSk6dC5zYXJSYXRpbyYmdC5zYXJSYXRpby5sZW5ndGg+MSYmaS5wdXNoKGUucGFzcCh0LnNhclJhdGlvKSksZS5ib3guYXBwbHkoZSxbYV0uY29uY2F0KGkpKX19LHtrZXk6ImF2Y0MiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByLGEsbixpPVtdLHM9W107cmV0dXJuIHQuc3BzLmZvckVhY2goKGZ1bmN0aW9uKGUpe249ZS5ieXRlTGVuZ3RoLGkucHVzaChuPj4+OCYyNTUpLGkucHVzaCgyNTUmbiksaS5wdXNoLmFwcGx5KGkseShlKSl9KSksdC5wcHMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7bj1lLmJ5dGVMZW5ndGgscy5wdXNoKG4+Pj44JjI1NSkscy5wdXNoKDI1NSZuKSxzLnB1c2guYXBwbHkocyx5KGUpKX0pKSxlLmJveChlLnR5cGVzLmF2Y0MsbmV3IFVpbnQ4QXJyYXkoKHI9KGE9WzEsaVszXSxpWzRdLGlbNV0sMjU1LDIyNHx0LnNwcy5sZW5ndGhdKS5jb25jYXQuYXBwbHkoYSxpKS5jb25jYXQoW3QucHBzLmxlbmd0aF0pKS5jb25jYXQuYXBwbHkocixzKSkpfX0se2tleToiaHZjQyIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9dC5odmNDO2lmKHIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcnx8ciBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpcmV0dXJuIHI7dmFyIGEsbj10LnZwcyxpPXQuc3BzLHM9dC5wcHM7aWYocil7dmFyIG89ci5nZW5lcmFsUHJvZmlsZUNvbXBhdGliaWxpdHlGbGFncyx1PXIuZ2VuZXJhbENvbnN0cmFpbnRJbmRpY2F0b3JGbGFncyxjPShuLmxlbmd0aCYmMSkrKGkubGVuZ3RoJiYxKSsocy5sZW5ndGgmJjEpO2E9WzEsci5nZW5lcmFsUHJvZmlsZVNwYWNlPDw2fHIuZ2VuZXJhbFRpZXJGbGFnPDw1fHIuZ2VuZXJhbFByb2ZpbGVJZGMsbz4+PjI0LG8+Pj4xNixvPj4+OCxvLHVbMF0sdVsxXSx1WzJdLHVbM10sdVs0XSx1WzVdLHIuZ2VuZXJhbExldmVsSWRjLDI0MCwwLDI1MiwyNTJ8ci5jaHJvbWFGb3JtYXRJZGMsMjQ4fHIuYml0RGVwdGhMdW1hTWludXM4LDI0OHxyLmJpdERlcHRoQ2hyb21hTWludXM4LDAsMCxyLm51bVRlbXBvcmFsTGF5ZXJzPDwzfHIudGVtcG9yYWxJZE5lc3RlZDw8MnwzLGNdO3ZhciBsPWZ1bmN0aW9uKGUpe3ZhciB0O2EucHVzaChlLmxlbmd0aD4+OCxlLmxlbmd0aCksKHQ9YSkucHVzaC5hcHBseSh0LHkoZSkpfTtuLmxlbmd0aCYmKGEucHVzaCgxNjAsMCxuLmxlbmd0aCksbi5mb3JFYWNoKGwpKSxpLmxlbmd0aCYmKGEucHVzaCgxNjEsMCxpLmxlbmd0aCksaS5mb3JFYWNoKGwpKSxzLmxlbmd0aCYmKGEucHVzaCgxNjIsMCxzLmxlbmd0aCkscy5mb3JFYWNoKGwpKX1lbHNlIGE9WzEsMSw5NiwwLDAsMCwxNDQsMCwwLDAsMCwwLDkzLDI0MCwwLDI1MiwyNTMsMjQ4LDI0OCwwLDAsMTUsMywxNjAsMCwxLDAsMjQsNjQsMSwxMiwxLDI1NSwyNTUsMSw5NiwwLDAsMywwLDE0NCwwLDAsMywwLDAsMywwLDkzLDE1MywxNTIsOSwxNjEsMCwxLDAsNDUsNjYsMSwxLDEsOTYsMCwwLDMsMCwxNDQsMCwwLDMsMCwwLDMsMCw5MywxNjAsMiwxMjgsMTI4LDQ1LDIyLDg5LDE1MywxNjQsMTQ3LDQzLDE1NCwxMjgsMTI4LDEyOCwxMzAsMCwwLDMsMCwyLDAsMCwzLDAsNTAsMTYsMTYyLDAsMSwwLDcsNjgsMSwxOTMsMTE0LDE4MCw5OCw2NF07cmV0dXJuIGUuYm94KGUudHlwZXMuaHZjQyxuZXcgVWludDhBcnJheShhKSl9fSx7a2V5OiJwYXNwIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj12KHQsMiksYT1yWzBdLG49clsxXTtyZXR1cm4gZS5ib3goZS50eXBlcy5wYXNwLG5ldyBVaW50OEFycmF5KFthPj4yNCxhPj4xNiYyNTUsYT4+OCYyNTUsMjU1JmEsbj4+MjQsbj4+MTYmMjU1LG4+PjgmMjU1LDI1NSZuXSkpfX0se2tleToibXA0YSIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94KGUudHlwZXMubXA0YSxuZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwxLDAsMCwwLDAsMCwwLDAsMCwwLHQuY2hhbm5lbENvdW50LDAsMTYsMCwwLDAsMCx0LnNhbXBsZVJhdGU+PjgmMjU1LDI1NSZ0LnNhbXBsZVJhdGUsMCwwXSksdC5jb25maWcubGVuZ3RoP2UuZXNkcyh0LmNvbmZpZyk6dm9pZCAwKX19LHtrZXk6ImVzZHMiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPXQubGVuZ3RoO3JldHVybiBlLmJveChlLnR5cGVzLmVzZHMsbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMywyMytyLDAsMCwwLDQsMTUrciw2NCwyMSwwLDYsMCwwLDAsMjE4LDE5MiwwLDAsMjE4LDE5Miw1XS5jb25jYXQoW3JdKS5jb25jYXQodCkuY29uY2F0KFs2LDEsMl0pKSl9fSx7a2V5OiJtdmV4Iix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5ib3guYXBwbHkoZSxbZS50eXBlcy5tdmV4XS5jb25jYXQoeSh0Lm1hcCgoZnVuY3Rpb24odCl7cmV0dXJuIGUudHJleCh0LmlkKX0pKSkpKX19LHtrZXk6InRyZXgiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBlLmJveChlLnR5cGVzLnRyZXgsbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsdD4+MjQsdD4+MTYmMjU1LHQ+PjgmMjU1LDI1NSZ0LDAsMCwwLDEsMCwwLDAsMCwwLDAsMCwwLDAsMSwwLDFdKSl9fSx7a2V5OiJ0cmV4MSIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94KGUudHlwZXMudHJleCxuZXcgVWludDhBcnJheShbMCwwLDAsMCx0Pj4yNCx0Pj4xNiYyNTUsdD4+OCYyNTUsMjU1JnQsMCwwLDAsMSwwLDAsMiwwLDAsMCwwLDAsMCwxLDAsMF0pKX19LHtrZXk6InRyZXgyIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5ib3goZS50eXBlcy50cmV4LG5ldyBVaW50OEFycmF5KFswLDAsMCwwLHQ+PjI0LHQ+PjE2JjI1NSx0Pj44JjI1NSwyNTUmdCwwLDAsMCwxLDAsMCw0LDAsMCwwLDAsMCwyLDAsMCwwXSkpfX0se2tleToibW9vZiIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94LmFwcGx5KGUsW2UudHlwZXMubW9vZixlLm1maGQodFswXS5zYW1wbGVzP3RbMF0uc2FtcGxlc1swXS5nb3BJZDowKV0uY29uY2F0KHkodC5tYXAoKGZ1bmN0aW9uKHQpe3JldHVybiBlLnRyYWYodCl9KSkpKSl9fSx7a2V5OiJtZmhkIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5ib3goZS50eXBlcy5tZmhkLG5ldyBVaW50OEFycmF5KFswLDAsMCwwLHQ+PjI0LHQ+PjE2JjI1NSx0Pj44JjI1NSwyNTUmdF0pKX19LHtrZXk6InRyYWYiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPWUudGZoZCh0LmlkKSxhPWUudGZkdCh0LHQuYmFzZU1lZGlhRGVjb2RlVGltZSksbj0wO2lmKHQuaXNWaWRlbyYmdC52aWRlb1NlbmMmJnQudmlkZW9TZW5jLmZvckVhY2goKGZ1bmN0aW9uKGUpe24rPTgsZS5zdWJzYW1wbGVzJiZlLnN1YnNhbXBsZXMubGVuZ3RoJiYobis9MixuKz02KmUuc3Vic2FtcGxlcy5sZW5ndGgpfSkpLHQudmlkZW9TZW5jTGVuZ3RoPW4sdC51c2VFTUUmJih0LmlzVmlkZW9FbmNyeXB0aW9ufHx0LmlzQXVkaW9FbmNyeXB0aW9uKSl7aWYodC5pc1ZpZGVvRW5jcnlwdGlvbil7aWYodC5pc1ZpZGVvKXt2YXIgaT1lLnNhaXoodCkscz1lLnNhaW8odCksbz1lLnRydW4xKHQpLHU9ZS5zZW5jKHQpO3JldHVybiBlLmJveChlLnR5cGVzLnRyYWYscixhLGkscyxvLHUpfWlmKHQuaXNBdWRpb0VuY3J5cHRpb24pe3ZhciBjPWUuc2JncCgpLGw9ZS5zYWl6KHQpLGY9ZS5zYWlvKHQpLGQ9ZS5zZW5jKHQpLGg9ZS50cnVuMSh0KTtyZXR1cm4gZS5ib3goZS50eXBlcy50cmFmLHIsYSxjLGwsZixkLGgpfXZhciBwPWUuc2JncCgpLHY9ZS50cnVuMSh0KTtyZXR1cm4gZS5ib3goZS50eXBlcy50cmFmLHIsYSxwLHYpfWlmKHQuaXNWaWRlbyl7dmFyIHk9ZS50cnVuMSh0KTtyZXR1cm4gZS5ib3goZS50eXBlcy50cmFmLHIsYSx5KX12YXIgbT1lLnNiZ3AoKSxnPWUuc2Fpeih0KSxrPWUuc2Fpbyh0KSxiPWUuc2VuYyh0KSxfPWUudHJ1bjEodCk7cmV0dXJuIGUuYm94KGUudHlwZXMudHJhZixyLGEsbSxnLGssYixfKX12YXIgdz1lLnNkdHAodCk7cmV0dXJuIGUuYm94KGUudHlwZXMudHJhZixyLGEsdyxlLnRydW4odC5zYW1wbGVzLHcuYnl0ZUxlbmd0aCs3NikpfX0se2tleToic2R0cCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9bmV3IERlO3JldHVybiB0LnNhbXBsZXMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ci53cml0ZShuZXcgVWludDhBcnJheSh0LmlzVmlkZW8/W2Uua2V5ZnJhbWU/MzI6MTZdOlsxNl0pKX0pKSxlLmJveChlLnR5cGVzLnNkdHAsdGhpcy5leHRlbnNpb24oMCwwKSxyLmJ1ZmZlcil9fSx7a2V5OiJ0cnVuMSIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9bmV3IERlLGE9RGUud3JpdGVVaW50MzIodC5zYW1wbGVzLmxlbmd0aCksbj1udWxsO2lmKHQuaXNWaWRlbyl7dmFyIGk9dC52aWRlb1NlbmNMZW5ndGg7bj1EZS53cml0ZVVpbnQzMigxNip0LnNhbXBsZXMubGVuZ3RoK2krMTQ5KSwhdC5pc1ZpZGVvRW5jcnlwdGlvbiYmdC5pc0F1ZGlvRW5jcnlwdGlvbiYmKG49RGUud3JpdGVVaW50MzIoMTYqdC5zYW1wbGVzLmxlbmd0aCs5MikpfWVsc2V7dmFyIHM9MTIqdC5zYW1wbGVzLmxlbmd0aCsxMjQ7dC5pc0F1ZGlvRW5jcnlwdGlvbiYmKHM9MTIqdC5zYW1wbGVzLmxlbmd0aCs4KnQuYXVkaW9TZW5jLmxlbmd0aCsxNzcpLG49RGUud3JpdGVVaW50MzIocyl9cmV0dXJuIHQuc2FtcGxlcy5mb3JFYWNoKChmdW5jdGlvbihlKXtyLndyaXRlKERlLndyaXRlVWludDMyKGUuZHVyYXRpb24pKSxyLndyaXRlKERlLndyaXRlVWludDMyKGUuc2l6ZSkpLHIud3JpdGUoRGUud3JpdGVVaW50MzIoZS5rZXlmcmFtZT8zMzU1NDQzMjo2NTUzNikpLHQuaXNWaWRlbyYmci53cml0ZShEZS53cml0ZVVpbnQzMihlLmN0cz9lLmN0czowKSl9KSksZS5ib3goZS50eXBlcy50cnVuLHRoaXMuZXh0ZW5zaW9uKDAsdC5mbGFncyksYSxuLHIuYnVmZmVyKX19LHtrZXk6InNlbmMiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPW5ldyBEZSxhPXQuc2FtcGxlcy5sZW5ndGgsbj10LmlzVmlkZW8/MTY6OCxpPXQuaXNWaWRlbz8yOjAscz1bXSxvPTA7cmV0dXJuIHQuaXNWaWRlbz8ocz10LnZpZGVvU2VuYyxvPXQudmlkZW9TZW5jTGVuZ3RoKTpzPXQuYXVkaW9TZW5jLG89b3x8biphLHIud3JpdGUoRGUud3JpdGVVaW50MzIoMTYrbyksZS50eXBlcy5zZW5jLHRoaXMuZXh0ZW5zaW9uKDAsaSkpLHIud3JpdGUoRGUud3JpdGVVaW50MzIoYSkpLHMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTA7dDxlLkluaXRpYWxpemF0aW9uVmVjdG9yLmxlbmd0aDt0Kyspci53cml0ZShuZXcgVWludDhBcnJheShbZS5Jbml0aWFsaXphdGlvblZlY3Rvclt0XV0pKTtlLnN1YnNhbXBsZXMmJmUuc3Vic2FtcGxlcy5sZW5ndGgmJihyLndyaXRlKERlLndyaXRlVWludDE2KGUuc3Vic2FtcGxlcy5sZW5ndGgpKSxlLnN1YnNhbXBsZXMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ci53cml0ZShEZS53cml0ZVVpbnQxNihlLkJ5dGVzT2ZDbGVhckRhdGEpKSxyLndyaXRlKERlLndyaXRlVWludDMyKGUuQnl0ZXNPZlByb3RlY3RlZERhdGEpKX0pKSl9KSksci5idWZmZXJ9fSx7a2V5OiJzYWlvIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj0xMip0LnNhbXBsZXMubGVuZ3RoKzE0MTshdC5pc1ZpZGVvJiZ0LmlzQXVkaW9FbmNyeXB0aW9uJiYocj0xNDkpO3ZhciBhPW5ldyBVaW50OEFycmF5KFsxLDAsMCwwLDAsMCwwLDEsMCwwLDAsMCxyPj4yNCYyNTUscj4+MTYmMjU1LHI+PjgmMjU1LDI1NSZyXSk7cmV0dXJuIGUuYm94KGUudHlwZXMuc2FpbyxhKX19LHtrZXk6InNhaXoiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPXQuc2FtcGxlcy5sZW5ndGgsYT1uZXcgVWludDhBcnJheShbMCwwLDAsMCwxNixyPj4yNCYyNTUscj4+MTYmMjU1LHI+PjgmMjU1LDI1NSZyXSk7cmV0dXJuIGUuYm94KGUudHlwZXMuc2FpeixhKX19LHtrZXk6InNiZ3AiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIHQ9bmV3IFVpbnQ4QXJyYXkoWzExNCwxMTEsMTA4LDEwOCwwLDAsMCwxLDAsMCwxLDI1LDAsMCwwLDFdKTtyZXR1cm4gZS5ib3goZS50eXBlcy5zYmdwLHRoaXMuZXh0ZW5zaW9uKDAsMCksdCl9fSx7a2V5OiJleHRlbnNpb24iLHZhbHVlOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIG5ldyBVaW50OEFycmF5KFtlLHQ+PjE2JjI1NSx0Pj44JjI1NSwyNTUmdF0pfX0se2tleToidGZoZCIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94KGUudHlwZXMudGZoZCxuZXcgVWludDhBcnJheShbMCwwLDAsMCx0Pj4yNCx0Pj4xNiYyNTUsdD4+OCYyNTUsMjU1JnRdKSl9fSx7a2V5OiJ0ZmR0Iix2YWx1ZTpmdW5jdGlvbih0LHIpe3ZhciBhPU1hdGguZmxvb3Ioci8oQmUrMSkpLG49TWF0aC5mbG9vcihyJShCZSsxKSk7cmV0dXJuIHQudXNlRU1FJiYodC5pc1ZpZGVvRW5jcnlwdGlvbnx8dC5pc0F1ZGlvRW5jcnlwdGlvbik/ZS5ib3goZS50eXBlcy50ZmR0LG5ldyBVaW50OEFycmF5KFswLDAsMCwwLG4+PjI0LG4+PjE2JjI1NSxuPj44JjI1NSwyNTUmbl0pKTplLmJveChlLnR5cGVzLnRmZHQsbmV3IFVpbnQ4QXJyYXkoWzEsMCwwLDAsYT4+MjQsYT4+MTYmMjU1LGE+PjgmMjU1LDI1NSZhLG4+PjI0LG4+PjE2JjI1NSxuPj44JjI1NSwyNTUmbl0pKX19LHtrZXk6InRydW4iLHZhbHVlOmZ1bmN0aW9uKHQscil7dmFyIGE9dC5sZW5ndGgsbj0xMisxNiphO3IrPTgrbjt2YXIgaT1uZXcgVWludDhBcnJheShuKTtpLnNldChbMCwwLDE1LDEsYT4+PjI0JjI1NSxhPj4+MTYmMjU1LGE+Pj44JjI1NSwyNTUmYSxyPj4+MjQmMjU1LHI+Pj4xNiYyNTUscj4+PjgmMjU1LDI1NSZyXSwwKTtmb3IodmFyIHM9MDtzPGE7cysrKXt2YXIgbz10W3NdLHU9by5kdXJhdGlvbixjPW8uc2l6ZSxsPW8uZmxhZyxmPXZvaWQgMD09PWw/e306bCxkPW8uY3RzLGg9dm9pZCAwPT09ZD8wOmQ7aS5zZXQoW3U+Pj4yNCYyNTUsdT4+PjE2JjI1NSx1Pj4+OCYyNTUsMjU1JnUsYz4+PjI0JjI1NSxjPj4+MTYmMjU1LGM+Pj44JjI1NSwyNTUmYyxmLmlzTGVhZGluZzw8MnwobnVsbD09PWYuZGVwZW5kc09ufHx2b2lkIDA9PT1mLmRlcGVuZHNPbj8xOmYuZGVwZW5kc09uKSxmLmlzRGVwZW5kZWRPbjw8NnxmLmhhc1JlZHVuZGFuY3k8PDR8Zi5wYWRkaW5nVmFsdWU8PDF8KG51bGw9PT1mLmlzTm9uU3luY1NhbXBsZXx8dm9pZCAwPT09Zi5pc05vblN5bmNTYW1wbGU/MTpmLmlzTm9uU3luY1NhbXBsZSksNjE0NDAmZi5kZWdyYWRhdGlvblByaW9yaXR5LDE1JmYuZGVncmFkYXRpb25Qcmlvcml0eSxoPj4+MjQmMjU1LGg+Pj4xNiYyNTUsaD4+PjgmMjU1LDI1NSZoXSwxMisxNipzKX1yZXR1cm4gZS5ib3goZS50eXBlcy50cnVuLGkpfX0se2tleToibW9vdk1QNCIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94LmFwcGx5KGUsW2UudHlwZXMubW9vdixlLm12aGQodFswXS5kdXJhdGlvbix0WzBdLnRpbWVzY2FsZSldLmNvbmNhdCh5KHQubWFwKChmdW5jdGlvbih0KXtyZXR1cm4gZS50cmFja01QNCh0KX0pKSkpKX19LHtrZXk6InRyYWNrTVA0Iix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5ib3goZS50eXBlcy50cmFrLGUudGtoZCh0LmlkLHQuZHVyYXRpb24sdC53aWR0aCx0LmhlaWdodCksZS5tZGlhTVA0KHQpKX19LHtrZXk6Im1kaWFNUDQiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBlLmJveChlLnR5cGVzLm1kaWEsZS5tZGhkKHQuZHVyYXRpb24sdC50aW1lc2NhbGUpLGUuaGRscih0LnR5cGUpLGUubWluZk1QNCh0KSl9fSx7a2V5OiJtaW5mTVA0Iix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5ib3goZS50eXBlcy5taW5mLHQudHlwZT09PWI/ZS5WTUhEOmUuU01IRCxlLkRJTkYsZS5zdGJsTVA0KHQpKX19LHtrZXk6InN0YmxNUDQiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPXQuZXh0LGE9W2Uuc3RzZCh0KSxlLnN0dHMoci5zdHRzKSxlLnN0c2Moci5zdHNjKSxlLnN0c3ooci5zdHN6KSxlLnN0Y28oci5zdGNvKV07cmV0dXJuIHIuc3Rzcy5sZW5ndGgmJmEucHVzaChlLnN0c3Moci5zdHNzKSksci5jdHRzLmxlbmd0aCYmYS5wdXNoKGUuY3R0cyhyLmN0dHMpKSxlLmJveC5hcHBseShlLFtlLnR5cGVzLnN0YmxdLmNvbmNhdChhKSl9fSx7a2V5OiJzdHRzIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj10Lmxlbmd0aCxhPW5ldyBVaW50OEFycmF5KDgqciksbj0wO3JldHVybiB0LmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0PWUudmFsdWUscj1lLmNvdW50O2Euc2V0KFtyPj4yNCxyPj4xNiYyNTUscj4+OCYyNTUsMjU1JnIsdD4+MjQsdD4+MTYmMjU1LHQ+PjgmMjU1LDI1NSZ0XSxuKSxuKz04fSkpLGUuYm94KGUudHlwZXMuc3R0cyxRKG5ldyBVaW50OEFycmF5KFswLDAsMCwwLHI+PjI0LHI+PjE2JjI1NSxyPj44JjI1NSwyNTUmcl0pLGEpKX19LHtrZXk6InN0c2MiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPXQubGVuZ3RoLGE9bmV3IFVpbnQ4QXJyYXkoMTIqciksbj0wO3JldHVybiB0LmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0PWUuZmlyc3RDaHVuayxyPWUuc2FtcGxlc1BlckNodW5rLGk9ZS5zYW1wbGVEZXNjSW5kZXg7YS5zZXQoW3Q+PjI0LHQ+PjE2JjI1NSx0Pj44JjI1NSwyNTUmdCxyPj4yNCxyPj4xNiYyNTUscj4+OCYyNTUsMjU1JnIsaT4+MjQsaT4+MTYmMjU1LGk+PjgmMjU1LDI1NSZpXSxuKSxuKz0xMn0pKSxlLmJveChlLnR5cGVzLnN0c2MsUShuZXcgVWludDhBcnJheShbMCwwLDAsMCxyPj4yNCxyPj4xNiYyNTUscj4+OCYyNTUsMjU1JnJdKSxhKSl9fSx7a2V5OiJzdHN6Iix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj10Lmxlbmd0aCxhPW5ldyBVaW50OEFycmF5KDQqciksbj0wO3JldHVybiB0LmZvckVhY2goKGZ1bmN0aW9uKGUpe2Euc2V0KFtlPj4yNCxlPj4xNiYyNTUsZT4+OCYyNTUsMjU1JmVdLG4pLG4rPTR9KSksZS5ib3goZS50eXBlcy5zdHN6LFEobmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMCxyPj4yNCxyPj4xNiYyNTUscj4+OCYyNTUsMjU1JnJdKSxhKSl9fSx7a2V5OiJzdGNvIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj10Lmxlbmd0aCxhPW5ldyBVaW50OEFycmF5KDQqciksbj0wO3JldHVybiB0LmZvckVhY2goKGZ1bmN0aW9uKGUpe2Euc2V0KFtlPj4yNCxlPj4xNiYyNTUsZT4+OCYyNTUsMjU1JmVdLG4pLG4rPTR9KSksZS5ib3goZS50eXBlcy5zdGNvLFEobmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAscj4+MjQscj4+MTYmMjU1LHI+PjgmMjU1LDI1NSZyXSksYSkpfX0se2tleToic3RzcyIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9dC5sZW5ndGgsYT1uZXcgVWludDhBcnJheSg0KnIpLG49MDtyZXR1cm4gdC5mb3JFYWNoKChmdW5jdGlvbihlKXthLnNldChbZT4+MjQsZT4+MTYmMjU1LGU+PjgmMjU1LDI1NSZlXSxuKSxuKz00fSkpLGUuYm94KGUudHlwZXMuc3RzcyxRKG5ldyBVaW50OEFycmF5KFswLDAsMCwwLHI+PjI0LHI+PjE2JjI1NSxyPj44JjI1NSwyNTUmcl0pLGEpKX19LHtrZXk6ImN0dHMiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPXQubGVuZ3RoLGE9bmV3IFVpbnQ4QXJyYXkoOCpyKSxuPTA7cmV0dXJuIHQuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIHQ9ZS52YWx1ZSxyPWUuY291bnQ7YS5zZXQoW3I+PjI0LHI+PjE2JjI1NSxyPj44JjI1NSwyNTUmcix0Pj4yNCx0Pj4xNiYyNTUsdD4+OCYyNTUsMjU1JnRdLG4pLG4rPTh9KSksZS5ib3goZS50eXBlcy5jdHRzLFEobmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAscj4+MjQscj4+MTYmMjU1LHI+PjgmMjU1LDI1NSZyXSksYSkpfX0se2tleToic3R5cCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gZS5ib3goZS50eXBlcy5zdHlwLG5ldyBVaW50OEFycmF5KFsxMDksMTE1LDEwMCwxMDQsMCwwLDAsMCwxMDksMTE1LDEwMCwxMDQsMTA5LDExNSwxMDUsMTIwXSkpfX0se2tleToic2lkeCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9dC50aW1lc2NhbGUsYT10LnNhbXBsZXNbMF0uZHVyYXRpb24sbj1hKnQuc2FtcGxlcy5sZW5ndGgsaT10LnNhbXBsZXNbMF0uc2FtcGxlT2Zmc2V0KmEscz04O3Quc2FtcGxlcy5mb3JFYWNoKChmdW5jdGlvbihlKXtzKz1lLnNpemV9KSk7dmFyIG89MDtpZih0LmlzVmlkZW8pe3ZhciB1LGM9MDt0LnZpZGVvU2VuYyYmKHU9dC52aWRlb1NlbmMpLHQuaXNWaWRlbyYmdS5mb3JFYWNoKChmdW5jdGlvbihlKXtjKz04LGUuc3Vic2FtcGxlcyYmZS5zdWJzYW1wbGVzLmxlbmd0aCYmKGMrPTIsYys9NiplLnN1YnNhbXBsZXMubGVuZ3RoKX0pKSx0LnZpZGVvU2VuY0xlbmd0aD1jLG89cysxNDErMTYqdC5zYW1wbGVzLmxlbmd0aCtjLHQudXNlRU1FJiZ0LmlzQXVkaW9FbmNyeXB0aW9uJiYhdC5pc1ZpZGVvRW5jcnlwdGlvbiYmKG89cysxNip0LnNhbXBsZXMubGVuZ3RoKzg0KX1lbHNlIG89cysxMTYrMTIqdC5zYW1wbGVzLmxlbmd0aCx0LnVzZUVNRSYmdC5pc0F1ZGlvRW5jcnlwdGlvbiYmKG89cysxNjkrMTIqdC5zYW1wbGVzLmxlbmd0aCs4KnQuYXVkaW9TZW5jLmxlbmd0aCk7dmFyIGw9bmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMjU1JnQuaWQscj4+MjQmMjU1LHI+PjE2JjI1NSxyPj44JjI1NSwyNTUmcixpPj4yNCYyNTUsaT4+MTYmMjU1LGk+PjgmMjU1LDI1NSZpLDAsMCwwLDAsMCwwLDAsMSwwLG8+PjE2JjI1NSxvPj44JjI1NSwyNTUmbyxuPj4yNCYyNTUsbj4+MTYmMjU1LG4+PjgmMjU1LDI1NSZuLDE0NCwwLDAsMF0pO3JldHVybiBlLmJveChlLnR5cGVzLnNpZHgsbCl9fSx7a2V5OiJtZGF0Iix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5ib3goZS50eXBlcy5tZGF0LHQpfX1dKSxlfSgpO2koRWUsInR5cGVzIixbImF2MDEiLCJhdjFDIiwiYXZjMSIsImF2Y0MiLCJodmMxIiwiaHZjQyIsImRpbmYiLCJkcmVmIiwiZXNkcyIsImZ0eXAiLCJoZGxyIiwibWRhdCIsIm1kaGQiLCJtZGlhIiwibWZoZCIsIm1pbmYiLCJtb29mIiwibW9vdiIsIm1wNGEiLCJtdmV4IiwibXZoZCIsInBhc3AiLCJzdGJsIiwic3RjbyIsInN0c2MiLCJzdHNkIiwic3RzeiIsInN0dHMiLCJ0ZmR0IiwidGZoZCIsInRyYWYiLCJ0cmFrIiwidHJleCIsInRraGQiLCJ2bWhkIiwic21oZCIsImN0dHMiLCJzdHNzIiwic3R5cCIsInBzc2giLCJzaWR4Iiwic2JncCIsInNhaXoiLCJzYWlvIiwic2VuYyIsInRydW4iLCJlbmN2IiwiZW5jYSIsInNpbmYiLCJidHJ0IiwiZnJtYSIsInRlbmMiLCJzY2htIiwic2NoaSIsIm1laGQiLCJmaWVsIiwic2R0cCJdLnJlZHVjZSgoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZVt0XT1bdC5jaGFyQ29kZUF0KDApLHQuY2hhckNvZGVBdCgxKSx0LmNoYXJDb2RlQXQoMiksdC5jaGFyQ29kZUF0KDMpXSxlfSksT2JqZWN0LmNyZWF0ZShudWxsKSkpLGkoRWUsIkhETFJfVFlQRVMiLHt2aWRlbzpuZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwwLDExOCwxMDUsMTAwLDEwMSwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCw4NiwxMDUsMTAwLDEwMSwxMTEsNzIsOTcsMTEwLDEwMCwxMDgsMTAxLDExNCwwXSksYXVkaW86bmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMCwxMTUsMTExLDExNywxMTAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsODMsMTExLDExNywxMTAsMTAwLDcyLDk3LDExMCwxMDAsMTA4LDEwMSwxMTQsMF0pfSksaShFZSwiRlRZUEFWQzEiLEVlLmJveChFZS50eXBlcy5mdHlwLG5ldyBVaW50OEFycmF5KFsxMDUsMTE1LDExMSwxMDksMCwwLDAsMSwxMDUsMTE1LDExMSwxMDksOTcsMTE4LDk5LDQ5XSkpKSxpKEVlLCJGVFlQSEVWMSIsRWUuYm94KEVlLnR5cGVzLmZ0eXAsbmV3IFVpbnQ4QXJyYXkoWzEwNSwxMTUsMTExLDEwOSwwLDAsMCwxLDEwNSwxMTUsMTExLDEwOSwxMDQsMTAxLDExOCw0OV0pKSksaShFZSwiRElORiIsRWUuYm94KEVlLnR5cGVzLmRpbmYsRWUuYm94KEVlLnR5cGVzLmRyZWYsbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMSwwLDAsMCwxMiwxMTcsMTE0LDEwOCwzMiwwLDAsMCwxXSkpKSksaShFZSwiVk1IRCIsRWUuYm94KEVlLnR5cGVzLnZtaGQsbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDEsMCwwLDAsMCwwLDAsMCwwXSkpKSxpKEVlLCJTTUhEIixFZS5ib3goRWUudHlwZXMuc21oZCxuZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwwXSkpKSxpKEVlLCJTdGJsVGFibGUiLG5ldyBVaW50OEFycmF5KFswLDAsMCwwLDAsMCwwLDBdKSksaShFZSwiU1RUUyIsRWUuYm94KEVlLnR5cGVzLnN0dHMsRWUuU3RibFRhYmxlKSksaShFZSwiU1RTQyIsRWUuYm94KEVlLnR5cGVzLnN0c2MsRWUuU3RibFRhYmxlKSksaShFZSwiU1RTWiIsRWUuYm94KEVlLnR5cGVzLnN0c3osbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwXSkpKSxpKEVlLCJTVENPIixFZS5ib3goRWUudHlwZXMuc3RjbyxFZS5TdGJsVGFibGUpKTt2YXIgVGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQsYSl7cih0aGlzLGUpLHRoaXMubmFtZT10fHwiIix0aGlzLl9wcmVmaXg9IlsiLmNvbmNhdCh0aGlzLm5hbWUsIl0iKSxlLmRpc2FibGVkPWF9cmV0dXJuIG4oZSxbe2tleToiZGVidWciLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIHQ7aWYoIWUuZGlzYWJsZWQpe2Zvcih2YXIgcj1hcmd1bWVudHMubGVuZ3RoLGE9bmV3IEFycmF5KHIpLG49MDtuPHI7bisrKWFbbl09YXJndW1lbnRzW25dOyh0PWNvbnNvbGUpLmRlYnVnLmFwcGx5KHQsW3RoaXMuX3ByZWZpeF0uY29uY2F0KGEpKX19fSx7a2V5OiJsb2ciLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIHQ7aWYoIWUuZGlzYWJsZWQpe2Zvcih2YXIgcj1hcmd1bWVudHMubGVuZ3RoLGE9bmV3IEFycmF5KHIpLG49MDtuPHI7bisrKWFbbl09YXJndW1lbnRzW25dOyh0PWNvbnNvbGUpLmxvZy5hcHBseSh0LFt0aGlzLl9wcmVmaXhdLmNvbmNhdChhKSl9fX0se2tleToid2FybiIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgdDtpZighZS5kaXNhYmxlZCl7Zm9yKHZhciByPWFyZ3VtZW50cy5sZW5ndGgsYT1uZXcgQXJyYXkociksbj0wO248cjtuKyspYVtuXT1hcmd1bWVudHNbbl07KHQ9Y29uc29sZSkud2Fybi5hcHBseSh0LFt0aGlzLl9wcmVmaXhdLmNvbmNhdChhKSl9fX0se2tleToiZXJyb3IiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIHQ7aWYoIWUuZGlzYWJsZWQpe2Zvcih2YXIgcj1hcmd1bWVudHMubGVuZ3RoLGE9bmV3IEFycmF5KHIpLG49MDtuPHI7bisrKWFbbl09YXJndW1lbnRzW25dOyh0PWNvbnNvbGUpLmVycm9yLmFwcGx5KHQsW3RoaXMuX3ByZWZpeF0uY29uY2F0KGEpKX19fSx7a2V5OiJ0YWJsZSIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgdDtlLmRpc2FibGVkfHwoY29uc29sZS5ncm91cCh0aGlzLl9wcmVmaXgpLCh0PWNvbnNvbGUpLnRhYmxlLmFwcGx5KHQsYXJndW1lbnRzKSxjb25zb2xlLmdyb3VwRW5kKCkpfX1dLFt7a2V5OiJlbmFibGUiLHZhbHVlOmZ1bmN0aW9uKCl7ZS5kaXNhYmxlZD0hMX19LHtrZXk6ImRpc2FibGUiLHZhbHVlOmZ1bmN0aW9uKCl7ZS5kaXNhYmxlZD0hMH19XSksZX0oKTtpKFRlLCJkaXNhYmxlZCIsITApO2Zvcih2YXIgVWU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQsYSxuKXtyKHRoaXMsZSksdGhpcy52aWRlb1RyYWNrPXQsdGhpcy5hdWRpb1RyYWNrPWE7dmFyIGk9L0Nocm9tZVwvKFteLl0rKS8uZXhlYyhuYXZpZ2F0b3IudXNlckFnZW50KTt0aGlzLmZvcmNlRmlyc3RJRFI9aSYmTnVtYmVyKGlbMV0pPDUwLHRoaXMubG9nPW5ldyBUZSgiRk1QNFJlbXV4ZXIiLCFufHwhbi5vcGVuTG9nfHwhbi5vcGVuTG9nKX1yZXR1cm4gbihlLFt7a2V5OiJyZW11eCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZSx0LHIsYSxuLGk9YXJndW1lbnRzLmxlbmd0aD4wJiZ2b2lkIDAhPT1hcmd1bWVudHNbMF0mJmFyZ3VtZW50c1swXSxzPWFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXTp7fSxvPXRoaXMudmlkZW9UcmFjayx1PXRoaXMuYXVkaW9UcmFjayxjPW8uZXhpc3QoKSxsPXUuZXhpc3QoKSxmPVtdO3JldHVybiBpJiYocyYmcy5pbml0TWVyZ2U/KGMmJmYucHVzaCh0aGlzLnZpZGVvVHJhY2spLGwmJmYucHVzaCh0aGlzLmF1ZGlvVHJhY2spLHI9RWUuaW5pdFNlZ21lbnQoZikpOihjJiYoZT1FZS5pbml0U2VnbWVudChbdGhpcy52aWRlb1RyYWNrXSkpLGwmJih0PUVlLmluaXRTZWdtZW50KFt0aGlzLmF1ZGlvVHJhY2tdKSkpKSxjJiZvLmhhc1NhbXBsZSgpJiYoYT10aGlzLl9yZW11eFZpZGVvKCkpLGwmJnUuaGFzU2FtcGxlKCkmJihuPXRoaXMuX3JlbXV4QXVkaW8oKSksby5zYW1wbGVzPVtdLHUuc2FtcGxlcz1bXSx7aW5pdFNlZ21lbnQ6cix2aWRlb0luaXRTZWdtZW50OmUsYXVkaW9Jbml0U2VnbWVudDp0LHZpZGVvU2VnbWVudDphLGF1ZGlvU2VnbWVudDpufX19LHtrZXk6Il9yZW11eFZpZGVvIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMudmlkZW9UcmFjazt0aGlzLmZvcmNlRmlyc3RJRFImJihlLnNhbXBsZXNbMF0uZmxhZz17ZGVwZW5kc09uOjIsaXNOb25TeW5jU2FtcGxlOjB9KTt2YXIgdD1lLnNhbXBsZXMscj0vYXYwMS8udGVzdChlLmNvZGVjKSxhPTA7cj90LmZvckVhY2goKGZ1bmN0aW9uKGUpe2ErPWUuZGF0YS5ieXRlTGVuZ3RofSkpOnQuZm9yRWFjaCgoZnVuY3Rpb24oZSl7YSs9ZS51bml0cy5yZWR1Y2UoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUrdC5ieXRlTGVuZ3RofSksMCksYSs9NCplLnVuaXRzLmxlbmd0aH0pKTt2YXIgbj1uZXcgVWludDhBcnJheShhKTtpZihyKWZvcih2YXIgaSxzPTAsbz10Lmxlbmd0aCx1PTA7czxvO3MrKylpPXRbc10sbi5zZXQoaS5kYXRhLHUpLGkuc2l6ZT1pLmRhdGEuYnl0ZUxlbmd0aCx1Kz1pLnNpemU7ZWxzZSBmb3IodmFyIGMsbD1uZXcgRGF0YVZpZXcobi5idWZmZXIpLGY9ZnVuY3Rpb24oZSxyKXtyPXRbZF07dmFyIGE9MDtyLnVuaXRzLmZvckVhY2goKGZ1bmN0aW9uKHQpe2wuc2V0VWludDMyKGUsdC5ieXRlTGVuZ3RoKSxlKz00LG4uc2V0KHQsZSksZSs9dC5ieXRlTGVuZ3RoLGErPTQrdC5ieXRlTGVuZ3RofSkpLHIuc2l6ZT1hLHA9ZSxjPXJ9LGQ9MCxoPXQubGVuZ3RoLHA9MDtkPGg7ZCsrKWYocCxjKTt2YXIgdj1FZS5tZGF0KG4pO3JldHVybiBRKEVlLm1vb2YoW2VdKSx2KX19LHtrZXk6Il9yZW11eEF1ZGlvIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuYXVkaW9UcmFjayx0PW5ldyBVaW50OEFycmF5KGUuc2FtcGxlcy5yZWR1Y2UoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUrdC5zaXplfSksMCkpO2Uuc2FtcGxlcy5yZWR1Y2UoKGZ1bmN0aW9uKGUscil7cmV0dXJuIHQuc2V0KHIuZGF0YSxlKSxlK3Iuc2l6ZX0pLDApO3ZhciByPUVlLm1kYXQodCk7cmV0dXJuIFEoRWUubW9vZihbZV0pLHIpfX0se2tleToicmVzZXQiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy52aWRlb1RyYWNrLnJlc2V0KCksdGhpcy5hdWRpb1RyYWNrLnJlc2V0KCl9fV0pLGV9KCksQ2U9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7cih0aGlzLGUpfXJldHVybiBuKGUsW3trZXk6Im1peEluIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0LmFzc2lnbih0aGlzLGUpfX0se2tleToiY2xvbmUiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9bmV3IHRoaXMuY29uc3RydWN0b3I7cmV0dXJuIE9iamVjdC5hc3NpZ24oZSx0aGlzKSxlfX1dLFt7a2V5OiJjcmVhdGUiLHZhbHVlOmZ1bmN0aW9uKCl7Zm9yKHZhciBlPWFyZ3VtZW50cy5sZW5ndGgsdD1uZXcgQXJyYXkoZSkscj0wO3I8ZTtyKyspdFtyXT1hcmd1bWVudHNbcl07cmV0dXJuIGwodGhpcyx0KX19XSksZX0oKSxQZT1mdW5jdGlvbihlKXtzKGEsZSk7dmFyIHQ9ZChhKTtmdW5jdGlvbiBhKCl7dmFyIGUsbj1hcmd1bWVudHMubGVuZ3RoPjAmJnZvaWQgMCE9PWFyZ3VtZW50c1swXT9hcmd1bWVudHNbMF06W10saT1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06NCpuLmxlbmd0aDtyKHRoaXMsYSksZT10LmNhbGwodGhpcyk7dmFyIHM9bjtpZihzIGluc3RhbmNlb2YgQXJyYXlCdWZmZXImJihzPW5ldyBVaW50OEFycmF5KHMpKSwocyBpbnN0YW5jZW9mIEludDhBcnJheXx8cyBpbnN0YW5jZW9mIFVpbnQ4Q2xhbXBlZEFycmF5fHxzIGluc3RhbmNlb2YgSW50MTZBcnJheXx8cyBpbnN0YW5jZW9mIFVpbnQxNkFycmF5fHxzIGluc3RhbmNlb2YgSW50MzJBcnJheXx8cyBpbnN0YW5jZW9mIFVpbnQzMkFycmF5fHxzIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5fHxzIGluc3RhbmNlb2YgRmxvYXQ2NEFycmF5KSYmKHM9bmV3IFVpbnQ4QXJyYXkocy5idWZmZXIscy5ieXRlT2Zmc2V0LHMuYnl0ZUxlbmd0aCkpLHMgaW5zdGFuY2VvZiBVaW50OEFycmF5KXtmb3IodmFyIG89cy5ieXRlTGVuZ3RoLHU9W10sYz0wO2M8bztjKz0xKXVbYz4+PjJdfD1zW2NdPDwyNC1jJTQqODtlLndvcmRzPXUsZS5zaWdCeXRlcz1vfWVsc2UgZS53b3Jkcz1uLGUuc2lnQnl0ZXM9aTtyZXR1cm4gZX1yZXR1cm4gbihhLFt7a2V5OiJ0b1N0cmluZyIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT1hcmd1bWVudHMubGVuZ3RoPjAmJnZvaWQgMCE9PWFyZ3VtZW50c1swXT9hcmd1bWVudHNbMF06SWU7cmV0dXJuIGUuc3RyaW5naWZ5KHRoaXMpfX0se2tleToiY29uY2F0Iix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLndvcmRzLHI9ZS53b3JkcyxhPXRoaXMuc2lnQnl0ZXMsbj1lLnNpZ0J5dGVzO2lmKHRoaXMuY2xhbXAoKSxhJTQpZm9yKHZhciBpPTA7aTxuO2krPTEpe3ZhciBzPXJbaT4+PjJdPj4+MjQtaSU0KjgmMjU1O3RbYStpPj4+Ml18PXM8PDI0LShhK2kpJTQqOH1lbHNlIGZvcih2YXIgbz0wO288bjtvKz00KXRbYStvPj4+Ml09cltvPj4+Ml07cmV0dXJuIHRoaXMuc2lnQnl0ZXMrPW4sdGhpc319LHtrZXk6ImNsYW1wIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMud29yZHMsdD10aGlzLnNpZ0J5dGVzO2VbdD4+PjJdJj00Mjk0OTY3Mjk1PDwzMi10JTQqOCxlLmxlbmd0aD1NYXRoLmNlaWwodC80KX19LHtrZXk6ImNsb25lIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXAobyhhLnByb3RvdHlwZSksImNsb25lIix0aGlzKS5jYWxsKHRoaXMpO3JldHVybiBlLndvcmRzPXRoaXMud29yZHMuc2xpY2UoMCksZX19XSxbe2tleToicmFuZG9tIix2YWx1ZTpmdW5jdGlvbihlKXtmb3IodmFyIHQscj1bXSxuPWZ1bmN0aW9uKGUpe3ZhciB0PWUscj05ODc2NTQzMjEsYT00Mjk0OTY3Mjk1O3JldHVybiBmdW5jdGlvbigpe3ZhciBlPSgocj0zNjk2OSooNjU1MzUmcikrKHI+PjE2KSZhKTw8MTYpKyh0PTE4ZTMqKDY1NTM1JnQpKyh0Pj4xNikmYSkmYTtyZXR1cm4gZS89NDI5NDk2NzI5NiwoZSs9LjUpKihNYXRoLnJhbmRvbSgpPi41PzE6LTEpfX0saT0wO2k8ZTtpKz00KXt2YXIgcz1uKDQyOTQ5NjcyOTYqKHR8fE1hdGgucmFuZG9tKCkpKTt0PTk4NzY1NDA3MSpzKCksci5wdXNoKDQyOTQ5NjcyOTYqcygpfDApfXJldHVybiBuZXcgYShyLGUpfX1dKSxhfShDZSksSWU9e3N0cmluZ2lmeTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9ZS53b3JkcyxyPWUuc2lnQnl0ZXMsYT1bXSxuPTA7bjxyO24rPTEpe3ZhciBpPXRbbj4+PjJdPj4+MjQtbiU0KjgmMjU1O2EucHVzaCgoaT4+PjQpLnRvU3RyaW5nKDE2KSksYS5wdXNoKCgxNSZpKS50b1N0cmluZygxNikpfXJldHVybiBhLmpvaW4oIiIpfSxwYXJzZTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9ZS5sZW5ndGgscj1bXSxhPTA7YTx0O2ErPTIpclthPj4+M118PXBhcnNlSW50KGUuc3Vic3RyKGEsMiksMTYpPDwyNC1hJTgqNDtyZXR1cm4gbmV3IFBlKHIsdC8yKX19LE1lPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLmxlbmd0aCxyPVtdLGE9MDthPHQ7YSs9MSlyW2E+Pj4yXXw9KDI1NSZlLmNoYXJDb2RlQXQoYSkpPDwyNC1hJTQqODtyZXR1cm4gbmV3IFBlKHIsdCl9LHplPWZ1bmN0aW9uKGUpe3JldHVybiBNZSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoZSkpKX0sT2U9ZnVuY3Rpb24oZSl7cyhhLGUpO3ZhciB0PWQoYSk7ZnVuY3Rpb24gYSgpe3ZhciBlO3JldHVybiByKHRoaXMsYSksKGU9dC5jYWxsKHRoaXMpKS5fbWluQnVmZmVyU2l6ZT0wLGV9cmV0dXJuIG4oYSxbe2tleToicmVzZXQiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fZGF0YT1uZXcgUGUsdGhpcy5fbkRhdGFCeXRlcz0wfX0se2tleToiX2FwcGVuZCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZTsic3RyaW5nIj09dHlwZW9mIHQmJih0PXplKHQpKSx0aGlzLl9kYXRhLmNvbmNhdCh0KSx0aGlzLl9uRGF0YUJ5dGVzKz10LnNpZ0J5dGVzfX0se2tleToiX3Byb2Nlc3MiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0LHI9dGhpcy5fZGF0YSxhPXRoaXMuYmxvY2tTaXplLG49ci53b3JkcyxpPXIuc2lnQnl0ZXMscz1pLyg0KmEpLG89KHM9ZT9NYXRoLmNlaWwocyk6TWF0aC5tYXgoKDB8cyktdGhpcy5fbWluQnVmZmVyU2l6ZSwwKSkqYSx1PU1hdGgubWluKDQqbyxpKTtpZihvKXtmb3IodmFyIGM9MDtjPG87Yys9YSl0aGlzLl9kb1Byb2Nlc3NCbG9jayhuLGMpO3Q9bi5zcGxpY2UoMCxvKSxyLnNpZ0J5dGVzLT11fXJldHVybiBuZXcgUGUodCx1KX19LHtrZXk6ImNsb25lIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXAobyhhLnByb3RvdHlwZSksImNsb25lIix0aGlzKS5jYWxsKHRoaXMpO3JldHVybiBlLl9kYXRhPXRoaXMuX2RhdGEuY2xvbmUoKSxlfX1dKSxhfShDZSksUmU9ZnVuY3Rpb24oZSl7cyhhLGUpO3ZhciB0PWQoYSk7ZnVuY3Rpb24gYShlKXt2YXIgbjtyZXR1cm4gcih0aGlzLGEpLChuPXQuY2FsbCh0aGlzKSkuYmxvY2tTaXplPTE2LG4uY2ZnPU9iamVjdC5hc3NpZ24obmV3IENlLGUpLG4ucmVzZXQoKSxufXJldHVybiBuKGEsW3trZXk6InJlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3AobyhhLnByb3RvdHlwZSksInJlc2V0Iix0aGlzKS5jYWxsKHRoaXMpLHRoaXMuX2RvUmVzZXQoKX19LHtrZXk6InVwZGF0ZSIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2FwcGVuZChlKSx0aGlzLl9wcm9jZXNzKCksdGhpc319LHtrZXk6ImZpbmFsaXplIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZSYmdGhpcy5fYXBwZW5kKGUpLHRoaXMuX2RvRmluYWxpemUoKX19XSxbe2tleToiX2NyZWF0ZUhlbHBlciIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKHQscil7cmV0dXJuIG5ldyBlKHIpLmZpbmFsaXplKHQpfX19LHtrZXk6Il9jcmVhdGVIbWFjSGVscGVyIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24odCxyKXtyZXR1cm4gbmV3IExlKGUscikuZmluYWxpemUodCl9fX1dKSxhfShPZSksTGU9ZnVuY3Rpb24oZSl7cyhhLGUpO3ZhciB0PWQoYSk7ZnVuY3Rpb24gYShlLG4pe3ZhciBpO3IodGhpcyxhKSxpPXQuY2FsbCh0aGlzKTt2YXIgcz1uZXcgZTtpLl9oYXNoZXI9czt2YXIgbz1uOyJzdHJpbmciPT10eXBlb2YgbyYmKG89emUobykpO3ZhciB1PXMuYmxvY2tTaXplLGM9NCp1O28uc2lnQnl0ZXM+YyYmKG89cy5maW5hbGl6ZShuKSksby5jbGFtcCgpO3ZhciBsPW8uY2xvbmUoKTtpLl9vS2V5PWw7dmFyIGY9by5jbG9uZSgpO2kuX2lLZXk9Zjtmb3IodmFyIGQ9bC53b3JkcyxoPWYud29yZHMscD0wO3A8dTtwKz0xKWRbcF1ePTE1NDk1NTY4MjgsaFtwXV49OTA5NTIyNDg2O3JldHVybiBsLnNpZ0J5dGVzPWMsZi5zaWdCeXRlcz1jLGkucmVzZXQoKSxpfXJldHVybiBuKGEsW3trZXk6InJlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuX2hhc2hlcjtlLnJlc2V0KCksZS51cGRhdGUodGhpcy5faUtleSl9fSx7a2V5OiJ1cGRhdGUiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9oYXNoZXIudXBkYXRlKGUpLHRoaXN9fSx7a2V5OiJmaW5hbGl6ZSIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5faGFzaGVyLHI9dC5maW5hbGl6ZShlKTtyZXR1cm4gdC5yZXNldCgpLHQuZmluYWxpemUodGhpcy5fb0tleS5jbG9uZSgpLmNvbmNhdChyKSl9fV0pLGF9KENlKSxWZT17c3RyaW5naWZ5OmZ1bmN0aW9uKGUpe3ZhciB0PWUud29yZHMscj1lLnNpZ0J5dGVzLGE9dGhpcy5fbWFwO2UuY2xhbXAoKTtmb3IodmFyIG49W10saT0wO2k8cjtpKz0zKWZvcih2YXIgcz0odFtpPj4+Ml0+Pj4yNC1pJTQqOCYyNTUpPDwxNnwodFtpKzE+Pj4yXT4+PjI0LShpKzEpJTQqOCYyNTUpPDw4fHRbaSsyPj4+Ml0+Pj4yNC0oaSsyKSU0KjgmMjU1LG89MDtvPDQmJmkrLjc1Km88cjtvKz0xKW4ucHVzaChhLmNoYXJBdChzPj4+NiooMy1vKSY2MykpO3ZhciB1PWEuY2hhckF0KDY0KTtpZih1KWZvcig7bi5sZW5ndGglNDspbi5wdXNoKHUpO3JldHVybiBuLmpvaW4oIiIpfSxwYXJzZTpmdW5jdGlvbihlKXt2YXIgdD1lLmxlbmd0aCxyPXRoaXMuX21hcCxhPXRoaXMuX3JldmVyc2VNYXA7aWYoIWEpe3RoaXMuX3JldmVyc2VNYXA9W10sYT10aGlzLl9yZXZlcnNlTWFwO2Zvcih2YXIgbj0wO248ci5sZW5ndGg7bis9MSlhW3IuY2hhckNvZGVBdChuKV09bn12YXIgaT1yLmNoYXJBdCg2NCk7aWYoaSl7dmFyIHM9ZS5pbmRleE9mKGkpOy0xIT09cyYmKHQ9cyl9cmV0dXJuIGZ1bmN0aW9uKGUsdCxyKXtmb3IodmFyIGE9W10sbj0wLGk9MDtpPHQ7aSs9MSlpZihpJTQpe3ZhciBzPXJbZS5jaGFyQ29kZUF0KGktMSldPDxpJTQqMnxyW2UuY2hhckNvZGVBdChpKV0+Pj42LWklNCoyO2Fbbj4+PjJdfD1zPDwyNC1uJTQqOCxuKz0xfXJldHVybiBQZS5jcmVhdGUoYSxuKX0oZSx0LGEpfSxfbWFwOiJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPSJ9LEZlPVtdLE5lPTA7TmU8NjQ7TmUrPTEpRmVbTmVdPTQyOTQ5NjcyOTYqTWF0aC5hYnMoTWF0aC5zaW4oTmUrMSkpfDA7dmFyIGplPWZ1bmN0aW9uKGUsdCxyLGEsbixpLHMpe3ZhciBvPWUrKHQmcnx+dCZhKStuK3M7cmV0dXJuKG88PGl8bz4+PjMyLWkpK3R9LEdlPWZ1bmN0aW9uKGUsdCxyLGEsbixpLHMpe3ZhciBvPWUrKHQmYXxyJn5hKStuK3M7cmV0dXJuKG88PGl8bz4+PjMyLWkpK3R9LEhlPWZ1bmN0aW9uKGUsdCxyLGEsbixpLHMpe3ZhciBvPWUrKHRecl5hKStuK3M7cmV0dXJuKG88PGl8bz4+PjMyLWkpK3R9LEtlPWZ1bmN0aW9uKGUsdCxyLGEsbixpLHMpe3ZhciBvPWUrKHJeKHR8fmEpKStuK3M7cmV0dXJuKG88PGl8bz4+PjMyLWkpK3R9LHFlPWZ1bmN0aW9uKGUpe3MoYSxlKTt2YXIgdD1kKGEpO2Z1bmN0aW9uIGEoKXtyZXR1cm4gcih0aGlzLGEpLHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiBuKGEsW3trZXk6Il9kb1Jlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX2hhc2g9bmV3IFBlKFsxNzMyNTg0MTkzLDQwMjMyMzM0MTcsMjU2MjM4MzEwMiwyNzE3MzM4NzhdKX19LHtrZXk6Il9kb1Byb2Nlc3NCbG9jayIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtmb3IodmFyIHI9ZSxhPTA7YTwxNjthKz0xKXt2YXIgbj10K2EsaT1lW25dO3Jbbl09MTY3MTE5MzUmKGk8PDh8aT4+PjI0KXw0Mjc4MjU1MzYwJihpPDwyNHxpPj4+OCl9dmFyIHM9dGhpcy5faGFzaC53b3JkcyxvPXJbdCswXSx1PXJbdCsxXSxjPXJbdCsyXSxsPXJbdCszXSxmPXJbdCs0XSxkPXJbdCs1XSxoPXJbdCs2XSxwPXJbdCs3XSx2PXJbdCs4XSx5PXJbdCs5XSxtPXJbdCsxMF0sZz1yW3QrMTFdLGs9clt0KzEyXSxiPXJbdCsxM10sXz1yW3QrMTRdLHc9clt0KzE1XSx4PXNbMF0sUz1zWzFdLEE9c1syXSxEPXNbM107eD1qZSh4LFMsQSxELG8sNyxGZVswXSksRD1qZShELHgsUyxBLHUsMTIsRmVbMV0pLEE9amUoQSxELHgsUyxjLDE3LEZlWzJdKSxTPWplKFMsQSxELHgsbCwyMixGZVszXSkseD1qZSh4LFMsQSxELGYsNyxGZVs0XSksRD1qZShELHgsUyxBLGQsMTIsRmVbNV0pLEE9amUoQSxELHgsUyxoLDE3LEZlWzZdKSxTPWplKFMsQSxELHgscCwyMixGZVs3XSkseD1qZSh4LFMsQSxELHYsNyxGZVs4XSksRD1qZShELHgsUyxBLHksMTIsRmVbOV0pLEE9amUoQSxELHgsUyxtLDE3LEZlWzEwXSksUz1qZShTLEEsRCx4LGcsMjIsRmVbMTFdKSx4PWplKHgsUyxBLEQsayw3LEZlWzEyXSksRD1qZShELHgsUyxBLGIsMTIsRmVbMTNdKSxBPWplKEEsRCx4LFMsXywxNyxGZVsxNF0pLFM9amUoUyxBLEQseCx3LDIyLEZlWzE1XSkseD1HZSh4LFMsQSxELHUsNSxGZVsxNl0pLEQ9R2UoRCx4LFMsQSxoLDksRmVbMTddKSxBPUdlKEEsRCx4LFMsZywxNCxGZVsxOF0pLFM9R2UoUyxBLEQseCxvLDIwLEZlWzE5XSkseD1HZSh4LFMsQSxELGQsNSxGZVsyMF0pLEQ9R2UoRCx4LFMsQSxtLDksRmVbMjFdKSxBPUdlKEEsRCx4LFMsdywxNCxGZVsyMl0pLFM9R2UoUyxBLEQseCxmLDIwLEZlWzIzXSkseD1HZSh4LFMsQSxELHksNSxGZVsyNF0pLEQ9R2UoRCx4LFMsQSxfLDksRmVbMjVdKSxBPUdlKEEsRCx4LFMsbCwxNCxGZVsyNl0pLFM9R2UoUyxBLEQseCx2LDIwLEZlWzI3XSkseD1HZSh4LFMsQSxELGIsNSxGZVsyOF0pLEQ9R2UoRCx4LFMsQSxjLDksRmVbMjldKSxBPUdlKEEsRCx4LFMscCwxNCxGZVszMF0pLFM9R2UoUyxBLEQseCxrLDIwLEZlWzMxXSkseD1IZSh4LFMsQSxELGQsNCxGZVszMl0pLEQ9SGUoRCx4LFMsQSx2LDExLEZlWzMzXSksQT1IZShBLEQseCxTLGcsMTYsRmVbMzRdKSxTPUhlKFMsQSxELHgsXywyMyxGZVszNV0pLHg9SGUoeCxTLEEsRCx1LDQsRmVbMzZdKSxEPUhlKEQseCxTLEEsZiwxMSxGZVszN10pLEE9SGUoQSxELHgsUyxwLDE2LEZlWzM4XSksUz1IZShTLEEsRCx4LG0sMjMsRmVbMzldKSx4PUhlKHgsUyxBLEQsYiw0LEZlWzQwXSksRD1IZShELHgsUyxBLG8sMTEsRmVbNDFdKSxBPUhlKEEsRCx4LFMsbCwxNixGZVs0Ml0pLFM9SGUoUyxBLEQseCxoLDIzLEZlWzQzXSkseD1IZSh4LFMsQSxELHksNCxGZVs0NF0pLEQ9SGUoRCx4LFMsQSxrLDExLEZlWzQ1XSksQT1IZShBLEQseCxTLHcsMTYsRmVbNDZdKSxTPUhlKFMsQSxELHgsYywyMyxGZVs0N10pLHg9S2UoeCxTLEEsRCxvLDYsRmVbNDhdKSxEPUtlKEQseCxTLEEscCwxMCxGZVs0OV0pLEE9S2UoQSxELHgsUyxfLDE1LEZlWzUwXSksUz1LZShTLEEsRCx4LGQsMjEsRmVbNTFdKSx4PUtlKHgsUyxBLEQsayw2LEZlWzUyXSksRD1LZShELHgsUyxBLGwsMTAsRmVbNTNdKSxBPUtlKEEsRCx4LFMsbSwxNSxGZVs1NF0pLFM9S2UoUyxBLEQseCx1LDIxLEZlWzU1XSkseD1LZSh4LFMsQSxELHYsNixGZVs1Nl0pLEQ9S2UoRCx4LFMsQSx3LDEwLEZlWzU3XSksQT1LZShBLEQseCxTLGgsMTUsRmVbNThdKSxTPUtlKFMsQSxELHgsYiwyMSxGZVs1OV0pLHg9S2UoeCxTLEEsRCxmLDYsRmVbNjBdKSxEPUtlKEQseCxTLEEsZywxMCxGZVs2MV0pLEE9S2UoQSxELHgsUyxjLDE1LEZlWzYyXSksUz1LZShTLEEsRCx4LHksMjEsRmVbNjNdKSxzWzBdPXNbMF0reHwwLHNbMV09c1sxXStTfDAsc1syXT1zWzJdK0F8MCxzWzNdPXNbM10rRHwwfX0se2tleToiX2RvRmluYWxpemUiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fZGF0YSx0PWUud29yZHMscj04KnRoaXMuX25EYXRhQnl0ZXMsYT04KmUuc2lnQnl0ZXM7dFthPj4+NV18PTEyODw8MjQtYSUzMjt2YXIgbj1NYXRoLmZsb29yKHIvNDI5NDk2NzI5NiksaT1yO3RbMTUrKGErNjQ+Pj45PDw0KV09MTY3MTE5MzUmKG48PDh8bj4+PjI0KXw0Mjc4MjU1MzYwJihuPDwyNHxuPj4+OCksdFsxNCsoYSs2ND4+Pjk8PDQpXT0xNjcxMTkzNSYoaTw8OHxpPj4+MjQpfDQyNzgyNTUzNjAmKGk8PDI0fGk+Pj44KSxlLnNpZ0J5dGVzPTQqKHQubGVuZ3RoKzEpLHRoaXMuX3Byb2Nlc3MoKTtmb3IodmFyIHM9dGhpcy5faGFzaCxvPXMud29yZHMsdT0wO3U8NDt1Kz0xKXt2YXIgYz1vW3VdO29bdV09MTY3MTE5MzUmKGM8PDh8Yz4+PjI0KXw0Mjc4MjU1MzYwJihjPDwyNHxjPj4+OCl9cmV0dXJuIHN9fSx7a2V5OiJjbG9uZSIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT1wKG8oYS5wcm90b3R5cGUpLCJjbG9uZSIsdGhpcykuY2FsbCh0aGlzKTtyZXR1cm4gZS5faGFzaD10aGlzLl9oYXNoLmNsb25lKCksZX19XSksYX0oUmUpO1JlLl9jcmVhdGVIZWxwZXIocWUpLFJlLl9jcmVhdGVIbWFjSGVscGVyKHFlKTt2YXIgV2U9ZnVuY3Rpb24oZSl7cyhhLGUpO3ZhciB0PWQoYSk7ZnVuY3Rpb24gYShlKXt2YXIgbjtyZXR1cm4gcih0aGlzLGEpLChuPXQuY2FsbCh0aGlzKSkuY2ZnPU9iamVjdC5hc3NpZ24obmV3IENlLHtrZXlTaXplOjQsaGFzaGVyOnFlLGl0ZXJhdGlvbnM6MX0sZSksbn1yZXR1cm4gbihhLFt7a2V5OiJjb21wdXRlIix2YWx1ZTpmdW5jdGlvbihlLHQpe2Zvcih2YXIgcixhPXRoaXMuY2ZnLG49YS5oYXNoZXIuY3JlYXRlKCksaT1QZS5jcmVhdGUoKSxzPWkud29yZHMsbz1hLmtleVNpemUsdT1hLml0ZXJhdGlvbnM7cy5sZW5ndGg8bzspe3ImJm4udXBkYXRlKHIpLHI9bi51cGRhdGUoZSkuZmluYWxpemUodCksbi5yZXNldCgpO2Zvcih2YXIgYz0xO2M8dTtjKz0xKXI9bi5maW5hbGl6ZShyKSxuLnJlc2V0KCk7aS5jb25jYXQocil9cmV0dXJuIGkuc2lnQnl0ZXM9NCpvLGl9fV0pLGF9KENlKSxYZT1mdW5jdGlvbihlKXtzKGEsZSk7dmFyIHQ9ZChhKTtmdW5jdGlvbiBhKGUsbixpKXt2YXIgcztyZXR1cm4gcih0aGlzLGEpLChzPXQuY2FsbCh0aGlzKSkuY2ZnPU9iamVjdC5hc3NpZ24obmV3IENlLGkpLHMuX3hmb3JtTW9kZT1lLHMuX2tleT1uLHMucmVzZXQoKSxzfXJldHVybiBuKGEsW3trZXk6InJlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3AobyhhLnByb3RvdHlwZSksInJlc2V0Iix0aGlzKS5jYWxsKHRoaXMpLHRoaXMuX2RvUmVzZXQoKX19LHtrZXk6InByb2Nlc3MiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9hcHBlbmQoZSksdGhpcy5fcHJvY2VzcygpfX0se2tleToiZmluYWxpemUiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBlJiZ0aGlzLl9hcHBlbmQoZSksdGhpcy5fZG9GaW5hbGl6ZSgpfX1dLFt7a2V5OiJjcmVhdGVFbmNyeXB0b3IiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuY3JlYXRlKHRoaXMuX0VOQ19YRk9STV9NT0RFLGUsdCl9fSx7a2V5OiJjcmVhdGVEZWNyeXB0b3IiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuY3JlYXRlKHRoaXMuX0RFQ19YRk9STV9NT0RFLGUsdCl9fSx7a2V5OiJfY3JlYXRlSGVscGVyIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbihlKXtyZXR1cm4ic3RyaW5nIj09dHlwZW9mIGU/bnQ6cnR9O3JldHVybntlbmNyeXB0OmZ1bmN0aW9uKHIsYSxuKXtyZXR1cm4gdChhKS5lbmNyeXB0KGUscixhLG4pfSxkZWNyeXB0OmZ1bmN0aW9uKHIsYSxuKXtyZXR1cm4gdChhKS5kZWNyeXB0KGUscixhLG4pfX19fV0pLGF9KE9lKTtYZS5fRU5DX1hGT1JNX01PREU9MSxYZS5fREVDX1hGT1JNX01PREU9MixYZS5rZXlTaXplPTQsWGUuaXZTaXplPTQ7dmFyIFllPWZ1bmN0aW9uKGUpe3MoYSxlKTt2YXIgdD1kKGEpO2Z1bmN0aW9uIGEoZSxuKXt2YXIgaTtyZXR1cm4gcih0aGlzLGEpLChpPXQuY2FsbCh0aGlzKSkuX2NpcGhlcj1lLGkuX2l2PW4saX1yZXR1cm4gbihhLG51bGwsW3trZXk6ImNyZWF0ZUVuY3J5cHRvciIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5FbmNyeXB0b3IuY3JlYXRlKGUsdCl9fSx7a2V5OiJjcmVhdGVEZWNyeXB0b3IiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuRGVjcnlwdG9yLmNyZWF0ZShlLHQpfX1dKSxhfShDZSk7ZnVuY3Rpb24gWmUoZSx0LHIpe3ZhciBhLG49ZSxpPXRoaXMuX2l2O2k/KGE9aSx0aGlzLl9pdj12b2lkIDApOmE9dGhpcy5fcHJldkJsb2NrO2Zvcih2YXIgcz0wO3M8cjtzKz0xKW5bdCtzXV49YVtzXX12YXIgUWU9ZnVuY3Rpb24oZSl7cyhhLGUpO3ZhciB0PWQoYSk7ZnVuY3Rpb24gYSgpe3JldHVybiByKHRoaXMsYSksdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cmV0dXJuIG4oYSl9KFllKTtRZS5FbmNyeXB0b3I9ZnVuY3Rpb24oZSl7cyhhLGUpO3ZhciB0PWQoYSk7ZnVuY3Rpb24gYSgpe3JldHVybiByKHRoaXMsYSksdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cmV0dXJuIG4oYSxbe2tleToicHJvY2Vzc0Jsb2NrIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciByPXRoaXMuX2NpcGhlcixhPXIuYmxvY2tTaXplO1plLmNhbGwodGhpcyxlLHQsYSksci5lbmNyeXB0QmxvY2soZSx0KSx0aGlzLl9wcmV2QmxvY2s9ZS5zbGljZSh0LHQrYSl9fV0pLGF9KFFlKSxRZS5EZWNyeXB0b3I9ZnVuY3Rpb24oZSl7cyhhLGUpO3ZhciB0PWQoYSk7ZnVuY3Rpb24gYSgpe3JldHVybiByKHRoaXMsYSksdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cmV0dXJuIG4oYSxbe2tleToicHJvY2Vzc0Jsb2NrIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciByPXRoaXMuX2NpcGhlcixhPXIuYmxvY2tTaXplLG49ZS5zbGljZSh0LHQrYSk7ci5kZWNyeXB0QmxvY2soZSx0KSxaZS5jYWxsKHRoaXMsZSx0LGEpLHRoaXMuX3ByZXZCbG9jaz1ufX1dKSxhfShRZSk7dmFyIEplPXtwYWQ6ZnVuY3Rpb24oZSx0KXtmb3IodmFyIHI9NCp0LGE9ci1lLnNpZ0J5dGVzJXIsbj1hPDwyNHxhPDwxNnxhPDw4fGEsaT1bXSxzPTA7czxhO3MrPTQpaS5wdXNoKG4pO3ZhciBvPVBlLmNyZWF0ZShpLGEpO2UuY29uY2F0KG8pfSx1bnBhZDpmdW5jdGlvbihlKXt2YXIgdD1lLHI9MjU1JnQud29yZHNbdC5zaWdCeXRlcy0xPj4+Ml07dC5zaWdCeXRlcy09cn19LCRlPWZ1bmN0aW9uKGUpe3MoYSxlKTt2YXIgdD1kKGEpO2Z1bmN0aW9uIGEoZSxuLGkpe3ZhciBzO3JldHVybiByKHRoaXMsYSksKHM9dC5jYWxsKHRoaXMsZSxuLE9iamVjdC5hc3NpZ24oe21vZGU6UWUscGFkZGluZzpKZX0saSkpKS5ibG9ja1NpemU9NCxzfXJldHVybiBuKGEsW3trZXk6InJlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlO3AobyhhLnByb3RvdHlwZSksInJlc2V0Iix0aGlzKS5jYWxsKHRoaXMpO3ZhciB0PXRoaXMuY2ZnLHI9dC5pdixuPXQubW9kZTt0aGlzLl94Zm9ybU1vZGU9PT10aGlzLmNvbnN0cnVjdG9yLl9FTkNfWEZPUk1fTU9ERT9lPW4uY3JlYXRlRW5jcnlwdG9yOihlPW4uY3JlYXRlRGVjcnlwdG9yLHRoaXMuX21pbkJ1ZmZlclNpemU9MSksdGhpcy5fbW9kZT1lLmNhbGwobix0aGlzLHImJnIud29yZHMpLHRoaXMuX21vZGUuX19jcmVhdG9yPWV9fSx7a2V5OiJfZG9Qcm9jZXNzQmxvY2siLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dGhpcy5fbW9kZS5wcm9jZXNzQmxvY2soZSx0KX19LHtrZXk6Il9kb0ZpbmFsaXplIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlLHQ9dGhpcy5jZmcucGFkZGluZztyZXR1cm4gdGhpcy5feGZvcm1Nb2RlPT09dGhpcy5jb25zdHJ1Y3Rvci5fRU5DX1hGT1JNX01PREU/KHQucGFkKHRoaXMuX2RhdGEsdGhpcy5ibG9ja1NpemUpLGU9dGhpcy5fcHJvY2VzcyghMCkpOihlPXRoaXMuX3Byb2Nlc3MoITApLHQudW5wYWQoZSkpLGV9fV0pLGF9KFhlKSxldD1mdW5jdGlvbihlKXtzKGEsZSk7dmFyIHQ9ZChhKTtmdW5jdGlvbiBhKGUpe3ZhciBuO3JldHVybiByKHRoaXMsYSksKG49dC5jYWxsKHRoaXMpKS5taXhJbihlKSxufXJldHVybiBuKGEsW3trZXk6InRvU3RyaW5nIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4oZXx8dGhpcy5mb3JtYXR0ZXIpLnN0cmluZ2lmeSh0aGlzKX19XSksYX0oQ2UpLHR0PXtzdHJpbmdpZnk6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5jaXBoZXJ0ZXh0LHI9ZS5zYWx0O3JldHVybihyP1BlLmNyZWF0ZShbMTM5ODg5MzY4NCwxNzAxMDc2ODMxXSkuY29uY2F0KHIpLmNvbmNhdCh0KTp0KS50b1N0cmluZyhWZSl9LHBhcnNlOmZ1bmN0aW9uKGUpe3ZhciB0LHI9VmUucGFyc2UoZSksYT1yLndvcmRzO3JldHVybiAxMzk4ODkzNjg0PT09YVswXSYmMTcwMTA3NjgzMT09PWFbMV0mJih0PVBlLmNyZWF0ZShhLnNsaWNlKDIsNCkpLGEuc3BsaWNlKDAsNCksci5zaWdCeXRlcy09MTYpLGV0LmNyZWF0ZSh7Y2lwaGVydGV4dDpyLHNhbHQ6dH0pfX0scnQ9ZnVuY3Rpb24oZSl7cyhhLGUpO3ZhciB0PWQoYSk7ZnVuY3Rpb24gYSgpe3JldHVybiByKHRoaXMsYSksdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cmV0dXJuIG4oYSxudWxsLFt7a2V5OiJlbmNyeXB0Iix2YWx1ZTpmdW5jdGlvbihlLHQscixhKXt2YXIgbj1PYmplY3QuYXNzaWduKG5ldyBDZSx0aGlzLmNmZyxhKSxpPWUuY3JlYXRlRW5jcnlwdG9yKHIsbikscz1pLmZpbmFsaXplKHQpLG89aS5jZmc7cmV0dXJuIGV0LmNyZWF0ZSh7Y2lwaGVydGV4dDpzLGtleTpyLGl2Om8uaXYsYWxnb3JpdGhtOmUsbW9kZTpvLm1vZGUscGFkZGluZzpvLnBhZGRpbmcsYmxvY2tTaXplOmkuYmxvY2tTaXplLGZvcm1hdHRlcjpuLmZvcm1hdH0pfX0se2tleToiZGVjcnlwdCIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIsYSl7dmFyIG49dCxpPU9iamVjdC5hc3NpZ24obmV3IENlLHRoaXMuY2ZnLGEpO3JldHVybiBuPXRoaXMuX3BhcnNlKG4saS5mb3JtYXQpLGUuY3JlYXRlRGVjcnlwdG9yKHIsaSkuZmluYWxpemUobi5jaXBoZXJ0ZXh0KX19LHtrZXk6Il9wYXJzZSIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4ic3RyaW5nIj09dHlwZW9mIGU/dC5wYXJzZShlLHRoaXMpOmV9fV0pLGF9KENlKTtydC5jZmc9T2JqZWN0LmFzc2lnbihuZXcgQ2Use2Zvcm1hdDp0dH0pO3ZhciBhdD17ZXhlY3V0ZTpmdW5jdGlvbihlLHQscixhKXt2YXIgbj1hO258fChuPVBlLnJhbmRvbSg4KSk7dmFyIGk9V2UuY3JlYXRlKHtrZXlTaXplOnQrcn0pLmNvbXB1dGUoZSxuKSxzPVBlLmNyZWF0ZShpLndvcmRzLnNsaWNlKHQpLDQqcik7cmV0dXJuIGkuc2lnQnl0ZXM9NCp0LGV0LmNyZWF0ZSh7a2V5OmksaXY6cyxzYWx0Om59KX19LG50PWZ1bmN0aW9uKGUpe3MoYSxlKTt2YXIgdD1kKGEpO2Z1bmN0aW9uIGEoKXtyZXR1cm4gcih0aGlzLGEpLHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiBuKGEsbnVsbCxbe2tleToiZW5jcnlwdCIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIsYSl7dmFyIG49T2JqZWN0LmFzc2lnbihuZXcgQ2UsdGhpcy5jZmcsYSksaT1uLmtkZi5leGVjdXRlKHIsZS5rZXlTaXplLGUuaXZTaXplKTtuLml2PWkuaXY7dmFyIHM9cnQuZW5jcnlwdC5jYWxsKHRoaXMsZSx0LGkua2V5LG4pO3JldHVybiBzLm1peEluKGkpLHN9fSx7a2V5OiJkZWNyeXB0Iix2YWx1ZTpmdW5jdGlvbihlLHQscixhKXt2YXIgbj10LGk9T2JqZWN0LmFzc2lnbihuZXcgQ2UsdGhpcy5jZmcsYSk7bj10aGlzLl9wYXJzZShuLGkuZm9ybWF0KTt2YXIgcz1pLmtkZi5leGVjdXRlKHIsZS5rZXlTaXplLGUuaXZTaXplLG4uc2FsdCk7cmV0dXJuIGkuaXY9cy5pdixydC5kZWNyeXB0LmNhbGwodGhpcyxlLG4scy5rZXksaSl9fV0pLGF9KHJ0KTtudC5jZmc9T2JqZWN0LmFzc2lnbihydC5jZmcse2tkZjphdH0pO2Zvcih2YXIgaXQ9W10sc3Q9W10sb3Q9W10sdXQ9W10sY3Q9W10sbHQ9W10sZnQ9W10sZHQ9W10saHQ9W10scHQ9W10sdnQ9W10seXQ9MDt5dDwyNTY7eXQrPTEpdnRbeXRdPXl0PDEyOD95dDw8MTp5dDw8MV4yODM7Zm9yKHZhciBtdD0wLGd0PTAsa3Q9MDtrdDwyNTY7a3QrPTEpe3ZhciBidD1ndF5ndDw8MV5ndDw8Ml5ndDw8M15ndDw8NDtidD1idD4+PjheMjU1JmJ0Xjk5LGl0W210XT1idCxzdFtidF09bXQ7dmFyIF90PXZ0W210XSx3dD12dFtfdF0seHQ9dnRbd3RdLFN0PTI1Nyp2dFtidF1eMTY4NDMwMDgqYnQ7b3RbbXRdPVN0PDwyNHxTdD4+PjgsdXRbbXRdPVN0PDwxNnxTdD4+PjE2LGN0W210XT1TdDw8OHxTdD4+PjI0LGx0W210XT1TdCxTdD0xNjg0MzAwOSp4dF42NTUzNyp3dF4yNTcqX3ReMTY4NDMwMDgqbXQsZnRbYnRdPVN0PDwyNHxTdD4+PjgsZHRbYnRdPVN0PDwxNnxTdD4+PjE2LGh0W2J0XT1TdDw8OHxTdD4+PjI0LHB0W2J0XT1TdCxtdD8obXQ9X3RednRbdnRbdnRbeHReX3RdXV0sZ3RePXZ0W3Z0W2d0XV0pOm10PWd0PTF9dmFyIEF0PVswLDEsMiw0LDgsMTYsMzIsNjQsMTI4LDI3LDU0XSxEdD1mdW5jdGlvbihlKXtzKGEsZSk7dmFyIHQ9ZChhKTtmdW5jdGlvbiBhKCl7cmV0dXJuIHIodGhpcyxhKSx0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gbihhLFt7a2V5OiJfZG9SZXNldCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZTtpZighdGhpcy5fblJvdW5kc3x8dGhpcy5fa2V5UHJpb3JSZXNldCE9PXRoaXMuX2tleSl7dGhpcy5fa2V5UHJpb3JSZXNldD10aGlzLl9rZXk7dmFyIHQ9dGhpcy5fa2V5UHJpb3JSZXNldCxyPXQud29yZHMsYT10LnNpZ0J5dGVzLzQ7dGhpcy5fblJvdW5kcz1hKzY7dmFyIG49NCoodGhpcy5fblJvdW5kcysxKTt0aGlzLl9rZXlTY2hlZHVsZT1bXTtmb3IodmFyIGk9dGhpcy5fa2V5U2NoZWR1bGUscz0wO3M8bjtzKz0xKXM8YT9pW3NdPXJbc106KGU9aVtzLTFdLHMlYT9hPjYmJnMlYT09NCYmKGU9aXRbZT4+PjI0XTw8MjR8aXRbZT4+PjE2JjI1NV08PDE2fGl0W2U+Pj44JjI1NV08PDh8aXRbMjU1JmVdKTooZT1pdFsoZT1lPDw4fGU+Pj4yNCk+Pj4yNF08PDI0fGl0W2U+Pj4xNiYyNTVdPDwxNnxpdFtlPj4+OCYyNTVdPDw4fGl0WzI1NSZlXSxlXj1BdFtzL2F8MF08PDI0KSxpW3NdPWlbcy1hXV5lKTt0aGlzLl9pbnZLZXlTY2hlZHVsZT1bXTtmb3IodmFyIG89dGhpcy5faW52S2V5U2NoZWR1bGUsdT0wO3U8bjt1Kz0xKXt2YXIgYz1uLXU7ZT11JTQ/aVtjXTppW2MtNF0sb1t1XT11PDR8fGM8PTQ/ZTpmdFtpdFtlPj4+MjRdXV5kdFtpdFtlPj4+MTYmMjU1XV1eaHRbaXRbZT4+PjgmMjU1XV1ecHRbaXRbMjU1JmVdXX19fX0se2tleToiZW5jcnlwdEJsb2NrIix2YWx1ZTpmdW5jdGlvbihlLHQpe3RoaXMuX2RvQ3J5cHRCbG9jayhlLHQsdGhpcy5fa2V5U2NoZWR1bGUsb3QsdXQsY3QsbHQsaXQpfX0se2tleToiZGVjcnlwdEJsb2NrIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciByPWUsYT1yW3QrMV07clt0KzFdPXJbdCszXSxyW3QrM109YSx0aGlzLl9kb0NyeXB0QmxvY2socix0LHRoaXMuX2ludktleVNjaGVkdWxlLGZ0LGR0LGh0LHB0LHN0KSxhPXJbdCsxXSxyW3QrMV09clt0KzNdLHJbdCszXT1hfX0se2tleToiX2RvQ3J5cHRCbG9jayIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIsYSxuLGkscyxvKXtmb3IodmFyIHU9ZSxjPXRoaXMuX25Sb3VuZHMsbD11W3RdXnJbMF0sZj11W3QrMV1eclsxXSxkPXVbdCsyXV5yWzJdLGg9dVt0KzNdXnJbM10scD00LHY9MTt2PGM7dis9MSl7dmFyIHk9YVtsPj4+MjRdXm5bZj4+PjE2JjI1NV1eaVtkPj4+OCYyNTVdXnNbMjU1JmhdXnJbcF07cCs9MTt2YXIgbT1hW2Y+Pj4yNF1ebltkPj4+MTYmMjU1XV5pW2g+Pj44JjI1NV1ec1syNTUmbF1ecltwXTtwKz0xO3ZhciBnPWFbZD4+PjI0XV5uW2g+Pj4xNiYyNTVdXmlbbD4+PjgmMjU1XV5zWzI1NSZmXV5yW3BdO3ArPTE7dmFyIGs9YVtoPj4+MjRdXm5bbD4+PjE2JjI1NV1eaVtmPj4+OCYyNTVdXnNbMjU1JmRdXnJbcF07cCs9MSxsPXksZj1tLGQ9ZyxoPWt9dmFyIGI9KG9bbD4+PjI0XTw8MjR8b1tmPj4+MTYmMjU1XTw8MTZ8b1tkPj4+OCYyNTVdPDw4fG9bMjU1JmhdKV5yW3BdO3ArPTE7dmFyIF89KG9bZj4+PjI0XTw8MjR8b1tkPj4+MTYmMjU1XTw8MTZ8b1toPj4+OCYyNTVdPDw4fG9bMjU1JmxdKV5yW3BdO3ArPTE7dmFyIHc9KG9bZD4+PjI0XTw8MjR8b1toPj4+MTYmMjU1XTw8MTZ8b1tsPj4+OCYyNTVdPDw4fG9bMjU1JmZdKV5yW3BdO3ArPTE7dmFyIHg9KG9baD4+PjI0XTw8MjR8b1tsPj4+MTYmMjU1XTw8MTZ8b1tmPj4+OCYyNTVdPDw4fG9bMjU1JmRdKV5yW3BdO3ArPTEsdVt0XT1iLHVbdCsxXT1fLHVbdCsyXT13LHVbdCszXT14fX1dKSxhfSgkZSk7RHQua2V5U2l6ZT04O3ZhciBCdD0kZS5fY3JlYXRlSGVscGVyKER0KSxFdD1mdW5jdGlvbihlKXtzKGEsZSk7dmFyIHQ9ZChhKTtmdW5jdGlvbiBhKCl7cmV0dXJuIHIodGhpcyxhKSx0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gbihhKX0oWWUpO0V0LkVuY3J5cHRvcj1mdW5jdGlvbihlKXtzKGEsZSk7dmFyIHQ9ZChhKTtmdW5jdGlvbiBhKCl7cmV0dXJuIHIodGhpcyxhKSx0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gbihhLFt7a2V5OiJwcm9jZXNzQmxvY2siLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9ZSxhPXRoaXMuX2NpcGhlcixuPWEuYmxvY2tTaXplLGk9dGhpcy5faXYscz10aGlzLl9jb3VudGVyO2kmJih0aGlzLl9jb3VudGVyPWkuc2xpY2UoMCkscz10aGlzLl9jb3VudGVyLHRoaXMuX2l2PXZvaWQgMCk7dmFyIG89cy5zbGljZSgwKTthLmVuY3J5cHRCbG9jayhvLDApLHNbbi0xXT1zW24tMV0rMXwwO2Zvcih2YXIgdT0wO3U8bjt1Kz0xKXJbdCt1XV49b1t1XX19XSksYX0oRXQpLEV0LkRlY3J5cHRvcj1FdC5FbmNyeXB0b3I7dmFyIFR0PXtwYWQ6ZnVuY3Rpb24oKXt9LHVucGFkOmZ1bmN0aW9uKCl7fX0sVXQ9e2RlY3J5cHRXb3JkQXJyYXk6ZnVuY3Rpb24oZSx0LHIpe3ZhciBhPUllLnBhcnNlKHQpLG49SWUucGFyc2UoYWUocikpLGk9UGUuY3JlYXRlKG5ldyBVaW50OEFycmF5KGUpKSxzPUJ0LmRlY3J5cHQoZXQuY3JlYXRlKHtjaXBoZXJ0ZXh0Oml9KSxhLHtpdjpuLG1vZGU6RXQscGFkZGluZzpUdH0pO3JldHVybiBVdC53b3JkQXJyYXlUb1VpbnQ4QXJyYXkocyl9LHdvcmRBcnJheVRvVWludDhBcnJheTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9ZS5zaWdCeXRlcyxyPWUud29yZHMsYT1uZXcgVWludDhBcnJheSh0KSxuPTAsaT0wO24hPT10Oyl7dmFyIHM9cltpKytdO2lmKGFbbisrXT0oNDI3ODE5MDA4MCZzKT4+PjI0LG49PT10KWJyZWFrO2lmKGFbbisrXT0oMTY3MTE2ODAmcyk+Pj4xNixuPT09dClicmVhaztpZihhW24rK109KDY1MjgwJnMpPj4+OCxuPT09dClicmVhazthW24rK109MjU1JnN9cmV0dXJuIGF9LGRlY29kZXJBRVNDVFJEYXRhOmZ1bmN0aW9uKGUsdCxyKXtpZihlLnZpZGVvU2VuYyl7dmFyIGE9ZS5raWRWYWx1ZSxuPWUudmlkZW9TZW5jO2Uuc2FtcGxlcy5mb3JFYWNoKChmdW5jdGlvbih0LGkpe3ZhciBzPW5baV0sbz10LmRhdGEsdT1bXSxjPVtdLGw9cy5Jbml0aWFsaXphdGlvblZlY3RvcjtpZihzLnN1YnNhbXBsZXMmJnMuc3Vic2FtcGxlcy5sZW5ndGgpcy5zdWJzYW1wbGVzLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0PWUuQnl0ZXNPZkNsZWFyRGF0YStlLkJ5dGVzT2ZQcm90ZWN0ZWREYXRhLHI9by5zbGljZSgwLHQpO3UucHVzaChyLnNsaWNlKDAsZS5CeXRlc09mQ2xlYXJEYXRhKSksYy5wdXNoKHIuc2xpY2UoZS5CeXRlc09mQ2xlYXJEYXRhKSksbz1vLnNsaWNlKHQpfSkpO2Vsc2V7dmFyIGY9dC5zaXplO3UucHVzaChvLnNsaWNlKDAsMCkpLGMucHVzaChvLnNsaWNlKDAsZikpLG89by5zbGljZShmKX12YXIgZD1uZXcgRGU7ZC53cml0ZS5hcHBseShkLGMpO3ZhciBoPXI/cihkLmJ1ZmZlcixhLGwpOlV0LmRlY3J5cHRXb3JkQXJyYXkoZC5idWZmZXIsYSxsKSxwPW5ldyBEZTt1LmZvckVhY2goKGZ1bmN0aW9uKGUsdCl7dmFyIHI9Y1t0XS5sZW5ndGgsYT1oLnNsaWNlKDAscik7cC53cml0ZShlKSxwLndyaXRlKGEpLGg9aC5zbGljZShyKX0pKSxlLnNhbXBsZXNbaV0uZGF0YT1wLmJ1ZmZlcn0pKX1pZih0LmF1ZGlvU2VuYyl7dmFyIGk9dC5raWRWYWx1ZSxzPXQuYXVkaW9TZW5jO3Quc2FtcGxlcy5mb3JFYWNoKChmdW5jdGlvbihlLGEpe3ZhciBuPXNbYV0sbz1yP3IoZS5kYXRhLGksbi5Jbml0aWFsaXphdGlvblZlY3Rvcik6VXQuZGVjcnlwdFdvcmRBcnJheShlLmRhdGEsaSxuLkluaXRpYWxpemF0aW9uVmVjdG9yKTt0LnNhbXBsZXNbYV0uZGF0YT1vfSkpfX19LEN0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LGEsbixzKXt2YXIgbz10aGlzO3IodGhpcyxlKSxpKHRoaXMsIl92aWRlb1NhbXBsZXMiLFtdKSxpKHRoaXMsIl9hdWRpb1NhbXBsZXMiLFtdKSxpKHRoaXMsIl9sYXN0UmVtYWluQnVmZmVyIixbXSksaSh0aGlzLCJfbGFzdFJlbWFpbkJ1ZmZlclN0YXJ0UG9zIiwwKSx0aGlzLnZpZGVvVHJhY2s9bmV3IHosdGhpcy5hdWRpb1RyYWNrPW5ldyBPLHRoaXMubWV0YWRhdGFUcmFjaz1ufHxuZXcgaix0aGlzLmxvZz1uZXcgVGUoIk1QNERlbXV4ZXIiLCFzfHwhcy5vcGVuTG9nfHwhcy5vcGVuTG9nKSx0JiZ0LmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0Oyh0PW8uX3ZpZGVvU2FtcGxlcykucHVzaC5hcHBseSh0LHkoZS5mcmFtZXMpKX0pKSxhJiZhLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0Oyh0PW8uX2F1ZGlvU2FtcGxlcykucHVzaC5hcHBseSh0LHkoZS5mcmFtZXMpKX0pKX1yZXR1cm4gbihlLFt7a2V5OiJwYXJzZVNhbXBsZXMiLHZhbHVlOmZ1bmN0aW9uKGUpe2lmKCFlKXRocm93IG5ldyBFcnJvcigibW9vdiBpcyByZXF1aXJlZCIpO2lmKHRoaXMudmlkZW9UcmFjay5jb2RlY3x8dGhpcy5hdWRpb1RyYWNrLmNvZGVjfHwoZ2UubW9vdlRvVHJhY2soZSx0aGlzLnZpZGVvVHJhY2ssdGhpcy5hdWRpb1RyYWNrKSx0aGlzLnZpZGVvU2VuYz10aGlzLnZpZGVvVHJhY2sudmlkZW9TZW5jLHRoaXMuYXVkaW9TZW5jPXRoaXMuYXVkaW9UcmFjay5hdWRpb1NlbmMpLCF0aGlzLl9hdWRpb1NhbXBsZXMubGVuZ3RoJiYhdGhpcy5fdmlkZW9TYW1wbGVzLmxlbmd0aCl7dmFyIHQ9Z2UubW9vdlRvU2FtcGxlcyhlKTtpZighdCl0aHJvdyBuZXcgRXJyb3IoImNhbm5vdCBwYXJzZSBzYW1wbGVzIGZyb20gbW9vdiBib3giKTt0aGlzLl92aWRlb1NhbXBsZXM9dC52aWRlb1NhbXBsZXN8fFtdLHRoaXMuX2F1ZGlvU2FtcGxlcz10LmF1ZGlvU2FtcGxlc3x8W119fX0se2tleToiZGVtdXgiLHZhbHVlOmZ1bmN0aW9uKGUsdCxyLGEsbil7dGhpcy5wYXJzZVNhbXBsZXMobik7dmFyIGkscyxvLHU9dGhpcy52aWRlb1RyYWNrLGM9dGhpcy5hdWRpb1RyYWNrO2lmKHUuc2FtcGxlcz1bXSxjLnNhbXBsZXM9W10scil7Zm9yKHZhciBsLGY9MCxkPXJbMF0saD1yWzFdO2Q8PWg7ZCsrKXtpZighKGk9dGhpcy5fdmlkZW9TYW1wbGVzW2RdKSl0aHJvdyBuZXcgRXJyb3IoImNhbm5vdCBmb3VuZCB2aWRlbyBmcmFtZSAjIi5jb25jYXQoZCkpO289aS5vZmZzZXQtdCxzPWUuc3ViYXJyYXkobyxvK2kuc2l6ZSksKGw9bmV3IFIoaS5wdHN8fGkuZHRzLGkuZHRzKSkuZHVyYXRpb249aS5kdXJhdGlvbixsLmdvcElkPWkuZ29wSWQsaS5rZXlmcmFtZSYmbC5zZXRUb0tleWZyYW1lKCk7Zm9yKHZhciBwPTAsdj1zLmxlbmd0aC0xO3A8djspZj1lZShzLHApLHArPTQsbC51bml0cy5wdXNoKHMuc3ViYXJyYXkocCxwK2YpKSxwKz1mO3Uuc2FtcGxlcy5wdXNoKGwpfXUuYmFzZU1lZGlhRGVjb2RlVGltZT11LnNhbXBsZXNbMF0uZHRzfWlmKGEpe2Zvcih2YXIgeT1hWzBdLG09YVsxXTt5PD1tO3krKyl7aWYoIShpPXRoaXMuX2F1ZGlvU2FtcGxlc1t5XSkpdGhyb3cgbmV3IEVycm9yKCJjYW5ub3QgZm91bmQgdmlkZW8gZnJhbWUgIyIuY29uY2F0KHkpKTtvPWkub2Zmc2V0LXQscz1lLnN1YmFycmF5KG8sbytpLnNpemUpLGMuc2FtcGxlcy5wdXNoKG5ldyBMKGkuZHRzLHMsaS5kdXJhdGlvbikpfWMuYmFzZU1lZGlhRGVjb2RlVGltZT1jLnNhbXBsZXNbMF0uZHRzfXJldHVybnt2aWRlb1RyYWNrOnUsYXVkaW9UcmFjazpjLG1ldGFkYXRhVHJhY2s6dGhpcy5tZXRhZGF0YVRyYWNrfX19LHtrZXk6ImRlbXV4UGFydCIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIsYSxuLGkscyxvKXtpZih0aGlzLnBhcnNlU2FtcGxlcyhuKSx0aGlzLnZpZGVvVHJhY2sudXNlRU1FPWksdGhpcy5hdWRpb1RyYWNrLnVzZUVNRT1pLHRoaXMuX2xhc3RSZW1haW5CdWZmZXImJnRoaXMuX2xhc3RSZW1haW5CdWZmZXIuYnl0ZUxlbmd0aD4wJiZ0PnRoaXMuX2xhc3RSZW1haW5CdWZmZXJTdGFydFBvcyYmdDw9dGhpcy5fbGFzdFJlbWFpbkJ1ZmZlclN0YXJ0UG9zK3RoaXMuX2xhc3RSZW1haW5CdWZmZXIuYnl0ZUxlbmd0aClmb3IodmFyIHU9MDt1PDIwOyl0cnl7dmFyIGM9dGhpcy5fbGFzdFJlbWFpbkJ1ZmZlci5zdWJhcnJheSgwLHQtdGhpcy5fbGFzdFJlbWFpbkJ1ZmZlclN0YXJ0UG9zKSxsPW5ldyBVaW50OEFycmF5KGUuYnl0ZUxlbmd0aCtjLmJ5dGVMZW5ndGgpO2wuc2V0KGMsMCksbC5zZXQobmV3IFVpbnQ4QXJyYXkoZSksYy5ieXRlTGVuZ3RoKSxlPWwsdC09Yy5ieXRlTGVuZ3RoLHRoaXMuX2xhc3RSZW1haW5CdWZmZXI9bnVsbCx0aGlzLl9sYXN0UmVtYWluQnVmZmVyU3RhcnRQb3M9MDticmVha31jYXRjaChCKXtpZighKHU8MjApKXRocm93IG5ldyBFcnJvcigibmV3IFVpbnQ4QXJyYXkgZXJyb3I6LCIrQi5lcnJvck1lc3NhZ2UpO3UrK312YXIgZixkLGgscD10aGlzLnZpZGVvVHJhY2ssdj10aGlzLmF1ZGlvVHJhY2s7cC5zYW1wbGVzPVtdLHYuc2FtcGxlcz1bXSxwLnZpZGVvU2VuYz1udWxsLHYuYXVkaW9TZW5jPW51bGw7dmFyIHk9MCxtPTA7aWYodGhpcy5fdmlkZW9TYW1wbGVzLmxlbmd0aD4wJiZyLmxlbmd0aD4wKXtmb3IodmFyIGcsaz1lLmJ5dGVMZW5ndGgrdCxiPXJbMF07Yjw9clsxXTtiKyspe2lmKCEoZj10aGlzLl92aWRlb1NhbXBsZXNbYl0pKXRocm93IG5ldyBFcnJvcigiY2Fubm90IGZvdW5kIHZpZGVvIGZyYW1lICMiLmNvbmNhdChiKSk7Zi5vZmZzZXQ+PXQmJmYub2Zmc2V0K2Yuc2l6ZTw9ayYmKHk9KGg9Zi5vZmZzZXQtdCkrZi5zaXplLGQ9ZS5zdWJhcnJheShoLHkpLChnPW5ldyBSKGYucHRzfHxmLmR0cyxmLmR0cykpLmR1cmF0aW9uPWYuZHVyYXRpb24sZy5nb3BJZD1mLmdvcElkLGcuc2FtcGxlT2Zmc2V0PWYuaW5kZXgsZi5rZXlmcmFtZSYmZy5zZXRUb0tleWZyYW1lKCksZy5kYXRhPWQsZy5zaXplPWYuc2l6ZSxwLnNhbXBsZXMucHVzaChnKSl9cC5zYW1wbGVzLmxlbmd0aD4wJiYocC5nb3BJZD1wLnNhbXBsZXNbMF0uZ29wSWQscC5iYXNlTWVkaWFEZWNvZGVUaW1lPXAuc2FtcGxlc1swXS5kdHMscC5zdGFydFB0cz1wLnNhbXBsZXNbMF0ucHRzL3AudGltZXNjYWxlLHAuZW5kUHRzPXAuc2FtcGxlc1twLnNhbXBsZXMubGVuZ3RoLTFdLnB0cy9wLnRpbWVzY2FsZSx0aGlzLnZpZGVvU2VuYyYmKHAudmlkZW9TZW5jPXRoaXMudmlkZW9TZW5jLnNsaWNlKHAuc2FtcGxlc1swXS5zYW1wbGVPZmZzZXQscC5zYW1wbGVzWzBdLnNhbXBsZU9mZnNldCtwLnNhbXBsZXMubGVuZ3RoKSxwLmtpZFZhbHVlPXMpKX1pZih0aGlzLl9hdWRpb1NhbXBsZXMubGVuZ3RoPjAmJmEubGVuZ3RoPjApe2Zvcih2YXIgXz1hWzBdO188PWFbMV07XysrKXtpZighKGY9dGhpcy5fYXVkaW9TYW1wbGVzW19dKSl0aHJvdyBuZXcgRXJyb3IoImNhbm5vdCBmb3VuZCB2aWRlbyBmcmFtZSAjIi5jb25jYXQoXykpO2Yub2Zmc2V0Pj10JiZmLm9mZnNldCtmLnNpemU8PWUuYnl0ZUxlbmd0aCt0JiYobT0oaD1mLm9mZnNldC10KStmLnNpemUsZD1lLnN1YmFycmF5KGgsbSksdi5zYW1wbGVzLnB1c2gobmV3IEwoZi5kdHMsZCxmLmR1cmF0aW9uLGYuaW5kZXgpKSl9di5zYW1wbGVzLmxlbmd0aD4wJiYodi5nb3BJZD12LnNhbXBsZXNbMF0uZ29wSWR8fHAuZ29wSWQsdi5iYXNlTWVkaWFEZWNvZGVUaW1lPXYuc2FtcGxlc1swXS5kdHMsdi5zdGFydFB0cz12LnNhbXBsZXNbMF0ucHRzL3YudGltZXNjYWxlLHYuZW5kUHRzPXYuc2FtcGxlc1t2LnNhbXBsZXMubGVuZ3RoLTFdLnB0cy92LnRpbWVzY2FsZSx0aGlzLmF1ZGlvU2VuYyYmKHYuYXVkaW9TZW5jPXRoaXMuYXVkaW9TZW5jLnNsaWNlKHYuc2FtcGxlc1swXS5zYW1wbGVPZmZzZXQsdi5zYW1wbGVzWzBdLnNhbXBsZU9mZnNldCt2LnNhbXBsZXMubGVuZ3RoKSx2LmtpZFZhbHVlPXMpKX10aGlzLmRlY29kZXJEYXRhKHAsdixvKTtmb3IodmFyIHc9MCx4PTA7eDxwLnNhbXBsZXMubGVuZ3RoO3grKylmb3IodmFyIFM9MCxBPXAuc2FtcGxlc1t4XS5kYXRhLEQ9QS5sZW5ndGgtMTtTPEQ7KXc9ZWUoQSxTKSxTKz00LHAuc2FtcGxlc1t4XS51bml0cy5wdXNoKEEuc3ViYXJyYXkoUyxTK3cpKSxTKz13O3JldHVybiB0aGlzLl9sYXN0UmVtYWluQnVmZmVyPWUuc3ViYXJyYXkoTWF0aC5tYXgoeSxtKSksdGhpcy5fbGFzdFJlbWFpbkJ1ZmZlci5ieXRlTGVuZ3RoPjA/dGhpcy5fbGFzdFJlbWFpbkJ1ZmZlclN0YXJ0UG9zPXQrZS5ieXRlTGVuZ3RoLXRoaXMuX2xhc3RSZW1haW5CdWZmZXIuYnl0ZUxlbmd0aDp0aGlzLl9sYXN0UmVtYWluQnVmZmVyU3RhcnRQb3M9MCx7dmlkZW9UcmFjazpwLGF1ZGlvVHJhY2s6dixtZXRhZGF0YVRyYWNrOnRoaXMubWV0YWRhdGFUcmFja319fSx7a2V5OiJyZXNldCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl92aWRlb1NhbXBsZXM9W10sdGhpcy5fYXVkaW9TYW1wbGVzPVtdLHRoaXMuX2xhc3RSZW1haW5CdWZmZXI9bnVsbCx0aGlzLl9sYXN0UmVtYWluQnVmZmVyU3RhcnRQb3M9MCx0aGlzLnZpZGVvVHJhY2sucmVzZXQoKSx0aGlzLmF1ZGlvVHJhY2sucmVzZXQoKSx0aGlzLm1ldGFkYXRhVHJhY2sucmVzZXQoKX19LHtrZXk6ImRlY29kZXJEYXRhIix2YWx1ZTpmdW5jdGlvbihlLHQscil7ZS51c2VFTUV8fHQudXNlRU1FfHxVdC5kZWNvZGVyQUVTQ1RSRGF0YShlLHQscil9fV0sW3trZXk6InByb2JlIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZ2UucHJvYmUoZSl9fV0pLGV9KCksUHQ9e25vd1RpbWU6ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIHBhcnNlSW50KHBlcmZvcm1hbmNlLm5vdygpLDEwKX1jYXRjaChlKXtyZXR1cm4obmV3IERhdGUpLmdldFRpbWUoKX19LGNvbmNhdERhdGE6ZnVuY3Rpb24oZSx0KXt2YXIgcj1bXSxhPTA7ZSYmci5wdXNoKGUpLHQmJnIucHVzaCh0KSxyLmV2ZXJ5KChmdW5jdGlvbihlKXtyZXR1cm4gZSYmKGErPWUuYnl0ZUxlbmd0aCksITB9KSk7dmFyIG49bmV3IFVpbnQ4QXJyYXkoYSksaT0wO3JldHVybiByLmV2ZXJ5KChmdW5jdGlvbihlKXtyZXR1cm4gZSYmKG4uc2V0KGUsaSksaSs9ZS5ieXRlTGVuZ3RoKSwhMH0pKSxufX07b25tZXNzYWdlPWZ1bmN0aW9uKGUpe3ZhciByPWUuZGF0YTtzd2l0Y2goci5tZXRob2Qpe2Nhc2UiaW5pdCI6dGhpcy5jb2RlY1R5cGU9ci5hcmdzLmNvZGVjVHlwZSx0aGlzLm9wZW5sb2c9ci5hcmdzLm9wZW5Mb2csdGhpcy5NUDREZW11eGVyPW51bGwsdGhpcy5GTVA0UmVtdXhlcj1udWxsLHRoaXMuX25lZWRJbml0U2VnbWVudD0hMCx0aGlzLnN1cHBvcnRIZXZjPXIuYXJncy5zdXBwb3J0SGV2YzticmVhaztjYXNlInRyYW5zbXV4Ijp2YXIgYT1lLmRhdGEuYXJncyxuPW5ldyBVaW50OEFycmF5KGUuZGF0YS5idWZmZXIpO3RoaXMuTVA0RGVtdXhlcnx8KHRoaXMuTVA0RGVtdXhlcj1uZXcgQ3QobnVsbCxudWxsLG51bGwse29wZW5sb2c6dGhpcy5vcGVubG9nfSkpO3ZhciBpLHM9dGhpcy5NUDREZW11eGVyLmRlbXV4UGFydChuLGEuc3RhcnQsYS52aWRlb0lkeCxhLmF1ZGlvSWR4LGEubW9vdixhLnVzZUVNRSxhLmtpZFZhbHVlKTtpZih0aGlzLkZNUDRSZW11eGVyfHwiaDI2NSI9PT10aGlzLmNvZGVjVHlwZSYmIXRoaXMuc3VwcG9ydEhldmN8fCh0aGlzLkZNUDRSZW11eGVyPW5ldyBVZSh0aGlzLk1QNERlbXV4ZXIudmlkZW9UcmFjayx0aGlzLk1QNERlbXV4ZXIuYXVkaW9UcmFjayx7b3BlbkxvZzp0aGlzLm9wZW5sb2d9KSksdGhpcy5GTVA0UmVtdXhlcil7dmFyIG89dGhpcy5GTVA0UmVtdXhlci5yZW11eCh0aGlzLl9uZWVkSW5pdFNlZ21lbnQse2luaXRNZXJnZTohMH0pO28uaW5pdFNlZ21lbnQmJih0aGlzLl9uZWVkSW5pdFNlZ21lbnQ9ITEpLGk9e2J1ZmZlcjpQdC5jb25jYXREYXRhKG8uYXVkaW9TZWdtZW50LG8udmlkZW9TZWdtZW50KSxyYW5nZTphLmNvbnRleHQucmFuZ2Usc3RhdGU6YS5jb250ZXh0LnN0YXRlLGNvbnRleHQ6e3JhbmdlOmEuY29udGV4dC5yYW5nZSxmcmFnSW5kZXg6YS5jb250ZXh0LmZyYWdJbmRleCxzdGFydFB0czpNYXRoLm1pbihzLnZpZGVvVHJhY2suc3RhcnRQdHMscy5hdWRpb1RyYWNrLnN0YXJ0UHRzKSxlbmRQdHM6TWF0aC5tYXgocy52aWRlb1RyYWNrLmVuZFB0cyxzLmF1ZGlvVHJhY2suZW5kUHRzKX0saW5pdFNlZzpvLmluaXRTZWdtZW50fX10aGlzLnBvc3RNZXNzYWdlKHttZXRob2Q6InRyYW5zbXV4IixpZDplLmRhdGEuaWQsYXJnczp0KHt9LGkpfSk7YnJlYWs7Y2FzZSJyZXNldCI6dGhpcy5GTVA0UmVtdXhlciYmdGhpcy5GTVA0UmVtdXhlci5yZXNldCgpLHRoaXMuTVA0RGVtdXhlciYmdGhpcy5NUDREZW11eGVyLnJlc2V0KCksdGhpcy5GTVA0UmVtdXhlcj1udWxsLHRoaXMuTVA0RGVtdXhlcj1udWxsLHRoaXMuX25lZWRJbml0U2VnbWVudD0hMH19fSgpOwo=",kn=typeof window<"u"&&window.Blob&&new Blob([atob(Xr)],{type:"text/javascript;charset=utf-8"});function wo(){var r=kn&&(window.URL||window.webkitURL).createObjectURL(kn);try{return r?new Worker(r,{}):new Worker("data:application/javascript;base64,"+Xr,{type:"module"})}finally{r&&(window.URL||window.webkitURL).revokeObjectURL(r)}}var Vo=function(r){gs(t,r);var a=Zs(t);function t(i){var e;return Rt(this,t),e=a.call(this),e.openlog=i.openLog,e.codecType=i.codecType,e.supportHevc=i.supportHevc,e.worker=new wo,e.worker.onmessage=function(s){e.emit(s.data.method,s.data)},e.worker.postMessage({method:"init",id:i.id||0,args:{openlog:e.openlog,supportHevc:e.supportHevc,codecType:e.codecType}}),e}return Tt(t,[{key:"transmux",value:function(e,s,n,l,o,u,h,d,c){var f=s.buffer;this.worker&&this.worker.postMessage({method:"transmux",id:e,buffer:f,args:{start:n,videoIdx:l,audioIdx:o,moov:u,useEME:h,kidValue:d,context:c}},[f])}},{key:"reset",value:function(){this.worker&&this.worker.postMessage({method:"reset"})}},{key:"destroy",value:function(){this.worker&&this.worker.terminate()}}]),t}(vt),Me={ERROR:"error",META_READY:"metaReady",MOOV_REQ_PROGRESS:"moov_request_Progress",UPDATE_LOAD_IDX:"update_load_fragmentIdx"},Ro=function(r){gs(t,r);var a=Zs(t);function t(i,e){var s;if(Rt(this,t),s=a.call(this),ze(Le(s),"onprogressDataArrive",function(){var n=we(ie().mark(function l(o,u,h){var d;return ie().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:o&&o.byteLength>0&&(d=s.timeRange[h.index].range,d&&h.range[1]>=d[1]&&!u&&(u=!0),s.log("[mp4.loadFragment onprogressDataArrive ] receive data, >>> index,",h.index,",range,",JSON.stringify(h.range),", dataLen,",o.byteLength),s._mux(o,h.range[0],h.index,u)),u&&(s.timeRange[h.index].downloaded=!0,s.bufferLoadedPos=-1,s.log("[FragLoadDowned],fragmentIdx,",h.index,",rangeEnd,",h.range[1]));case 2:case"end":return f.stop()}},l)}));return function(l,o,u){return n.apply(this,arguments)}}()),s.url=i,s.options=t.getDefaultConfig(),Object.keys(e).map(function(n){e[n]!==void 0&&e[n]!==null&&(s.options[n]=e[n])}),s.timeRange=[],s.CHUNK_SIZE=s.options.chunkSize,s.bufferLoaded=new Uint8Array(0),s.bufferLoadedPos=0,s.meta=null,s.videoTrak=null,s.audioTrak=null,s.canDownload=!0,s._loadSuccessCallBack=null,s._isPending=!1,s._metaLoading=!1,s.MP4Loader=new So(mt(mt({segmentDuration:s.options.segmentDuration,url:i,vid:e.vid,retry:s.options.retryCount,retryDelay:s.options.retryDelay,timeout:s.options.timeout},e.reqOptions),{},{openLog:Nt()})),s.fMP4Demuxer=null,s.MP4Demuxer=null,s.FMP4Remuxer=null,s._needInitSegment=!0,s._switchBitRate=!1,s.enableWorker=s.options.enableWorker,s.enableWorker&&typeof Worker<"u")try{s.workerSequence=0,s.transmuxerWorkerControl=new Vo({id:s.workerSequence,codecType:e.codecType,supportHevc:s.options.supportHevc,openLog:Nt()}),s.transmuxerWorkerControl.on("transmux",function(n){var l=n.args;s.log("[transmuxerworker end] ,range, ",JSON.stringify(l.range),",dataLen,",l.buffer.byteLength,l.context),s._loadSuccessCallBack&&s._loadSuccessCallBack(l)})}catch(n){s.log("Error in worker:",n),s.enableWorker=!1,s.transmuxerWorkerControl=null}return s.enableWorker||(s.MP4Demuxer=null,s.FMP4Remuxer=null),s.seekTime=-1,s.changeBitRateTime=-1,s}return Tt(t,[{key:"changeBitRate",value:function(){var i=we(ie().mark(function s(n){return ie().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.url=n.url,o.next=3,this.MP4Loader.changeUrl(this.url,this.options.vid+Date.now(),this.CHUNK_SIZE);case 3:this._switchBitRate=!0,this.log("[switchBitrate] changeUrl, bitRate,",this.url);case 5:case"end":return o.stop()}},s,this)}));function e(s){return i.apply(this,arguments)}return e}()},{key:"log",value:function(e){for(var s=this.options,n=s&&s.vid?"[MP4] ".concat(s.vid," ").concat(e):"[MP4] ".concat(e),l=arguments.length,o=new Array(l>1?l-1:0),u=1;u<l;u++)o[u-1]=arguments[u];Er.apply(void 0,[n].concat(o))}},{key:"errorHandler",value:function(){var i=we(ie().mark(function s(n,l){var o,u,h,d;return ie().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:o=n.response,u=n.message,h=this.options?this.options.vid:"",d=null,this._isPending=!0,o?(d=new eo("network",o.status,{httpText:o.httpText,message:u,url:o.url}),this.emit(Me.ERROR,d)):(console.log("[MP4] [".concat(h,"] errorHandler,"),n),d=n,this.emit(Me.ERROR,d));case 6:case"end":return f.stop()}},s,this)}));function e(s,n){return i.apply(this,arguments)}return e}()},{key:"init",value:function(){var i=we(ie().mark(function s(){return ie().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!this.url){l.next=3;break}return l.next=3,this.MP4Loader.changeUrl(this.url,this.options.vid+Date.now(),this.CHUNK_SIZE);case 3:return l.next=5,this.getMetaInfo();case 5:case"end":return l.stop()}},s,this)}));function e(){return i.apply(this,arguments)}return e}()},{key:"getTimeRange",value:function(){for(var e=[],s=null,n=0;this.videoTrak&&n<this.videoTrak.length;n++)s={startTime:this.videoTrak[n].startTime,endTime:this.videoTrak[n].endTime,downloaded:!1,isLoading:!1},e.push(s);if(this.audioTrak&&this.audioTrak.length>e.length)for(var l=e.length;l<this.audioTrak.length;l++)s={startTime:Math.max(this.audioTrak[l].startTime,s?s.endTime:0),endTime:Math.max(this.audioTrak[l].endTime,s?s.endTime:0),downloaded:!1,isLoading:!1},e.push(s);return e}},{key:"getMetaInfo",value:function(){var i=we(ie().mark(function s(){var n=this,l,o,u,h=arguments;return ie().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return l=h.length>0&&h[0]!==void 0?h[0]:!0,c.prev=1,this._metaLoading=!0,this.log("getMetaInfo start"),this.bufferLoaded=new Uint8Array(0),o=0,u=function(){var f=we(ie().mark(function y(g,b,S){var G;return ie().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:n.log("getMetaInfo onProgressHandle, dataLen,",g?g.byteLength:-1,", state,",b,",range,",JSON.stringify(S.range)),g&&S.range[0]===o&&(n.bufferLoaded=ql(Uint8Array,n.bufferLoaded,new Uint8Array(g)),o+=g.byteLength),S.meta&&!n.meta&&(G=S.meta,n.videoTrak=G.videoSegments,n.audioTrak=G.audioSegments,n.timeRange=n.getTimeRange(),n.meta=mt(mt({},G.meta),{},{ext:{videoTrak:n.videoTrak,audioTrak:n.audioTrak}}),G.bufferLoaded=n.bufferLoaded,n.log("meta reach"),l&&n.emit(Me.META_READY,n.meta)),n.meta&&b&&(n.log("[getMetaInfo req end]"),n._metaLoading=!1),n.meta&&(g||b)&&(n.log("emit moov_req_progress"),n.emit(Me.MOOV_REQ_PROGRESS));case 5:case"end":return L.stop()}},y)}));return function(g,b,S){return f.apply(this,arguments)}}(),c.next=9,this.MP4Loader.loadMetaProcess(this.MP4Loader.cache,[0,this.CHUNK_SIZE],u);case 9:c.next=15;break;case 11:c.prev=11,c.t0=c.catch(1),console.error("[MP4] trigger errorHandler getMetaInfo",c.t0===null||c.t0===void 0?void 0:c.t0.message),this.loadError(c.t0,"getMetaInfo");case 15:case"end":return c.stop()}},s,this,[[1,11]])}));function e(){return i.apply(this,arguments)}return e}()},{key:"getFragmentIdx",value:function(e){var s,n;if(this.videoTrak.length){if(s=this.videoTrak.find(function(o){return o.startTime<=e&&o.endTime>e}),n=this.audioTrak.find(function(o){return o.startTime<=e&&o.endTime>e}),s&&n)return Math.min(s.index,n.index);if(s||n)return s?s.index:n.index;var l=Number.MAX_VALUE;return this.videoTrak&&this.videoTrak.length>0&&(l=this.videoTrak.length-1),this.audioTrak&&this.audioTrak.length>0&&(l=Math.min(this.audioTrak.length-1,l)),l}else return n=this.audioTrak.find(function(o){return o.startTime<=e&&o.endTime>e}),n?n.index:0}},{key:"_checkHasMeta",value:function(){var i=we(ie().mark(function s(){var n;return ie().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.log(" loadMeta start"),this._metaLoading=!0,o.next=4,this.MP4Loader.loadMeta(this.MP4Loader.cache,Math.round(this.CHUNK_SIZE/2));case 4:return n=o.sent,this._metaLoading=!1,this.videoTrak=n.videoSegments,this.audioTrak=n.audioSegments,this.meta=mt(mt({},n.meta),{},{ext:{videoTrak:this.videoTrak,audioTrak:this.audioTrak}}),this.timeRange=this.getTimeRange(),this.bufferLoaded=new Uint8Array(0),n.bufferLoaded=this.bufferLoaded,o.abrupt("return",!0);case 13:case"end":return o.stop()}},s,this)}));function e(){return i.apply(this,arguments)}return e}()},{key:"resetFragmentLoadState",value:function(e){for(var s=0;s<this.timeRange.length;s++)s<e?(this.timeRange[s].downloaded=!0,this.timeRange[s].isLoading=!0):(this.timeRange[s].downloaded=!1,this.timeRange[s].isLoading=!1)}},{key:"getFragRange",value:function(e){var s,n,l,o,u=null;this.videoTrak&&(u=e<this.videoTrak.length?this.videoTrak[e]:this.videoTrak[this.videoTrak.length-1]);var h=null;this.audioTrak&&(h=e<this.audioTrak.length?this.audioTrak[e]:this.audioTrak[this.audioTrak.length-1]);var d=0,c=0;this.videoTrak&&e>=this.videoTrak.length-1&&(d=-1),this.audioTrak&&e>=this.audioTrak.length-1&&(c=-1);var f=[Math.min(((s=u)===null||s===void 0?void 0:s.range[0])||1/0,((n=h)===null||n===void 0?void 0:n.range[0])||1/0),Math.max(((l=u)===null||l===void 0?void 0:l.range[1])+d||0,((o=h)===null||o===void 0?void 0:o.range[1])+c||0)];return e<this.timeRange.length&&(this.timeRange[e].range=f),f}},{key:"load",value:function(){var i=we(ie().mark(function s(n,l){var o,u,h;return ie().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(this._loadSuccessCallBack=l,!(this._switchBitRate&&!this._metaLoading)){c.next=12;break}return this.log("[switchBitrate], switch bitRate start load, time,",n>=this.videoTrak.length?this.audioTrak[n].startTime:this.videoTrak[n].startTime,", fragIndex,",n),c.next=5,this._checkHasMeta();case 5:o=c.sent,this.changeBitRateTime>0&&(this.timeRange[n].startTime<=this.changeBitRateTime&&this.changeBitRateTime<this.timeRange[n].endTime?this.log("[switchBitrate], not need update load fragIndex",n,",stTime,",this.changeBitRateTime):(n=this.getFragmentIdx(this.changeBitRateTime),this.log("[switchBitrate], need update load fragIndex",n,",stTime,",this.changeBitRateTime,",newBitrateTimeRange,",this.timeRange[n].startTime,"-",this.timeRange[n].endTime),this.emit(Me.UPDATE_LOAD_IDX,n)),this.seekTime=this.changeBitRateTime,this.changeBitRateTime=-1),this.resetFragmentLoadState(n),this.log("[switchBitrate], reset timerange state,",n),this._needInitSegment=!0,this.resetTansmuxer(),o&&(this._switchBitRate=!1);case 12:if(!(this._switchBitRate&&this._metaLoading)){c.next=14;break}return c.abrupt("return");case 14:u=this.getFragRange(n),this.log("loadFragment,",n,",range,",JSON.stringify(u)),this.seekTime>0?(h=this.getSubRange(n,this.seekTime,u),this.loadFragment(n,h),this.seekTime=-1):this.loadFragment(n,u);case 17:case"end":return c.stop()}},s,this)}));function e(s,n){return i.apply(this,arguments)}return e}()},{key:"getSubRange",value:function(e,s,n){var l=n[0],o=n[0],u=1,h=!1;if(this.log(">>>>>getSubRange time,",s,JSON.stringify(n)),this.videoTrak){var d=e<this.videoTrak.length?this.videoTrak[e]:this.videoTrak[this.videoTrak.length-1];if(d.frames.length===0)return this.log(">>>>>getSubRange video, no frames"),n;var c=d.frames.filter(To),f=this.meta.videoTimescale,y=c[0].startTime/f;this.log(">>>>>getSubRange video, startTime,",d.startTime,",endTime,",d.endTime);for(var g=0;g<c.length;g++)this.log(">>>>>getSubRange video keyFrameList, startTime,",c[g].startTime/f,",range,",c[g].offset);for(;u<c.length;u++){var b=c[u].startTime/f;if(y<=s&&s<b&&n[0]<c[u-1].offset){l=c[u-1].offset,h=!0,this.log(">>>>>getSubRange video end, startTime,",y,",endTime,",b,",startRange,",l,", keyFrameIndex,",u-1);break}y=b}!h&&y<=s&&s<d.endTime+.8&&(l=c[u-1].offset,this.log(">>>>>getSubRange video last, startTime,",y,",endTime,",d.endTime,",startRange,",l))}if(u=1,this.audioTrak){var S=e<this.audioTrak.length?this.audioTrak[e]:this.audioTrak[this.audioTrak.length-1];if(S.frames.length===0)return this.log(">>>>>getSubRange video, no frames"),n;var G=S.frames,X=this.meta.audioTimescale;u=Math.floor((s*X-G[0].startTime)/S.frames[0].duration),u=Math.min(G.length-1,u);for(var L=u>0?G[u-1].startTime/X:G[0].startTime/X;u>=0&&u<G.length;){if(u>0&&L>s){u-=1,L=G[u].startTime/X;continue}var k=(G[u].startTime+G[u].duration)/X;if(L<=s&&s<k&&n[0]<G[u].offset){o=G[u].offset,h=!0,this.log(">>>>>getSubRange audio end, startTime,",L,",endTime,",k,",startRange,",o,", index,",u);break}L=k,u++}}var W=[Math.min(o,l),n[1]];return this.log(">>>>>getSubRange finalRange ",JSON.stringify(W),",oldRange,",JSON.stringify(n)),W}},{key:"_mux",value:function(e,s,n,l){var o=this.getSamplesRange(n,"video"),u=this.getSamplesRange(n,"audio"),h=[s,s+e.byteLength];if(this.transmuxerWorkerControl&&!this.meta.isFragmentMP4){var d={range:h,state:l,fragIndex:n};this.log("[transmuxerworker start] ,range, ",JSON.stringify(h),",dataLen,",e.byteLength,d),this.transmuxerWorkerControl.transmux(this.workerSequence,e,s,o,u,this.meta.moov,this.useEME,this.kidValue,d)}else try{var c;this.meta.isFragmentMP4?(this.fMP4Demuxer||(this.fMP4Demuxer=new $n),c=this.fMP4Demuxer.demuxPart(e,s,this.meta.moov)):(this.MP4Demuxer||(this.MP4Demuxer=new al(this.videoTrak,this.audioTrak,null,{openLog:Nt()})),c=this.MP4Demuxer.demuxPart(e,s,o,u,this.meta.moov,this.useEME,this.kidValue)),!this.FMP4Remuxer&&(!this.checkCodecH265()||this.options.supportHevc)&&(this.FMP4Remuxer=new vs(c.videoTrack,c.audioTrack,{openLog:Nt()}));var f;this.log("[mux], videoTimeRange,",c.videoTrack?[c.videoTrack.startPts,c.videoTrack.endPts]:null,",audioTimeRange,",c.audioTrack?[c.audioTrack.startPts,c.audioTrack.endPts]:null);var y=Math.min(c.videoTrack.startPts,c.audioTrack.startPts),g=Math.max(c.videoTrack.endPts,c.audioTrack.endPts),b=[y,g];if(this.FMP4Remuxer){var S=this.FMP4Remuxer.remux(this._needInitSegment,{initMerge:!0,range:h});S.initSegment&&(this._needInitSegment=!1);var G=et.concatData(S.audioSegment,S.videoSegment);f={buffer:G,range:h,state:l,context:{range:h,fragIndex:n,timeRange:b},initSeg:S.initSegment}}else f={videoTrack:c.videoTrack,audioTrack:c.audioTrack,buffer:null,range:h,state:l,context:{range:h,fragIndex:n,timeRange:b}};this._loadSuccessCallBack&&this._loadSuccessCallBack(f)}catch(L){console.error("mux err:",L);var X=new to(It.remux,qe.muxError,{msg:JSON.stringify(L)});this.errorHandler(X,"mux",{fragIndex:n,range:[s,s+e.byteLength]})}}},{key:"getSamplesRange",value:function(e,s){var n=[];switch(s){case"video":if(this.videoTrak&&e<this.videoTrak.length){var l=this.videoTrak[e].frames;if(!l.length)break;n.push(l[0].index),n.push(l[l.length-1].index)}break;case"audio":if(this.audioTrak&&e<this.audioTrak.length){var o=this.audioTrak[e].frames;if(!o.length)break;n.push(o[0].index),n.push(o[o.length-1].index)}break;default:console.warn("[getSamplesRange] type ",s," is invalid");break}return n}},{key:"loadFragment",value:function(){var i=we(ie().mark(function s(n,l){var o,u,h,d;return ie().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(this._isPending||l.length>0&&l[0]===0&&l[1]===0||this.timeRange[n].isLoading)){f.next=2;break}return f.abrupt("return");case 2:if(this.log("[MP4.loadFragment] ,fragIndex,",n,",range ",l,",len ,",l[1]-l[0],", bufferLoaded_Len,",this.bufferLoaded.byteLength),!(l.length>=2&&l[1]&&l[1]>0&&l[1]<=this.bufferLoaded.byteLength)){f.next=13;break}this.timeRange[n].isLoading=!0,o=Math.max(l[0],this.bufferLoadedPos),u=new Uint8Array(this.bufferLoaded.slice(o,l[1])),this.log("[mp4.loadFragment] has all data: ",o,l[1]),this.timeRange[n].downloaded=!0,this.bufferLoadedPos=-1,this._mux(u,o,n,!0),f.next=34;break;case 13:if(!(l.length>=2&&l[0]&&l[0]<=this.bufferLoaded.byteLength)){f.next=29;break}if(this.timeRange[n].isLoading){f.next=27;break}if(h=Math.max(l[0],this.bufferLoadedPos),d=new Uint8Array(this.bufferLoaded.slice(h,l[1])),!(d.byteLength>0)){f.next=22;break}return this.bufferLoadedPos=h+d.byteLength,this.log("[mp4.loadFragment] has part data: ",h,h+d.byteLength),this._mux(d,h,n,l[1]<=this.bufferLoadedPos),f.abrupt("return");case 22:if(!(!this._metaLoading&&!this.timeRange[n].isLoading)){f.next=27;break}return this.log("[mp4.loadFragment] ready to load part data >>> ",this.bufferLoaded.byteLength,l[1]),this.timeRange[n].isLoading=!0,f.next=27,this.startLoad([this.bufferLoaded.byteLength,l[1]],n);case 27:f.next=34;break;case 29:if(!((!this._metaLoading||l[0]>=this.CHUNK_SIZE)&&!this.timeRange[n].isLoading)){f.next=34;break}return this.timeRange[n].isLoading=!0,this.log("[mp4.loadFragment],ready to load all data ,segmentIdx, ",n,",range >>> ",JSON.stringify(l)),f.next=34,this.startLoad(l,n);case 34:case"end":return f.stop()}},s,this)}));function e(s,n){return i.apply(this,arguments)}return e}()},{key:"startLoad",value:function(){var i=we(ie().mark(function s(n,l){return ie().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.next=3,this.MP4Loader.loadData(n,this.MP4Loader.cache,{index:l,onProgress:this.onprogressDataArrive,onProcessMinLen:this.options.onProcessMinLen});case 3:u.next=9;break;case 5:u.prev=5,u.t0=u.catch(0),console.error("[MP4] trigger errorHandler getMetaInfo",u.t0===null||u.t0===void 0?void 0:u.t0.message),this.loadError(u.t0,"loadFragment",{range:n,fragIndex:l});case 9:case"end":return u.stop()}},s,this,[[0,5]])}));function e(s,n){return i.apply(this,arguments)}return e}()},{key:"loadError",value:function(e,s,n){var l;!e.response&&(e.response={}),e.isTimeout?e.response.status="timeout":e!=null&&(l=e.response)!==null&&l!==void 0&&l.status||(e.response.status="networkError"),this.errorHandler(e,s,n)}},{key:"cancelLoading",value:function(){var i=we(ie().mark(function s(){return ie().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.MP4Loader;case 2:if(l.t0=l.sent,!l.t0){l.next=5;break}this.MP4Loader.cancel();case 5:case"end":return l.stop()}},s,this)}));function e(){return i.apply(this,arguments)}return e}()},{key:"update",value:function(e){this.url=e}},{key:"checkCodecH265",value:function(){var e=this.meta&&(this.meta.videoCodec.indexOf("hvc1")>-1||this.meta.videoCodec.indexOf("hev1")>-1);return e}},{key:"destroy",value:function(){this.hasDestroyed||(this.resetTansmuxer(),this.transmuxerWorkerControl&&this.transmuxerWorkerControl.destroy(),this._isPending=!1,this._metaLoading=!1,this.bufferLoadedPos=0,this.bufferLoaded=new Uint8Array(0),this.MP4Loader&&(this.MP4Loader.cancel(),this.MP4Loader.destroy()),this.hasDestroyed=!0)}},{key:"resetTansmuxer",value:function(){this.MP4Demuxer&&this.MP4Demuxer.reset(),this.MP4Demuxer=null,this.FMP4Remuxer&&this.FMP4Remuxer.reset(),this.FMP4Remuxer=null,this.transmuxerWorkerControl&&this.transmuxerWorkerControl.reset()}}],[{key:"getDefaultConfig",value:function(){return{segmentDuration:5,onProcessMinLen:1024,chunkSize:8e5,retryCount:3,retryDelay:1e3,timeout:3e3,enableWorker:!1,playerId:"",vid:"",ext:{}}}}]),t}(vt);function To(r){if(r.keyframe)return r}var xo=function(){function r(a){Rt(this,r),this.onTick_=a,this.cancelPending_=null}return Tt(r,[{key:"tickAfter",value:function(t){var i=this,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.stop();var s=!0,n=null;this.cancelPending_=function(){window.clearTimeout(n),s=!1};var l=function(){s&&(i.onTick_(),e&&e())};return n=window.setTimeout(l,t*1e3),this}},{key:"tickEvery",value:function(t){var i=this;this.tickAfter(t,function(){i.tickEvery(t)})}},{key:"stop",value:function(){this.cancelPending_&&(this.cancelPending_(),this.cancelPending_=null)}}]),r}(),Mo=function(){function r(){Rt(this,r);var a,t,i=new Promise(function(s,n){a=s,t=n}),e=i;return e.resolve=function(s){a(s),e.state="fulfilled"},e.reject=function(s){t(s),e.state="rejected",e.isBreak=s==="DESTROYED"},e.state="pending",e}return Tt(r,[{key:"resolve",value:function(t){}},{key:"reject",value:function(t){}}]),r}(),Co="DESTROYED",Sn=null,Bi=null,Ln=null,En=null,Yo=function(r){gs(t,r);var a=Zs(t);function t(i){var e;return Rt(this,t),e=a.call(this,i),ze(Le(e),"_onMp4DataCallBack",function(){e._isMseInit&&e._onTimeUpdate()}),ze(Le(e),"_onMp4MetaReady",function(s){var n=Le(e),l=n.config,o=e.mp4.checkCodecH265();try{if(o&&!e.config.supportHevc){var u="browser not support HEVC",h=new St(e.player,{errorType:"runtime",errorTypeCode:It.runtime,errorCode:qe.h265Error,errorMessage:u,vid:l.vid,mediaError:{code:qe.h265Error,message:u}});e._errorHandler(h)}else e._initMse(s),e._initPromise.resolve()}catch(c){var d=new St(e.player,{errorType:"runtime",errorTypeCode:It.runtime,errorCode:qe.mse,errorMessage:c==null?void 0:c.message,vid:l.vid,mediaError:{code:qe.other1,message:c==null?void 0:c.message}});e._errorHandler(d);return}e._loadData()}),ze(Le(e),"_onMp4Error",function(s){var n=e.playerConfig.vid;console.error("[Index] _onMp4Error",n,s),e._errorHandler(s)}),ze(Le(e),"_loadDataSuccess",function(s){if(!(e.isDestroy||!e.mse)){e.log("[loadFragment] _loadDataSuccess ",JSON.stringify(s.context.range),",dataLen,",s.buffer?s.buffer.byteLength:0,s.state);try{s.initSeg&&(e._appendInitSeg(s.initSeg),(!s.buffer||s.buffer.byteLength<1)&&(e.log("no data, must load data"),e._onTimeUpdate()));var n=s.buffer,l=s.state,o=s.context;if(e.mse&&l&&(!n||n.byteLength<=0)&&o.fragIndex===e.mp4.timeRange.length-1){var u=e.player.buffered;u&&u.length>0&&(e.bufferEndTime=u.end(u.length-1)),e._isEnded(),e.log("loaded ended !!!==>>>",JSON.stringify(o.range),", fragIndex,",o.fragIndex,", bufferEndTime,",e.bufferEndTime,",meta_duration,",e.mp4.meta.duration)}if(e.mse&&l&&o.fragIndex===e.mp4.timeRange.length-1&&(!n||n.byteLength<=0)){var h=e.player.buffered;h&&h.length>0&&(e.bufferEndTime=h.end(h.length-1)),e._isEnded(),e.log("load ended !!!==>>>",e.playerConfig.vid,JSON.stringify(o.range),", fragIndex,",o.fragIndex,", bufferEndTime,",e.bufferEndTime,",meta_duration,",e.mp4.meta.duration)}n&&e.mse&&n&&n.byteLength>0&&e._appendBuffer(ce.VIDEO,n,o,l)}catch(c){e.log("appendBuffer error",c);var d=new St(e.player,{errorType:"runtime",errorTypeCode:It.runtime,errorCode:qe.mse,vid:e.player.config.vid,errorMessage:c.message,mediaError:{code:qe.mse,message:c.message}});e._errorHandler(d)}s!=null&&s.state&&e._onTimeUpdate()}}),ze(Le(e),"_onWaiting",function(){var s=Le(e),n=s.player,l=s.config;clearTimeout(e._waitInBufferTimer),e._waitInBufferTimer=null;var o=n.currentTime,u=n.bufferedPoint;u.end>0&&u.end-n.currentTime>=2&&e._waitAdjustTimeCnt<l.waitJampBufferMaxCnt&&(e._waitInBufferTimer=setTimeout(function(){e._waitAdjustTimeCnt++,n.currentTime=n.currentTime+.5,e.log("[waitInBufferTimeout], waitAdjustTimeCnt,",e._waitAdjustTimeCnt,",curtime,",o,et.nowTime())},l.waitingInBufferTimeOut))}),ze(Le(e),"_onSeeking",we(ie().mark(function s(){var n,l,o,u,h,d,c,f,y,g,b;return ie().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(n=Le(e),l=n.player,o=n.mp4,u=l.currentTime,e.log("[seekTime], curTime,",u,",buffer,",l.buffered2.bufferedList),!(!o||!o.meta)){G.next=5;break}return G.abrupt("return");case 5:if(e.endofstream=!1,o.bufferLoadedPos=-1,o._metaLoading=!1,h=l.bufferedPoint,d=!1,c=0,!(h.end>0)){G.next=25;break}if(d=!0,!(o.meta.duration-h.end<.5)){G.next=17;break}return e._startProgress(),e.log("[seeking in buffered range], buffer end,",h.end,", duration,",o.meta.duration),G.abrupt("return");case 17:if(c=o.getFragmentIdx(h.end),e._curLoadSegmentIdx!==c){G.next=22;break}return e._startProgress(),e.log("[seeking in buffered range], seek fragIndex is current load segmentIdx",c),G.abrupt("return");case 22:o.seekTime=h.end,c<0&&(c=e._curLoadSegmentIdx),e.log("[seeking in buffered range], seekTime ",u,",bufferRange,",h.start,"-",h.end,", fragIndex,",c);case 25:return d||(o.seekTime=u,c=o.getFragmentIdx(u),c<0&&(c=e._curLoadSegmentIdx),e.log("[seekTime out buffer range], curTime,",u,", Idx,",c),f=Le(e),y=f.mse,y&&y.isFull()&&(g=l.buffered2.bufferedList,b=g[g.length-1],y.clearOpQueues(ce.VIDEO),e._checkRemoveSourceBuffer([b.start,b.end],l.currentTime,!0,!0))),G.next=28,o.cancelLoading();case 28:o.resetFragmentLoadState(c),e._curLoadSegmentIdx=c,e._onTimeUpdate(),e._startProgress(),e._isEnded();case 33:case"end":return G.stop()}},s)}))),ze(Le(e),"changeDefineCanPlay",function(s,n,l,o){var u=Le(e),h=u.player;if(h.ended){h.currentTime=0;return}e.log("[oldChangeDefinition],this._changeDefState,",e._changeDefState),h.currentTime=e._changeDefState?e._changeDefState.currentTime:s;var d=e._changeDefState?e._changeDefState.paused:n;d?h.pause():h.play(),e._changeDefState=null,h.emit(Cr,{from:l,to:o})}),ze(Le(e),"changeDefinition",function(){var s=we(ie().mark(function n(l,o){var u,h,d,c,f,y,g;return ie().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(u=Le(e),h=u.player,d=u.config,c=u.mp4,o||(o=h.curDefinition),e._MSEError=!1,!d.witchBitRateWay){S.next=6;break}return e.oldChangeDefinition(l,o),S.abrupt("return");case 6:if(h.emit(Yr,{from:o,to:l}),f=h.currentTime,y=c.getFragmentIdx(f),y<0&&(y=e._curLoadSegmentIdx),e.log("switchBitrate:point,fragIndex,",y,",startTime,",c.timeRange[y].startTime,",currentTime,",h.currentTime),!c){S.next=16;break}return e.mp4.changeBitRateTime=f,S.next=15,c.cancelLoading();case 15:c._metaLoading&&(c._metaLoading=!1);case 16:return e._removeBuffeEndTime=c.timeRange[y].startTime,e._isChangeDefinition=!0,g=h.getBufferedRange(h.buffered),g[1]>0&&g[1]-h.currentTime>5&&(e.mse.clearOpQueues(ce.VIDEO),e.mse.remove(ce.VIDEO,h.currentTime+5,g[1])),e.log("switchBitrate: resetFragmentLoadState,",y),c.resetFragmentLoadState(y),e._curLoadSegmentIdx=y,S.next=25,e.mp4.changeBitRate(l);case 25:e._onTimeUpdate(),h.emit("RESOLUTION_UPDATE",l);case 27:case"end":return S.stop()}},n)}));return function(n,l){return s.apply(this,arguments)}}()),ze(Le(e),"_replayHook",function(){var s;return(s=e.player)===null||s===void 0||s.play(),!1}),ze(Le(e),"_retryHook",function(){return e.beforePlayerInit(),!1}),e.mp4=null,e.mse=null,e._waitAdjustTimeCnt=0,e._lastCheckTime=et.nowTime(),e._removeBuffeEndTime=0,e._pendingPromises=[],e}return Tt(t,[{key:"afterCreate",value:function(){var e=this;window.__mp4player=this;try{Kt.defineGetterOrSetter(this.player,{__url:{get:function(){try{return e.mse?e.mse.url:e.config.url}catch{return null}}}})}catch{}this._proxyPlayer()}},{key:"attachEvents",value:function(){this.off(xi,this._onSeeking),this.on(xi,this._onSeeking),this.on(ws,this._onWaiting),this.off(Ut,this.switchURL),this.on(Ut,this.switchURL)}},{key:"detachEvents",value:function(){this.off(xi,this._onSeeking),this.off(ws,this._onWaiting),this.off(Ut,this.switchURL)}},{key:"_proxyPlayer",value:function(){var e=this;typeof this.player.playNext=="function"&&(Sn=this.player.playNext),this.player.playNext=function(){e.playNext.apply(e,arguments)},Bi=this.player._startInit,En=this.player.switchURL,Ln=this.player.changeDefinition,this.player._startInit=this._playerStartInit.bind(this),this.player.switchURL=this.switchURL.bind(this),this.player.changeDefinition=this.changeDefinition.bind(this),this.player.removeHooks("replay",this._replayHook),this.player.removeHooks("retry",this._retryHook)}},{key:"_playerStartInit",value:function(e){var s=this,n=this.config,l=this.playerConfig;n.supportHevc===void 0&&ei!==null&&ei!==void 0&&ei.isHevcSupported&&ei.isHevcSupported()&&(n.supportHevc=!0);var o=this.initMp4();this._initPromise=o,this._addPendingPromise(this._initPromise),this.mse&&Mr.typeOf(e)==="String"&&/^blob/.test(e)&&e!==this.mse.url&&(e=l.url),o.then(function(){s.mse&&(e=s.mse.url),s.attachEvents(),s._startProgress()}).catch(function(u){var h=s._initPromise?s._initPromise.isBreak:!1;if(!(s.isDestroy||h)){var d=u;d.errorCode||(d=new St(s.player,{errorType:It.RUNTIME,errorCode:(u==null?void 0:u.errorCode)||qe.other,vid:s.playerConfig.vid,errorMessage:(u==null?void 0:u.errorMessage)||(u==null?void 0:u.message),mediaError:{code:(u==null?void 0:u.httpCode)||qe.other,message:(u==null?void 0:u.errorMessage)||(u==null?void 0:u.message),errorType:u==null?void 0:u.errorType}}),d.url=e),s.useVideoLoad=!0,s.player.vtype="MP4_1",s.player.emit("playCatch",s.player.vtype,d)}}).finally(function(){if(s._initPromise){var u=s._initPromise.isBreak;u||(s._initPromise&&s._removePendingPromise(s._initPromise),s._initPromise=null,!s.isDestroy&&!u&&Bi.call(s.player,e))}})}},{key:"initMp4",value:function(){var e=this,s=this.player;s.config.vid||(s.config.vid=Date.now());var n=new Mo;return this.mp4&&(this.mp4.off(Me.META_READY,this._onMp4MetaReady),this.mp4.off(Me.ERROR,this._onMp4Error),this.mp4.off(Me.MOOV_REQ_PROGRESS,this._onMp4DataCallBack),this.mp4.destroy(),this.mp4=null),this.mp4=new Ro(s.config.url,mt(mt({},this.config),{},{vid:s.config.vid})),this.mp4.on(Me.META_READY,this._onMp4MetaReady),this.mp4.on(Me.ERROR,this._onMp4Error),this.mp4.on(Me.MOOV_REQ_PROGRESS,this._onMp4DataCallBack),this.mp4.on(Me.UPDATE_LOAD_IDX,function(l){e._curLoadSegmentIdx=l,e.log("[update curLoadSegmentIdx]",l)}),this.mp4.init(),n}},{key:"setConfig",value:function(e){this.config=Object.assign(this.config,e)}},{key:"playNext",value:function(e){var s=this.player;this._defInited=!1,s.resetState(),s._currentTime=0,s._duration=0,s.isPlaying=!1,this._MSEError=!1,s.pause(),this._reset(),s.setConfig(e),this.log("[Index] playNext",e),s.play(),this.emit("playnext")}},{key:"checkDegrade",value:function(e){var s=this.config.closeDowngrade;return!s||e.httpCode==="networkError"}},{key:"_errorHandler",value:function(e){var s,n=this.player,l=this.config;if(!(!n||this.useVideoLoad)){!e.url&&(s=this.mp4)!==null&&s!==void 0&&s.url&&(e.url=this.mp4.url);var o=n.paused;console.error("final error !!!!, ",l.vid,e),this.player.vtype="MP4_2",this.player.emit("playCatch",this.player.vtype,e);var u=this.checkDegrade(e);if(u)this._initPromise?this._removeAndRejectInitPromise(e):this._startDegradedPlayback(e,o);else{this.player.pause(),this._reset();var h=n.currentTime;this.destroyMSE(),n.currentTime=h,this.emit("error",e)}}}},{key:"_startDegradedPlayback",value:function(e,s){var n=this;console.log(">>>_startDegradedPlayback");var l=this.player,o=this.playerConfig;this.useVideoLoad=!0,this.destroyMSE(),this._currentTime=l.currentTime,this.__onmetadataHandle=function(){n._currentTime&&(l.currentTime=n._currentTime),s?n.player.pause():n.player.play(),l.media.removeEventListener("loadedmetadata",n.__onmetadataHandle),n.__onmetadataHandle=null},l.media.addEventListener("loadedmetadata",this.__onmetadataHandle);var u=o.url;l.media.src=u}},{key:"_addPendingPromise",value:function(e){this._pendingPromises.push(e)}},{key:"_removePendingPromise",value:function(e){var s=this._pendingPromises.indexOf(e);s>-1&&this._pendingPromises.splice(s,1)}},{key:"_cancelPendingPromises",value:function(){this._pendingPromises.length>0&&this._pendingPromises.forEach(function(e){e.reject(Co)}),this._pendingPromises=[]}},{key:"_removeAndRejectInitPromise",value:function(e){this._initPromise&&(this._removePendingPromise(this._initPromise),this._initPromise.reject(e))}},{key:"_initMse",value:function(){var i=we(ie().mark(function s(n){var l=this,o,u,h,d,c;return ie().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!this.mse){y.next=4;break}return y.next=3,this.mse.unbindMedia();case 3:this.mse=null;case 4:o=!!n.videoCodec,u=!!n.audioCodec,o&&u?h='video/mp4; codecs="'.concat(n.videoCodec,', mp4a.40.5"'):o?h='video/mp4; codecs="'.concat(n.videoCodec,'"'):h='video/mp4; codecs="mp4a.40.5"',d=ze({},ce.VIDEO,{mimeType:"video/mp4",codec:h}),this.mse=new ce,c=this.mse.bindMedia(this.player.video),c.then(function(){var g=Object.keys(d);try{for(var b=0;b<g.length;b++){var S=g[b];l.mse.createSource(S,d[S].codec)}}catch(G){console.error("MSE error: ",G),l._errorHandler(G)}l._isMseInit=!0,l._onTimeUpdate()});case 11:case"end":return y.stop()}},s,this)}));function e(s){return i.apply(this,arguments)}return e}()},{key:"destroyMSE",value:function(){var i=we(ie().mark(function s(){var n;return ie().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(n=this.mse)===null||n===void 0?void 0:n.unbindMedia();case 2:this.mse=null;case 3:case"end":return o.stop()}},s,this)}));function e(){return i.apply(this,arguments)}return e}()},{key:"_onTimeUpdate",value:function(){var e=this,s=this.mse,n=this.mp4,l=this.player,o=this.config;if(n){var u=n.timeRange,h=l.getBufferedRange(l.buffered2);if(s&&n&&n.canDownload){et.nowTime()-this._lastCheckTime>1e3&&(this._lastCheckTime=et.nowTime(),this._loadStuckCheck(),this._checkRemoveSourceBuffer(h,l.currentTime));var d=l.paused?l.currentTime+o.minBufferLength:l.currentTime+o.maxBufferLength;h[1]-d<0&&u.every(function(c,f){if(c.downloaded)return!0;if(!e._isChangeDefinition&&c.endTime-c.startTime>1&&e._isInBuffer(c))return c.downloaded=!0,c.isLoading=!0,e.log("onTimeUpdate, ".concat(f," download segment, has buffer"),c.startTime,c.endTime),!0;c.startTime-l.currentTime<o.maxBufferLength&&(e._curLoadSegmentIdx=f,e.log("[onTimeUpdate],load index==>>>, ",f,",IdxTimeRange, ",c.startTime,"-",c.endTime,",buffEnd, ",h[1],",playCurTime,",l.currentTime,", bufferLen,",h[1]-l.currentTime,",bufferRangeList,",e.player.buffered2?e.player.buffered2.bufferedList:null),e._loadData())}),this._isEnded()}this.checkRemoveOldBitrateBuffer()}}},{key:"checkRemoveOldBitrateBuffer",value:function(){var e=this.mse,s=this.player;e&&this._removeBuffeEndTime>0&&s.currentTime>this._removeBuffeEndTime+1&&(this.log("remove old bitrate buffer",this._removeBuffeEndTime),e.remove(ce.VIDEO,0,this._removeBuffeEndTime-1),this._removeBuffeEndTime=0)}},{key:"_isInBuffer",value:function(e){for(var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=!1,l=this.player.video.buffered,o=0;o<l.length;o++){var u=l.start(o)-s,h=l.end(o)+s;if(u<=e.startTime&&e.endTime<=h){n=!0;break}}return n}},{key:"_loadData",value:function(){var i=we(ie().mark(function s(){return ie().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(!this.mp4||!this._isMseInit)){l.next=3;break}return this.log("loadData, player.mp4 null",this._isMseInit),l.abrupt("return");case 3:return l.prev=3,l.next=6,this.mp4.load(this._curLoadSegmentIdx,this._loadDataSuccess);case 6:l.next=11;break;case 8:l.prev=8,l.t0=l.catch(3),console.error("[Index] _loadData error",this.playerConfig.vid,l.t0);case 11:case"end":return l.stop()}},s,this,[[3,8]])}));function e(){return i.apply(this,arguments)}return e}()},{key:"_appendInitSeg",value:function(e){var s=this;!this.mp4||!this.mse||this.mse.append(ce.VIDEO,e,{vid:this.playerConfig.vid,range:null,dataLen:e.byteLength,isinit:!0}).then(function(n){s.log("appendInitSeg end ==>>>",n.context?n.context:null,", costTime,",n.costtime)})}},{key:"_appendBuffer",value:function(e,s){var n=this,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0,u=this.mse,h=this.config;u.append(e,s,{vid:h.vid,fragIndex:l.fragIndex,range:l.range,dataLen:s.byteLength,state:o}).then(function(d){if(n.log("player appendBuffer end ==>>>",d.context?d.context:null,", costTime,",d.costtime,", opt,",d.name,",bufferRange,",n.player.getBufferedRange()),n.mse&&l.state&&l.fragIndex===n.mp4.timeRange.length-1){var c=n.player.buffered;c&&c.length>0&&(n.bufferEndTime=c.end(c.length-1)),n._isEnded(),n.log("loaded ended !!!==>>>",l.range,", fragIndex,",l.fragIndex,", bufferEndTime,",n.bufferEndTime,",meta_duration,",n.mp4.meta.duration)}}).catch(function(d){if(console.log("[MSE error]",d),d&&u!==null&&u!==void 0&&u.isFull()){var c=n.player.getBufferedRange(n.player.buffered2);n._checkRemoveSourceBuffer(c,n.player.currentTime,!0)}})}},{key:"_checkRemoveSourceBuffer",value:function(e,s,n){var l=this,o=this.mse,u=this.mp4,h=this.player;if(!(!o||!u||!h)&&(n&&(clearTimeout(this._removeBufferTimer),this._removeBufferTimer=null),e||(e=h.getBufferedRange(h.buffered2)),s||(s=h.currentTime),!(!n&&et.nowTime()-this._checkRemoveBufferLastTime<=this.config.removeBufferLen||this.endofstream)&&(this._checkRemoveBufferLastTime=et.nowTime(),e&&e[0]>=0&&(s-e[0]>this.config.removeBufferLen||o.isFull())))){var d=e[1],c=u.getFragmentIdx(d);if(c>=0&&u.timeRange[c].startTime<s){var f=Math.floor(Math.min(u.timeRange[c].startTime,e[1]));e[0]<f?(this.log("[checkremoveSourceBuffer], remove range==>>>",e[0],f),o.remove(ce.VIDEO,e[0],f)):o.isFull()&&!this._removeBufferTimer&&(this._removeBufferTimer=setTimeout(function(){l._checkRemoveSourceBuffer(null,null,!0)},10*1e3))}}}},{key:"_isEnded",value:function(){var e=this.player,s=this.mp4,n=e.bufferedPoint,l=n?n.end:0;return!this.endofstream&&this.mse&&s.meta.duration-e.currentTime<.5&&(this.log("[check player isEnded],deal mse.endOfStream, currentTime,",e.currentTime,", bufferend,",l,", duration,",s.meta.duration),this.endofstream=!0,this.mse.endOfStream()),s&&s.meta&&s.meta.duration-e.currentTime<.5?(this._stopProgress(),this.log("[check player isEnded],stopProgress and endOfStream,currentTime, ",e.currentTime,", bufferend,",l,", duration,",s.meta.duration),this.mse&&this.mse.endOfStream(),!0):!1}},{key:"switchURL",value:function(e){this.changeDefinition(e)}},{key:"oldChangeDefinition",value:function(e,s){var n=this,l=this.config,o=this.player;this.log("[oldChangeDefinition],currentTime,",o.currentTime,",from,",s,",to,",e);var u=o.currentTime,h=o.paused;this._changeDefState||(this._changeDefState={currentTime:u,paused:h},this.log("[oldChangeDefinition],currentTime,",o.currentTime,",pause,",h)),o.config.url=e.url,l.focusUserDefinition=!0,o.currentTime=0,o.pause(),this._reset(),this._isMseInit=!1,this._changeDefineCanPlay&&o.off("canplay",this._changeDefineCanPlay),this._changeDefineCanPlay=function(){n.changeDefineCanPlay(u,h,s,e),n._changeDefineCanPlay=null},o.once("canplay",this._changeDefineCanPlay),this.player.video.load(),this.initMp4()}},{key:"_loadStuckCheck",value:function(){var e=this,s=this.config,n=this.player;s.disableBufferBreakCheck||(n.currentTime-(this._lastCurrentTime||0)>.1||n.paused?(this._bufferBreakFlag===1||this._bufferBreakFlag===2)&&(this.log("视频没有卡死,重置卡死标记"),this._bufferBreakFlag=0,clearTimeout(this._bufferBreakTimer),this._bufferBreakFlag=null):this._bufferBreakFlag||(this._bufferBreakFlag=1,this.log("卡死计时开始! 持续".concat(s.waitingTimeOut,"毫秒则确认卡死")),this._bufferBreakTimer=setTimeout(function(){e.isDestroy||(e._bufferBreakFlag===1&&(e._bufferBreakFlag=2,e.log("确认卡死!!!"),e._errorHandler(new St(e.player,{errorType:"runtime",errorTypeCode:It.runtime,errorCode:qe.waitTimeout,errorMessage:"wait_timeout",vid:s.vid}))),e._bufferBreakTimer=null)},s.waitingTimeOut)),this._lastCurrentTime=n.currentTime)}},{key:"isDestroy",get:function(){return!this.player}},{key:"_stopProgress",value:function(){this._hasStartProgress=!1,this._requestTimer&&(this._requestTimer.stop(),this._requestTimer=null),this._bufferBreakTimer&&(clearTimeout(this._bufferBreakTimer),this._bufferBreakTimer=null,this._bufferBreakFlag=void 0)}},{key:"_startProgress",value:function(){var e=this;this._hasStartProgress||(this._stopProgress(),this._requestTimer=new xo(function(){e._requestTimer&&e._onTimeUpdate()}),this._requestTimer.tickEvery(this.config.tickInSeconds),this._hasStartProgress=!0)}},{key:"log",value:function(e){for(var s=this.playerConfig,n=s&&s.vid?"[Index]".concat(s.vid," ").concat(e):"[Index] ".concat(e),l=arguments.length,o=new Array(l>1?l-1:0),u=1;u<l;u++)o[u-1]=arguments[u];Er.apply(void 0,[n].concat(o))}},{key:"_reset",value:function(){this._isMseInit=!1,this.endofstream=!1,this._curLoadSegmentIdx=0,this._removeBuffeEndTime=0,this._isChangeDefinition=!1,this._stopProgress(),this.mp4&&(this.mp4.off(Me.META_READY,this._onMp4MetaReady),this.mp4.off(Me.ERROR,this._onMp4Error),this.mp4.off(Me.MOOV_REQ_PROGRESS,this._onMp4DataCallBack),this.mp4.destroy(),this.mp4=null),this.mse&&(this.mse.unbindMedia(),this.mse=null),this._unloadVideo()}},{key:"_unloadVideo",value:function(){var e=this.player;try{this.log("unloadVideo src ".concat(e.video.src)),e.video&&e.video.src&&(e.video.removeAttribute("src"),e.video.load())}catch(s){this.log("unloadVideo error",s)}}},{key:"destroy",value:function(){var e=this.player;e.removeHooks("replay",this._replayHook),e.removeHooks("retry",this._retryHook),this.detachEvents(),this._reset(),this.player.playNext=Sn,this.player._startInit=Bi,this.player.changeDefinition=Ln,this.player.switchURL=En,this._bufferBreakTimer&&clearInterval(this._bufferBreakTimer),this._removeBufferTimer&&(clearTimeout(this._removeBufferTimer),this._removeBufferTimer=null),this._waitInBufferTimer&&(clearTimeout(this._waitInBufferTimer),this._waitInBufferTimer=null)}}],[{key:"pluginName",get:function(){return"mp4Plugin"}},{key:"defaultConfig",get:function(){return{maxBufferLength:40,minBufferLength:5,disableBufferBreakCheck:!1,waitingTimeOut:15e3,waitingInBufferTimeOut:5e3,waitJampBufferMaxCnt:3,tickInSeconds:.1,reqOptions:null,closeDowngrade:!1}}},{key:"version",get:function(){return"3.0.19"}}]),t}(Kt);const Io={__name:"index",setup(r){Mi({type:null});const a=Mi({url:[{value:"https://stream7.iqilu.com/10339/upload_transcode/202002/18/20200218114723HDu3hhxqIT.mp4",label:"mp4测试用例"},{value:"https://vip.lz-cdn5.com/20220401/3315_dbd60bc0/index.m3u8",label:"m3u8测试用例"},{value:"https://sf1-hscdn-tos.pstatp.com/obj/media-fe/xgplayer_doc_video/flv/xgplayer-demo-360p.flv",label:"flv测试用例"}]}),t=Mi({id:"mse",url:"https://vip.lz-cdn5.com/20220401/3315_dbd60bc0/index.m3u8",height:"300",width:"400",fluid:!0,fitVideoSize:"auto",volume:.6,autoplay:!1,loop:!1,videoInit:!0,poster:"",playbackRate:[.5,.75,1,1.5,2],defaultPlaybackRate:1,plugins:[],playsinline:!0,whitelist:[""],keyShortcut:"on",closeVideoClick:!0,closeVideoDblclick:!0,closeVideoTouch:!0,pip:!0,download:!0,thumbnail:{pic_num:44,width:160,height:90,col:10,row:10,urls:[""]},progressDot:[{time:10,text:"标记文字",duration:8,style:{background:"blue"}},{time:22,text:"标记文字"},{time:56,duration:8},{time:76}]});let i=Ir();_r(()=>{t.plugins.push(bi),i.value=new Vs(t)});const e=()=>{if(i.value.destroy(),t.url){let s=t.url.split(".").at(-1);switch(console.log(s),s){case"m3u8":t.plugins=[bi];break;case"flv":t.plugins=[cr];break;case"mp4":t.plugins=[Yo];break;default:t.plugins=[]}i.value=new Vs(t)}};return(s,n)=>(ui(),Rs(Zt(Tr),null,{default:Mt(()=>[n[2]||(n[2]=Ct("div",{id:"mse"},null,-1)),Lt(Zt(Wr),{"label-width":"100px",style:{"margin-top":"20px"}},{default:Mt(()=>[Lt(Zt(Ws),{label:"视频源src"},{default:Mt(()=>[Lt(Zt(wr),{modelValue:t.url,"onUpdate:modelValue":n[0]||(n[0]=l=>t.url=l),placeholder:"请输入视频源（src）",onChange:e,clearable:""},{default:Mt(()=>[(ui(!0),Wn(Fr,null,Kr(a.url,l=>(ui(),Rs(Zt(Vr),{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),Lt(Zt(Ws),{label:"视频源src"},{default:Mt(()=>[Lt(Zt(Rr),{type:"textarea",rows:4,modelValue:t.url,"onUpdate:modelValue":n[1]||(n[1]=l=>t.url=l),onChange:e,placeholder:"请输入视频源（src）",maxlength:-1,"show-word-limit":!1,autosize:!1,clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}))}},Po=JSON.parse('{"title":"xgPlayer（西瓜播放器）","description":"","frontmatter":{},"headers":[],"relativePath":"插件扩展/效率工具/xgplayer/index.md","filePath":"插件扩展/效率工具/xgplayer/index.md","lastUpdated":1728539239000}'),_o={name:"插件扩展/效率工具/xgplayer/index.md"},Ho=Object.assign(_o,{setup(r){return(a,t)=>{const i=Hr("client-only");return ui(),Wn("div",null,[t[1]||(t[1]=Ct("h1",{id:"xgplayer-西瓜播放器",tabindex:"-1"},[Dr("xgPlayer（西瓜播放器） "),Ct("a",{class:"header-anchor",href:"#xgplayer-西瓜播放器","aria-label":'Permalink to "xgPlayer（西瓜播放器）"'},"​")],-1)),t[2]||(t[2]=Ct("p",null,[Ct("a",{href:"https://h5player.bytedance.com/",target:"_blank",rel:"noreferrer"},"xgPlayer 官网")],-1)),Lt(i,null,{default:Mt(()=>[t[0]||(t[0]=Ct("br",null,null,-1)),Lt(Io)]),_:1}),t[3]||(t[3]=Pr(`<div class="warning custom-block"><p class="custom-block-title">视频格式支持</p><p>目前仅支持（hls，mp4，flv）</p></div><br><details class="details custom-block"><summary>具体实现代码</summary><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-iVcwb" id="tab-55Vg8bJ" checked><label for="tab-55Vg8bJ">index.vue</label></div><div class="blocks"><div class="language-vue vp-adaptive-theme active line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { ElCard, ElForm, ElFormItem, ElInput, ElOption, ElSelect } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;element-plus&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;element-plus/dist/index.css&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { onMounted, reactive, ref } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vue&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;xgplayer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Player </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;xgplayer&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> FlvPlayer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;xgplayer-flv&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> HlsPlayer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;xgplayer-hls&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Mp4Player </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;xgplayer-mp4&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;xgplayer/dist/index.min.css&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 配置选项</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Form</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> reactive</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    type: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> dicts</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> reactive</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    url: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        { value: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;https://stream7.iqilu.com/10339/upload_transcode/202002/18/20200218114723HDu3hhxqIT.mp4&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, label: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;mp4测试用例&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        { value: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;https://vip.lz-cdn5.com/20220401/3315_dbd60bc0/index.m3u8&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, label: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;m3u8测试用例&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        { value: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;https://sf1-hscdn-tos.pstatp.com/obj/media-fe/xgplayer_doc_video/flv/xgplayer-demo-360p.flv&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, label: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;flv测试用例&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// xgplayer</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> reactive</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;mse&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://vip.lz-cdn5.com/20220401/3315_dbd60bc0/index.m3u8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 尺寸</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;height&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;300&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;width&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;400&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 流式布局</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;fluid&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 自适应视频内容宽高</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;fitVideoSize&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;auto&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 音量</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;volume&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 自动播放</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;autoplay&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 循环播放</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;loop&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 初始化显示视频首帧</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;videoInit&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 封面图</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;poster&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 倍速播放</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;playbackRate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.75</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 默认播放速度</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;defaultPlaybackRate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 记忆播放</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 离开时存下 上次播放时间</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    //  lastPlayTime: 20, //视频起播时间（单位：秒）</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // lastPlayTimeHideDelay: 5, //提示文字展示时长（单位：秒）</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 视频旋转</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // &quot;rotate&quot;: {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    //     &quot;clockwise&quot;: true,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    //     &quot;innerRotate&quot;: true</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // },</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;plugins&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;playsinline&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;whitelist&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;keyShortcut&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;on&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;closeVideoClick&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;closeVideoDblclick&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;closeVideoTouch&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;pip&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;download&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;thumbnail&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;pic_num&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">44</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;width&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">160</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;height&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">90</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;col&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;row&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;urls&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            &quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 预览本地视频</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // preview: {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    //     uploadEl: uploadDom</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    progressDot: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//展示标记的时间</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            text: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;标记文字&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//鼠标hover在标记时展示的文字</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            duration: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//标记段长度（以时长计算）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            style: { </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//标记样式</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                background: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;blue&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">22</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            text: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;标记文字&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">56</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            duration: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            time: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">76</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> player </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onMounted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    options.plugins.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(HlsPlayer)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    player.value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Player</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(options)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> change</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    player.value.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">destroy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (options.url) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> type </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> options.url.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">split</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;.&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">at</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(type);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        switch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (type) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            case</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;m3u8&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                options.plugins </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [HlsPlayer]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                break</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            case</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;flv&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                options.plugins </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [FlvPlayer]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                break</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            case</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;mp4&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                options.plugins </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [Mp4Player]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                break</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                options.plugins </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        player.value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Player</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(options)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ElCard</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;mse&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">el-form</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> label-width</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;100px&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> style</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">margin-top</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">px</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">el-form-item</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> label</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;视频源src&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">el-select</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> v-model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">options.url</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> placeholder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;请输入视频源（src）&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">change</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">change</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> clearable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">el-option</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> v-for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dicts.url</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item.value</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">label</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item.label</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">item.value</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">el-option</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">el-select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">el-form-item</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">el-form-item</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> label</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;视频源src&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">el-input</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;textarea&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rows</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> v-model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">options.url</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">change</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">change</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> placeholder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;请输入视频源（src）&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                    :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">maxlength</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">show-word-limit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">autosize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> clearable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">el-input</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">el-form-item</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">el-form</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ElCard</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">style</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> lang</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;scss&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> scoped</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">style</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br></div></div></div></div></details><br>`,4))])}}});export{Po as __pageData,Ho as default};
